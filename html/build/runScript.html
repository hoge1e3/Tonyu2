<!DOCTYPE html>
<head>
<meta charset="utf-8">
<script src="../../js/lib/jquery-1.10.1.js" type="text/javascript"></script>
<script src="../../js/lib/timbre.js" type="text/javascript"></script>
<script src="../../js/gen/runScript_concat.js"></script>
</head>
<!--
このプログラムをTonyuの開発環境で編集するには，
http://tonyuedit.appspot.com/edit/importFromJsdoit.html
を開きます．
-->
<script type='text/tonyu' data-filename='Ball.tonyu'>


while(y<$screenHeight && !$gov) {
    y+=$spd;
    if ( dist2($mouseX-x,$mouseY-y)<400 ) {
        if (check()) {
            playSE("l64o4v10gfev5dc>g v3fedc");
        } else {
            playSE("l16 o3 b-b-4");
            new X{x,y,text:"x"};
        }
        $prev=p;
        dieEffect();
    }
    update();
}
$gov=true;
dieEffect();

\dist2(x,y) {
    return x*x+y*y;
}

\dieEffect() {
    while (true) {
        scaleX+=0.1;
        alpha-=20;
        rotate+=20;
        if (alpha<=0) break;
        update();
    }
    die();
}

\getCol(p) {
    var pp=p-$pat_balls;
    var c=pp%5;
    var r=(pp-c)/5;
    return {c,r};
}
\check(){
    if (!$prev) return true;
    var p1=getCol($prev);
    var p2=getCol(p);
    return p1.c==p2.c || p1.c==p2.r || p1.r==p2.c || p1.r==p2.r;
}</script>

<script type='text/tonyu' data-filename='Main.tonyu'>
$spd=1;
$gov=false;
$prev=null;
tick=32;
new MayGet{x:200, y:250, t:-1};
new MayGet{x:100, y:300, t:0};
new MayGet{x:100, y:350, t:1};
new MayGet{x:320, y:300, t:2};
new MayGet{x:320, y:350, t:3};
//x=20;
//y=20;
while(!$gov) {
    if (tick>32) {
        new Ball{p:$pat_balls+rnd(25),x:rnd($screenWidth),y:0};
        tick-=32;
    }
    if (all(Ball).max("y")<$screenHeight-200) {
        $spd=5;
    } else {
        $spd=1;
    }
    tick+=$spd;
    if (all(X).size()>=3) $gov=true;
    update();
}
size=30;
x=$screenWidth/2; y=$screenHeight/2;
play("o4l16v15av10>av5>a");
text="Game Over";
//for (a in all(Ball)) a.dieEffect();
</script>

<script type='text/tonyu' data-filename='MayGet.tonyu'>
text="-";
col=["青","赤","黄","緑","紫"];
while (true) {
    if (t==-1) {
        if ($prev) text="取っていいボール：";
        else text="どれか1つボールを取る";
    }
    if ($prev) {
        pp=$prev-$pat_balls;
        pc=pp%5;
        pr=(pp-pc)/5;
        if (t==0) {
            text="文字の色が"+col[pc]+"色のボール";
        } else if (t==1) {
            text="文字の色が"+col[pr]+"色のボール";
        } else if (t==2) {
            text="「"+col[pr]+"」という文字が書かれたボール";
        } else if (t==3) {
            text="「"+col[pc]+"」という文字が書かれたボール";
        }

    }
    update();
}</script>

<script type='text/tonyu' data-filename='X.tonyu'>text="X";
fillStyle="red";
size=10;
while (size<50) {
    size+=5;
    update();
}
while (x<all(X).max("x")+32) {
    x+=32;
    update();
}
while (y<$screenHeight-50) {
    y+=32;
    update();
}
y=$screenHeight-50;
while (x>50) {
    x-=10;
    if (crashTo(X)) {
        x+=10;
        break;
    }
    update();
}
</script>

<script type='text/tonyu' data-filename='.desktop' data-wrap='80'>{"runMenuOrd":["Main","Ball","MayGet","X"]}
</script>

<script type='text/tonyu' data-filename='res.json' data-wrap='80'>{"images":[{"name":"$pat_base","url":"images/base.png","pwidth":32,"pheight":32}\
,{"name":"$pat_balls","url":"http://jsrun.it/assets/9/P/f/p/9Pfpj.png","pwidth":\
32,"pheight":32}],"sounds":[]}






</script>

<script type='text/tonyu' data-filename='options.json' data-wrap='80'>{"compiler":{"defaultSuperClass":"Actor"},"run":{"mainClass":"Main","bootClass":\
"Boot"},"kernelEditable":false}
</script>


