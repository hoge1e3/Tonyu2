{"version":3,"sources":["/prj/mapEditor2/Cursor.tonyu","/prj/mapEditor2/DstCur.tonyu","/prj/mapEditor2/Edit.tonyu","/prj/mapEditor2/MapFiles.tonyu","/prj/mapEditor2/PatList.tonyu","/prj/mapEditor2/PatSel.tonyu","/prj/mapEditor2/StartMapEditor.tonyu"],"names":[],"mappings":"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","sourcesContent":["var dx,dy;\r\nvar undos;\r\nvar curP;\r\n\\onAppear() {\r\n    undos=[];\r\n}\r\n\\draw(ctx) {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.strokeStyle=\"white\";\r\n    if (dx==null) dx=x;\r\n    if (dy==null) dy=y;\r\n    var w=$map.chipWidth, h=$map.chipHeight;\r\n    ctx.moveTo(     x*w  , y*h);\r\n    ctx.lineTo((dx+1)*w-1, y*h);\r\n    ctx.lineTo((dx+1)*w-1, (dy+1)*h-1);\r\n    ctx.lineTo(     x*w  , (dy+1)*h-1);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n    ctx.restore();\r\n}\r\n\\move(dx,dy) {\r\n    x+=dx;y+=dy;\r\n    x=clamp(x,0,min(250,$map.col+30));\r\n    y=clamp(y,0,min(250,$map.row+30));\r\n    dx=x;dy=y;\r\n\r\n    //print(\"moved\", x,y);\r\n}\r\n\r\n\\moveTo(xx,yy) {\r\n    if (x==xx && y==yy) return false;\r\n    x=xx;y=yy;\r\n    dx=x;dy=y;\r\n    //print(\"moved\", x,y);\r\n    return true;\r\n}\r\n\\clearUndos() {\r\n    undos=[];\r\n}\r\n\\rollbacker() {\r\n    var c=undos.length;\r\n    return {\r\n        rollback: \\{\r\n            while(undos.length>c) {\r\n                undo();\r\n            }\r\n        }\r\n    };\r\n}\r\n\\curLayerName {\r\n    return curLayer.name;\r\n}\r\n\\curLayer {// {name:string, pats:[number]}\r\n    return curP.curL;\r\n}\r\n\\undo() {\r\n    var u=undos.pop();\r\n    if (!u) return;\r\n    $map.chip(u.x,u.y, u.layer.name).p=u.was;\r\n    /*if (u.layer===\"base\") {\r\n        $map.set(u.x, u.y, u.was);\r\n    } else {\r\n        $map.setOn(u.x, u.y, u.was);\r\n    }*/\r\n}\r\n\\put(curP) {\r\n    //print(p,la);\r\n    var chip=$map.chip(x,y,curLayerName);\r\n    var was=chip.p;\r\n    chip.p=curP.p;\r\n    /*if (curP.curL===\"base\") {\r\n        was=$map.get(x,y);\r\n        $map.set(x,y,curP.p);\r\n        //$map.setOn(x,y,$map.getOn(x,y));\r\n    } else {\r\n        was=$map.getOn(x,y);\r\n        $map.setOn(x,y,curP.p);\r\n    }*/\r\n    undos.push{x,y,was,layer:curLayer};\r\n    $editor.modified();\r\n}\r\n\\pick(curP) {\r\n    var chip=$map.chip(x,y,curLayerName);\r\n    curP.set(chip.p);\r\n    /*if (curP.curL===\"base\") {\r\n        curP.set($map.get(x,y));\r\n    } else {\r\n        curP.set($map.getOn(x,y));\r\n    }*/\r\n    return true;\r\n}\r\n\\sel(dx,dy) {\r\n    if (dx==x && dy==y) return false;\r\n    if (dx>x) {\r\n        this.dx=dx;\r\n    } else {\r\n        this.dx=x;\r\n        x=dx;\r\n    }\r\n    if (dy>y) {\r\n        this.dy=dy;\r\n    } else {\r\n        this.dy=y;\r\n        y=dy;\r\n    }\r\n    return true;\r\n}","var row, col;\r\n\r\n\\draw(ctx) {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.strokeStyle=\"red\";\r\n    ctx.moveTo(x*32,y*32);\r\n    ctx.lineTo((x+col)*32-1,y*32);\r\n    ctx.lineTo((x+col)*32-1,(y+row)*32-1);\r\n    ctx.lineTo(x*32,(y+row)*32-1);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n    ctx.restore();\r\n}\r\n\\setFrom(cur) {\r\n    x=cur.x;y=cur.y;\r\n    col=cur.dx-cur.x+1;\r\n    row=cur.dy-cur.y+1;\r\n    \r\n}\r\n\\doCopy(cur) {\r\n    var a=[];\r\n    \r\n    for (var i=0;i<row;i++) {\r\n        for (var j=0;j<col;j++) {\r\n            var p=$map.get(cur.x+j, cur.y+i);\r\n            a.push(p);\r\n            var p=$map.getOn(cur.x+j, cur.y+i);\r\n            a.push(p);\r\n        }\r\n    }\r\n    for (var i=0;i<row;i++) {\r\n        for (var j=0;j<col;j++) {\r\n            $map.set(x+j,y+i,a.shift());\r\n            $map.setOn(x+j,y+i,a.shift());\r\n        }\r\n    }\r\n    \r\n}","\n$Screen.selectLayer($mainLayer);\n\nvar mapFile;\nvar config=config||$editorConfig;// Config\n$editor=this;\nmapFile=mapFile||$lastFile;\n$lastFile=mapFile;\n$map=new Map2;\nif (mapFile.exists()) {\n    $map.load(mapFile);\n}\n$map.expand=\"right bottom\";\nvar bw=50;\nvar h=$screenHeight;\nvar w=$screenWidth;\nvar bhide=1000;\nnew Button{left:bw*0.5-bhide, top: h-bw*3, width:bw ,text:\"↑\", key:\"up\",onClick:moveC,autoRepeat:30};\nnew Button{left:bw*0.5-bhide, top: h-bw*1, width:bw ,text:\"↓\", key:\"down\",onClick:moveC,autoRepeat:30};\nnew Button{left:bw*0-bhide, top: h-bw*2, width:bw ,text:\"←\", key:\"left\",onClick:moveC,autoRepeat:30};\nnew Button{left:bw*1-bhide, top: h-bw*2, width:bw ,text:\"→\", key:\"right\",onClick:moveC,autoRepeat:30};\n\n\nvar putB=new Button{top:h-bw*3,left:bw*3-bhide,width:100,text:\"Put\",key:\"space\",onClick:put};\nnew Button{top:h-bw*3,left:bw*5-bhide,width:100,text:\"Pick\",key:\"z\",onClick:pick};\nif (config.mainPage) {\n    new Button{top:h-bw*1,left:bw*1,width:100,text:\"Play\",key:\"p\",onClick:play};\n}\nnew Button{top:h-bw*1,left:bw*4,width:100,text:\"Exit\",key:\"e\",onClick:back};\nnew Button{top:h-bw*1,left:w-100,width:100,text:\"Undo\",key:\"u\",onClick:\\{\n        c.undo();\n}};\n\n\nif (config.showHelp) {\n    new Label{x:10,y:h-bw*3,text:\"Left Click: Put\\n\"+\n        \"Right Click: Pick\\n\"+\n        \"Right Click x2: Change Layer\\n\"+\n        \"Right Click+drag: Copy Mode\\n\"+\n        \"wasd or Multi tap: Scroll\",\n        align:\"left\",\n        size:20\n    };\n}\n\nvar menuPanelHeight=bw*(1+config.layers.length);\n\nvar sx=w/2,sy=h/2,zoom=1;\n$Screen.setPivot(sx,sy);\n$Screen.scrollTo(sx,sy);\n\nvar plw=$Math.max.apply($Math, config.layers.map\\(l) {return l.pats.length;} );\nvar curP=new PatList{config, x:w-plw*32, y:h-menuPanelHeight};\nvar c=new Cursor{x:0,y:0,curP};\non(\"keyDown\",\"c\") \\{\n    curP.shift(1);      \n};\non(\"keyDown\",\"x\") \\{\n    curP.shift(-1);      \n};\non(\"keyDown\",\"q\") \\{\n    curP.changeLayer();\n};\non(\"keyDown\",\"d\") \\{\n    scrollTo(sx+32,sy,zoom);\n};\non(\"keyDown\",\"a\") \\{\n    scrollTo(sx-32,sy,zoom);\n};\non(\"keyDown\",\"s\") \\{\n    scrollTo(sx,sy+32,zoom);\n};\non(\"keyDown\",\"w\") \\{\n    scrollTo(sx,sy-32,zoom);\n};\n\\scrollTo(sx,sy,zoom) {\n    var csz=getChipSize(curP.p);\n    if (!csz) return;\n    sx=clamp(sx,0, 240*32-w/2);\n    sy=clamp(sy,0, 240*32-h/2);\n    zoom=clamp(zoom, 0.1, 5);\n    $Screen.scrollTo(sx,sy,zoom);\n    extend{sx,sy,zoom};\n}\n\\zoomAt(px, py, zoom) {\n    var p=new Vec3(px,py);\n    var s=new Vec3(sx,sy);\n    var d=s.sub(p);\n    \n    /*\n    zoom=2\n       <p>\n          <s>\n          \n       <p>\n          <ns>\n             <s>\n    */\n}\n\nvar lastMousePos;\nvar dstCur;\nvar mmove=$InputDevice.on(\"mouseMove\") \\(e) {\n    //print(e.x,e.y);\n    var cv=$Screen.convert(e,$mainLayer);\n    if (dstCur) {\n        var csz=getChipSize(curP.p);\n        if (!csz) return;\n        e.layer=$frontLayer;\n        dstCur.x=floor(cv.x/csz.w);\n        dstCur.y=floor(cv.y/csz.h);\n    }\n    lastMousePos={x:cv.x, y:cv.y};\n};\non(\"die\") \\{\n    mmove.remove();\n};\n\nvar menuPanel=new Panel{\n    width:w, height:menuPanelHeight, \n    x:w/2,   y:h-menuPanelHeight/2,\n    alpha:180, zOrder:100, layer:$frontLayer\n};\nmenuPanel.fillStyle=\"gray\";\nmenuPanel.fillRect(0,0,menuPanel.width,menuPanel.height);\nvar mapToucher=new Panel{width:$screenWidth, height: h-menuPanel.height, layer:$frontLayer};\nvar singleTouchState, multiTouchState;//=false, multi=false ,rb;\nmapToucher.on(\"touch\") \\(e){\n    //print(e.finger.x, e.finger.y);  \n    var f=e.finger;\n    var csz=getChipSize(curP.p);\n    if (!csz) return;\n    f.layer=$mainLayer;\n    if (singleTouchState) {\n        //print(\"Double!\");\n        if (!multiTouchState) {\n            singleTouchState.rollback();\n            multiTouchState={\n                finger1: singleTouchState.finger,\n                finger2: f,\n            };\n            procMulti(multiTouchState);\n        }\n        return;\n    } else {\n        var s={\n            rollbacker=c.rollbacker(),\n            finger=f,\n            rollback=\\{\n                s.rollbacker.rollback();\n                s.endEvent.remove();\n                if (s.moveEvent) s.moveEvent.remove();     \n            },\n            endEvent=f.on(\"end\") \\{\n                singleTouchState=null;  \n            }\n        };\n        singleTouchState=s;\n    }\n    //print (e.byMouse);\n    if (e.byMouse==2) {\n        var moved=c.moveTo(floor(e.finger.x/csz.w), floor(e.finger.y/csz.h));\n        if (!moved) {\n           // print(\"layer change!\");\n            curP.changeLayer();\n        }\n        pick();\n        f.on(\"move\") \\(e) {\n            // print(\"mv\");\n            var moved=c.sel(floor(e.finger.x/csz.w), floor(e.finger.y/csz.h));\n            if (!moved) return;\n            if (!dstCur) dstCur=new DstCur;\n            dstCur.setFrom(c);\n        };\n        \n    } else {\n        if (dstCur) {\n            dstCur.doCopy(c);\n            dstCur.die();\n            dstCur=null;\n            var moved=c.moveTo(floor(e.finger.x/csz.w), floor(e.finger.y/csz.h));\n        } else {\n            var moved=c.moveTo(floor(e.finger.x/csz.w), floor(e.finger.y/csz.h));\n            put();\n            singleTouchState.moveEvent=f.on(\"move\") \\(e) {\n                var moved=c.moveTo(floor(e.finger.x/csz.w), floor(e.finger.y/csz.h));\n                if (moved) put();\n            };\n        }\n    }\n};\n\\procMulti(m) {\n    var f1=m.finger1;\n    var f2=m.finger2;\n    f1.layer=$frontLayer;\n    f2.layer=$frontLayer;\n    var ox=(f1.x+f2.x)/2;\n    var oy=(f1.y+f2.y)/2;\n    var ssx=sx,ssy=sy;\n    var od=dist(f1.x-f2.x, f1.y-f2.y);\n    var sz=zoom;\n    var h=[\n    f1.on(\"move\", mv),\n    f2.on(\"move\", mv),\n    f1.on(\"end\",ed),\n    f2.on(\"end\",ed),\n    ];\n    \\mv() {\n        var nx=(f1.x+f2.x)/2;\n        var ny=(f1.y+f2.y)/2;\n        var d=dist(f1.x-f2.x, f1.y-f2.y);\n        scrollTo(ssx-(nx-ox)/zoom, ssy-(ny-oy)/zoom, sz*(d/od));\n    }\n    \\ed() {\n        for (var e of h) e.remove();\n        singleTouchState=multiTouchState=null;\n    }\n}\n\n\\moveC(b) {\n    switch (b.key){\n        case \"up\":\n        c.move(0,-1);\n        \n        if (putB.clicked) put();\n        break;\n        case \"down\":\n        c.move(0,1);\n        if (putB.clicked) put();\n        break;\n        case \"left\":\n        c.move(-1,0);\n        if (putB.clicked) put();\n        break;\n        case \"right\":\n        c.move(1,0);\n        if (putB.clicked) put();\n        break;\n    }\n}\n\\getChipSize(p) {\n    var chipWidth=$map.chipWidth;\n    var chipHeight=$map.chipHeight;\n    if (chipWidth && chipHeight) {\n        return {w:chipWidth, h:chipHeight};\n    }\n    var pImg=$imageList[p];\n    if (pImg) {\n        chipWidth=pImg.width||32;\n        chipHeight=pImg.height||32;\n        return {w:chipWidth, h:chipHeight};\n    }/* else {\n        chipWidth=chipWidth|| 32;\n        chipHeight=chipHeight || chipWidth|| 32;\n    }*/\n    return null;\n}\n\\put() {\n    c.put(curP);\n}\n\\pick() {\n    c.pick(curP);\n}\n\\save() {\n    $map.save(mapFile);\n}\n\\play() {\n    save();\n    loadPage(config.mainPage) {mapFile};\n}\n\\back() {\n    save();\n    loadPage(MapFiles) {config};\n}\n\\modified() {\n    //$records.modified(mapFile);\n}","var config=config||$editorConfig;\r\nvar mapEXT=\".json\";\r\nvar mapDir=config.mapDir;//$editable ? $userMapDir :  $storyMapDir;\r\nif (!mapDir.exists()) mapDir.mkdir();\r\n$InputBox.useNative=true;\r\n$Screen.resize(600,800);\r\n$Screen.setPivot(0,0);\r\n$Screen.scrollTo(0,0);\r\n$Screen.selectLayer($frontLayer);\r\n\r\n$Screen.on(\"touch\") \\(e) {\r\n    let f=e.finger;\r\n    f.on(\"move\") \\{\r\n        $Screen.scrollBy(0,-f.vy);      \r\n    };\r\n};\r\n$sound.stopBGM();\r\ny=20;\r\nvar pitch=50;\r\nfor (var mf of mapDir.listFiles()) {\r\n    if (mf.ext()!==\".json\") break;\r\n    item(mf,y);\r\n    y+=pitch;\r\n}\r\nnewItem(y);\r\ny+=pitch;\r\nbackItem(y);\r\n\\newItem(y) {\r\n    var b=new Button{left:10,top:y, width:100, padding:2,height:pitch*0.7,text:\"New..\"};\r\n    b.on(\"touch\") \\{\r\n        //$InputDevice.reset();\r\n        var name=uniqFile(mapDir, \"map\", mapEXT).truncExt();\r\n        name=$InputBox.prompt(\"New File Name\",name);\r\n        if (name) {\r\n            name=name.replace(/\\.json$/,\"\");\r\n            name=name+\".json\";\r\n            loadPage(Edit) {config, mapFile:mapDir.rel(name)}; \r\n        }\r\n    };\r\n}\r\n\\backItem(y) {\r\n    if (!config.titlePage) return;\r\n    var b=new Button{left:10,top:y, width:100, padding:2,height:pitch*0.7,text:\"Title\"};\r\n    b.on(\"touch\") \\{\r\n        loadPage(config.titlePage);\r\n    };\r\n}\r\n\r\n\r\n\\item(file, y) {\r\n    var name=file.truncExt();\r\n    new Actor{text:name,align:\"left\", x:10,y,size:30,layer:$frontLayer};\r\n    var b;\r\n    var xx=400;\r\n    b=new Button{left:$screenWidth-xx,top:y, width:100, padding:2,height:pitch*0.8,text:\"Edit\"};\r\n    b.on(\"touch\") \\{\r\n        loadPage(Edit) {config, mapFile:file};  \r\n    };\r\n    xx-=100;\r\n    if (config.mainPage) {\r\n        b=new Button{left:$screenWidth-xx,top:y, width:100, padding:2,height:pitch*0.8,text:\"Play\"};\r\n        b.on(\"touch\") \\{\r\n            loadPage(config.mainPage) {mapFile:file};  \r\n        };\r\n    }\r\n    xx-=100;\r\n    b=new Button{left:$screenWidth-xx,top:y, width:100, padding:2,height:pitch*0.8,text:\"Copy\"};\r\n    b.on(\"touch\") \\{\r\n        //$InputDevice.reset();\r\n        name=uniqFile(file.up(), file.truncExt(), mapEXT).truncExt();\r\n        var nname=$InputBox.prompt(\"New File Name\",name);\r\n        if (nname && name!==nname) {\r\n            file.copyTo(file.sibling(nname+mapEXT));\r\n            loadPage(MapFiles) {config};\r\n        }\r\n    };\r\n    xx-=100;\r\n    b=new Button{left:$screenWidth-xx,top:y, width:100, padding:2,height:pitch*0.8,text:\"Del\",\r\n        fillStyle=\"#f88\"\r\n    };\r\n    b.on(\"touch\") \\{\r\n        //$InputDevice.reset();\r\n        var r=$InputBox.confirm(\"Delete \"+name+\"?\");\r\n        if (r) {\r\n            file.rm();\r\n            loadPage(MapFiles) {config};\r\n        }\r\n    };\r\n}\r\n\\uniqFile(dir,name, ext) {\r\n    name=name.replace(/\\d*$/,\"\");\r\n    var res=dir.rel(name+ext);\r\n    var i=1;\r\n    for (var j=0;j<100;j++) {\r\n        res=dir.rel(name+i+ext);\r\n        if (!res.exists()) break;\r\n        i++;\r\n    }\r\n    //print(res.path()+\"NOT EX!\");\r\n    return res;\r\n}","\"field strict\";\n\\draw(){}\nvar editor;\nvar config;\nvar patSels;// [ [PatSel] ]\nvar layers=config.layers;//[ {name:string, pats:[number]} ] \nvar curL=layers[0];// {name:string, pats:[number]}\nvar savePats=[];//[number];\n\nvar bw=50;\nvar patSels=config.layers.map\\(layer, lidx) {\n    return layer.pats.map\\(p,i) {\n        return new PatSel{y:y+(config.layers.length-1-lidx)*bw+16 , x:x+32*i, p , la:layer};\n    };\n};\nsavePats=layers.map\\(layer) {\n    return layer.pats[clamp(1,0,layer.pats.length-1)];\n};\np=savePats[curL];\nvar cursor=new Actor{x:0,y:0,layer,text:\"▲\"};\nsize=20;\nshift(0);\n\n\\curLIndex {\n    return layers.indexOf(curL);\n}\n\\curLIndex=v {\n    curL=layers[v];\n}\n\\changeLayer() {\n    var i=curLIndex;\n    savePats[i]=p;\n    i=(i+1)%layers.length;\n    p=savePats[i];\n    curLIndex=i;\n    shift(0);\n    /*if (curL===\"base\") {\n        savePats.base=p;\n        p=savePats.on;\n        curL=\"on\";\n        shift(0);\n    } else {\n        savePats.on=p;\n        p=savePats.base;\n        curL=\"base\";\n        shift(0);\n    }*/\n}\n\\defaultLayer{\n    return $frontLayer;\n}\n\\shift(by) {\n    var a=patSels[curLIndex];\n    for(var i=0;i<a.length ;i++) {\n        if (a[i].p===p && !clamped(i+by,0,a.length-1)) {\n            p=a[i+by].p;\n            cursor.x=a[i+by].x;\n            cursor.y=a[i+by].y+16;\n            break;\n        }\n    }\n}\n\\set(p, la) {// la:  {name:string, pats:[number]}\n    var preP=this.p, preL=curL;\n    curL=la || curL;\n    this.p=p;\n    if (preP==this.p && preL==curL) {\n        return false;\n    }\n    shift(0);\n    return true;\n}","\nvar la;// {name:string, pats:number}\n\\draw(ctx) {\n    if (p>-1) {\n        if (width && height) {\n            scaleX=32/width;\n            scaleY=32/height;\n        }\n        return super.draw(ctx);\n    }\n    text=\"Del\";\n    fillStyle=\"white\";\n    super.draw(ctx);\n    width=32;\n    height=32;\n    text=null;\n    \n}\n\\defaultLayer{\n    return $frontLayer;\n}\non(\"touch\",sel);\n\n\\sel(e) {\n    $editor.curP.set(p,la);\n}","\n//「実行」→「StartMapEditorを実行」で起動\n\nvar bp=$pat_mapchip;\n$editorConfig={\n    //レイヤー名，レイヤーで使えるパターン\n    layers:[\n    //奥のレイヤー\n    {name:\"base\", pats:[-1, bp+88, bp+89, bp+90, bp+91]},\n    //手前のレイヤー\n    {name:\"on\", pats:[-1,  $pat_mgoku, bp+1, bp+2, bp+3, bp+4, $pat_neko]},\n    ],\n    \n    // 編集対象のマップファイルのあるフォルダ\n    mapDir: file(\"../maps/\"),\n    \n    // オプション：「Play」ボタンで読み込まれるページクラスを指定．\n    // フィールドmapFileにマップのファイル名．次のように読み込む:\n    //   $map=new Map2;$map.load(mapFile);\n    //mainPage: Stage,\n    \n    // オプション：「Title」ボタンで読み込まれるページ\n    //titlePage: Title,\n    \n    showHelp: true,//ヘルプの表示\n};\nloadPage(MapFiles);\n\n\n"]}