Tonyu.klass.define({
  fullName: 'kernel.EventHandlerCaller',
  shortName: 'EventHandlerCaller',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_EventHandlerCaller_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_EventHandlerCaller_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      callEventHandler :function _trc_EventHandlerCaller_callEventHandler(h,args) {
        "use strict";
        var _this=this;
        var t;
        
        
        //$LASTPOS=1000076;//kernel.EventHandlerCaller:76
        if (h["fiber"]) {
          //$LASTPOS=1000103;//kernel.EventHandlerCaller:103
          t=Tonyu.thread();
          //$LASTPOS=1000130;//kernel.EventHandlerCaller:130
          h["fiber"].apply(_this.target,[t].concat(args));
          //$LASTPOS=1000184;//kernel.EventHandlerCaller:184
          t.steps();
          
        } else {
          //$LASTPOS=1000218;//kernel.EventHandlerCaller:218
          h.apply(_this.target,args);
          
        }
      },
      fiber$callEventHandler :function _trc_EventHandlerCaller_f_callEventHandler(_thread,h,args) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var t;
        
        
        //$LASTPOS=1000076;//kernel.EventHandlerCaller:76
        if (h["fiber"]) {
          //$LASTPOS=1000103;//kernel.EventHandlerCaller:103
          t=Tonyu.thread();
          //$LASTPOS=1000130;//kernel.EventHandlerCaller:130
          h["fiber"].apply(_this.target,[t].concat(args));
          //$LASTPOS=1000184;//kernel.EventHandlerCaller:184
          t.steps();
          
        } else {
          //$LASTPOS=1000218;//kernel.EventHandlerCaller:218
          h.apply(_this.target,args);
          
        }
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"callEventHandler":{"nowait":false}},"fields":{"target":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.EventMod',
  shortName: 'EventMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_EventMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=2000047;//kernel.EventMod:47
        "field strict";
        
      },
      fiber$main :function _trc_EventMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=2000047;//kernel.EventMod:47
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initEventMod :function _trc_EventMod_initEventMod() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=2000114;//kernel.EventMod:114
        if (_this._eventHandlers) {
          return _this;
        }
        //$LASTPOS=2000207;//kernel.EventMod:207
        _this._eventHandlers={};
        //$LASTPOS=2000230;//kernel.EventMod:230
        _this.on("die",Tonyu.bindFunc(_this,_this.releaseEventMod));
      },
      releaseEventMod :function _trc_EventMod_releaseEventMod() {
        "use strict";
        var _this=this;
        var k;
        var v;
        var _it_2;
        
        //$LASTPOS=2000294;//kernel.EventMod:294
        _it_2=Tonyu.iterator(_this._eventHandlers,2);
        while(_it_2.next()) {
          k=_it_2[0];
          v=_it_2[1];
          
          //$LASTPOS=2000336;//kernel.EventMod:336
          v.release();
          
        }
      },
      parseEventArgs :function _trc_EventMod_parseEventArgs(a) {
        "use strict";
        var _this=this;
        var res;
        var i;
        
        //$LASTPOS=2000391;//kernel.EventMod:391
        res = {type: a[0],args: []};
        
        //$LASTPOS=2000425;//kernel.EventMod:425
        //$LASTPOS=2000430;//kernel.EventMod:430
        i = 1;
        for (; i<a.length ; i++) {
          {
            //$LASTPOS=2000468;//kernel.EventMod:468
            res.args.push(a[i]);
          }
        }
        return res;
      },
      findEventHandlerClass :function _trc_EventMod_findEventHandlerClass(type) {
        "use strict";
        var _this=this;
        
        return Tonyu.classes.kernel.EventHandler;
      },
      registerEventHandler :function _trc_EventMod_registerEventHandler(type,obj) {
        "use strict";
        var _this=this;
        var cl;
        
        //$LASTPOS=2000657;//kernel.EventMod:657
        _this.initEventMod();
        //$LASTPOS=2000677;//kernel.EventMod:677
        if (typeof  type=="function") {
          //$LASTPOS=2000716;//kernel.EventMod:716
          obj=obj||new type({target: _this});
          //$LASTPOS=2000756;//kernel.EventMod:756
          type=obj.getClassInfo().fullName;
          
        } else {
          //$LASTPOS=2000811;//kernel.EventMod:811
          if (! obj) {
            //$LASTPOS=2000835;//kernel.EventMod:835
            cl = _this.findEventHandlerClass(type);
            
            //$LASTPOS=2000925;//kernel.EventMod:925
            obj=new cl({target: _this});
            
          }
          
        }
        return _this._eventHandlers[type]=obj;
      },
      getEventHandler :function _trc_EventMod_getEventHandler(type) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=2001138;//kernel.EventMod:1138
        _this.initEventMod();
        //$LASTPOS=2001158;//kernel.EventMod:1158
        if (typeof  type=="function") {
          //$LASTPOS=2001197;//kernel.EventMod:1197
          type=type.meta.fullName;
          
        }
        //$LASTPOS=2001232;//kernel.EventMod:1232
        res = _this._eventHandlers[type];
        
        return res;
      },
      getOrRegisterEventHandler :function _trc_EventMod_getOrRegisterEventHandler(type) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=2001328;//kernel.EventMod:1328
        res = _this.getEventHandler(type)||_this.registerEventHandler(type);
        
        return res;
      },
      on :function _trc_EventMod_on() {
        "use strict";
        var _this=this;
        var a;
        var h;
        
        //$LASTPOS=2001431;//kernel.EventMod:1431
        a = _this.parseEventArgs(arguments);
        
        //$LASTPOS=2001469;//kernel.EventMod:1469
        h = _this.getOrRegisterEventHandler(a.type);
        
        return h.addListener.apply(h,a.args);
      },
      fireEvent :function _trc_EventMod_fireEvent(type,arg) {
        "use strict";
        var _this=this;
        var h;
        
        //$LASTPOS=2001654;//kernel.EventMod:1654
        if (! _this._eventHandlers) {
          return _this;
        }
        //$LASTPOS=2001688;//kernel.EventMod:1688
        h = _this.getEventHandler(type);
        
        //$LASTPOS=2001722;//kernel.EventMod:1722
        if (h) {
          //$LASTPOS=2001729;//kernel.EventMod:1729
          h.fire([arg]);
        }
      },
      sendEvent :function _trc_EventMod_sendEvent(type,arg) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=2001784;//kernel.EventMod:1784
        _this.fireEvent(type,arg);
      },
      waitEvent :function _trc_EventMod_waitEvent() {
        "use strict";
        var _this=this;
        var args;
        var act;
        
        //$LASTPOS=2001831;//kernel.EventMod:1831
        if (null) {
          //$LASTPOS=2001855;//kernel.EventMod:1855
          args = new Tonyu.classes.kernel.ArgParser(arguments);
          
          //$LASTPOS=2001899;//kernel.EventMod:1899
          act = args.shift(Tonyu.classes.kernel.EventMod)||_this;
          
          //$LASTPOS=2001946;//kernel.EventMod:1946
          args.trimUndefs();
          //$LASTPOS=2001974;//kernel.EventMod:1974
          null.waitEvent(act,args.toArray());
          
        }
      },
      fiber$waitEvent :function _trc_EventMod_f_waitEvent(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var args;
        var act;
        
        //$LASTPOS=2001831;//kernel.EventMod:1831
        if (_thread) {
          //$LASTPOS=2001855;//kernel.EventMod:1855
          args = new Tonyu.classes.kernel.ArgParser(_arguments);
          
          //$LASTPOS=2001899;//kernel.EventMod:1899
          act = args.shift(Tonyu.classes.kernel.EventMod)||_this;
          
          //$LASTPOS=2001946;//kernel.EventMod:1946
          args.trimUndefs();
          //$LASTPOS=2001974;//kernel.EventMod:1974
          _thread.waitEvent(act,args.toArray());
          
        }
        
        _thread.retVal=_this;return;
      },
      waitFor :function _trc_EventMod_waitFor(f) {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=2002046;//kernel.EventMod:2046
        if (null) {
          //$LASTPOS=2002070;//kernel.EventMod:2070
          r = null.waitFor(f);
          
          return r;
          
        }
        return f;
      },
      fiber$waitFor :function _trc_EventMod_f_waitFor(_thread,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        //$LASTPOS=2002046;//kernel.EventMod:2046
        if (_thread) {
          //$LASTPOS=2002070;//kernel.EventMod:2070
          r = _thread.waitFor(f);
          
          _thread.retVal=r;return;
          
          
        }
        _thread.retVal=f;return;
        
        
        _thread.retVal=_this;return;
      },
      runAsync :function _trc_EventMod_runAsync(f) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=2002163;//kernel.EventMod:2163
        if (! null) {
          throw new Error("runAsync should run in wait mode");
          
          
        }
        //$LASTPOS=2002253;//kernel.EventMod:2253
        null.runAsync(f);
      },
      fiber$runAsync :function _trc_EventMod_f_runAsync(_thread,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=2002163;//kernel.EventMod:2163
        if (! _thread) {
          throw new Error("runAsync should run in wait mode");
          
          
        }
        //$LASTPOS=2002253;//kernel.EventMod:2253
        _thread.runAsync(f);
        
        _thread.retVal=_this;return;
      },
      runPromise :function _trc_EventMod_runPromise(f) {
        "use strict";
        var _this=this;
        var r;
        var e;
        
        //$LASTPOS=2002300;//kernel.EventMod:2300
        if (! null) {
          return Tonyu.DeferredUtil.promise(f);
          
        } else {
          
          try {
            //$LASTPOS=2002422;//kernel.EventMod:2422
            r=_this.runAsync(f);
            
          } catch (e) {
            throw null.wrapError(e.args[0]);
            
            
          }
          return r[0];
          
        }
      },
      fiber$runPromise :function _trc_EventMod_f_runPromise(_thread,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        var e;
        
        
        _thread.enter(function _trc_EventMod_ent_runPromise(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=2002300;//kernel.EventMod:2300
              if (!(! _thread)) { __pc=1     ; break; }
              _thread.exit(Tonyu.DeferredUtil.promise(f));return;
              __pc=5     ;break;
            case 1     :
              
              _thread.enterTry(3     );
              //$LASTPOS=2002422;//kernel.EventMod:2422
              _this.fiber$runAsync(_thread, f);
              __pc=2;return;
            case 2:
              r=_thread.retVal;
              _thread.exitTry();
              __pc=4     ;break;
            case 3     :
              e=_thread.startCatch();
              {
                throw _thread.wrapError(e.args[0]);
                
              }
            case 4     :
              
              _thread.exit(r[0]);return;
            case 5     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initEventMod":{"nowait":true},"releaseEventMod":{"nowait":true},"parseEventArgs":{"nowait":true},"findEventHandlerClass":{"nowait":true},"registerEventHandler":{"nowait":true},"getEventHandler":{"nowait":true},"getOrRegisterEventHandler":{"nowait":true},"on":{"nowait":true},"fireEvent":{"nowait":true},"sendEvent":{"nowait":true},"waitEvent":{"nowait":false},"waitFor":{"nowait":false},"runAsync":{"nowait":false},"runPromise":{"nowait":false}},"fields":{"_eventHandlers":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.OneframeSpriteMod',
  shortName: 'OneframeSpriteMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_OneframeSpriteMod_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_OneframeSpriteMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      drawText :function _trc_OneframeSpriteMod_drawText(x,y,text,col,size,zOrder) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=3000067;//kernel.OneframeSpriteMod:67
        if (! size) {
          //$LASTPOS=3000078;//kernel.OneframeSpriteMod:78
          size=15;
        }
        //$LASTPOS=3000092;//kernel.OneframeSpriteMod:92
        if (! col) {
          //$LASTPOS=3000102;//kernel.OneframeSpriteMod:102
          col="white";
        }
        //$LASTPOS=3000120;//kernel.OneframeSpriteMod:120
        _this.appear(Tonyu.classes.kernel.T1Text,{x: x,y: y,text: text,col: col,size: size,zOrder: zOrder,owner: _this});
      },
      drawLine :function _trc_OneframeSpriteMod_drawLine(x,y,tx,ty,col,zOrder) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=3000225;//kernel.OneframeSpriteMod:225
        if (! col) {
          //$LASTPOS=3000235;//kernel.OneframeSpriteMod:235
          col="white";
        }
        //$LASTPOS=3000253;//kernel.OneframeSpriteMod:253
        _this.appear(Tonyu.classes.kernel.T1Line,{x: x,y: y,tx: tx,ty: ty,col: col,zOrder: zOrder,owner: _this});
      },
      fillRect :function _trc_OneframeSpriteMod_fillRect(x,y,w,h,col,zOrder) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=3000353;//kernel.OneframeSpriteMod:353
        _this.appear(Tonyu.classes.kernel.T1Rect,{x: x,y: y,w: w,h: h,col: col,zOrder: zOrder,owner: _this});
      },
      drawSprite :function _trc_OneframeSpriteMod_drawSprite(x,y,p,f,zOrder) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=3000450;//kernel.OneframeSpriteMod:450
        _this.drawDxSprite(x,y,p,f,zOrder,0,255,1,1);
      },
      drawDxSprite :function _trc_OneframeSpriteMod_drawDxSprite(x,y,p,f,zOrder,angle,alpha,scaleX,scaleY) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=3000564;//kernel.OneframeSpriteMod:564
        _this.appear(Tonyu.classes.kernel.T1Sprite,{x: x,y: y,p: p,f: f,zOrder: zOrder,angle: angle,alpha: alpha,scaleX: scaleX,scaleY: scaleY,owner: _this});
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"drawText":{"nowait":true},"drawLine":{"nowait":true},"fillRect":{"nowait":true},"drawSprite":{"nowait":true},"drawDxSprite":{"nowait":true}},"fields":{"appear":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.SpriteMod',
  shortName: 'SpriteMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_SpriteMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=4000015;//kernel.SpriteMod:15
        "field strict";
        
      },
      fiber$main :function _trc_SpriteMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=4000015;//kernel.SpriteMod:15
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initSpriteMod :function _trc_SpriteMod_initSpriteMod() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=4000246;//kernel.SpriteMod:246
        _this.position=new Tonyu.classes.kernel.Vec3View(_this);
        //$LASTPOS=4000391;//kernel.SpriteMod:391
        if (_this.scaleX==null) {
          //$LASTPOS=4000409;//kernel.SpriteMod:409
          _this.scaleX=1;
        }
        //$LASTPOS=4000424;//kernel.SpriteMod:424
        if (_this.rotation==null) {
          //$LASTPOS=4000444;//kernel.SpriteMod:444
          _this.rotation=0;
        }
        //$LASTPOS=4000461;//kernel.SpriteMod:461
        if (_this.alpha==null) {
          //$LASTPOS=4000478;//kernel.SpriteMod:478
          _this.alpha=255;
        }
        //$LASTPOS=4000494;//kernel.SpriteMod:494
        if (_this.zOrder==null) {
          //$LASTPOS=4000512;//kernel.SpriteMod:512
          _this.zOrder=0;
        }
        //$LASTPOS=4000527;//kernel.SpriteMod:527
        _this.initTransform();
      },
      fiber$initSpriteMod :function _trc_SpriteMod_f_initSpriteMod(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=4000246;//kernel.SpriteMod:246
        _this.position=new Tonyu.classes.kernel.Vec3View(_this);
        //$LASTPOS=4000391;//kernel.SpriteMod:391
        if (_this.scaleX==null) {
          //$LASTPOS=4000409;//kernel.SpriteMod:409
          _this.scaleX=1;
        }
        //$LASTPOS=4000424;//kernel.SpriteMod:424
        if (_this.rotation==null) {
          //$LASTPOS=4000444;//kernel.SpriteMod:444
          _this.rotation=0;
        }
        //$LASTPOS=4000461;//kernel.SpriteMod:461
        if (_this.alpha==null) {
          //$LASTPOS=4000478;//kernel.SpriteMod:478
          _this.alpha=255;
        }
        //$LASTPOS=4000494;//kernel.SpriteMod:494
        if (_this.zOrder==null) {
          //$LASTPOS=4000512;//kernel.SpriteMod:512
          _this.zOrder=0;
        }
        
        _thread.enter(function _trc_SpriteMod_ent_initSpriteMod(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=4000527;//kernel.SpriteMod:527
              _this.fiber$initTransform(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initTransform :function _trc_SpriteMod_initTransform() {
        "use strict";
        var _this=this;
        
      },
      fiber$initTransform :function _trc_SpriteMod_f_initTransform(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      prepareImage :function _trc_SpriteMod_prepareImage() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=4000604;//kernel.SpriteMod:604
        if (typeof  _this.p!="number") {
          //$LASTPOS=4000639;//kernel.SpriteMod:639
          _this.p=0;
          
        }
        //$LASTPOS=4000656;//kernel.SpriteMod:656
        _this.p=Math.floor(_this.p);
        //$LASTPOS=4000678;//kernel.SpriteMod:678
        _this.pImg=Tonyu.globals.$imageList[_this.p];
        //$LASTPOS=4000703;//kernel.SpriteMod:703
        if (! _this.pImg) {
          return _this;
        }
        //$LASTPOS=4000727;//kernel.SpriteMod:727
        _this.width=_this.pImg.width;
        //$LASTPOS=4000750;//kernel.SpriteMod:750
        _this.height=_this.pImg.height;
      },
      color :function _trc_SpriteMod_color(r,g,b) {
        "use strict";
        var _this=this;
        
        return "rgb("+[r,g,b].join(",")+")";
      },
      setVisible :function _trc_SpriteMod_setVisible(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=4000919;//kernel.SpriteMod:919
        _this._isInvisible=! v;
      },
      fiber$setVisible :function _trc_SpriteMod_f_setVisible(_thread,v) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=4000919;//kernel.SpriteMod:919
        _this._isInvisible=! v;
        
        _thread.retVal=_this;return;
      },
      detectSpriteType :function _trc_SpriteMod_detectSpriteType() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=4000967;//kernel.SpriteMod:967
        if (_this.text!=null) {
          return "Text";
          
        } else {
          //$LASTPOS=4001021;//kernel.SpriteMod:1021
          if (_this.fillStyle!=null) {
            return "Shape";
            
          } else {
            //$LASTPOS=4001081;//kernel.SpriteMod:1081
            if (_this.p&&typeof  _this.p.draw==="function") {
              return "Custom";
              
            } else {
              return "Image";
              
            }
          }
        }
      },
      fiber$detectSpriteType :function _trc_SpriteMod_f_detectSpriteType(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=4000967;//kernel.SpriteMod:967
        if (_this.text!=null) {
          _thread.retVal="Text";return;
          
          
        } else {
          //$LASTPOS=4001021;//kernel.SpriteMod:1021
          if (_this.fillStyle!=null) {
            _thread.retVal="Shape";return;
            
            
          } else {
            //$LASTPOS=4001081;//kernel.SpriteMod:1081
            if (_this.p&&typeof  _this.p.draw==="function") {
              _thread.retVal="Custom";return;
              
              
            } else {
              _thread.retVal="Image";return;
              
              
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initSpriteMod":{"nowait":false},"initTransform":{"nowait":false},"prepareImage":{"nowait":true},"color":{"nowait":true},"setVisible":{"nowait":false},"detectSpriteType":{"nowait":false}},"fields":{"p":{},"pImg":{},"text":{},"size":{},"font":{},"align":{},"fillStyle":{},"scaleX":{},"scaleY":{},"width":{},"height":{},"radius":{},"rotation":{},"alpha":{},"position":{},"zOrder":{},"_isInvisible":{},"subsprites":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.SpriteMod3D',
  shortName: 'SpriteMod3D',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.SpriteMod],
  methods: function (__superClass) {
    return {
      main :function _trc_SpriteMod3D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=5000036;//kernel.SpriteMod3D:36
        "field strict";
        
      },
      fiber$main :function _trc_SpriteMod3D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=5000036;//kernel.SpriteMod3D:36
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      detectSpriteType :function _trc_SpriteMod3D_detectSpriteType() {
        "use strict";
        var _this=this;
        var t;
        
        //$LASTPOS=5000124;//kernel.SpriteMod3D:124
        t = __superClass.prototype.detectSpriteType.apply( _this, []);
        
        //$LASTPOS=5000161;//kernel.SpriteMod3D:161
        if (t==="Image"&&_this.p&&_this.p.draw3D) {
          return "Custom";
        }
        return t;
      },
      fiber$detectSpriteType :function _trc_SpriteMod3D_f_detectSpriteType(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var t;
        
        //$LASTPOS=5000124;//kernel.SpriteMod3D:124
        t = __superClass.prototype.detectSpriteType.apply( _this, []);
        
        //$LASTPOS=5000161;//kernel.SpriteMod3D:161
        if (t==="Image"&&_this.p&&_this.p.draw3D) {
          _thread.retVal="Custom";return;
          
        }
        _thread.retVal=t;return;
        
        
        _thread.retVal=_this;return;
      },
      initTransform :function _trc_SpriteMod3D_initTransform() {
        "use strict";
        var _this=this;
        var givenTransform;
        
        //$LASTPOS=5000321;//kernel.SpriteMod3D:321
        if (_this.direction) {
          //$LASTPOS=5000336;//kernel.SpriteMod3D:336
          _this.direction=_this.direction.clone();
        } else {
          //$LASTPOS=5000375;//kernel.SpriteMod3D:375
          _this.direction=new Tonyu.classes.kernel.Direction;
        }
        //$LASTPOS=5000407;//kernel.SpriteMod3D:407
        givenTransform = _this.transform;
        
        //$LASTPOS=5000442;//kernel.SpriteMod3D:442
        _this.transform=new Tonyu.classes.kernel.Transform({direction: _this.direction,position: _this.position,scale: (_this._prescale||1),actor: _this});
        //$LASTPOS=5000541;//kernel.SpriteMod3D:541
        if (givenTransform) {
          //$LASTPOS=5000561;//kernel.SpriteMod3D:561
          _this.transform.set(givenTransform);
        }
      },
      fiber$initTransform :function _trc_SpriteMod3D_f_initTransform(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var givenTransform;
        
        //$LASTPOS=5000321;//kernel.SpriteMod3D:321
        if (_this.direction) {
          //$LASTPOS=5000336;//kernel.SpriteMod3D:336
          _this.direction=_this.direction.clone();
        } else {
          //$LASTPOS=5000375;//kernel.SpriteMod3D:375
          _this.direction=new Tonyu.classes.kernel.Direction;
        }
        //$LASTPOS=5000407;//kernel.SpriteMod3D:407
        givenTransform = _this.transform;
        
        //$LASTPOS=5000442;//kernel.SpriteMod3D:442
        _this.transform=new Tonyu.classes.kernel.Transform({direction: _this.direction,position: _this.position,scale: (_this._prescale||1),actor: _this});
        //$LASTPOS=5000541;//kernel.SpriteMod3D:541
        if (givenTransform) {
          //$LASTPOS=5000561;//kernel.SpriteMod3D:561
          _this.transform.set(givenTransform);
        }
        
        _thread.retVal=_this;return;
      },
      __getter__scale :function _trc_SpriteMod3D___getter__scale() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=5000921;//kernel.SpriteMod3D:921
        if (! _this.transform) {
          return _this._prescale;
        }
        return _this.transform.scale;
      },
      __setter__scale :function _trc_SpriteMod3D___setter__scale(s) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=5001004;//kernel.SpriteMod3D:1004
        if (! _this.transform) {
          return _this._prescale=s;
        }
        //$LASTPOS=5001045;//kernel.SpriteMod3D:1045
        _this.transform.scale=s;
      },
      draw3D :function _trc_SpriteMod3D_draw3D(ctx3d) {
        "use strict";
        var _this=this;
        var t;
        
        //$LASTPOS=5001090;//kernel.SpriteMod3D:1090
        t = _this.detectSpriteType();
        
        //$LASTPOS=5001121;//kernel.SpriteMod3D:1121
        if (t==="Image") {
          //$LASTPOS=5001140;//kernel.SpriteMod3D:1140
          _this.prepareImage();
        }
        //$LASTPOS=5001358;//kernel.SpriteMod3D:1358
        if (_this.p&&_this.p.draw3D) {
          //$LASTPOS=5001388;//kernel.SpriteMod3D:1388
          ctx3d.save();
          //$LASTPOS=5001411;//kernel.SpriteMod3D:1411
          ctx3d.transform(_this.transform);
          //$LASTPOS=5001448;//kernel.SpriteMod3D:1448
          _this.p.draw3D(ctx3d);
          //$LASTPOS=5001474;//kernel.SpriteMod3D:1474
          ctx3d.restore();
          
        } else {
          //$LASTPOS=5001514;//kernel.SpriteMod3D:1514
          ctx3d.addSprite3D(_this);
          
        }
        //$LASTPOS=5001551;//kernel.SpriteMod3D:1551
        if (_this.subsprites&&_this.subsprites.draw3D) {
          //$LASTPOS=5001599;//kernel.SpriteMod3D:1599
          ctx3d.save();
          //$LASTPOS=5001622;//kernel.SpriteMod3D:1622
          ctx3d.transform(_this.transform);
          //$LASTPOS=5001659;//kernel.SpriteMod3D:1659
          _this.subsprites.draw3D(ctx3d);
          //$LASTPOS=5001694;//kernel.SpriteMod3D:1694
          ctx3d.restore();
          
        }
      },
      fiber$draw3D :function _trc_SpriteMod3D_f_draw3D(_thread,ctx3d) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var t;
        
        
        _thread.enter(function _trc_SpriteMod3D_ent_draw3D(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=5001090;//kernel.SpriteMod3D:1090
              _this.fiber$detectSpriteType(_thread);
              __pc=1;return;
            case 1:
              t=_thread.retVal;
              
              //$LASTPOS=5001121;//kernel.SpriteMod3D:1121
              if (t==="Image") {
                //$LASTPOS=5001140;//kernel.SpriteMod3D:1140
                _this.prepareImage();
              }
              //$LASTPOS=5001358;//kernel.SpriteMod3D:1358
              if (_this.p&&_this.p.draw3D) {
                //$LASTPOS=5001388;//kernel.SpriteMod3D:1388
                ctx3d.save();
                //$LASTPOS=5001411;//kernel.SpriteMod3D:1411
                ctx3d.transform(_this.transform);
                //$LASTPOS=5001448;//kernel.SpriteMod3D:1448
                _this.p.draw3D(ctx3d);
                //$LASTPOS=5001474;//kernel.SpriteMod3D:1474
                ctx3d.restore();
                
              } else {
                //$LASTPOS=5001514;//kernel.SpriteMod3D:1514
                ctx3d.addSprite3D(_this);
                
              }
              //$LASTPOS=5001551;//kernel.SpriteMod3D:1551
              if (_this.subsprites&&_this.subsprites.draw3D) {
                //$LASTPOS=5001599;//kernel.SpriteMod3D:1599
                ctx3d.save();
                //$LASTPOS=5001622;//kernel.SpriteMod3D:1622
                ctx3d.transform(_this.transform);
                //$LASTPOS=5001659;//kernel.SpriteMod3D:1659
                _this.subsprites.draw3D(ctx3d);
                //$LASTPOS=5001694;//kernel.SpriteMod3D:1694
                ctx3d.restore();
                
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"detectSpriteType":{"nowait":false},"initTransform":{"nowait":false},"__getter__scale":{"nowait":true},"__setter__scale":{"nowait":true},"draw3D":{"nowait":false}},"fields":{"x":{},"y":{},"z":{},"direction":{},"transform":{},"_prescale":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.TextRectMod',
  shortName: 'TextRectMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_TextRectMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=6000015;//kernel.TextRectMod:15
        "field strict";
      },
      fiber$main :function _trc_TextRectMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=6000015;//kernel.TextRectMod:15
        "field strict";
        
        _thread.retVal=_this;return;
      },
      drawTextRect :function _trc_TextRectMod_drawTextRect(ctx,text,x,topY,h,align,type) {
        "use strict";
        var _this=this;
        var met;
        var res;
        var t;
        
        //$LASTPOS=6000107;//kernel.TextRectMod:107
        if (! align) {
          //$LASTPOS=6000119;//kernel.TextRectMod:119
          align="center";
        }
        //$LASTPOS=6000140;//kernel.TextRectMod:140
        ctx.textBaseline="top";
        //$LASTPOS=6000169;//kernel.TextRectMod:169
        _this.setFontSize(ctx,h);
        //$LASTPOS=6000195;//kernel.TextRectMod:195
        met = ctx.measureText(text);
        
        //$LASTPOS=6000231;//kernel.TextRectMod:231
        res = {y: topY,w: met.width,h: h};
        
        //$LASTPOS=6000273;//kernel.TextRectMod:273
        t = align.substring(0,1).toLowerCase();
        
        //$LASTPOS=6000320;//kernel.TextRectMod:320
        if (t=="l") {
          //$LASTPOS=6000332;//kernel.TextRectMod:332
          res.x=x;
        } else {
          //$LASTPOS=6000351;//kernel.TextRectMod:351
          if (t=="r") {
            //$LASTPOS=6000363;//kernel.TextRectMod:363
            res.x=x-met.width;
          } else {
            //$LASTPOS=6000392;//kernel.TextRectMod:392
            if (t=="c") {
              //$LASTPOS=6000404;//kernel.TextRectMod:404
              res.x=x-met.width/2;
            }
          }
        }
        //$LASTPOS=6000430;//kernel.TextRectMod:430
        if (type=="fill") {
          //$LASTPOS=6000448;//kernel.TextRectMod:448
          ctx.fillText(text,res.x,topY);
        }
        //$LASTPOS=6000485;//kernel.TextRectMod:485
        if (type=="stroke") {
          //$LASTPOS=6000505;//kernel.TextRectMod:505
          ctx.strokeText(text,res.x,topY);
        }
        return res;
      },
      setFontSize :function _trc_TextRectMod_setFontSize(ctx,sz) {
        "use strict";
        var _this=this;
        var post;
        
        //$LASTPOS=6000603;//kernel.TextRectMod:603
        post = ctx.font.replace(/^[0-9\.]+/,"");
        
        //$LASTPOS=6000651;//kernel.TextRectMod:651
        ctx.font=sz+post;
      },
      fukidashi :function _trc_TextRectMod_fukidashi(ctx,text,x,y,sz) {
        "use strict";
        var _this=this;
        var align;
        var theight;
        var margin;
        var r;
        var fs;
        
        //$LASTPOS=6000729;//kernel.TextRectMod:729
        align = "c";
        
        //$LASTPOS=6000749;//kernel.TextRectMod:749
        theight = 20;
        
        //$LASTPOS=6000770;//kernel.TextRectMod:770
        margin = 5;
        
        //$LASTPOS=6000789;//kernel.TextRectMod:789
        r = _this.drawTextRect(ctx,text,x,y-theight-margin-sz,sz,align);
        
        //$LASTPOS=6000859;//kernel.TextRectMod:859
        ctx.beginPath();
        //$LASTPOS=6000881;//kernel.TextRectMod:881
        ctx.moveTo(x,y);
        //$LASTPOS=6000905;//kernel.TextRectMod:905
        ctx.lineTo(x+margin,y-theight);
        //$LASTPOS=6000944;//kernel.TextRectMod:944
        ctx.lineTo(x+r.w/2+margin,y-theight);
        //$LASTPOS=6000989;//kernel.TextRectMod:989
        ctx.lineTo(x+r.w/2+margin,y-theight-r.h-margin*2);
        //$LASTPOS=6001047;//kernel.TextRectMod:1047
        ctx.lineTo(x-r.w/2-margin,y-theight-r.h-margin*2);
        //$LASTPOS=6001105;//kernel.TextRectMod:1105
        ctx.lineTo(x-r.w/2-margin,y-theight);
        //$LASTPOS=6001150;//kernel.TextRectMod:1150
        ctx.lineTo(x-margin,y-theight);
        //$LASTPOS=6001189;//kernel.TextRectMod:1189
        ctx.closePath();
        //$LASTPOS=6001211;//kernel.TextRectMod:1211
        ctx.fill();
        //$LASTPOS=6001228;//kernel.TextRectMod:1228
        ctx.stroke();
        //$LASTPOS=6001249;//kernel.TextRectMod:1249
        fs = ctx.fillStyle;
        
        //$LASTPOS=6001276;//kernel.TextRectMod:1276
        ctx.fillStyle=ctx.strokeStyle;
        //$LASTPOS=6001312;//kernel.TextRectMod:1312
        _this.drawTextRect(ctx,text,x,y-theight-margin-sz,sz,align,"fill");
        //$LASTPOS=6001385;//kernel.TextRectMod:1385
        ctx.fillStyle=fs;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"drawTextRect":{"nowait":true},"setFontSize":{"nowait":true},"fukidashi":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.T2Mod',
  shortName: 'T2Mod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T2Mod_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T2Mod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      bvec :function _trc_T2Mod_bvec(tx,ty) {
        "use strict";
        var _this=this;
        var b2Vec2;
        
        //$LASTPOS=7000037;//kernel.T2Mod:37
        b2Vec2 = Box2D.Common.Math.b2Vec2;
        
        return new b2Vec2(tx/_this.scale,ty/_this.scale);
      },
      fiber$bvec :function _trc_T2Mod_f_bvec(_thread,tx,ty) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var b2Vec2;
        
        //$LASTPOS=7000037;//kernel.T2Mod:37
        b2Vec2 = Box2D.Common.Math.b2Vec2;
        
        _thread.retVal=new b2Vec2(tx/_this.scale,ty/_this.scale);return;
        
        
        _thread.retVal=_this;return;
      },
      defv :function _trc_T2Mod_defv(t,d) {
        "use strict";
        var _this=this;
        
        return (t===t&&(typeof  t)==="number")?t:d;
      },
      fiber$defv :function _trc_T2Mod_f_defv(_thread,t,d) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=(t===t&&(typeof  t)==="number")?t:d;return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"bvec":{"nowait":false},"defv":{"nowait":false}},"fields":{"scale":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.MediaPlayer',
  shortName: 'MediaPlayer',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_MediaPlayer_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_MediaPlayer_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      play :function _trc_MediaPlayer_play(s) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=8000031;//kernel.MediaPlayer:31
        Tonyu.globals.$sound.playBGM(s);
      },
      fiber$play :function _trc_MediaPlayer_f_play(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=8000031;//kernel.MediaPlayer:31
        Tonyu.globals.$sound.playBGM(s);
        
        _thread.retVal=_this;return;
      },
      stop :function _trc_MediaPlayer_stop() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=8000069;//kernel.MediaPlayer:69
        Tonyu.globals.$sound.stopBGM(_this.s);
      },
      fiber$stop :function _trc_MediaPlayer_f_stop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=8000069;//kernel.MediaPlayer:69
        Tonyu.globals.$sound.stopBGM(_this.s);
        
        _thread.retVal=_this;return;
      },
      playSE :function _trc_MediaPlayer_playSE() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=8000109;//kernel.MediaPlayer:109
        Tonyu.globals.$sound.playSE(_this.s);
      },
      fiber$playSE :function _trc_MediaPlayer_f_playSE(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=8000109;//kernel.MediaPlayer:109
        Tonyu.globals.$sound.playSE(_this.s);
        
        _thread.retVal=_this;return;
      },
      setDelay :function _trc_MediaPlayer_setDelay() {
        "use strict";
        var _this=this;
        
      },
      fiber$setDelay :function _trc_MediaPlayer_f_setDelay(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      setVolume :function _trc_MediaPlayer_setVolume() {
        "use strict";
        var _this=this;
        
      },
      fiber$setVolume :function _trc_MediaPlayer_f_setVolume(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"play":{"nowait":false},"stop":{"nowait":false},"playSE":{"nowait":false},"setDelay":{"nowait":false},"setVolume":{"nowait":false}},"fields":{"s":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ParallelMod',
  shortName: 'ParallelMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ParallelMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=9000037;//kernel.ParallelMod:37
        "field strict";
      },
      fiber$main :function _trc_ParallelMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=9000037;//kernel.ParallelMod:37
        "field strict";
        
        _thread.retVal=_this;return;
      },
      parallel :function _trc_ParallelMod_parallel() {
        "use strict";
        var _this=this;
        var args;
        var i;
        var name;
        var th;
        
        //$LASTPOS=9000083;//kernel.ParallelMod:83
        args = [];
        
        //$LASTPOS=9000102;//kernel.ParallelMod:102
        //$LASTPOS=9000107;//kernel.ParallelMod:107
        i = 1;
        for (; i<arguments.length ; i++) {
          {
            //$LASTPOS=9000153;//kernel.ParallelMod:153
            args.push(arguments[i]);
          }
        }
        //$LASTPOS=9000192;//kernel.ParallelMod:192
        name = arguments[0];
        
        
        //$LASTPOS=9000235;//kernel.ParallelMod:235
        th=Tonyu.globals.$Boot.schedule(_this,name,args);
        return th;
      },
      call :function _trc_ParallelMod_call() {
        "use strict";
        var _this=this;
        var a;
        var t;
        var n;
        var f;
        var ag2;
        
        //$LASTPOS=9000306;//kernel.ParallelMod:306
        if (! null) {
          throw new Error("callは待機可能モードで呼び出してください");
          
        }
        //$LASTPOS=9000368;//kernel.ParallelMod:368
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=9000405;//kernel.ParallelMod:405
        t = a.shift();
        
        //$LASTPOS=9000427;//kernel.ParallelMod:427
        n = a.shift();
        
        //$LASTPOS=9000449;//kernel.ParallelMod:449
        f = t["fiber$"+n];
        
        //$LASTPOS=9000475;//kernel.ParallelMod:475
        if (! f) {
          throw new Error("メソッド"+n+"が見つかりません");
          
          
        }
        //$LASTPOS=9000544;//kernel.ParallelMod:544
        ag2 = a.toArray();
        
        //$LASTPOS=9000570;//kernel.ParallelMod:570
        ag2.unshift(null);
        return f.apply(t,ag2);
      },
      fiber$call :function _trc_ParallelMod_f_call(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var t;
        var n;
        var f;
        var ag2;
        
        //$LASTPOS=9000306;//kernel.ParallelMod:306
        if (! _thread) {
          throw new Error("callは待機可能モードで呼び出してください");
          
        }
        //$LASTPOS=9000368;//kernel.ParallelMod:368
        a = new Tonyu.classes.kernel.ArgParser(_arguments);
        
        //$LASTPOS=9000405;//kernel.ParallelMod:405
        t = a.shift();
        
        //$LASTPOS=9000427;//kernel.ParallelMod:427
        n = a.shift();
        
        //$LASTPOS=9000449;//kernel.ParallelMod:449
        f = t["fiber$"+n];
        
        //$LASTPOS=9000475;//kernel.ParallelMod:475
        if (! f) {
          throw new Error("メソッド"+n+"が見つかりません");
          
          
        }
        //$LASTPOS=9000544;//kernel.ParallelMod:544
        ag2 = a.toArray();
        
        //$LASTPOS=9000570;//kernel.ParallelMod:570
        ag2.unshift(_thread);
        _thread.retVal=f.apply(t,ag2);return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"parallel":{"nowait":true},"call":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.SchedulerMod',
  shortName: 'SchedulerMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_SchedulerMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=10000015;//kernel.SchedulerMod:15
        "field strict";
        
      },
      fiber$main :function _trc_SchedulerMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=10000015;//kernel.SchedulerMod:15
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initSchedulerMod :function _trc_SchedulerMod_initSchedulerMod() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=10000170;//kernel.SchedulerMod:170
        _this._scheduler=_this._scheduler||Tonyu.globals.$Scheduler;
        //$LASTPOS=10000210;//kernel.SchedulerMod:210
        if (Tonyu.runMode) {
          //$LASTPOS=10000229;//kernel.SchedulerMod:229
          _this._th=Tonyu.globals.$Boot.schedule(_this,"main",[]);
        }
      },
      fiber$initSchedulerMod :function _trc_SchedulerMod_f_initSchedulerMod(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=10000170;//kernel.SchedulerMod:170
        _this._scheduler=_this._scheduler||Tonyu.globals.$Scheduler;
        //$LASTPOS=10000210;//kernel.SchedulerMod:210
        if (Tonyu.runMode) {
          //$LASTPOS=10000229;//kernel.SchedulerMod:229
          _this._th=Tonyu.globals.$Boot.schedule(_this,"main",[]);
        }
        
        _thread.retVal=_this;return;
      },
      update :function _trc_SchedulerMod_update() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=10000288;//kernel.SchedulerMod:288
        _this.onUpdate();
        //$LASTPOS=10000305;//kernel.SchedulerMod:305
        if (null) {
          //$LASTPOS=10000328;//kernel.SchedulerMod:328
          null.suspend();
          //$LASTPOS=10000356;//kernel.SchedulerMod:356
          if (_this._scheduler) {
            //$LASTPOS=10000372;//kernel.SchedulerMod:372
            _this._scheduler.addToNext(null);
          }
          
        } else {
          //$LASTPOS=10000426;//kernel.SchedulerMod:426
          _this._scheduler.checkTimeout();
          
        }
      },
      fiber$update :function _trc_SchedulerMod_f_update(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=10000288;//kernel.SchedulerMod:288
        _this.onUpdate();
        //$LASTPOS=10000305;//kernel.SchedulerMod:305
        if (_thread) {
          //$LASTPOS=10000328;//kernel.SchedulerMod:328
          _thread.suspend();
          //$LASTPOS=10000356;//kernel.SchedulerMod:356
          if (_this._scheduler) {
            //$LASTPOS=10000372;//kernel.SchedulerMod:372
            _this._scheduler.addToNext(_thread);
          }
          
        } else {
          //$LASTPOS=10000426;//kernel.SchedulerMod:426
          _this._scheduler.checkTimeout();
          
        }
        
        _thread.retVal=_this;return;
      },
      onUpdate :function _trc_SchedulerMod_onUpdate() {
        "use strict";
        var _this=this;
        
      },
      updateEx :function _trc_SchedulerMod_updateEx(updateT) {
        "use strict";
        var _this=this;
        var updateCount;
        
        //$LASTPOS=10000516;//kernel.SchedulerMod:516
        //$LASTPOS=10000520;//kernel.SchedulerMod:520
        updateCount = 0;
        for (; updateCount<updateT ; updateCount++) {
          {
            //$LASTPOS=10000583;//kernel.SchedulerMod:583
            _this.update();
          }
        }
      },
      fiber$updateEx :function _trc_SchedulerMod_f_updateEx(_thread,updateT) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var updateCount;
        
        
        _thread.enter(function _trc_SchedulerMod_ent_updateEx(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=10000516;//kernel.SchedulerMod:516
              //$LASTPOS=10000520;//kernel.SchedulerMod:520
              updateCount = 0;
              
            case 1:
              if (!(updateCount<updateT)) { __pc=4     ; break; }
              //$LASTPOS=10000583;//kernel.SchedulerMod:583
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
            case 3     :
              updateCount++;
              __pc=1;break;
            case 4     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      currentThreadGroup :function _trc_SchedulerMod_currentThreadGroup() {
        "use strict";
        var _this=this;
        
        return _this._scheduler;
      },
      wait :function _trc_SchedulerMod_wait(t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=10000715;//kernel.SchedulerMod:715
        if (null) {
          //$LASTPOS=10000738;//kernel.SchedulerMod:738
          null.suspend();
          //$LASTPOS=10000766;//kernel.SchedulerMod:766
          if (t) {
            //$LASTPOS=10000788;//kernel.SchedulerMod:788
            null.waitCount=t;
            //$LASTPOS=10000822;//kernel.SchedulerMod:822
            if (_this._scheduler) {
              //$LASTPOS=10000838;//kernel.SchedulerMod:838
              _this._scheduler.addToNext(null);
            }
            
          }
          
        } else {
          //$LASTPOS=10000892;//kernel.SchedulerMod:892
          if (_this._th) {
            //$LASTPOS=10000912;//kernel.SchedulerMod:912
            if (t) {
              //$LASTPOS=10000934;//kernel.SchedulerMod:934
              _this._th.waitCount=t;
              
            } else {
              //$LASTPOS=10000982;//kernel.SchedulerMod:982
              if (_this._th.scheduled) {
                //$LASTPOS=10001001;//kernel.SchedulerMod:1001
                _this._th.scheduled.unschedule(_this._th);
              }
              
            }
            
          }
        }
      },
      fiber$wait :function _trc_SchedulerMod_f_wait(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=10000715;//kernel.SchedulerMod:715
        if (_thread) {
          //$LASTPOS=10000738;//kernel.SchedulerMod:738
          _thread.suspend();
          //$LASTPOS=10000766;//kernel.SchedulerMod:766
          if (t) {
            //$LASTPOS=10000788;//kernel.SchedulerMod:788
            _thread.waitCount=t;
            //$LASTPOS=10000822;//kernel.SchedulerMod:822
            if (_this._scheduler) {
              //$LASTPOS=10000838;//kernel.SchedulerMod:838
              _this._scheduler.addToNext(_thread);
            }
            
          }
          
        } else {
          //$LASTPOS=10000892;//kernel.SchedulerMod:892
          if (_this._th) {
            //$LASTPOS=10000912;//kernel.SchedulerMod:912
            if (t) {
              //$LASTPOS=10000934;//kernel.SchedulerMod:934
              _this._th.waitCount=t;
              
            } else {
              //$LASTPOS=10000982;//kernel.SchedulerMod:982
              if (_this._th.scheduled) {
                //$LASTPOS=10001001;//kernel.SchedulerMod:1001
                _this._th.scheduled.unschedule(_this._th);
              }
              
            }
            
          }
        }
        
        _thread.retVal=_this;return;
      },
      notify :function _trc_SchedulerMod_notify() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=10001078;//kernel.SchedulerMod:1078
        if (_this._th) {
          //$LASTPOS=10001098;//kernel.SchedulerMod:1098
          if (_this._th.scheduled) {
            //$LASTPOS=10001133;//kernel.SchedulerMod:1133
            _this._th.waitCount=0;
            
          } else {
            //$LASTPOS=10001181;//kernel.SchedulerMod:1181
            if (_this._scheduler) {
              //$LASTPOS=10001197;//kernel.SchedulerMod:1197
              _this._scheduler.addToCur(_this._th);
            }
            
          }
          
        }
      },
      timeStop :function _trc_SchedulerMod_timeStop() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$Boot.timeStop(_this);
      },
      fiber$timeStop :function _trc_SchedulerMod_f_timeStop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$Boot.timeStop(_this);return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initSchedulerMod":{"nowait":false},"update":{"nowait":false},"onUpdate":{"nowait":true},"updateEx":{"nowait":false},"currentThreadGroup":{"nowait":true},"wait":{"nowait":false},"notify":{"nowait":true},"timeStop":{"nowait":false}},"fields":{"_scheduler":{},"_th":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ThreadGroupMod',
  shortName: 'ThreadGroupMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ThreadGroupMod_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ThreadGroupMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      isDeadThreadGroup :function _trc_ThreadGroupMod_isDeadThreadGroup() {
        "use strict";
        var _this=this;
        
        return _this._isDeadThreadGroup=_this._isDeadThreadGroup||(_this._threadGroup&&(_this._threadGroup.objectPoolAge!=_this.tGrpObjectPoolAge||_this._threadGroup.isDeadThreadGroup()));
      },
      fiber$isDeadThreadGroup :function _trc_ThreadGroupMod_f_isDeadThreadGroup(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this._isDeadThreadGroup=_this._isDeadThreadGroup||(_this._threadGroup&&(_this._threadGroup.objectPoolAge!=_this.tGrpObjectPoolAge||_this._threadGroup.isDeadThreadGroup()));return;
        
        
        _thread.retVal=_this;return;
      },
      setThreadGroup :function _trc_ThreadGroupMod_setThreadGroup(g) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=11000252;//kernel.ThreadGroupMod:252
        _this._threadGroup=g;
        //$LASTPOS=11000273;//kernel.ThreadGroupMod:273
        _this.tGrpObjectPoolAge=g.objectPoolAge;
      },
      fiber$setThreadGroup :function _trc_ThreadGroupMod_f_setThreadGroup(_thread,g) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=11000252;//kernel.ThreadGroupMod:252
        _this._threadGroup=g;
        //$LASTPOS=11000273;//kernel.ThreadGroupMod:273
        _this.tGrpObjectPoolAge=g.objectPoolAge;
        
        _thread.retVal=_this;return;
      },
      killThreadGroup :function _trc_ThreadGroupMod_killThreadGroup() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=11000338;//kernel.ThreadGroupMod:338
        _this._isDeadThreadGroup=true;
      },
      fiber$killThreadGroup :function _trc_ThreadGroupMod_f_killThreadGroup(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=11000338;//kernel.ThreadGroupMod:338
        _this._isDeadThreadGroup=true;
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"isDeadThreadGroup":{"nowait":false},"setThreadGroup":{"nowait":false},"killThreadGroup":{"nowait":false}},"fields":{"_isDeadThreadGroup":{},"_threadGroup":{},"tGrpObjectPoolAge":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.InputDevice',
  shortName: 'InputDevice',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.EventMod],
  methods: function (__superClass) {
    return {
      main :function _trc_InputDevice_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_InputDevice_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_InputDevice_initialize() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=12000129;//kernel.InputDevice:129
        _this.listeners=[];
        //$LASTPOS=12000148;//kernel.InputDevice:148
        _this.touchEmu=true;
        //$LASTPOS=12000168;//kernel.InputDevice:168
        _this.defaultLayer=Tonyu.globals.$Screen;
      },
      handleListeners :function _trc_InputDevice_handleListeners(type,evt) {
        "use strict";
        var _this=this;
        var l;
        
        //$LASTPOS=12000228;//kernel.InputDevice:228
        l = _this.listeners;
        
        //$LASTPOS=12000250;//kernel.InputDevice:250
        _this.listeners=[];
        //$LASTPOS=12000269;//kernel.InputDevice:269
        while (l.length>0) {
          //$LASTPOS=12000290;//kernel.InputDevice:290
          (l.shift())();
          
        }
        //$LASTPOS=12000312;//kernel.InputDevice:312
        if (type&&evt) {
          //$LASTPOS=12000340;//kernel.InputDevice:340
          evt.type=type;
          //$LASTPOS=12000364;//kernel.InputDevice:364
          _this.fireEvent(type,evt);
          
        }
        //$LASTPOS=12000397;//kernel.InputDevice:397
        if (Tonyu.globals.$Boot.economyMode&&! Tonyu.globals.$Boot.economyMode.manualDraw) {
          //$LASTPOS=12000464;//kernel.InputDevice:464
          Tonyu.globals.$Boot.requestDrawFrame();
          
        }
      },
      fiber$handleListeners :function _trc_InputDevice_f_handleListeners(_thread,type,evt) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var l;
        
        //$LASTPOS=12000228;//kernel.InputDevice:228
        l = _this.listeners;
        
        //$LASTPOS=12000250;//kernel.InputDevice:250
        _this.listeners=[];
        
        _thread.enter(function _trc_InputDevice_ent_handleListeners(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=12000269;//kernel.InputDevice:269
            case 1:
              if (!(l.length>0)) { __pc=2     ; break; }
              {
                //$LASTPOS=12000290;//kernel.InputDevice:290
                (l.shift())();
              }
              __pc=1;break;
            case 2     :
              
              //$LASTPOS=12000312;//kernel.InputDevice:312
              if (type&&evt) {
                //$LASTPOS=12000340;//kernel.InputDevice:340
                evt.type=type;
                //$LASTPOS=12000364;//kernel.InputDevice:364
                _this.fireEvent(type,evt);
                
              }
              //$LASTPOS=12000397;//kernel.InputDevice:397
              if (Tonyu.globals.$Boot.economyMode&&! Tonyu.globals.$Boot.economyMode.manualDraw) {
                //$LASTPOS=12000464;//kernel.InputDevice:464
                Tonyu.globals.$Boot.requestDrawFrame();
                
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      addOnetimeListener :function _trc_InputDevice_addOnetimeListener(l) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=12000530;//kernel.InputDevice:530
        _this.listeners.push(l);
      },
      fiber$addOnetimeListener :function _trc_InputDevice_f_addOnetimeListener(_thread,l) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=12000530;//kernel.InputDevice:530
        _this.listeners.push(l);
        
        _thread.retVal=_this;return;
      },
      newTouch :function _trc_InputDevice_newTouch(i) {
        "use strict";
        var _this=this;
        
        return {index: i,px: 0,py: 0,x: 0,y: 0,vx: 0,vy: 0,touched: 0,identifier: - 1,ended: false,layer: _this.defaultLayer};
      },
      fiber$newTouch :function _trc_InputDevice_f_newTouch(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal={index: i,px: 0,py: 0,x: 0,y: 0,vx: 0,vy: 0,touched: 0,identifier: - 1,ended: false,layer: _this.defaultLayer};return;
        
        
        _thread.retVal=_this;return;
      },
      changeTouchLayer :function _trc_InputDevice_changeTouchLayer(t,toLayer) {
        "use strict";
        var _this=this;
        
        return t.layer=toLayer;
      },
      fiber$changeTouchLayer :function _trc_InputDevice_f_changeTouchLayer(_thread,t,toLayer) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=t.layer=toLayer;return;
        
        
        _thread.retVal=_this;return;
      },
      initCanvasEvents :function _trc_InputDevice_initCanvasEvents(cvj) {
        "use strict";
        var _this=this;
        var cv;
        var ID_MOUSE;
        var handleMouseDown;
        var handleMouseMove;
        var handleMouseUp;
        var handleTouchStart;
        var handleTouchMove;
        var handleTouchEnd;
        var d;
        
        //$LASTPOS=12000790;//kernel.InputDevice:790
        _this.rootCanvas=cvj;
        //$LASTPOS=12000811;//kernel.InputDevice:811
        cv = cvj[0];
        
        //$LASTPOS=12000831;//kernel.InputDevice:831
        ID_MOUSE = 31238612;
        
        //$LASTPOS=12000859;//kernel.InputDevice:859
        Tonyu.globals.$handleMouseDown=(function anonymous_876(e) {
          var p;
          var mp;
          
          //$LASTPOS=12000892;//kernel.InputDevice:892
          _this.mouseDownAtCV=true;
          //$LASTPOS=12000921;//kernel.InputDevice:921
          Tonyu.resetLoopCheck();
          //$LASTPOS=12000954;//kernel.InputDevice:954
          if (Tonyu.globals.$t2MediaLib) {
            //$LASTPOS=12000971;//kernel.InputDevice:971
            Tonyu.globals.$t2MediaLib.activate();
          }
          //$LASTPOS=12001120;//kernel.InputDevice:1120
          p = cvj.offset();
          
          //$LASTPOS=12001149;//kernel.InputDevice:1149
          mp = {x: e.clientX-p.left,y: e.clientY-p.top,layer: Tonyu.globals.$Screen.layer};
          
          //$LASTPOS=12001226;//kernel.InputDevice:1226
          mp=Tonyu.globals.$Screen.convert(mp,_this.defaultLayer);
          //$LASTPOS=12001298;//kernel.InputDevice:1298
          Tonyu.globals.$mouseX=mp.x;
          //$LASTPOS=12001321;//kernel.InputDevice:1321
          Tonyu.globals.$mouseY=mp.y;
          //$LASTPOS=12001344;//kernel.InputDevice:1344
          _this.mouseButton=_this.mouseButton|(1<<e.button);
          //$LASTPOS=12001392;//kernel.InputDevice:1392
          _this.isMouseDown=true;
          //$LASTPOS=12001419;//kernel.InputDevice:1419
          if (Tonyu.globals.$InputDevice.touchEmu) {
            //$LASTPOS=12001461;//kernel.InputDevice:1461
            Tonyu.globals.$handleTouchStart({preventDefault: (function anonymous_1513() {
              
            }),originalEvent: {changedTouches: [{identifier: ID_MOUSE,pageX: e.clientX,pageY: e.clientY}]}});
            
          }
          //$LASTPOS=12001758;//kernel.InputDevice:1758
          _this.handleListeners();
        });
        //$LASTPOS=12001790;//kernel.InputDevice:1790
        Tonyu.globals.$handleMouseMove=(function anonymous_1807(e) {
          var p;
          var mp;
          
          //$LASTPOS=12001823;//kernel.InputDevice:1823
          Tonyu.resetLoopCheck();
          //$LASTPOS=12001856;//kernel.InputDevice:1856
          if (_this.mouseDownAtCV) {
            //$LASTPOS=12001875;//kernel.InputDevice:1875
            e.preventDefault();
          }
          //$LASTPOS=12001904;//kernel.InputDevice:1904
          p = cvj.offset();
          
          //$LASTPOS=12001933;//kernel.InputDevice:1933
          mp = {x: e.clientX-p.left,y: e.clientY-p.top,layer: Tonyu.globals.$Screen.layer};
          
          //$LASTPOS=12002010;//kernel.InputDevice:2010
          mp=Tonyu.globals.$Screen.convert(mp,_this.defaultLayer);
          //$LASTPOS=12002082;//kernel.InputDevice:2082
          Tonyu.globals.$mouseX=mp.x;
          //$LASTPOS=12002105;//kernel.InputDevice:2105
          Tonyu.globals.$mouseY=mp.y;
          //$LASTPOS=12002128;//kernel.InputDevice:2128
          if (_this.isMouseDown&&Tonyu.globals.$InputDevice.touchEmu) {
            //$LASTPOS=12002185;//kernel.InputDevice:2185
            Tonyu.globals.$handleTouchMove({preventDefault: (function anonymous_2236() {
              
            }),originalEvent: {changedTouches: [{identifier: ID_MOUSE,pageX: e.clientX,pageY: e.clientY}]}});
            
          }
          //$LASTPOS=12002481;//kernel.InputDevice:2481
          _this.handleListeners();
        });
        //$LASTPOS=12002513;//kernel.InputDevice:2513
        Tonyu.globals.$handleMouseUp=(function anonymous_2528(e) {
          
          //$LASTPOS=12002544;//kernel.InputDevice:2544
          Tonyu.resetLoopCheck();
          //$LASTPOS=12002577;//kernel.InputDevice:2577
          if (Tonyu.globals.$t2MediaLib) {
            //$LASTPOS=12002594;//kernel.InputDevice:2594
            Tonyu.globals.$t2MediaLib.activate();
          }
          //$LASTPOS=12002627;//kernel.InputDevice:2627
          if (_this.mouseDownAtCV) {
            //$LASTPOS=12002646;//kernel.InputDevice:2646
            e.preventDefault();
          }
          //$LASTPOS=12002675;//kernel.InputDevice:2675
          _this.mouseDownAtCV=false;
          //$LASTPOS=12002705;//kernel.InputDevice:2705
          _this.isMouseDown=false;
          //$LASTPOS=12002733;//kernel.InputDevice:2733
          _this.mouseButton=_this.mouseButton&~ (1<<e.button);
          //$LASTPOS=12002782;//kernel.InputDevice:2782
          if (Tonyu.globals.$InputDevice.touchEmu) {
            //$LASTPOS=12002824;//kernel.InputDevice:2824
            Tonyu.globals.$handleTouchEnd({preventDefault: (function anonymous_2874() {
              
            }),originalEvent: {changedTouches: [{identifier: ID_MOUSE,pageX: e.clientX,pageY: e.clientY}]}});
            
          }
        });
        //$LASTPOS=12003134;//kernel.InputDevice:3134
        _this.touch=new Tonyu.classes.kernel.TouchFingers(_this);
        //$LASTPOS=12003169;//kernel.InputDevice:3169
        Tonyu.globals.$touches=_this.touch.fingerArray;
        //$LASTPOS=12003202;//kernel.InputDevice:3202
        Tonyu.globals.$handleTouchStart=(function anonymous_3220(e) {
          
          return _this.touch.handleStart(e);
        });
        //$LASTPOS=12003287;//kernel.InputDevice:3287
        Tonyu.globals.$handleTouchMove=(function anonymous_3304(e) {
          
          return _this.touch.handleMove(e);
        });
        //$LASTPOS=12003370;//kernel.InputDevice:3370
        Tonyu.globals.$handleTouchEnd=(function anonymous_3386(e) {
          
          return _this.touch.handleEnd(e);
        });
        //$LASTPOS=12003451;//kernel.InputDevice:3451
        Tonyu.globals.$unsetTouchEmu=(function anonymous_3466() {
          
          //$LASTPOS=12003481;//kernel.InputDevice:3481
          Tonyu.resetLoopCheck();
          //$LASTPOS=12003514;//kernel.InputDevice:3514
          Tonyu.globals.$InputDevice.touchEmu=false;
          return _this.touch.unsetEmu();
        });
        //$LASTPOS=12003599;//kernel.InputDevice:3599
        handleMouseDown = (function anonymous_3619(e) {
          
          //$LASTPOS=12003624;//kernel.InputDevice:3624
          Tonyu.globals.$handleMouseDown(e);
        });
        
        //$LASTPOS=12003652;//kernel.InputDevice:3652
        handleMouseMove = (function anonymous_3672(e) {
          
          //$LASTPOS=12003677;//kernel.InputDevice:3677
          Tonyu.globals.$handleMouseMove(e);
        });
        
        //$LASTPOS=12003705;//kernel.InputDevice:3705
        handleMouseUp = (function anonymous_3723(e) {
          
          //$LASTPOS=12003728;//kernel.InputDevice:3728
          Tonyu.globals.$handleMouseUp(e);
        });
        
        //$LASTPOS=12003754;//kernel.InputDevice:3754
        handleTouchStart = (function anonymous_3775(e) {
          
          //$LASTPOS=12003780;//kernel.InputDevice:3780
          Tonyu.globals.$unsetTouchEmu();
          //$LASTPOS=12003797;//kernel.InputDevice:3797
          Tonyu.globals.$handleTouchStart(e);
        });
        
        //$LASTPOS=12003826;//kernel.InputDevice:3826
        handleTouchMove = (function anonymous_3846(e) {
          
          //$LASTPOS=12003851;//kernel.InputDevice:3851
          Tonyu.globals.$unsetTouchEmu();
          //$LASTPOS=12003868;//kernel.InputDevice:3868
          Tonyu.globals.$handleTouchMove(e);
        });
        
        //$LASTPOS=12003896;//kernel.InputDevice:3896
        handleTouchEnd = (function anonymous_3915(e) {
          
          //$LASTPOS=12003920;//kernel.InputDevice:3920
          Tonyu.globals.$unsetTouchEmu();
          //$LASTPOS=12003937;//kernel.InputDevice:3937
          Tonyu.globals.$handleTouchEnd(e);
        });
        
        //$LASTPOS=12003964;//kernel.InputDevice:3964
        d = $.data(cv,"events");
        
        //$LASTPOS=12003996;//kernel.InputDevice:3996
        if (! d) {
          //$LASTPOS=12004015;//kernel.InputDevice:4015
          $.data(cv,"events","true");
          //$LASTPOS=12004052;//kernel.InputDevice:4052
          cvj.mousedown(handleMouseDown);
          //$LASTPOS=12004093;//kernel.InputDevice:4093
          $(document).mousemove(handleMouseMove);
          //$LASTPOS=12004142;//kernel.InputDevice:4142
          $(document).mouseup(handleMouseUp);
          //$LASTPOS=12004187;//kernel.InputDevice:4187
          cvj.on("contextmenu",(function anonymous_4208(e) {
            
            //$LASTPOS=12004236;//kernel.InputDevice:4236
            e.stopPropagation();
            //$LASTPOS=12004270;//kernel.InputDevice:4270
            e.preventDefault();
          }));
          //$LASTPOS=12004312;//kernel.InputDevice:4312
          cvj.on("touchstart",handleTouchStart);
          //$LASTPOS=12004360;//kernel.InputDevice:4360
          cvj.on("touchmove",handleTouchMove);
          //$LASTPOS=12004406;//kernel.InputDevice:4406
          cvj.on("touchend",handleTouchEnd);
          //$LASTPOS=12004450;//kernel.InputDevice:4450
          cvj.on("touchcancel",handleTouchEnd);
          
        }
      },
      fiber$initCanvasEvents :function _trc_InputDevice_f_initCanvasEvents(_thread,cvj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var cv;
        var ID_MOUSE;
        var handleMouseDown;
        var handleMouseMove;
        var handleMouseUp;
        var handleTouchStart;
        var handleTouchMove;
        var handleTouchEnd;
        var d;
        
        //$LASTPOS=12000790;//kernel.InputDevice:790
        _this.rootCanvas=cvj;
        //$LASTPOS=12000811;//kernel.InputDevice:811
        cv = cvj[0];
        
        //$LASTPOS=12000831;//kernel.InputDevice:831
        ID_MOUSE = 31238612;
        
        
        _thread.enter(function _trc_InputDevice_ent_initCanvasEvents(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=12000859;//kernel.InputDevice:859
              Tonyu.globals.$handleMouseDown=(function anonymous_876(e) {
                var p;
                var mp;
                
                //$LASTPOS=12000892;//kernel.InputDevice:892
                _this.mouseDownAtCV=true;
                //$LASTPOS=12000921;//kernel.InputDevice:921
                Tonyu.resetLoopCheck();
                //$LASTPOS=12000954;//kernel.InputDevice:954
                if (Tonyu.globals.$t2MediaLib) {
                  //$LASTPOS=12000971;//kernel.InputDevice:971
                  Tonyu.globals.$t2MediaLib.activate();
                }
                //$LASTPOS=12001120;//kernel.InputDevice:1120
                p = cvj.offset();
                
                //$LASTPOS=12001149;//kernel.InputDevice:1149
                mp = {x: e.clientX-p.left,y: e.clientY-p.top,layer: Tonyu.globals.$Screen.layer};
                
                //$LASTPOS=12001226;//kernel.InputDevice:1226
                mp=Tonyu.globals.$Screen.convert(mp,_this.defaultLayer);
                //$LASTPOS=12001298;//kernel.InputDevice:1298
                Tonyu.globals.$mouseX=mp.x;
                //$LASTPOS=12001321;//kernel.InputDevice:1321
                Tonyu.globals.$mouseY=mp.y;
                //$LASTPOS=12001344;//kernel.InputDevice:1344
                _this.mouseButton=_this.mouseButton|(1<<e.button);
                //$LASTPOS=12001392;//kernel.InputDevice:1392
                _this.isMouseDown=true;
                //$LASTPOS=12001419;//kernel.InputDevice:1419
                if (Tonyu.globals.$InputDevice.touchEmu) {
                  //$LASTPOS=12001461;//kernel.InputDevice:1461
                  Tonyu.globals.$handleTouchStart({preventDefault: (function anonymous_1513() {
                    
                  }),originalEvent: {changedTouches: [{identifier: ID_MOUSE,pageX: e.clientX,pageY: e.clientY}]}});
                  
                }
                //$LASTPOS=12001758;//kernel.InputDevice:1758
                _this.handleListeners();
              });
              //$LASTPOS=12001790;//kernel.InputDevice:1790
              Tonyu.globals.$handleMouseMove=(function anonymous_1807(e) {
                var p;
                var mp;
                
                //$LASTPOS=12001823;//kernel.InputDevice:1823
                Tonyu.resetLoopCheck();
                //$LASTPOS=12001856;//kernel.InputDevice:1856
                if (_this.mouseDownAtCV) {
                  //$LASTPOS=12001875;//kernel.InputDevice:1875
                  e.preventDefault();
                }
                //$LASTPOS=12001904;//kernel.InputDevice:1904
                p = cvj.offset();
                
                //$LASTPOS=12001933;//kernel.InputDevice:1933
                mp = {x: e.clientX-p.left,y: e.clientY-p.top,layer: Tonyu.globals.$Screen.layer};
                
                //$LASTPOS=12002010;//kernel.InputDevice:2010
                mp=Tonyu.globals.$Screen.convert(mp,_this.defaultLayer);
                //$LASTPOS=12002082;//kernel.InputDevice:2082
                Tonyu.globals.$mouseX=mp.x;
                //$LASTPOS=12002105;//kernel.InputDevice:2105
                Tonyu.globals.$mouseY=mp.y;
                //$LASTPOS=12002128;//kernel.InputDevice:2128
                if (_this.isMouseDown&&Tonyu.globals.$InputDevice.touchEmu) {
                  //$LASTPOS=12002185;//kernel.InputDevice:2185
                  Tonyu.globals.$handleTouchMove({preventDefault: (function anonymous_2236() {
                    
                  }),originalEvent: {changedTouches: [{identifier: ID_MOUSE,pageX: e.clientX,pageY: e.clientY}]}});
                  
                }
                //$LASTPOS=12002481;//kernel.InputDevice:2481
                _this.handleListeners();
              });
              //$LASTPOS=12002513;//kernel.InputDevice:2513
              Tonyu.globals.$handleMouseUp=(function anonymous_2528(e) {
                
                //$LASTPOS=12002544;//kernel.InputDevice:2544
                Tonyu.resetLoopCheck();
                //$LASTPOS=12002577;//kernel.InputDevice:2577
                if (Tonyu.globals.$t2MediaLib) {
                  //$LASTPOS=12002594;//kernel.InputDevice:2594
                  Tonyu.globals.$t2MediaLib.activate();
                }
                //$LASTPOS=12002627;//kernel.InputDevice:2627
                if (_this.mouseDownAtCV) {
                  //$LASTPOS=12002646;//kernel.InputDevice:2646
                  e.preventDefault();
                }
                //$LASTPOS=12002675;//kernel.InputDevice:2675
                _this.mouseDownAtCV=false;
                //$LASTPOS=12002705;//kernel.InputDevice:2705
                _this.isMouseDown=false;
                //$LASTPOS=12002733;//kernel.InputDevice:2733
                _this.mouseButton=_this.mouseButton&~ (1<<e.button);
                //$LASTPOS=12002782;//kernel.InputDevice:2782
                if (Tonyu.globals.$InputDevice.touchEmu) {
                  //$LASTPOS=12002824;//kernel.InputDevice:2824
                  Tonyu.globals.$handleTouchEnd({preventDefault: (function anonymous_2874() {
                    
                  }),originalEvent: {changedTouches: [{identifier: ID_MOUSE,pageX: e.clientX,pageY: e.clientY}]}});
                  
                }
              });
              //$LASTPOS=12003134;//kernel.InputDevice:3134
              _this.touch=new Tonyu.classes.kernel.TouchFingers(_this);
              //$LASTPOS=12003169;//kernel.InputDevice:3169
              Tonyu.globals.$touches=_this.touch.fingerArray;
              //$LASTPOS=12003202;//kernel.InputDevice:3202
              Tonyu.globals.$handleTouchStart=(function anonymous_3220(e) {
                
                return _this.touch.handleStart(e);
              });
              //$LASTPOS=12003287;//kernel.InputDevice:3287
              Tonyu.globals.$handleTouchMove=(function anonymous_3304(e) {
                
                return _this.touch.handleMove(e);
              });
              //$LASTPOS=12003370;//kernel.InputDevice:3370
              Tonyu.globals.$handleTouchEnd=(function anonymous_3386(e) {
                
                return _this.touch.handleEnd(e);
              });
              //$LASTPOS=12003451;//kernel.InputDevice:3451
              Tonyu.globals.$unsetTouchEmu=(function anonymous_3466() {
                
                //$LASTPOS=12003481;//kernel.InputDevice:3481
                Tonyu.resetLoopCheck();
                //$LASTPOS=12003514;//kernel.InputDevice:3514
                Tonyu.globals.$InputDevice.touchEmu=false;
                return _this.touch.unsetEmu();
              });
              //$LASTPOS=12003599;//kernel.InputDevice:3599
              handleMouseDown = (function anonymous_3619(e) {
                
                //$LASTPOS=12003624;//kernel.InputDevice:3624
                Tonyu.globals.$handleMouseDown(e);
              });
              
              //$LASTPOS=12003652;//kernel.InputDevice:3652
              handleMouseMove = (function anonymous_3672(e) {
                
                //$LASTPOS=12003677;//kernel.InputDevice:3677
                Tonyu.globals.$handleMouseMove(e);
              });
              
              //$LASTPOS=12003705;//kernel.InputDevice:3705
              handleMouseUp = (function anonymous_3723(e) {
                
                //$LASTPOS=12003728;//kernel.InputDevice:3728
                Tonyu.globals.$handleMouseUp(e);
              });
              
              //$LASTPOS=12003754;//kernel.InputDevice:3754
              handleTouchStart = (function anonymous_3775(e) {
                
                //$LASTPOS=12003780;//kernel.InputDevice:3780
                Tonyu.globals.$unsetTouchEmu();
                //$LASTPOS=12003797;//kernel.InputDevice:3797
                Tonyu.globals.$handleTouchStart(e);
              });
              
              //$LASTPOS=12003826;//kernel.InputDevice:3826
              handleTouchMove = (function anonymous_3846(e) {
                
                //$LASTPOS=12003851;//kernel.InputDevice:3851
                Tonyu.globals.$unsetTouchEmu();
                //$LASTPOS=12003868;//kernel.InputDevice:3868
                Tonyu.globals.$handleTouchMove(e);
              });
              
              //$LASTPOS=12003896;//kernel.InputDevice:3896
              handleTouchEnd = (function anonymous_3915(e) {
                
                //$LASTPOS=12003920;//kernel.InputDevice:3920
                Tonyu.globals.$unsetTouchEmu();
                //$LASTPOS=12003937;//kernel.InputDevice:3937
                Tonyu.globals.$handleTouchEnd(e);
              });
              
              //$LASTPOS=12003964;//kernel.InputDevice:3964
              d = $.data(cv,"events");
              
              //$LASTPOS=12003996;//kernel.InputDevice:3996
              if (! d) {
                //$LASTPOS=12004015;//kernel.InputDevice:4015
                $.data(cv,"events","true");
                //$LASTPOS=12004052;//kernel.InputDevice:4052
                cvj.mousedown(handleMouseDown);
                //$LASTPOS=12004093;//kernel.InputDevice:4093
                $(document).mousemove(handleMouseMove);
                //$LASTPOS=12004142;//kernel.InputDevice:4142
                $(document).mouseup(handleMouseUp);
                //$LASTPOS=12004187;//kernel.InputDevice:4187
                cvj.on("contextmenu",(function anonymous_4208(e) {
                  
                  //$LASTPOS=12004236;//kernel.InputDevice:4236
                  e.stopPropagation();
                  //$LASTPOS=12004270;//kernel.InputDevice:4270
                  e.preventDefault();
                }));
                //$LASTPOS=12004312;//kernel.InputDevice:4312
                cvj.on("touchstart",handleTouchStart);
                //$LASTPOS=12004360;//kernel.InputDevice:4360
                cvj.on("touchmove",handleTouchMove);
                //$LASTPOS=12004406;//kernel.InputDevice:4406
                cvj.on("touchend",handleTouchEnd);
                //$LASTPOS=12004450;//kernel.InputDevice:4450
                cvj.on("touchcancel",handleTouchEnd);
                
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      update :function _trc_InputDevice_update() {
        "use strict";
        var _this=this;
        
        return _this.touch.updateFingers();
      },
      fiber$update :function _trc_InputDevice_f_update(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.touch.updateFingers();return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"handleListeners":{"nowait":false},"addOnetimeListener":{"nowait":false},"newTouch":{"nowait":false},"changeTouchLayer":{"nowait":false},"initCanvasEvents":{"nowait":false},"update":{"nowait":false}},"fields":{"listeners":{},"touchEmu":{},"defaultLayer":{},"rootCanvas":{},"mouseDownAtCV":{},"mouseButton":{},"isMouseDown":{},"touch":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ArgParser',
  shortName: 'ArgParser',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ArgParser_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ArgParser_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_ArgParser_initialize(asrc) {
        "use strict";
        var _this=this;
        var i;
        
        //$LASTPOS=13000018;//kernel.ArgParser:18
        if (! asrc) {
          throw new Error("Use as: new ArgParser(arguments)");
          
        }
        //$LASTPOS=13000087;//kernel.ArgParser:87
        _this.length=0;
        //$LASTPOS=13000102;//kernel.ArgParser:102
        _this.a=_this;
        //$LASTPOS=13000115;//kernel.ArgParser:115
        //$LASTPOS=13000120;//kernel.ArgParser:120
        i = 0;
        for (; i<asrc.length ; i++) {
          //$LASTPOS=13000148;//kernel.ArgParser:148
          _this.push(asrc[i]);
        }
      },
      push :function _trc_ArgParser_push(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=13000183;//kernel.ArgParser:183
        _this.a[_this.length++]=v;
      },
      fiber$push :function _trc_ArgParser_f_push(_thread,v) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=13000183;//kernel.ArgParser:183
        _this.a[_this.length++]=v;
        
        _thread.retVal=_this;return;
      },
      trimUndefs :function _trc_ArgParser_trimUndefs() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=13000223;//kernel.ArgParser:223
        while (_this.length>0) {
          //$LASTPOS=13000250;//kernel.ArgParser:250
          if (_this.a[_this.length-1]!==_this._undef) {
            break;
            
          }
          //$LASTPOS=13000292;//kernel.ArgParser:292
          _this.length--;
          //$LASTPOS=13000311;//kernel.ArgParser:311
          delete _this.a[_this.length];
          
        }
      },
      fiber$trimUndefs :function _trc_ArgParser_f_trimUndefs(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_ArgParser_ent_trimUndefs(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=13000223;//kernel.ArgParser:223
            case 1:
              if (!(_this.length>0)) { __pc=3     ; break; }
              //$LASTPOS=13000250;//kernel.ArgParser:250
              if (!(_this.a[_this.length-1]!==_this._undef)) { __pc=2     ; break; }
              __pc=3     ; break;
              
            case 2     :
              
              //$LASTPOS=13000292;//kernel.ArgParser:292
              _this.length--;
              //$LASTPOS=13000311;//kernel.ArgParser:311
              delete _this.a[_this.length];
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      peek :function _trc_ArgParser_peek(i) {
        "use strict";
        var _this=this;
        
        return _this.a[i||0];
      },
      fiber$peek :function _trc_ArgParser_f_peek(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.a[i||0];return;
        
        
        _thread.retVal=_this;return;
      },
      shift :function _trc_ArgParser_shift(type) {
        "use strict";
        var _this=this;
        var res;
        var i;
        
        //$LASTPOS=13000396;//kernel.ArgParser:396
        if (typeof  type=="number") {
          //$LASTPOS=13000434;//kernel.ArgParser:434
          res = [];
          
          //$LASTPOS=13000455;//kernel.ArgParser:455
          //$LASTPOS=13000460;//kernel.ArgParser:460
          i = 0;
          for (; i<type ; i++) {
            //$LASTPOS=13000481;//kernel.ArgParser:481
            res.push(_this.shift());
          }
          return res;
          
        } else {
          //$LASTPOS=13000533;//kernel.ArgParser:533
          if (typeof  type=="string") {
            //$LASTPOS=13000571;//kernel.ArgParser:571
            if (_this.a[0]==null) {
              return _this._undef;
            }
            //$LASTPOS=13000657;//kernel.ArgParser:657
            if (typeof  _this.a[0]===type) {
              return _this.shift();
            }
            return _this._undef;
            
          } else {
            //$LASTPOS=13000733;//kernel.ArgParser:733
            if (type) {
              //$LASTPOS=13000754;//kernel.ArgParser:754
              if (Tonyu.is(_this.a[0],type)) {
                return _this.shift();
              }
              return _this._undef;
              
            }
          }
        }
        //$LASTPOS=13000824;//kernel.ArgParser:824
        res = _this.a[0];
        
        //$LASTPOS=13000843;//kernel.ArgParser:843
        //$LASTPOS=13000848;//kernel.ArgParser:848
        i = 1;
        for (; i<_this.length ; i++) {
          {
            //$LASTPOS=13000885;//kernel.ArgParser:885
            _this.a[i-1]=_this.a[i];
          }
        }
        //$LASTPOS=13000910;//kernel.ArgParser:910
        _this.length--;
        //$LASTPOS=13000941;//kernel.ArgParser:941
        delete _this.a[_this.length];
        return res;
      },
      fiber$shift :function _trc_ArgParser_f_shift(_thread,type) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var i;
        
        
        _thread.enter(function _trc_ArgParser_ent_shift(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=13000396;//kernel.ArgParser:396
              if (!(typeof  type=="number")) { __pc=1     ; break; }
              //$LASTPOS=13000434;//kernel.ArgParser:434
              res = [];
              
              //$LASTPOS=13000455;//kernel.ArgParser:455
              //$LASTPOS=13000460;//kernel.ArgParser:460
              i = 0;
              for (; i<type ; i++) {
                //$LASTPOS=13000481;//kernel.ArgParser:481
                res.push(_this.shift());
              }
              _thread.exit(res);return;
              __pc=10    ;break;
            case 1     :
              //$LASTPOS=13000533;//kernel.ArgParser:533
              if (!(typeof  type=="string")) { __pc=5     ; break; }
              //$LASTPOS=13000571;//kernel.ArgParser:571
              if (!(_this.a[0]==null)) { __pc=2     ; break; }
              _thread.exit(_this._undef);return;
            case 2     :
              
              //$LASTPOS=13000657;//kernel.ArgParser:657
              if (!(typeof  _this.a[0]===type)) { __pc=4     ; break; }
              _this.fiber$shift(_thread);
              __pc=3;return;
            case 3:
              _thread.exit(_thread.retVal);return;
              
            case 4     :
              
              _thread.exit(_this._undef);return;
              __pc=9     ;break;
            case 5     :
              //$LASTPOS=13000733;//kernel.ArgParser:733
              if (!(type)) { __pc=8     ; break; }
              //$LASTPOS=13000754;//kernel.ArgParser:754
              if (!(Tonyu.is(_this.a[0],type))) { __pc=7     ; break; }
              _this.fiber$shift(_thread);
              __pc=6;return;
            case 6:
              _thread.exit(_thread.retVal);return;
              
            case 7     :
              
              _thread.exit(_this._undef);return;
            case 8     :
              
            case 9     :
              
            case 10    :
              
              //$LASTPOS=13000824;//kernel.ArgParser:824
              res = _this.a[0];
              
              //$LASTPOS=13000843;//kernel.ArgParser:843
              //$LASTPOS=13000848;//kernel.ArgParser:848
              i = 1;
              for (; i<_this.length ; i++) {
                {
                  //$LASTPOS=13000885;//kernel.ArgParser:885
                  _this.a[i-1]=_this.a[i];
                }
              }
              //$LASTPOS=13000910;//kernel.ArgParser:910
              _this.length--;
              //$LASTPOS=13000941;//kernel.ArgParser:941
              delete _this.a[_this.length];
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      toArray :function _trc_ArgParser_toArray() {
        "use strict";
        var _this=this;
        var res;
        var i;
        
        //$LASTPOS=13001003;//kernel.ArgParser:1003
        res = [];
        
        //$LASTPOS=13001020;//kernel.ArgParser:1020
        //$LASTPOS=13001025;//kernel.ArgParser:1025
        i = 0;
        for (; i<_this.a.length ; i++) {
          //$LASTPOS=13001051;//kernel.ArgParser:1051
          res.push(_this.a[i]);
        }
        return res;
      },
      fiber$toArray :function _trc_ArgParser_f_toArray(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var i;
        
        //$LASTPOS=13001003;//kernel.ArgParser:1003
        res = [];
        
        //$LASTPOS=13001020;//kernel.ArgParser:1020
        //$LASTPOS=13001025;//kernel.ArgParser:1025
        i = 0;
        for (; i<_this.a.length ; i++) {
          //$LASTPOS=13001051;//kernel.ArgParser:1051
          res.push(_this.a[i]);
        }
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      parseOptions :function _trc_ArgParser_parseOptions(spec) {
        "use strict";
        var _this=this;
        var speca;
        var res;
        var name;
        var opt;
        var notOption;
        var k;
        var v;
        var _it_74;
        var _it_75;
        
        //$LASTPOS=13001115;//kernel.ArgParser:1115
        speca = spec.split(",");
        
        //$LASTPOS=13001147;//kernel.ArgParser:1147
        res = {};
        
        //$LASTPOS=13001164;//kernel.ArgParser:1164
        if (_this.length>speca.length) {
          throw new Error("# of arguments("+_this.length+") is more than spec("+speca.length+").");
          
          
        }
        //$LASTPOS=13001306;//kernel.ArgParser:1306
        while (_this.length>1) {
          //$LASTPOS=13001333;//kernel.ArgParser:1333
          name = speca.shift();
          
          //$LASTPOS=13001366;//kernel.ArgParser:1366
          res[name]=_this.shift();
          
        }
        //$LASTPOS=13001397;//kernel.ArgParser:1397
        opt = _this.shift();
        
        //$LASTPOS=13001429;//kernel.ArgParser:1429
        if (typeof  opt!=="object") {
          //$LASTPOS=13001467;//kernel.ArgParser:1467
          notOption=true;
          
        } else {
          //$LASTPOS=13001506;//kernel.ArgParser:1506
          _it_74=Tonyu.iterator(opt,2);
          while(_it_74.next()) {
            k=_it_74[0];
            v=_it_74[1];
            
            //$LASTPOS=13001542;//kernel.ArgParser:1542
            if (speca.indexOf(k)<0) {
              //$LASTPOS=13001585;//kernel.ArgParser:1585
              notOption=true;
              break;
              
              
            }
            
          }
          
        }
        //$LASTPOS=13001663;//kernel.ArgParser:1663
        if (notOption) {
          //$LASTPOS=13001689;//kernel.ArgParser:1689
          res[speca.shift()]=opt;
          
        } else {
          //$LASTPOS=13001736;//kernel.ArgParser:1736
          _it_75=Tonyu.iterator(opt,2);
          while(_it_75.next()) {
            k=_it_75[0];
            v=_it_75[1];
            
            //$LASTPOS=13001772;//kernel.ArgParser:1772
            res[k]=v;
            
          }
          
        }
        return res;
      },
      fiber$parseOptions :function _trc_ArgParser_f_parseOptions(_thread,spec) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var speca;
        var res;
        var name;
        var opt;
        var notOption;
        var k;
        var v;
        var _it_74;
        var _it_75;
        
        //$LASTPOS=13001115;//kernel.ArgParser:1115
        speca = spec.split(",");
        
        //$LASTPOS=13001147;//kernel.ArgParser:1147
        res = {};
        
        //$LASTPOS=13001164;//kernel.ArgParser:1164
        if (_this.length>speca.length) {
          throw new Error("# of arguments("+_this.length+") is more than spec("+speca.length+").");
          
          
        }
        
        _thread.enter(function _trc_ArgParser_ent_parseOptions(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=13001306;//kernel.ArgParser:1306
            case 1:
              if (!(_this.length>1)) { __pc=3     ; break; }
              //$LASTPOS=13001333;//kernel.ArgParser:1333
              name = speca.shift();
              
              //$LASTPOS=13001366;//kernel.ArgParser:1366
              _this.fiber$shift(_thread);
              __pc=2;return;
            case 2:
              res[name]=_thread.retVal;
              
              __pc=1;break;
            case 3     :
              
              //$LASTPOS=13001397;//kernel.ArgParser:1397
              _this.fiber$shift(_thread);
              __pc=4;return;
            case 4:
              opt=_thread.retVal;
              
              //$LASTPOS=13001429;//kernel.ArgParser:1429
              if (!(typeof  opt!=="object")) { __pc=5     ; break; }
              {
                //$LASTPOS=13001467;//kernel.ArgParser:1467
                notOption=true;
              }
              __pc=6     ;break;
            case 5     :
              //$LASTPOS=13001506;//kernel.ArgParser:1506
              _it_74=Tonyu.iterator(opt,2);
              while(_it_74.next()) {
                k=_it_74[0];
                v=_it_74[1];
                
                //$LASTPOS=13001542;//kernel.ArgParser:1542
                if (speca.indexOf(k)<0) {
                  //$LASTPOS=13001585;//kernel.ArgParser:1585
                  notOption=true;
                  break;
                  
                  
                }
                
              }
            case 6     :
              
              //$LASTPOS=13001663;//kernel.ArgParser:1663
              if (notOption) {
                //$LASTPOS=13001689;//kernel.ArgParser:1689
                res[speca.shift()]=opt;
                
              } else {
                //$LASTPOS=13001736;//kernel.ArgParser:1736
                _it_75=Tonyu.iterator(opt,2);
                while(_it_75.next()) {
                  k=_it_75[0];
                  v=_it_75[1];
                  
                  //$LASTPOS=13001772;//kernel.ArgParser:1772
                  res[k]=v;
                  
                }
                
              }
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"push":{"nowait":false},"trimUndefs":{"nowait":false},"peek":{"nowait":false},"shift":{"nowait":false},"toArray":{"nowait":false},"parseOptions":{"nowait":false}},"fields":{"length":{},"a":{},"_undef":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.FileMod',
  shortName: 'FileMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_FileMod_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_FileMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      file :function _trc_FileMod_file(path) {
        "use strict";
        var _this=this;
        var d;
        var files;
        
        //$LASTPOS=14000034;//kernel.FileMod:34
        d = Tonyu.currentProject.getDir();
        
        //$LASTPOS=14000076;//kernel.FileMod:76
        if (path.isSFile&&path.isSFile()) {
          return path;
        }
        //$LASTPOS=14000130;//kernel.FileMod:130
        files = d.rel("files/");
        
        return files.rel(path).setPolicy({topDir: d});
      },
      fiber$file :function _trc_FileMod_f_file(_thread,path) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var d;
        var files;
        
        //$LASTPOS=14000034;//kernel.FileMod:34
        d = Tonyu.currentProject.getDir();
        
        //$LASTPOS=14000076;//kernel.FileMod:76
        if (path.isSFile&&path.isSFile()) {
          _thread.retVal=path;return;
          
        }
        //$LASTPOS=14000130;//kernel.FileMod:130
        files = d.rel("files/");
        
        _thread.retVal=files.rel(path).setPolicy({topDir: d});return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"file":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.GeneratorMod',
  shortName: 'GeneratorMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_GeneratorMod_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_GeneratorMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      generator :function _trc_GeneratorMod_generator() {
        "use strict";
        var _this=this;
        var a;
        var methodName;
        var th;
        var res;
        
        //$LASTPOS=15000035;//kernel.GeneratorMod:35
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=15000072;//kernel.GeneratorMod:72
        methodName = a.shift();
        
        //$LASTPOS=15000103;//kernel.GeneratorMod:103
        th = Tonyu.thread();
        
        //$LASTPOS=15000131;//kernel.GeneratorMod:131
        a = a.toArray();
        
        //$LASTPOS=15000155;//kernel.GeneratorMod:155
        a.unshift(_this.yielder);
        //$LASTPOS=15000180;//kernel.GeneratorMod:180
        res = {tonyuIterator: (function anonymous_214() {
          
        })};
        
        //$LASTPOS=15000243;//kernel.GeneratorMod:243
        th.apply(_this,methodName,a);
      },
      fiber$generator :function _trc_GeneratorMod_f_generator(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var methodName;
        var th;
        var res;
        
        //$LASTPOS=15000035;//kernel.GeneratorMod:35
        a = new Tonyu.classes.kernel.ArgParser(_arguments);
        
        //$LASTPOS=15000072;//kernel.GeneratorMod:72
        methodName = a.shift();
        
        //$LASTPOS=15000103;//kernel.GeneratorMod:103
        th = Tonyu.thread();
        
        //$LASTPOS=15000131;//kernel.GeneratorMod:131
        a = a.toArray();
        
        //$LASTPOS=15000155;//kernel.GeneratorMod:155
        a.unshift(_this.yielder);
        //$LASTPOS=15000180;//kernel.GeneratorMod:180
        res = {tonyuIterator: (function anonymous_214() {
          
        })};
        
        //$LASTPOS=15000243;//kernel.GeneratorMod:243
        th.apply(_this,methodName,a);
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"generator":{"nowait":false}},"fields":{"yielder":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.MathMod',
  shortName: 'MathMod',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_MathMod_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_MathMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      sin :function _trc_MathMod_sin(d) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=16000073;//kernel.MathMod:73
        if (d%90==0) {
          //$LASTPOS=16000097;//kernel.MathMod:97
          d=_this.amod(d,360);
          return [0,1,0,- 1][_this.floor(d/90)];
          
        }
        return Math.sin(_this.rad(d));
      },
      cos :function _trc_MathMod_cos(d) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=16000216;//kernel.MathMod:216
        if (d%90==0) {
          //$LASTPOS=16000240;//kernel.MathMod:240
          d=_this.amod(d,360);
          return [1,0,- 1,0][_this.floor(d/90)];
          
        }
        return Math.cos(_this.rad(d));
      },
      rad :function _trc_MathMod_rad(d) {
        "use strict";
        var _this=this;
        
        return d/180*Math.PI;
      },
      deg :function _trc_MathMod_deg(d) {
        "use strict";
        var _this=this;
        
        return d/Math.PI*180;
      },
      abs :function _trc_MathMod_abs(v) {
        "use strict";
        var _this=this;
        
        return Math.abs(v);
      },
      sgn :function _trc_MathMod_sgn(v,base) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=16000508;//kernel.MathMod:508
        base=base||0;
        return (v>base?1:v<- base?- 1:0);
      },
      atan2 :function _trc_MathMod_atan2(y,x) {
        "use strict";
        var _this=this;
        
        return _this.deg(Math.atan2(y,x));
      },
      atanxy :function _trc_MathMod_atanxy(x,y) {
        "use strict";
        var _this=this;
        
        return _this.atan2(y,x);
      },
      floor :function _trc_MathMod_floor(x) {
        "use strict";
        var _this=this;
        
        return Math.floor(x);
      },
      angleDiff :function _trc_MathMod_angleDiff(a,b) {
        "use strict";
        var _this=this;
        var c;
        
        
        //$LASTPOS=16000766;//kernel.MathMod:766
        a=_this.floor(a);
        //$LASTPOS=16000783;//kernel.MathMod:783
        b=_this.floor(b);
        //$LASTPOS=16000800;//kernel.MathMod:800
        if (a>=b) {
          //$LASTPOS=16000821;//kernel.MathMod:821
          c=(a-b)%360;
          //$LASTPOS=16000845;//kernel.MathMod:845
          if (c>=180) {
            //$LASTPOS=16000857;//kernel.MathMod:857
            c-=360;
          }
          
        } else {
          //$LASTPOS=16000888;//kernel.MathMod:888
          c=- ((b-a)%360);
          //$LASTPOS=16000915;//kernel.MathMod:915
          if (c<- 180) {
            //$LASTPOS=16000927;//kernel.MathMod:927
            c+=360;
          }
          
        }
        return c;
      },
      sqrt :function _trc_MathMod_sqrt(t) {
        "use strict";
        var _this=this;
        
        return Math.sqrt(t);
      },
      dist :function _trc_MathMod_dist(dx,dy) {
        "use strict";
        var _this=this;
        var t;
        
        //$LASTPOS=16001036;//kernel.MathMod:1036
        if (typeof  dx=="object") {
          //$LASTPOS=16001072;//kernel.MathMod:1072
          t = dx;
          
          //$LASTPOS=16001091;//kernel.MathMod:1091
          dx=t.x-_this.x;
          //$LASTPOS=16001100;//kernel.MathMod:1100
          dy=t.y-_this.y;
          
        }
        return _this.sqrt(dx*dx+dy*dy);
      },
      trunc :function _trc_MathMod_trunc(f) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=16001176;//kernel.MathMod:1176
        if (f>=0) {
          return Math.floor(f);
        } else {
          return Math.ceil(f);
        }
      },
      ceil :function _trc_MathMod_ceil(f) {
        "use strict";
        var _this=this;
        
        return Math.ceil(f);
      },
      rndFloat :function _trc_MathMod_rndFloat(r,m) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=16001318;//kernel.MathMod:1318
        if (typeof  r!=="number") {
          //$LASTPOS=16001343;//kernel.MathMod:1343
          r=0;
        }
        //$LASTPOS=16001353;//kernel.MathMod:1353
        if (typeof  m!=="number") {
          //$LASTPOS=16001378;//kernel.MathMod:1378
          m=1;
        }
        //$LASTPOS=16001388;//kernel.MathMod:1388
        if (r<m) {
          return Math.random()*(m-r)+r;
          
        } else {
          return Math.random()*(r-m)+m;
          
        }
      },
      rnd :function _trc_MathMod_rnd(r,m) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=16001528;//kernel.MathMod:1528
        if (typeof  r=="number") {
          //$LASTPOS=16001563;//kernel.MathMod:1563
          if (typeof  m=="number") {
            //$LASTPOS=16001602;//kernel.MathMod:1602
            if (r<m) {
              return Math.floor(Math.random()*(m-r)+r);
              
            } else {
              return Math.floor(Math.random()*(r-m)+m);
              
            }
            
          } else {
            return Math.floor(Math.random()*(r>0?r:0));
            
          }
          
        }
        return Math.random();
      },
      parseFloat :function _trc_MathMod_parseFloat(s) {
        "use strict";
        var _this=this;
        
        return parseFloat(s);
      },
      clamp :function _trc_MathMod_clamp(v,min,max) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=16001979;//kernel.MathMod:1979
        if (min>max) {
          return _this.clamp(v,max,min);
        }
        return v<min?min:v>max?max:v;
      },
      clamped :function _trc_MathMod_clamped(v,min,max) {
        "use strict";
        var _this=this;
        
        return _this.clamp(v,min,max)-v;
      },
      min :function _trc_MathMod_min() {
        "use strict";
        var _this=this;
        
        return Math.min.apply(Math,arguments);
      },
      max :function _trc_MathMod_max() {
        "use strict";
        var _this=this;
        
        return Math.max.apply(Math,arguments);
      },
      amod :function _trc_MathMod_amod(v,d) {
        "use strict";
        var _this=this;
        
        return (v%d+d)%d;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"sin":{"nowait":true},"cos":{"nowait":true},"rad":{"nowait":true},"deg":{"nowait":true},"abs":{"nowait":true},"sgn":{"nowait":true},"atan2":{"nowait":true},"atanxy":{"nowait":true},"floor":{"nowait":true},"angleDiff":{"nowait":true},"sqrt":{"nowait":true},"dist":{"nowait":true},"trunc":{"nowait":true},"ceil":{"nowait":true},"rndFloat":{"nowait":true},"rnd":{"nowait":true},"parseFloat":{"nowait":true},"clamp":{"nowait":true},"clamped":{"nowait":true},"min":{"nowait":true},"max":{"nowait":true},"amod":{"nowait":true}},"fields":{"x":{},"y":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Navigator',
  shortName: 'Navigator',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Navigator_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Navigator_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      getUserAgent :function _trc_Navigator_getUserAgent() {
        "use strict";
        var _this=this;
        
        return navigator.userAgent;
      },
      fiber$getUserAgent :function _trc_Navigator_f_getUserAgent(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=navigator.userAgent;return;
        
        
        _thread.retVal=_this;return;
      },
      isTablet :function _trc_Navigator_isTablet() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17000263;//kernel.Navigator:263
        u = _this.getUserAgent().toLowerCase();
        
        return ((u.indexOf("windows")!=- 1&&u.indexOf("touch")!=- 1&&u.indexOf("tablet pc")==- 1)||u.indexOf("ipad")!=- 1||(u.indexOf("android")!=- 1&&u.indexOf("windows")==- 1&&u.indexOf("mobile")==- 1)||(u.indexOf("firefox")!=- 1&&u.indexOf("tablet")!=- 1)||u.indexOf("kindle")!=- 1||u.indexOf("silk")!=- 1||u.indexOf("playbook")!=- 1||u.indexOf('a1_07')!=- 1||u.indexOf('sc-01c')!=- 1);
      },
      fiber$isTablet :function _trc_Navigator_f_isTablet(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17000263;//kernel.Navigator:263
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=((u.indexOf("windows")!=- 1&&u.indexOf("touch")!=- 1&&u.indexOf("tablet pc")==- 1)||u.indexOf("ipad")!=- 1||(u.indexOf("android")!=- 1&&u.indexOf("windows")==- 1&&u.indexOf("mobile")==- 1)||(u.indexOf("firefox")!=- 1&&u.indexOf("tablet")!=- 1)||u.indexOf("kindle")!=- 1||u.indexOf("silk")!=- 1||u.indexOf("playbook")!=- 1||u.indexOf('a1_07')!=- 1||u.indexOf('sc-01c')!=- 1);return;
        
        
        _thread.retVal=_this;return;
      },
      isMobile :function _trc_Navigator_isMobile() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17000800;//kernel.Navigator:800
        u = _this.getUserAgent().toLowerCase();
        
        return ((u.indexOf("windows")!=- 1&&u.indexOf("phone")!=- 1)||u.indexOf("iphone")!=- 1||u.indexOf("ipod")!=- 1||(u.indexOf("android")!=- 1&&u.indexOf("windows")==- 1&&u.indexOf("mobile")!=- 1)||(u.indexOf("firefox")!=- 1&&u.indexOf("mobile")!=- 1)||(u.indexOf("blackberry")!=- 1||(u.indexOf("bb10")!=- 1&&u.indexOf("mobile")!=- 1)));
      },
      fiber$isMobile :function _trc_Navigator_f_isMobile(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17000800;//kernel.Navigator:800
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=((u.indexOf("windows")!=- 1&&u.indexOf("phone")!=- 1)||u.indexOf("iphone")!=- 1||u.indexOf("ipod")!=- 1||(u.indexOf("android")!=- 1&&u.indexOf("windows")==- 1&&u.indexOf("mobile")!=- 1)||(u.indexOf("firefox")!=- 1&&u.indexOf("mobile")!=- 1)||(u.indexOf("blackberry")!=- 1||(u.indexOf("bb10")!=- 1&&u.indexOf("mobile")!=- 1)));return;
        
        
        _thread.retVal=_this;return;
      },
      isWindows :function _trc_Navigator_isWindows() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17001274;//kernel.Navigator:1274
        u = _this.getUserAgent().toLowerCase();
        
        return u.indexOf("windows")!=- 1;
      },
      fiber$isWindows :function _trc_Navigator_f_isWindows(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17001274;//kernel.Navigator:1274
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=u.indexOf("windows")!=- 1;return;
        
        
        _thread.retVal=_this;return;
      },
      isAndroid :function _trc_Navigator_isAndroid() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17001378;//kernel.Navigator:1378
        u = _this.getUserAgent().toLowerCase();
        
        return (u.indexOf("android")!=- 1&&u.indexOf("windows")==- 1);
      },
      fiber$isAndroid :function _trc_Navigator_f_isAndroid(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17001378;//kernel.Navigator:1378
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=(u.indexOf("android")!=- 1&&u.indexOf("windows")==- 1);return;
        
        
        _thread.retVal=_this;return;
      },
      isIOS :function _trc_Navigator_isIOS() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17001522;//kernel.Navigator:1522
        u = _this.getUserAgent().toLowerCase();
        
        return (u.indexOf("iphone")!=- 1||u.indexOf("ipad")!=- 1||u.indexOf("ipod")!=- 1);
      },
      fiber$isIOS :function _trc_Navigator_f_isIOS(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17001522;//kernel.Navigator:1522
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=(u.indexOf("iphone")!=- 1||u.indexOf("ipad")!=- 1||u.indexOf("ipod")!=- 1);return;
        
        
        _thread.retVal=_this;return;
      },
      isFirefoxOS :function _trc_Navigator_isFirefoxOS() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17001705;//kernel.Navigator:1705
        u = _this.getUserAgent().toLowerCase();
        
        return u.indexOf("firefox")!=1;
      },
      fiber$isFirefoxOS :function _trc_Navigator_f_isFirefoxOS(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17001705;//kernel.Navigator:1705
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=u.indexOf("firefox")!=1;return;
        
        
        _thread.retVal=_this;return;
      },
      isKindle :function _trc_Navigator_isKindle() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17001807;//kernel.Navigator:1807
        u = _this.getUserAgent().toLowerCase();
        
        return (u.indexOf("kindle")!=- 1||u.indexOf("silk")!=- 1);
      },
      fiber$isKindle :function _trc_Navigator_f_isKindle(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17001807;//kernel.Navigator:1807
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=(u.indexOf("kindle")!=- 1||u.indexOf("silk")!=- 1);return;
        
        
        _thread.retVal=_this;return;
      },
      isBlackBerry :function _trc_Navigator_isBlackBerry() {
        "use strict";
        var _this=this;
        var u;
        
        //$LASTPOS=17001959;//kernel.Navigator:1959
        u = _this.getUserAgent().toLowerCase();
        
        return (u.indexOf("blackberry")!=- 1||u.indexOf("playbook")!=- 1||(u.indexOf("bb10")!=- 1&&u.indexOf("mobile")!=- 1));
      },
      fiber$isBlackBerry :function _trc_Navigator_f_isBlackBerry(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var u;
        
        //$LASTPOS=17001959;//kernel.Navigator:1959
        u = _this.getUserAgent().toLowerCase();
        
        _thread.retVal=(u.indexOf("blackberry")!=- 1||u.indexOf("playbook")!=- 1||(u.indexOf("bb10")!=- 1&&u.indexOf("mobile")!=- 1));return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"getUserAgent":{"nowait":false},"isTablet":{"nowait":false},"isMobile":{"nowait":false},"isWindows":{"nowait":false},"isAndroid":{"nowait":false},"isIOS":{"nowait":false},"isFirefoxOS":{"nowait":false},"isKindle":{"nowait":false},"isBlackBerry":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.ObjectPool',
  shortName: 'ObjectPool',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ObjectPool_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ObjectPool_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      pool :function _trc_ObjectPool_pool(key,o) {
        "use strict";
        var _this=this;
        var list;
        
        //$LASTPOS=18000091;//kernel.ObjectPool:91
        list = _this.poolList(key);
        
        //$LASTPOS=18000117;//kernel.ObjectPool:117
        o.objectPoolAge=(o.objectPoolAge||0)+1;
        //$LASTPOS=18000159;//kernel.ObjectPool:159
        list.push(o);
      },
      fiber$pool :function _trc_ObjectPool_f_pool(_thread,key,o) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var list;
        
        
        _thread.enter(function _trc_ObjectPool_ent_pool(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=18000091;//kernel.ObjectPool:91
              _this.fiber$poolList(_thread, key);
              __pc=1;return;
            case 1:
              list=_thread.retVal;
              
              //$LASTPOS=18000117;//kernel.ObjectPool:117
              o.objectPoolAge=(o.objectPoolAge||0)+1;
              //$LASTPOS=18000159;//kernel.ObjectPool:159
              list.push(o);
              _thread.exit(_this);return;
            }
          }
        });
      },
      withdraw :function _trc_ObjectPool_withdraw(key) {
        "use strict";
        var _this=this;
        var list;
        
        //$LASTPOS=18000196;//kernel.ObjectPool:196
        list = _this.poolList(key);
        
        return list.shift();
      },
      fiber$withdraw :function _trc_ObjectPool_f_withdraw(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var list;
        
        
        _thread.enter(function _trc_ObjectPool_ent_withdraw(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=18000196;//kernel.ObjectPool:196
              _this.fiber$poolList(_thread, key);
              __pc=1;return;
            case 1:
              list=_thread.retVal;
              
              _thread.exit(list.shift());return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      poolList :function _trc_ObjectPool_poolList(key) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=18000266;//kernel.ObjectPool:266
        _this.lists=_this.lists||{};
        return _this.lists[key]=_this.lists[key]||[];
      },
      fiber$poolList :function _trc_ObjectPool_f_poolList(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=18000266;//kernel.ObjectPool:266
        _this.lists=_this.lists||{};
        _thread.retVal=_this.lists[key]=_this.lists[key]||[];return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"pool":{"nowait":false},"withdraw":{"nowait":false},"poolList":{"nowait":false}},"fields":{"lists":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.TObject',
  shortName: 'TObject',
  namespace: 'kernel',
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_TObject_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_TObject_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_TObject_initialize(options) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=19000052;//kernel.TObject:52
        if (typeof  options=="object") {
          //$LASTPOS=19000082;//kernel.TObject:82
          _this.extend(options);
        }
        //$LASTPOS=19000104;//kernel.TObject:104
        if (Tonyu.runMode) {
          //$LASTPOS=19000123;//kernel.TObject:123
          _this.main();
        }
      },
      extend :function _trc_TObject_extend(obj) {
        "use strict";
        var _this=this;
        
        return Tonyu.extend(_this,obj);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"extend":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.TQuery',
  shortName: 'TQuery',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_TQuery_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_TQuery_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_TQuery_initialize(context) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=20000059;//kernel.TQuery:59
        _this.length=0;
        //$LASTPOS=20000074;//kernel.TQuery:74
        if (Tonyu.is(context,Tonyu.classes.kernel.BaseActor)) {
          //$LASTPOS=20000100;//kernel.TQuery:100
          context={actor: context};
        }
        //$LASTPOS=20000130;//kernel.TQuery:130
        if (Tonyu.is(context,Tonyu.classes.kernel.Screen)) {
          //$LASTPOS=20000153;//kernel.TQuery:153
          context={screen: context};
        }
        //$LASTPOS=20000184;//kernel.TQuery:184
        context=context||{};
        //$LASTPOS=20000210;//kernel.TQuery:210
        context.is3D=(Tonyu.is(context.actor,Tonyu.classes.kernel.Actor3D));
        //$LASTPOS=20000256;//kernel.TQuery:256
        context.screen=context.screen||Tonyu.globals.$Screen;
        //$LASTPOS=20000301;//kernel.TQuery:301
        _this.context=context;
      },
      __getter__parent :function _trc_TQuery___getter__parent() {
        "use strict";
        var _this=this;
        
        return _this.context.actor;
      },
      create :function _trc_TQuery_create() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.TQuery(_this.context);
      },
      fiber$create :function _trc_TQuery_f_create(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=new Tonyu.classes.kernel.TQuery(_this.context);return;
        
        
        _thread.retVal=_this;return;
      },
      contains :function _trc_TQuery_contains(t) {
        "use strict";
        var _this=this;
        var o;
        var _it_103;
        
        //$LASTPOS=20000437;//kernel.TQuery:437
        _it_103=Tonyu.iterator(_this,1);
        while(_it_103.next()) {
          o=_it_103[0];
          
          //$LASTPOS=20000468;//kernel.TQuery:468
          if (o===t) {
            return true;
          }
          
        }
        return false;
      },
      fiber$contains :function _trc_TQuery_f_contains(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var o;
        var _it_103;
        
        //$LASTPOS=20000437;//kernel.TQuery:437
        _it_103=Tonyu.iterator(_this,1);
        while(_it_103.next()) {
          o=_it_103[0];
          
          //$LASTPOS=20000468;//kernel.TQuery:468
          if (o===t) {
            _thread.retVal=true;return;
            
          }
          
        }
        _thread.retVal=false;return;
        
        
        _thread.retVal=_this;return;
      },
      tonyuIterator :function _trc_TQuery_tonyuIterator(arity) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=20000551;//kernel.TQuery:551
        res = {};
        
        //$LASTPOS=20000568;//kernel.TQuery:568
        res.i=0;
        //$LASTPOS=20000582;//kernel.TQuery:582
        if (arity==1) {
          //$LASTPOS=20000607;//kernel.TQuery:607
          res.next=(function anonymous_616() {
            
            //$LASTPOS=20000643;//kernel.TQuery:643
            if (res.i<_this.length) {
              //$LASTPOS=20000685;//kernel.TQuery:685
              res[0]=_this[res.i];
              //$LASTPOS=20000722;//kernel.TQuery:722
              res.i++;
              return true;
              
            }
            return false;
          });
          
        } else {
          //$LASTPOS=20000838;//kernel.TQuery:838
          res.next=(function anonymous_847() {
            
            //$LASTPOS=20000874;//kernel.TQuery:874
            if (res.i<_this.length) {
              //$LASTPOS=20000916;//kernel.TQuery:916
              res[0]=res.i;
              //$LASTPOS=20000947;//kernel.TQuery:947
              res[1]=_this[res.i];
              //$LASTPOS=20000984;//kernel.TQuery:984
              res.i++;
              return true;
              
            }
            return false;
          });
          
        }
        return res;
      },
      fiber$tonyuIterator :function _trc_TQuery_f_tonyuIterator(_thread,arity) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        
        //$LASTPOS=20000551;//kernel.TQuery:551
        res = {};
        
        //$LASTPOS=20000568;//kernel.TQuery:568
        res.i=0;
        //$LASTPOS=20000582;//kernel.TQuery:582
        if (arity==1) {
          //$LASTPOS=20000607;//kernel.TQuery:607
          res.next=(function anonymous_616() {
            
            //$LASTPOS=20000643;//kernel.TQuery:643
            if (res.i<_this.length) {
              //$LASTPOS=20000685;//kernel.TQuery:685
              res[0]=_this[res.i];
              //$LASTPOS=20000722;//kernel.TQuery:722
              res.i++;
              return true;
              
            }
            return false;
          });
          
        } else {
          //$LASTPOS=20000838;//kernel.TQuery:838
          res.next=(function anonymous_847() {
            
            //$LASTPOS=20000874;//kernel.TQuery:874
            if (res.i<_this.length) {
              //$LASTPOS=20000916;//kernel.TQuery:916
              res[0]=res.i;
              //$LASTPOS=20000947;//kernel.TQuery:947
              res[1]=_this[res.i];
              //$LASTPOS=20000984;//kernel.TQuery:984
              res.i++;
              return true;
              
            }
            return false;
          });
          
        }
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      attr :function _trc_TQuery_attr() {
        "use strict";
        var _this=this;
        var values;
        var i;
        var e;
        var _it_107;
        
        
        //$LASTPOS=20001137;//kernel.TQuery:1137
        if (_this.length==0) {
          return _this;
        }
        //$LASTPOS=20001165;//kernel.TQuery:1165
        if (arguments.length==1&&typeof  arguments[0]=="string") {
          return _this[0][arguments[0]];
          
        }
        //$LASTPOS=20001276;//kernel.TQuery:1276
        if (arguments.length>=2) {
          //$LASTPOS=20001312;//kernel.TQuery:1312
          values={};
          //$LASTPOS=20001332;//kernel.TQuery:1332
          //$LASTPOS=20001337;//kernel.TQuery:1337
          i = 0;
          for (; i<arguments.length-1 ; i+=2) {
            {
              //$LASTPOS=20001390;//kernel.TQuery:1390
              values[arguments[i]]=arguments[i+1];
            }
          }
          
        } else {
          //$LASTPOS=20001461;//kernel.TQuery:1461
          values=arguments[0];
          
        }
        //$LASTPOS=20001494;//kernel.TQuery:1494
        if (values) {
          //$LASTPOS=20001517;//kernel.TQuery:1517
          _it_107=Tonyu.iterator(_this,1);
          while(_it_107.next()) {
            e=_it_107[0];
            
            //$LASTPOS=20001552;//kernel.TQuery:1552
            e.extend(values);
            
          }
          
        }
      },
      fiber$attr :function _trc_TQuery_f_attr(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var values;
        var i;
        var e;
        var _it_107;
        
        
        //$LASTPOS=20001137;//kernel.TQuery:1137
        if (_this.length==0) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=20001165;//kernel.TQuery:1165
        if (_arguments.length==1&&typeof  _arguments[0]=="string") {
          _thread.retVal=_this[0][_arguments[0]];return;
          
          
        }
        //$LASTPOS=20001276;//kernel.TQuery:1276
        if (_arguments.length>=2) {
          //$LASTPOS=20001312;//kernel.TQuery:1312
          values={};
          //$LASTPOS=20001332;//kernel.TQuery:1332
          //$LASTPOS=20001337;//kernel.TQuery:1337
          i = 0;
          for (; i<_arguments.length-1 ; i+=2) {
            {
              //$LASTPOS=20001390;//kernel.TQuery:1390
              values[_arguments[i]]=_arguments[i+1];
            }
          }
          
        } else {
          //$LASTPOS=20001461;//kernel.TQuery:1461
          values=_arguments[0];
          
        }
        //$LASTPOS=20001494;//kernel.TQuery:1494
        if (values) {
          //$LASTPOS=20001517;//kernel.TQuery:1517
          _it_107=Tonyu.iterator(_this,1);
          while(_it_107.next()) {
            e=_it_107[0];
            
            //$LASTPOS=20001552;//kernel.TQuery:1552
            e.extend(values);
            
          }
          
        }
        
        _thread.retVal=_this;return;
      },
      genKeyfunc :function _trc_TQuery_genKeyfunc(key) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=20001617;//kernel.TQuery:1617
        if (typeof  key!="function") {
          return (function anonymous_1663(o) {
            
            return o[key];
          });
          
        } else {
          return key;
          
        }
      },
      fiber$genKeyfunc :function _trc_TQuery_f_genKeyfunc(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=20001617;//kernel.TQuery:1617
        if (typeof  key!="function") {
          _thread.retVal=(function anonymous_1663(o) {
            
            return o[key];
          });return;
          
          
        } else {
          _thread.retVal=key;return;
          
          
        }
        
        _thread.retVal=_this;return;
      },
      applyArrayMethod :function _trc_TQuery_applyArrayMethod(name,args) {
        "use strict";
        var _this=this;
        var res;
        var a;
        var r;
        
        //$LASTPOS=20001768;//kernel.TQuery:1768
        res = _this.create();
        
        //$LASTPOS=20001791;//kernel.TQuery:1791
        a = _this.toArray();
        
        //$LASTPOS=20001813;//kernel.TQuery:1813
        r = a[name].apply(a,args);
        
        //$LASTPOS=20001847;//kernel.TQuery:1847
        res.push(r);
        return res;
      },
      fiber$applyArrayMethod :function _trc_TQuery_f_applyArrayMethod(_thread,name,args) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var a;
        var r;
        
        
        _thread.enter(function _trc_TQuery_ent_applyArrayMethod(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20001768;//kernel.TQuery:1768
              _this.fiber$create(_thread);
              __pc=1;return;
            case 1:
              res=_thread.retVal;
              
              //$LASTPOS=20001791;//kernel.TQuery:1791
              _this.fiber$toArray(_thread);
              __pc=2;return;
            case 2:
              a=_thread.retVal;
              
              //$LASTPOS=20001813;//kernel.TQuery:1813
              r = a[name].apply(a,args);
              
              //$LASTPOS=20001847;//kernel.TQuery:1847
              res.push(r);
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      toArray :function _trc_TQuery_toArray() {
        "use strict";
        var _this=this;
        var res;
        var i;
        
        //$LASTPOS=20001899;//kernel.TQuery:1899
        res = [];
        
        //$LASTPOS=20001916;//kernel.TQuery:1916
        //$LASTPOS=20001920;//kernel.TQuery:1920
        i = 0;
        for (; i<_this.length ; i++) {
          //$LASTPOS=20001942;//kernel.TQuery:1942
          res.push(_this[i]);
        }
        return res;
      },
      fiber$toArray :function _trc_TQuery_f_toArray(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var i;
        
        //$LASTPOS=20001899;//kernel.TQuery:1899
        res = [];
        
        //$LASTPOS=20001916;//kernel.TQuery:1916
        //$LASTPOS=20001920;//kernel.TQuery:1920
        i = 0;
        for (; i<_this.length ; i++) {
          //$LASTPOS=20001942;//kernel.TQuery:1942
          res.push(_this[i]);
        }
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      sort :function _trc_TQuery_sort() {
        "use strict";
        var _this=this;
        
        return _this.applyArrayMethod("sort",arguments);
      },
      fiber$sort :function _trc_TQuery_f_sort(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_TQuery_ent_sort(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$applyArrayMethod(_thread, "sort", _arguments);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      slice :function _trc_TQuery_slice() {
        "use strict";
        var _this=this;
        
        return _this.applyArrayMethod("slice",arguments);
      },
      fiber$slice :function _trc_TQuery_f_slice(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_TQuery_ent_slice(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$applyArrayMethod(_thread, "slice", _arguments);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      maxs :function _trc_TQuery_maxs(key) {
        "use strict";
        var _this=this;
        var f;
        var res;
        var reso;
        var o;
        var _it_118;
        var v;
        
        //$LASTPOS=20002126;//kernel.TQuery:2126
        f = _this.genKeyfunc(key);
        
        //$LASTPOS=20002154;//kernel.TQuery:2154
        reso = _this.create();
        
        //$LASTPOS=20002182;//kernel.TQuery:2182
        _it_118=Tonyu.iterator(_this,1);
        while(_it_118.next()) {
          o=_it_118[0];
          
          //$LASTPOS=20002213;//kernel.TQuery:2213
          v = f(o);
          
          //$LASTPOS=20002234;//kernel.TQuery:2234
          if (res==null||v>=res) {
            //$LASTPOS=20002274;//kernel.TQuery:2274
            if (v>res) {
              //$LASTPOS=20002285;//kernel.TQuery:2285
              reso=_this.create();
            }
            //$LASTPOS=20002313;//kernel.TQuery:2313
            reso.push(o);
            //$LASTPOS=20002340;//kernel.TQuery:2340
            res=v;
            
          }
          
        }
        return reso;
      },
      fiber$maxs :function _trc_TQuery_f_maxs(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var f;
        var res;
        var reso;
        var o;
        var _it_118;
        var v;
        
        
        _thread.enter(function _trc_TQuery_ent_maxs(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20002126;//kernel.TQuery:2126
              _this.fiber$genKeyfunc(_thread, key);
              __pc=1;return;
            case 1:
              f=_thread.retVal;
              
              //$LASTPOS=20002154;//kernel.TQuery:2154
              _this.fiber$create(_thread);
              __pc=2;return;
            case 2:
              reso=_thread.retVal;
              
              //$LASTPOS=20002182;//kernel.TQuery:2182
              _it_118=Tonyu.iterator(_this,1);
            case 3:
              if (!(_it_118.next())) { __pc=7     ; break; }
              o=_it_118[0];
              
              //$LASTPOS=20002213;//kernel.TQuery:2213
              v = f(o);
              
              //$LASTPOS=20002234;//kernel.TQuery:2234
              if (!(res==null||v>=res)) { __pc=6     ; break; }
              //$LASTPOS=20002274;//kernel.TQuery:2274
              if (!(v>res)) { __pc=5     ; break; }
              //$LASTPOS=20002285;//kernel.TQuery:2285
              _this.fiber$create(_thread);
              __pc=4;return;
            case 4:
              reso=_thread.retVal;
              
            case 5     :
              
              //$LASTPOS=20002313;//kernel.TQuery:2313
              reso.push(o);
              //$LASTPOS=20002340;//kernel.TQuery:2340
              res=v;
            case 6     :
              
              __pc=3;break;
            case 7     :
              
              _thread.exit(reso);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      mins :function _trc_TQuery_mins(key) {
        "use strict";
        var _this=this;
        var f;
        var res;
        var reso;
        var o;
        var _it_125;
        var v;
        
        //$LASTPOS=20002405;//kernel.TQuery:2405
        f = _this.genKeyfunc(key);
        
        //$LASTPOS=20002433;//kernel.TQuery:2433
        reso = _this.create();
        
        //$LASTPOS=20002461;//kernel.TQuery:2461
        _it_125=Tonyu.iterator(_this,1);
        while(_it_125.next()) {
          o=_it_125[0];
          
          //$LASTPOS=20002492;//kernel.TQuery:2492
          v = f(o);
          
          //$LASTPOS=20002513;//kernel.TQuery:2513
          if (res==null||v<=res) {
            //$LASTPOS=20002553;//kernel.TQuery:2553
            if (v<res) {
              //$LASTPOS=20002564;//kernel.TQuery:2564
              reso=_this.create();
            }
            //$LASTPOS=20002592;//kernel.TQuery:2592
            reso.push(o);
            //$LASTPOS=20002619;//kernel.TQuery:2619
            res=v;
            
          }
          
        }
        return reso;
      },
      fiber$mins :function _trc_TQuery_f_mins(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var f;
        var res;
        var reso;
        var o;
        var _it_125;
        var v;
        
        
        _thread.enter(function _trc_TQuery_ent_mins(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20002405;//kernel.TQuery:2405
              _this.fiber$genKeyfunc(_thread, key);
              __pc=1;return;
            case 1:
              f=_thread.retVal;
              
              //$LASTPOS=20002433;//kernel.TQuery:2433
              _this.fiber$create(_thread);
              __pc=2;return;
            case 2:
              reso=_thread.retVal;
              
              //$LASTPOS=20002461;//kernel.TQuery:2461
              _it_125=Tonyu.iterator(_this,1);
            case 3:
              if (!(_it_125.next())) { __pc=7     ; break; }
              o=_it_125[0];
              
              //$LASTPOS=20002492;//kernel.TQuery:2492
              v = f(o);
              
              //$LASTPOS=20002513;//kernel.TQuery:2513
              if (!(res==null||v<=res)) { __pc=6     ; break; }
              //$LASTPOS=20002553;//kernel.TQuery:2553
              if (!(v<res)) { __pc=5     ; break; }
              //$LASTPOS=20002564;//kernel.TQuery:2564
              _this.fiber$create(_thread);
              __pc=4;return;
            case 4:
              reso=_thread.retVal;
              
            case 5     :
              
              //$LASTPOS=20002592;//kernel.TQuery:2592
              reso.push(o);
              //$LASTPOS=20002619;//kernel.TQuery:2619
              res=v;
            case 6     :
              
              __pc=3;break;
            case 7     :
              
              _thread.exit(reso);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      minObj :function _trc_TQuery_minObj(key) {
        "use strict";
        var _this=this;
        
        return _this.mins(key)[0];
      },
      fiber$minObj :function _trc_TQuery_f_minObj(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.mins(key)[0];return;
        
        
        _thread.retVal=_this;return;
      },
      maxObj :function _trc_TQuery_maxObj(key) {
        "use strict";
        var _this=this;
        
        return _this.maxs(key)[0];
      },
      fiber$maxObj :function _trc_TQuery_f_maxObj(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.maxs(key)[0];return;
        
        
        _thread.retVal=_this;return;
      },
      nearests :function _trc_TQuery_nearests(x,y) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=20002778;//kernel.TQuery:2778
        if (x==null) {
          //$LASTPOS=20002802;//kernel.TQuery:2802
          if (! _this.parent) {
            throw new Error("nearests: 座標を指定してください");
            
          }
          //$LASTPOS=20002866;//kernel.TQuery:2866
          x=_this.parent.x;
          //$LASTPOS=20002877;//kernel.TQuery:2877
          y=_this.parent.y;
          //$LASTPOS=20002898;//kernel.TQuery:2898
          if (_this.context.is3D) {
            //$LASTPOS=20002916;//kernel.TQuery:2916
            _this.z=_this.parent.z;
          }
          
        }
        //$LASTPOS=20002940;//kernel.TQuery:2940
        if (typeof  x=="object") {
          //$LASTPOS=20002965;//kernel.TQuery:2965
          y=x.y;
          //$LASTPOS=20002971;//kernel.TQuery:2971
          x=x.x;
          
        }
        //$LASTPOS=20002984;//kernel.TQuery:2984
        if (_this.context.is3D) {
          return _this.mins((function anonymous_3025(o) {
            
            return _this.context.actor.dist(o);
          }));
          
        }
        return _this.mins((function anonymous_3115(o) {
          
          return _this.dist(o.x-x,o.y-y);
        }));
      },
      fiber$nearests :function _trc_TQuery_f_nearests(_thread,x,y) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=20002778;//kernel.TQuery:2778
        if (x==null) {
          //$LASTPOS=20002802;//kernel.TQuery:2802
          if (! _this.parent) {
            throw new Error("nearests: 座標を指定してください");
            
          }
          //$LASTPOS=20002866;//kernel.TQuery:2866
          x=_this.parent.x;
          //$LASTPOS=20002877;//kernel.TQuery:2877
          y=_this.parent.y;
          //$LASTPOS=20002898;//kernel.TQuery:2898
          if (_this.context.is3D) {
            //$LASTPOS=20002916;//kernel.TQuery:2916
            _this.z=_this.parent.z;
          }
          
        }
        //$LASTPOS=20002940;//kernel.TQuery:2940
        if (typeof  x=="object") {
          //$LASTPOS=20002965;//kernel.TQuery:2965
          y=x.y;
          //$LASTPOS=20002971;//kernel.TQuery:2971
          x=x.x;
          
        }
        
        _thread.enter(function _trc_TQuery_ent_nearests(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20002984;//kernel.TQuery:2984
              if (!(_this.context.is3D)) { __pc=2     ; break; }
              _this.fiber$mins(_thread, (function anonymous_3025(o) {
                
                return _this.context.actor.dist(o);
              }));
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
            case 2     :
              
              _this.fiber$mins(_thread, (function anonymous_3115(o) {
                
                return _this.dist(o.x-x,o.y-y);
              }));
              __pc=3;return;
            case 3:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      nearest :function _trc_TQuery_nearest(x,y) {
        "use strict";
        var _this=this;
        
        return _this.nearests(x,y)[0];
      },
      fiber$nearest :function _trc_TQuery_f_nearest(_thread,x,y) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.nearests(x,y)[0];return;
        
        
        _thread.retVal=_this;return;
      },
      withins :function _trc_TQuery_withins(xo,yd,d) {
        "use strict";
        var _this=this;
        var x;
        var y;
        var z;
        
        
        //$LASTPOS=20003260;//kernel.TQuery:3260
        if (arguments.length==1) {
          //$LASTPOS=20003296;//kernel.TQuery:3296
          if (! _this.parent) {
            throw new Error("withins: 座標を指定してください");
            
          }
          //$LASTPOS=20003359;//kernel.TQuery:3359
          x=_this.parent.x;
          //$LASTPOS=20003380;//kernel.TQuery:3380
          y=_this.parent.y;
          //$LASTPOS=20003401;//kernel.TQuery:3401
          if (_this.context.is3D) {
            //$LASTPOS=20003419;//kernel.TQuery:3419
            z=_this.parent.z;
          }
          //$LASTPOS=20003440;//kernel.TQuery:3440
          d=xo;
          
        } else {
          //$LASTPOS=20003458;//kernel.TQuery:3458
          if (typeof  xo=="object") {
            //$LASTPOS=20003494;//kernel.TQuery:3494
            x=xo.x;
            //$LASTPOS=20003501;//kernel.TQuery:3501
            y=xo.y;
            //$LASTPOS=20003508;//kernel.TQuery:3508
            d=yd;
            
          } else {
            //$LASTPOS=20003537;//kernel.TQuery:3537
            x=xo;
            //$LASTPOS=20003542;//kernel.TQuery:3542
            y=yd;
            
          }
        }
        //$LASTPOS=20003560;//kernel.TQuery:3560
        if (_this.context.is3D) {
          return _this.find((function anonymous_3601(o) {
            
            return _this.context.actor.dist(o)<=d;
          }));
          
        }
        return _this.find((function anonymous_3694(o) {
          
          return _this.dist(o.x-x,o.y-y)<=d;
        }));
      },
      fiber$withins :function _trc_TQuery_f_withins(_thread,xo,yd,d) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var x;
        var y;
        var z;
        
        
        //$LASTPOS=20003260;//kernel.TQuery:3260
        if (_arguments.length==1) {
          //$LASTPOS=20003296;//kernel.TQuery:3296
          if (! _this.parent) {
            throw new Error("withins: 座標を指定してください");
            
          }
          //$LASTPOS=20003359;//kernel.TQuery:3359
          x=_this.parent.x;
          //$LASTPOS=20003380;//kernel.TQuery:3380
          y=_this.parent.y;
          //$LASTPOS=20003401;//kernel.TQuery:3401
          if (_this.context.is3D) {
            //$LASTPOS=20003419;//kernel.TQuery:3419
            z=_this.parent.z;
          }
          //$LASTPOS=20003440;//kernel.TQuery:3440
          d=xo;
          
        } else {
          //$LASTPOS=20003458;//kernel.TQuery:3458
          if (typeof  xo=="object") {
            //$LASTPOS=20003494;//kernel.TQuery:3494
            x=xo.x;
            //$LASTPOS=20003501;//kernel.TQuery:3501
            y=xo.y;
            //$LASTPOS=20003508;//kernel.TQuery:3508
            d=yd;
            
          } else {
            //$LASTPOS=20003537;//kernel.TQuery:3537
            x=xo;
            //$LASTPOS=20003542;//kernel.TQuery:3542
            y=yd;
            
          }
        }
        
        _thread.enter(function _trc_TQuery_ent_withins(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20003560;//kernel.TQuery:3560
              if (!(_this.context.is3D)) { __pc=2     ; break; }
              _this.fiber$find(_thread, (function anonymous_3601(o) {
                
                return _this.context.actor.dist(o)<=d;
              }));
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
            case 2     :
              
              _this.fiber$find(_thread, (function anonymous_3694(o) {
                
                return _this.dist(o.x-x,o.y-y)<=d;
              }));
              __pc=3;return;
            case 3:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      within :function _trc_TQuery_within(xo,yd,d) {
        "use strict";
        var _this=this;
        
        return _this.withins(xo,yd,d).nearest();
      },
      fiber$within :function _trc_TQuery_f_within(_thread,xo,yd,d) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.withins(xo,yd,d).nearest();return;
        
        
        _thread.retVal=_this;return;
      },
      max :function _trc_TQuery_max(key) {
        "use strict";
        var _this=this;
        var f;
        var res;
        var o;
        var _it_139;
        var v;
        
        //$LASTPOS=20003837;//kernel.TQuery:3837
        f = _this.genKeyfunc(key);
        
        
        //$LASTPOS=20003879;//kernel.TQuery:3879
        _it_139=Tonyu.iterator(_this,1);
        while(_it_139.next()) {
          o=_it_139[0];
          
          //$LASTPOS=20003910;//kernel.TQuery:3910
          v = f(o);
          
          //$LASTPOS=20003931;//kernel.TQuery:3931
          if (res==null||v>res) {
            //$LASTPOS=20003955;//kernel.TQuery:3955
            res=v;
          }
          
        }
        return res;
      },
      min :function _trc_TQuery_min(key) {
        "use strict";
        var _this=this;
        var f;
        var res;
        var o;
        var _it_145;
        var v;
        
        //$LASTPOS=20004007;//kernel.TQuery:4007
        f = _this.genKeyfunc(key);
        
        
        //$LASTPOS=20004049;//kernel.TQuery:4049
        _it_145=Tonyu.iterator(_this,1);
        while(_it_145.next()) {
          o=_it_145[0];
          
          //$LASTPOS=20004080;//kernel.TQuery:4080
          v = f(o);
          
          //$LASTPOS=20004101;//kernel.TQuery:4101
          if (res==null||v<res) {
            //$LASTPOS=20004125;//kernel.TQuery:4125
            res=v;
          }
          
        }
        return res;
      },
      push :function _trc_TQuery_push(e) {
        "use strict";
        var _this=this;
        var ee;
        var _it_151;
        
        //$LASTPOS=20004176;//kernel.TQuery:4176
        if (Tonyu.is(e,Tonyu.classes.kernel.TQuery)||Tonyu.is(e,Array)) {
          //$LASTPOS=20004218;//kernel.TQuery:4218
          _it_151=Tonyu.iterator(e,1);
          while(_it_151.next()) {
            ee=_it_151[0];
            
            //$LASTPOS=20004236;//kernel.TQuery:4236
            _this.push(ee);
          }
          
        } else {
          //$LASTPOS=20004269;//kernel.TQuery:4269
          _this[_this.length]=e;
          //$LASTPOS=20004294;//kernel.TQuery:4294
          _this.length++;
          
        }
      },
      fiber$push :function _trc_TQuery_f_push(_thread,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ee;
        var _it_151;
        
        
        _thread.enter(function _trc_TQuery_ent_push(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20004176;//kernel.TQuery:4176
              if (!(Tonyu.is(e,Tonyu.classes.kernel.TQuery)||Tonyu.is(e,Array))) { __pc=4     ; break; }
              //$LASTPOS=20004218;//kernel.TQuery:4218
              _it_151=Tonyu.iterator(e,1);
            case 1:
              if (!(_it_151.next())) { __pc=3     ; break; }
              ee=_it_151[0];
              
              //$LASTPOS=20004236;//kernel.TQuery:4236
              _this.fiber$push(_thread, ee);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              __pc=5     ;break;
            case 4     :
              {
                //$LASTPOS=20004269;//kernel.TQuery:4269
                _this[_this.length]=e;
                //$LASTPOS=20004294;//kernel.TQuery:4294
                _this.length++;
              }
            case 5     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      size :function _trc_TQuery_size() {
        "use strict";
        var _this=this;
        
        return _this.length;
      },
      fiber$size :function _trc_TQuery_f_size(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.length;return;
        
        
        _thread.retVal=_this;return;
      },
      find :function _trc_TQuery_find(f) {
        "use strict";
        var _this=this;
        var no;
        var q;
        var o;
        var _it_154;
        
        //$LASTPOS=20004357;//kernel.TQuery:4357
        no = _this.create();
        
        //$LASTPOS=20004379;//kernel.TQuery:4379
        if (typeof  f==="object") {
          //$LASTPOS=20004415;//kernel.TQuery:4415
          q = f;
          
          //$LASTPOS=20004433;//kernel.TQuery:4433
          f=(function anonymous_4435(o) {
            var k;
            var v;
            var _it_160;
            
            //$LASTPOS=20004455;//kernel.TQuery:4455
            _it_160=Tonyu.iterator(q,2);
            while(_it_160.next()) {
              k=_it_160[0];
              v=_it_160[1];
              
              //$LASTPOS=20004493;//kernel.TQuery:4493
              if (o[k]!==v) {
                return false;
              }
              
            }
            return true;
          });
          
        }
        //$LASTPOS=20004586;//kernel.TQuery:4586
        _it_154=Tonyu.iterator(_this,1);
        while(_it_154.next()) {
          o=_it_154[0];
          
          //$LASTPOS=20004617;//kernel.TQuery:4617
          if (f(o)) {
            //$LASTPOS=20004627;//kernel.TQuery:4627
            no.push(o);
          }
          
        }
        return no;
      },
      fiber$find :function _trc_TQuery_f_find(_thread,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var no;
        var q;
        var o;
        var _it_154;
        
        
        _thread.enter(function _trc_TQuery_ent_find(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20004357;//kernel.TQuery:4357
              _this.fiber$create(_thread);
              __pc=1;return;
            case 1:
              no=_thread.retVal;
              
              //$LASTPOS=20004379;//kernel.TQuery:4379
              if (!(typeof  f==="object")) { __pc=2     ; break; }
              //$LASTPOS=20004415;//kernel.TQuery:4415
              q = f;
              
              //$LASTPOS=20004433;//kernel.TQuery:4433
              f=(function anonymous_4435(o) {
                var k;
                var v;
                var _it_160;
                
                //$LASTPOS=20004455;//kernel.TQuery:4455
                _it_160=Tonyu.iterator(q,2);
                while(_it_160.next()) {
                  k=_it_160[0];
                  v=_it_160[1];
                  
                  //$LASTPOS=20004493;//kernel.TQuery:4493
                  if (o[k]!==v) {
                    return false;
                  }
                  
                }
                return true;
              });
            case 2     :
              
              //$LASTPOS=20004586;//kernel.TQuery:4586
              _it_154=Tonyu.iterator(_this,1);
              while(_it_154.next()) {
                o=_it_154[0];
                
                //$LASTPOS=20004617;//kernel.TQuery:4617
                if (f(o)) {
                  //$LASTPOS=20004627;//kernel.TQuery:4627
                  no.push(o);
                }
                
              }
              _thread.exit(no);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      find1 :function _trc_TQuery_find1(f) {
        "use strict";
        var _this=this;
        
        return _this.find(f)[0];
      },
      fiber$find1 :function _trc_TQuery_f_find1(_thread,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.find(f)[0];return;
        
        
        _thread.retVal=_this;return;
      },
      random :function _trc_TQuery_random() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=20004723;//kernel.TQuery:4723
        if (_this.length===0) {
          return null;
        }
        return _this[_this.rnd(_this.length)];
      },
      fiber$random :function _trc_TQuery_f_random(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=20004723;//kernel.TQuery:4723
        if (_this.length===0) {
          _thread.retVal=null;return;
          
        }
        _thread.retVal=_this[_this.rnd(_this.length)];return;
        
        
        _thread.retVal=_this;return;
      },
      apply :function _trc_TQuery_apply(name,args) {
        "use strict";
        var _this=this;
        var res;
        var o;
        var _it_164;
        var f;
        
        
        //$LASTPOS=20004827;//kernel.TQuery:4827
        if (! args) {
          //$LASTPOS=20004838;//kernel.TQuery:4838
          args=[];
        }
        //$LASTPOS=20004852;//kernel.TQuery:4852
        _it_164=Tonyu.iterator(_this,1);
        while(_it_164.next()) {
          o=_it_164[0];
          
          //$LASTPOS=20004883;//kernel.TQuery:4883
          f = o[name];
          
          //$LASTPOS=20004907;//kernel.TQuery:4907
          if (typeof  f=="function") {
            //$LASTPOS=20004948;//kernel.TQuery:4948
            res=f.apply(o,args);
            
          }
          
        }
        return res;
      },
      fiber$apply :function _trc_TQuery_f_apply(_thread,name,args) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var o;
        var _it_164;
        var f;
        
        
        //$LASTPOS=20004827;//kernel.TQuery:4827
        if (! args) {
          //$LASTPOS=20004838;//kernel.TQuery:4838
          args=[];
        }
        //$LASTPOS=20004852;//kernel.TQuery:4852
        _it_164=Tonyu.iterator(_this,1);
        while(_it_164.next()) {
          o=_it_164[0];
          
          //$LASTPOS=20004883;//kernel.TQuery:4883
          f = o[name];
          
          //$LASTPOS=20004907;//kernel.TQuery:4907
          if (typeof  f=="function") {
            //$LASTPOS=20004948;//kernel.TQuery:4948
            res=f.apply(o,args);
            
          }
          
        }
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      alive :function _trc_TQuery_alive() {
        "use strict";
        var _this=this;
        
        return _this.find((function anonymous_5093(o) {
          
          return ! o.isDead();
        }));
      },
      fiber$alive :function _trc_TQuery_f_alive(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_TQuery_ent_alive(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$find(_thread, (function anonymous_5093(o) {
                
                return ! o.isDead();
              }));
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      die :function _trc_TQuery_die() {
        "use strict";
        var _this=this;
        var a;
        
        //$LASTPOS=20005155;//kernel.TQuery:5155
        a = _this.alive();
        
        //$LASTPOS=20005175;//kernel.TQuery:5175
        if (a.length==0) {
          return false;
        }
        //$LASTPOS=20005211;//kernel.TQuery:5211
        a.apply("die");
        return true;
      },
      fiber$die :function _trc_TQuery_f_die(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        
        
        _thread.enter(function _trc_TQuery_ent_die(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=20005155;//kernel.TQuery:5155
              _this.fiber$alive(_thread);
              __pc=1;return;
            case 1:
              a=_thread.retVal;
              
              //$LASTPOS=20005175;//kernel.TQuery:5175
              if (!(a.length==0)) { __pc=2     ; break; }
              _thread.exit(false);return;
            case 2     :
              
              //$LASTPOS=20005211;//kernel.TQuery:5211
              a.apply("die");
              _thread.exit(true);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      klass :function _trc_TQuery_klass(k) {
        "use strict";
        var _this=this;
        
        return _this.find((function anonymous_5280(o) {
          
          return o instanceof k;
        }));
      },
      fiber$klass :function _trc_TQuery_f_klass(_thread,k) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_TQuery_ent_klass(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$find(_thread, (function anonymous_5280(o) {
                
                return o instanceof k;
              }));
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"__getter__parent":{"nowait":true},"create":{"nowait":false},"contains":{"nowait":false},"tonyuIterator":{"nowait":false},"attr":{"nowait":false},"genKeyfunc":{"nowait":false},"applyArrayMethod":{"nowait":false},"toArray":{"nowait":false},"sort":{"nowait":false},"slice":{"nowait":false},"maxs":{"nowait":false},"mins":{"nowait":false},"minObj":{"nowait":false},"maxObj":{"nowait":false},"nearests":{"nowait":false},"nearest":{"nowait":false},"withins":{"nowait":false},"within":{"nowait":false},"max":{"nowait":true},"min":{"nowait":true},"push":{"nowait":false},"size":{"nowait":false},"find":{"nowait":false},"find1":{"nowait":false},"random":{"nowait":false},"apply":{"nowait":false},"alive":{"nowait":false},"die":{"nowait":false},"klass":{"nowait":false}},"fields":{"length":{},"context":{},"z":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.EventHandler',
  shortName: 'EventHandler',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.EventHandlerCaller],
  methods: function (__superClass) {
    return {
      main :function _trc_EventHandler_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=21000063;//kernel.EventHandler:63
        "field strict";
        
      },
      fiber$main :function _trc_EventHandler_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=21000063;//kernel.EventHandler:63
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_EventHandler_initialize(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=21000164;//kernel.EventHandler:164
        __superClass.apply( _this, [param]);
        //$LASTPOS=21000183;//kernel.EventHandler:183
        if (Tonyu.runMode) {
          //$LASTPOS=21000202;//kernel.EventHandler:202
          _this.listeners=[];
        }
      },
      toListener :function _trc_EventHandler_toListener(f) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=21000251;//kernel.EventHandler:251
        if (_this.target&&(typeof  f)=="string") {
          //$LASTPOS=21000298;//kernel.EventHandler:298
          f=_this.target[f];
          
        }
        //$LASTPOS=21000323;//kernel.EventHandler:323
        if (typeof  f!="function") {
          throw new Error("Not a event listener: "+_this.target+" / "+f);
          
        }
        return f;
      },
      newListener :function _trc_EventHandler_newListener(f) {
        "use strict";
        var _this=this;
        var listener;
        
        //$LASTPOS=21000456;//kernel.EventHandler:456
        listener = {action: f};
        
        return listener;
      },
      addListener :function _trc_EventHandler_addListener() {
        "use strict";
        var _this=this;
        var a;
        var f;
        var listener;
        
        //$LASTPOS=21000553;//kernel.EventHandler:553
        a = new Tonyu.classes.kernel.ArgParser(arguments).toArray();
        
        //$LASTPOS=21000600;//kernel.EventHandler:600
        f = a.pop();
        
        //$LASTPOS=21000620;//kernel.EventHandler:620
        f=_this.toListener(f);
        //$LASTPOS=21000642;//kernel.EventHandler:642
        a.push(f);
        //$LASTPOS=21000658;//kernel.EventHandler:658
        listener = Tonyu.bindFunc(_this,_this.newListener).apply(_this,a);
        
        //$LASTPOS=21000703;//kernel.EventHandler:703
        listener.remove=(function anonymous_719() {
          
          //$LASTPOS=21000730;//kernel.EventHandler:730
          _this.removeListener(listener);
        });
        //$LASTPOS=21000769;//kernel.EventHandler:769
        listener.dispose=listener.dispose||(function anonymous_804() {
          
        });
        //$LASTPOS=21000814;//kernel.EventHandler:814
        listener.action=listener.action||f;
        //$LASTPOS=21000855;//kernel.EventHandler:855
        _this.listeners.push(listener);
        return listener;
      },
      doDispose :function _trc_EventHandler_doDispose(listener) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=21000942;//kernel.EventHandler:942
        if (typeof  listener.dispose==="function") {
          //$LASTPOS=21000995;//kernel.EventHandler:995
          listener.dispose({last: _this.listeners.length==0,listener: listener});
          
        }
      },
      removeListener :function _trc_EventHandler_removeListener(listener) {
        "use strict";
        var _this=this;
        var i;
        
        //$LASTPOS=21001099;//kernel.EventHandler:1099
        i = _this.listeners.indexOf(listener);
        
        //$LASTPOS=21001139;//kernel.EventHandler:1139
        if (i>=0) {
          //$LASTPOS=21001160;//kernel.EventHandler:1160
          _this.listeners.splice(i,1);
          //$LASTPOS=21001192;//kernel.EventHandler:1192
          _this.doDispose(listener);
          
        }
      },
      removeAllListeners :function _trc_EventHandler_removeAllListeners() {
        "use strict";
        var _this=this;
        var listener;
        
        
        //$LASTPOS=21001279;//kernel.EventHandler:1279
        while (listener=_this.listeners.shift()) {
          //$LASTPOS=21001324;//kernel.EventHandler:1324
          _this.doDispose(listener);
          
        }
      },
      fire :function _trc_EventHandler_fire(args) {
        "use strict";
        var _this=this;
        var listener;
        var _it_178;
        
        //$LASTPOS=21001375;//kernel.EventHandler:1375
        if (_this.released) {
          return _this;
        }
        //$LASTPOS=21001402;//kernel.EventHandler:1402
        _it_178=Tonyu.iterator(_this.listeners,1);
        while(_it_178.next()) {
          listener=_it_178[0];
          
          //$LASTPOS=21001445;//kernel.EventHandler:1445
          _this.callEventHandler(listener.action,args);
          
        }
      },
      fiber$fire :function _trc_EventHandler_f_fire(_thread,args) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var listener;
        var _it_178;
        
        //$LASTPOS=21001375;//kernel.EventHandler:1375
        if (_this.released) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_EventHandler_ent_fire(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=21001402;//kernel.EventHandler:1402
              _it_178=Tonyu.iterator(_this.listeners,1);
            case 1:
              if (!(_it_178.next())) { __pc=3     ; break; }
              listener=_it_178[0];
              
              //$LASTPOS=21001445;//kernel.EventHandler:1445
              _this.fiber$callEventHandler(_thread, listener.action, args);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      release :function _trc_EventHandler_release() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=21001522;//kernel.EventHandler:1522
        _this.released=true;
        //$LASTPOS=21001542;//kernel.EventHandler:1542
        _this.removeAllListeners();
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"toListener":{"nowait":true},"newListener":{"nowait":true},"addListener":{"nowait":true},"doDispose":{"nowait":true},"removeListener":{"nowait":true},"removeAllListeners":{"nowait":true},"fire":{"nowait":false},"release":{"nowait":true}},"fields":{"listeners":{},"target":{},"released":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ScreenOutHandler',
  shortName: 'ScreenOutHandler',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.EventHandler,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ScreenOutHandler_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ScreenOutHandler_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      addListener :function _trc_ScreenOutHandler_addListener(d,f) {
        "use strict";
        var _this=this;
        var retThread;
        
        //$LASTPOS=22000049;//kernel.ScreenOutHandler:49
        retThread = _this.target.parallel("screenOutChecker",d,_this.toListener(f));
        
        return {remove: (function anonymous_147() {
          
          //$LASTPOS=22000163;//kernel.ScreenOutHandler:163
          retThread.kill();
        })};
      },
      initialize :function _trc_ScreenOutHandler_initialize(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=22000222;//kernel.ScreenOutHandler:222
        __superClass.apply( _this, [param]);
        //$LASTPOS=22000240;//kernel.ScreenOutHandler:240
        _this.id=(Tonyu.globals.$idseq=(Tonyu.globals.$idseq||0)+1);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"addListener":{"nowait":true},"new":{"nowait":false}},"fields":{"id":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.WithinHandler',
  shortName: 'WithinHandler',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.EventHandler,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_WithinHandler_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_WithinHandler_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      addListener :function _trc_WithinHandler_addListener(d,r,f) {
        "use strict";
        var _this=this;
        var retThread;
        
        //$LASTPOS=23000052;//kernel.WithinHandler:52
        retThread = _this.target.parallel("withinChecker",d,r,_this.toListener(f));
        
        return {remove: (function anonymous_149() {
          
          //$LASTPOS=23000165;//kernel.WithinHandler:165
          retThread.kill();
        })};
      },
      initialize :function _trc_WithinHandler_initialize(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=23000225;//kernel.WithinHandler:225
        __superClass.apply( _this, [param]);
        //$LASTPOS=23000244;//kernel.WithinHandler:244
        _this.id=(Tonyu.globals.$idseq=(Tonyu.globals.$idseq||0)+1);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"addListener":{"nowait":true},"new":{"nowait":false}},"fields":{"id":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.CubeShape',
  shortName: 'CubeShape',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_CubeShape_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=24000018;//kernel.CubeShape:18
        "field strict";
        
      },
      fiber$main :function _trc_CubeShape_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=24000018;//kernel.CubeShape:18
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      intersects :function _trc_CubeShape_intersects(s) {
        "use strict";
        var _this=this;
        
        return s&&Math.abs(_this.x-s.x)*2<_this.width+s.width&&Math.abs(_this.y-s.y)*2<_this.height+s.height&&Math.abs(_this.z-s.z)*2<_this.depth+s.depth;
      },
      fiber$intersects :function _trc_CubeShape_f_intersects(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=s&&Math.abs(_this.x-s.x)*2<_this.width+s.width&&Math.abs(_this.y-s.y)*2<_this.height+s.height&&Math.abs(_this.z-s.z)*2<_this.depth+s.depth;return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"intersects":{"nowait":false}},"fields":{"x":{},"y":{},"z":{},"width":{},"height":{},"depth":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Direction',
  shortName: 'Direction',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Direction_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=25000037;//kernel.Direction:37
        "field strict";
        
        
      },
      fiber$main :function _trc_Direction_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=25000037;//kernel.Direction:37
        "field strict";
        
        
        
        _thread.retVal=_this;return;
      },
      initAxis :function _trc_Direction_initAxis() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=25000139;//kernel.Direction:139
        if (! Tonyu.classes.kernel.Direction.axis) {
          //$LASTPOS=25000185;//kernel.Direction:185
          Tonyu.classes.kernel.Direction.axis={roll: new Tonyu.classes.kernel.Vec3(0,0,1),pitch: new Tonyu.classes.kernel.Vec3(1,0,0),yaw: new Tonyu.classes.kernel.Vec3(0,1,0)};
          
        }
      },
      fiber$initAxis :function _trc_Direction_f_initAxis(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=25000139;//kernel.Direction:139
        if (! Tonyu.classes.kernel.Direction.axis) {
          //$LASTPOS=25000185;//kernel.Direction:185
          Tonyu.classes.kernel.Direction.axis={roll: new Tonyu.classes.kernel.Vec3(0,0,1),pitch: new Tonyu.classes.kernel.Vec3(1,0,0),yaw: new Tonyu.classes.kernel.Vec3(0,1,0)};
          
        }
        
        _thread.retVal=_this;return;
      },
      clone :function _trc_Direction_clone() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.Direction().set(_this);
      },
      fiber$clone :function _trc_Direction_f_clone(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=new Tonyu.classes.kernel.Direction().set(_this);return;
        
        
        _thread.retVal=_this;return;
      },
      set :function _trc_Direction_set(d) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=25000409;//kernel.Direction:409
        _this.quaternion.set(d.quaternion);
        return _this;
      },
      fiber$set :function _trc_Direction_f_set(_thread,d) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=25000409;//kernel.Direction:409
        _this.quaternion.set(d.quaternion);
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Direction_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=25000476;//kernel.Direction:476
        _this.initAxis();
        //$LASTPOS=25000493;//kernel.Direction:493
        __superClass.apply( _this, [p]);
        //$LASTPOS=25000508;//kernel.Direction:508
        _this.quaternion=new Tonyu.classes.kernel.Quaternion;
        //$LASTPOS=25000540;//kernel.Direction:540
        _this.forward=new Tonyu.classes.kernel.ComputedVec3((function anonymous_565(t) {
          var r;
          
          //$LASTPOS=25000581;//kernel.Direction:581
          r = _this.quaternion.rotate(Tonyu.classes.kernel.Direction.axis.roll);
          
          return t.keep(r);
        }));
        //$LASTPOS=25000667;//kernel.Direction:667
        _this.down=new Tonyu.classes.kernel.ComputedVec3((function anonymous_689(t) {
          var r;
          
          //$LASTPOS=25000705;//kernel.Direction:705
          r = _this.quaternion.rotate(Tonyu.classes.kernel.Direction.axis.yaw);
          
          return t.keep(r);
        }));
        //$LASTPOS=25000790;//kernel.Direction:790
        _this.right=new Tonyu.classes.kernel.ComputedVec3((function anonymous_813(t) {
          var r;
          
          //$LASTPOS=25000829;//kernel.Direction:829
          r = _this.quaternion.rotate(Tonyu.classes.kernel.Direction.axis.pitch);
          
          return t.keep(r);
        }));
        //$LASTPOS=25000916;//kernel.Direction:916
        _this.back=new Tonyu.classes.kernel.ComputedVec3((function anonymous_938(t) {
          
          return _this.forward.mul(- 1);
        }));
        //$LASTPOS=25000991;//kernel.Direction:991
        _this.up=new Tonyu.classes.kernel.ComputedVec3((function anonymous_1011(t) {
          
          return _this.down.mul(- 1);
        }));
        //$LASTPOS=25001061;//kernel.Direction:1061
        _this.left=new Tonyu.classes.kernel.ComputedVec3((function anonymous_1083(t) {
          
          return _this.right.mul(- 1);
        }));
      },
      rotate :function _trc_Direction_rotate(mode,angle,unit) {
        "use strict";
        var _this=this;
        var x;
        var y;
        var nx;
        var ny;
        var axis;
        
        
        //$LASTPOS=25001264;//kernel.Direction:1264
        if (Tonyu.is(mode,Tonyu.classes.kernel.Vec3)) {
          //$LASTPOS=25001282;//kernel.Direction:1282
          axis=mode;
        } else {
          //$LASTPOS=25001303;//kernel.Direction:1303
          axis=Tonyu.classes.kernel.Direction.axis[mode];
        }
        //$LASTPOS=25001335;//kernel.Direction:1335
        if (! axis) {
          //$LASTPOS=25001357;//kernel.Direction:1357
          _this.quaternion.set(new Tonyu.classes.kernel.Quaternion);
          
        } else {
          //$LASTPOS=25001412;//kernel.Direction:1412
          _this.quaternion.product(new Tonyu.classes.kernel.Quaternion({axis: axis,r: angle}),_this.quaternion);
          
        }
        //$LASTPOS=25001485;//kernel.Direction:1485
        _this.forward.requestCompute();
        //$LASTPOS=25001516;//kernel.Direction:1516
        _this.down.requestCompute();
        //$LASTPOS=25001544;//kernel.Direction:1544
        _this.right.requestCompute();
        return _this;
      },
      fiber$rotate :function _trc_Direction_f_rotate(_thread,mode,angle,unit) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var x;
        var y;
        var nx;
        var ny;
        var axis;
        
        
        //$LASTPOS=25001264;//kernel.Direction:1264
        if (Tonyu.is(mode,Tonyu.classes.kernel.Vec3)) {
          //$LASTPOS=25001282;//kernel.Direction:1282
          axis=mode;
        } else {
          //$LASTPOS=25001303;//kernel.Direction:1303
          axis=Tonyu.classes.kernel.Direction.axis[mode];
        }
        //$LASTPOS=25001335;//kernel.Direction:1335
        if (! axis) {
          //$LASTPOS=25001357;//kernel.Direction:1357
          _this.quaternion.set(new Tonyu.classes.kernel.Quaternion);
          
        } else {
          //$LASTPOS=25001412;//kernel.Direction:1412
          _this.quaternion.product(new Tonyu.classes.kernel.Quaternion({axis: axis,r: angle}),_this.quaternion);
          
        }
        //$LASTPOS=25001485;//kernel.Direction:1485
        _this.forward.requestCompute();
        //$LASTPOS=25001516;//kernel.Direction:1516
        _this.down.requestCompute();
        //$LASTPOS=25001544;//kernel.Direction:1544
        _this.right.requestCompute();
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      localToWorld :function _trc_Direction_localToWorld(local,dst) {
        "use strict";
        var _this=this;
        
        return _this.quaternion.rotate(local,dst);
      },
      fiber$localToWorld :function _trc_Direction_f_localToWorld(_thread,local,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.quaternion.rotate(local,dst);return;
        
        
        _thread.retVal=_this;return;
      },
      worldToLocal :function _trc_Direction_worldToLocal(world,dst) {
        "use strict";
        var _this=this;
        
        return _this.quaternion.inverse.rotate(world,dst);
      },
      fiber$worldToLocal :function _trc_Direction_f_worldToLocal(_thread,world,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.quaternion.inverse.rotate(world,dst);return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initAxis":{"nowait":false},"clone":{"nowait":false},"set":{"nowait":false},"new":{"nowait":false},"rotate":{"nowait":false},"localToWorld":{"nowait":false},"worldToLocal":{"nowait":false}},"fields":{"forward":{},"down":{},"right":{},"back":{},"up":{},"left":{},"quaternion":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ParentChanger',
  shortName: 'ParentChanger',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ParentChanger_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=26000018;//kernel.ParentChanger:18
        "field strict";
        
        
      },
      fiber$main :function _trc_ParentChanger_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=26000018;//kernel.ParentChanger:18
        "field strict";
        
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_ParentChanger_initialize(dstParent) {
        "use strict";
        var _this=this;
        var cnode;
        var t;
        
        
        //$LASTPOS=26000197;//kernel.ParentChanger:197
        _this.nodes={};
        //$LASTPOS=26000212;//kernel.ParentChanger:212
        dstParent=dstParent||Tonyu.classes.kernel.Transform.root;
        //$LASTPOS=26000256;//kernel.ParentChanger:256
        _this.dstParent=dstParent;
        //$LASTPOS=26000287;//kernel.ParentChanger:287
        _this.nodes[dstParent.id]=cnode=_this.cn({transform: dstParent,isDst: true});
        //$LASTPOS=26000356;//kernel.ParentChanger:356
        //$LASTPOS=26000361;//kernel.ParentChanger:361
        t = dstParent.parent;
        for (; t ; t=t.parent) {
          {
            //$LASTPOS=26000412;//kernel.ParentChanger:412
            cnode=_this.cn({transform: t,next: cnode,relation: "child"});
            //$LASTPOS=26000475;//kernel.ParentChanger:475
            _this.nodes[t.id]=cnode;
          }
        }
      },
      cn :function _trc_ParentChanger_cn(n) {
        "use strict";
        var _this=this;
        
        switch (n.relation) {
        case "parent":
          //$LASTPOS=26000697;//kernel.ParentChanger:697
          _this.chk(n.next.transform.isParentOf(n.transform),"cn::parent not match");
          break;
          
        case "child":
          //$LASTPOS=26000815;//kernel.ParentChanger:815
          _this.chk(n.next.transform.isChildOf(n.transform),"cn::child not match");
          break;
          
        case "sibling":
          //$LASTPOS=26000933;//kernel.ParentChanger:933
          _this.chk(n.next.transform.isSibling(n.transform),"cn::sibling not match");
          break;
          
        default:
          //$LASTPOS=26001046;//kernel.ParentChanger:1046
          _this.chk(n.isDst,"cn::relation not set");
        }
        return n;
      },
      fiber$cn :function _trc_ParentChanger_f_cn(_thread,n) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_ParentChanger_ent_cn(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              switch (n.relation) {
              case "parent":
                __pc=1     ;break;
              case "child":
                __pc=3     ;break;
              case "sibling":
                __pc=5     ;break;
              default:
                __pc=7     ;break;
                
              }
              break;
            case 1     :
              //$LASTPOS=26000697;//kernel.ParentChanger:697
              _this.fiber$chk(_thread, n.next.transform.isParentOf(n.transform), "cn::parent not match");
              __pc=2;return;
            case 2:
              
              __pc=9     ; break;
              
            case 3     :
              //$LASTPOS=26000815;//kernel.ParentChanger:815
              _this.fiber$chk(_thread, n.next.transform.isChildOf(n.transform), "cn::child not match");
              __pc=4;return;
            case 4:
              
              __pc=9     ; break;
              
            case 5     :
              //$LASTPOS=26000933;//kernel.ParentChanger:933
              _this.fiber$chk(_thread, n.next.transform.isSibling(n.transform), "cn::sibling not match");
              __pc=6;return;
            case 6:
              
              __pc=9     ; break;
              
            case 7     :
              //$LASTPOS=26001046;//kernel.ParentChanger:1046
              _this.fiber$chk(_thread, n.isDst, "cn::relation not set");
              __pc=8;return;
            case 8:
              
              case 9     :
              
              _thread.exit(n);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      chk :function _trc_ParentChanger_chk(b,mesg) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=26001129;//kernel.ParentChanger:1129
        if (! b) {
          throw new Error("ParentChanger::"+mesg);
          
        }
      },
      fiber$chk :function _trc_ParentChanger_f_chk(_thread,b,mesg) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=26001129;//kernel.ParentChanger:1129
        if (! b) {
          throw new Error("ParentChanger::"+mesg);
          
        }
        
        _thread.retVal=_this;return;
      },
      getNode :function _trc_ParentChanger_getNode(tt) {
        "use strict";
        var _this=this;
        var cnode;
        var prev;
        var path;
        var t;
        
        //$LASTPOS=26001212;//kernel.ParentChanger:1212
        if (_this.nodes[tt.id]) {
          return _this.nodes[tt.id];
        }
        
        //$LASTPOS=26001277;//kernel.ParentChanger:1277
        path = [];
        
        //$LASTPOS=26001399;//kernel.ParentChanger:1399
        t = tt;
        
        //$LASTPOS=26001414;//kernel.ParentChanger:1414
        while (true) {
          //$LASTPOS=26001438;//kernel.ParentChanger:1438
          _this.chk(t,"t reached to root(null)");
          //$LASTPOS=26001481;//kernel.ParentChanger:1481
          cnode=_this.nodes[t.id];
          //$LASTPOS=26001509;//kernel.ParentChanger:1509
          if (cnode) {
            break;
            
            
          }
          //$LASTPOS=26001562;//kernel.ParentChanger:1562
          path.unshift(t);
          //$LASTPOS=26001588;//kernel.ParentChanger:1588
          t=t.parent;
          
        }
        //$LASTPOS=26001612;//kernel.ParentChanger:1612
        if (cnode.relation==="child") {
          //$LASTPOS=26001653;//kernel.ParentChanger:1653
          t=path.shift();
          //$LASTPOS=26001678;//kernel.ParentChanger:1678
          cnode=_this.nodes[t.id]=_this.cn({next: cnode.next,relation: "sibling",transform: t});
          
        }
        //$LASTPOS=26001786;//kernel.ParentChanger:1786
        while (t=path.shift()) {
          //$LASTPOS=26001851;//kernel.ParentChanger:1851
          _this.chk(t.parent===cnode.transform,"getNode cnode parent not match");
          //$LASTPOS=26001927;//kernel.ParentChanger:1927
          cnode=_this.nodes[t.id]=_this.cn({next: cnode,relation: "parent",transform: t});
          
        }
        //$LASTPOS=26002029;//kernel.ParentChanger:2029
        _this.chk(cnode.transform===tt,"getNode cnode not match");
        return cnode;
      },
      fiber$getNode :function _trc_ParentChanger_f_getNode(_thread,tt) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var cnode;
        var prev;
        var path;
        var t;
        
        //$LASTPOS=26001212;//kernel.ParentChanger:1212
        if (_this.nodes[tt.id]) {
          _thread.retVal=_this.nodes[tt.id];return;
          
        }
        
        //$LASTPOS=26001277;//kernel.ParentChanger:1277
        path = [];
        
        //$LASTPOS=26001399;//kernel.ParentChanger:1399
        t = tt;
        
        
        _thread.enter(function _trc_ParentChanger_ent_getNode(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=26001414;//kernel.ParentChanger:1414
            case 1:
              //$LASTPOS=26001438;//kernel.ParentChanger:1438
              _this.fiber$chk(_thread, t, "t reached to root(null)");
              __pc=2;return;
            case 2:
              
              //$LASTPOS=26001481;//kernel.ParentChanger:1481
              cnode=_this.nodes[t.id];
              //$LASTPOS=26001509;//kernel.ParentChanger:1509
              if (!(cnode)) { __pc=3     ; break; }
              __pc=4     ; break;
              
            case 3     :
              
              //$LASTPOS=26001562;//kernel.ParentChanger:1562
              path.unshift(t);
              //$LASTPOS=26001588;//kernel.ParentChanger:1588
              t=t.parent;
              __pc=1;break;
            case 4     :
              
              //$LASTPOS=26001612;//kernel.ParentChanger:1612
              if (cnode.relation==="child") {
                //$LASTPOS=26001653;//kernel.ParentChanger:1653
                t=path.shift();
                //$LASTPOS=26001678;//kernel.ParentChanger:1678
                cnode=_this.nodes[t.id]=_this.cn({next: cnode.next,relation: "sibling",transform: t});
                
              }
              //$LASTPOS=26001786;//kernel.ParentChanger:1786
            case 5:
              if (!(t=path.shift())) { __pc=7     ; break; }
              //$LASTPOS=26001851;//kernel.ParentChanger:1851
              _this.fiber$chk(_thread, t.parent===cnode.transform, "getNode cnode parent not match");
              __pc=6;return;
            case 6:
              
              //$LASTPOS=26001927;//kernel.ParentChanger:1927
              cnode=_this.nodes[t.id]=_this.cn({next: cnode,relation: "parent",transform: t});
              __pc=5;break;
            case 7     :
              
              //$LASTPOS=26002029;//kernel.ParentChanger:2029
              _this.fiber$chk(_thread, cnode.transform===tt, "getNode cnode not match");
              __pc=8;return;
            case 8:
              
              _thread.exit(cnode);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      change :function _trc_ParentChanger_change(t,res) {
        "use strict";
        var _this=this;
        var n;
        var dstNode;
        
        //$LASTPOS=26002147;//kernel.ParentChanger:2147
        res=res||new Tonyu.classes.kernel.Transform;
        //$LASTPOS=26002176;//kernel.ParentChanger:2176
        res.set(t);
        //$LASTPOS=26002193;//kernel.ParentChanger:2193
        if (res.parent===_this.dstParent) {
          return res;
        }
        //$LASTPOS=26002238;//kernel.ParentChanger:2238
        n = _this.getNode(res.parent);
        
        //$LASTPOS=26002270;//kernel.ParentChanger:2270
        dstNode = _this.getNode(_this.dstParent);
        
        //$LASTPOS=26002307;//kernel.ParentChanger:2307
        while (n!==dstNode) {
          //$LASTPOS=26002337;//kernel.ParentChanger:2337
          _this.chk(res.parent===n.transform,"convert not match ");
          switch (n.relation) {
          case "parent":
            //$LASTPOS=26002461;//kernel.ParentChanger:2461
            n.transform.childToSibling(res,res);
            break;
            
          case "child":
            //$LASTPOS=26002746;//kernel.ParentChanger:2746
            _this.chk(n.next.transform.isSibling(res),"convert::child not match");
            //$LASTPOS=26002824;//kernel.ParentChanger:2824
            n.next.transform.siblingToChild(res,res);
            break;
            
          case "sibling":
            //$LASTPOS=26002974;//kernel.ParentChanger:2974
            n.transform.childToSibling(res,res);
            //$LASTPOS=26003089;//kernel.ParentChanger:3089
            _this.chk(n.next.transform.isSibling(res),"convert::sibling not match");
            //$LASTPOS=26003170;//kernel.ParentChanger:3170
            n.next.transform.siblingToChild(res,res);
            break;
            
          default:
            //$LASTPOS=26003311;//kernel.ParentChanger:3311
            _this.chk(false,"Unknown relation:"+n.relation+"/"+n.transform.id+"/"+_this.dstParent.id);
          }
          //$LASTPOS=26003450;//kernel.ParentChanger:3450
          n=n.next;
          
        }
        //$LASTPOS=26003600;//kernel.ParentChanger:3600
        _this.chk(res.parent===_this.dstParent,"change::fail");
        return res;
      },
      fiber$change :function _trc_ParentChanger_f_change(_thread,t,res) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var n;
        var dstNode;
        
        //$LASTPOS=26002147;//kernel.ParentChanger:2147
        res=res||new Tonyu.classes.kernel.Transform;
        //$LASTPOS=26002176;//kernel.ParentChanger:2176
        res.set(t);
        //$LASTPOS=26002193;//kernel.ParentChanger:2193
        if (res.parent===_this.dstParent) {
          _thread.retVal=res;return;
          
        }
        
        _thread.enter(function _trc_ParentChanger_ent_change(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=26002238;//kernel.ParentChanger:2238
              _this.fiber$getNode(_thread, res.parent);
              __pc=1;return;
            case 1:
              n=_thread.retVal;
              
              //$LASTPOS=26002270;//kernel.ParentChanger:2270
              _this.fiber$getNode(_thread, _this.dstParent);
              __pc=2;return;
            case 2:
              dstNode=_thread.retVal;
              
              //$LASTPOS=26002307;//kernel.ParentChanger:2307
            case 3:
              if (!(n!==dstNode)) { __pc=13    ; break; }
              //$LASTPOS=26002337;//kernel.ParentChanger:2337
              _this.fiber$chk(_thread, res.parent===n.transform, "convert not match ");
              __pc=4;return;
            case 4:
              
              switch (n.relation) {
              case "parent":
                __pc=5     ;break;
              case "child":
                __pc=6     ;break;
              case "sibling":
                __pc=8     ;break;
              default:
                __pc=10    ;break;
                
              }
              break;
            case 5     :
              //$LASTPOS=26002461;//kernel.ParentChanger:2461
              n.transform.childToSibling(res,res);
              __pc=12    ; break;
              
            case 6     :
              //$LASTPOS=26002746;//kernel.ParentChanger:2746
              _this.fiber$chk(_thread, n.next.transform.isSibling(res), "convert::child not match");
              __pc=7;return;
            case 7:
              
              //$LASTPOS=26002824;//kernel.ParentChanger:2824
              n.next.transform.siblingToChild(res,res);
              __pc=12    ; break;
              
            case 8     :
              //$LASTPOS=26002974;//kernel.ParentChanger:2974
              n.transform.childToSibling(res,res);
              //$LASTPOS=26003089;//kernel.ParentChanger:3089
              _this.fiber$chk(_thread, n.next.transform.isSibling(res), "convert::sibling not match");
              __pc=9;return;
            case 9:
              
              //$LASTPOS=26003170;//kernel.ParentChanger:3170
              n.next.transform.siblingToChild(res,res);
              __pc=12    ; break;
              
            case 10    :
              //$LASTPOS=26003311;//kernel.ParentChanger:3311
              _this.fiber$chk(_thread, false, "Unknown relation:"+n.relation+"/"+n.transform.id+"/"+_this.dstParent.id);
              __pc=11;return;
            case 11:
              
              case 12    :
              
              //$LASTPOS=26003450;//kernel.ParentChanger:3450
              n=n.next;
              __pc=3;break;
            case 13    :
              
              //$LASTPOS=26003600;//kernel.ParentChanger:3600
              _this.fiber$chk(_thread, res.parent===_this.dstParent, "change::fail");
              __pc=14;return;
            case 14:
              
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"cn":{"nowait":false},"chk":{"nowait":false},"getNode":{"nowait":false},"change":{"nowait":false}},"fields":{"dstParent":{},"nodes":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Quaternion',
  shortName: 'Quaternion',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Quaternion_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=27000037;//kernel.Quaternion:37
        "field strict";
        
        
      },
      fiber$main :function _trc_Quaternion_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=27000037;//kernel.Quaternion:37
        "field strict";
        
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Quaternion_initialize(p) {
        "use strict";
        var _this=this;
        var v;
        
        //$LASTPOS=27000189;//kernel.Quaternion:189
        __superClass.apply( _this, [p]);
        //$LASTPOS=27000204;//kernel.Quaternion:204
        if (_this.axis&&typeof  _this.r==="number") {
          //$LASTPOS=27000248;//kernel.Quaternion:248
          _this.theta=_this.r/2;
          //$LASTPOS=27000312;//kernel.Quaternion:312
          v = _this.axis.normalize(_this.sin(_this.theta));
          
          //$LASTPOS=27000355;//kernel.Quaternion:355
          _this.x=v.x;
          //$LASTPOS=27000361;//kernel.Quaternion:361
          _this.y=v.y;
          //$LASTPOS=27000367;//kernel.Quaternion:367
          _this.z=v.z;
          //$LASTPOS=27000383;//kernel.Quaternion:383
          _this.w=_this.cos(_this.theta);
          
        } else {
          //$LASTPOS=27000420;//kernel.Quaternion:420
          _this.x=_this.x||0;
          //$LASTPOS=27000437;//kernel.Quaternion:437
          _this.y=_this.y||0;
          //$LASTPOS=27000454;//kernel.Quaternion:454
          _this.z=_this.z||0;
          //$LASTPOS=27000471;//kernel.Quaternion:471
          if (_this.w==null) {
            //$LASTPOS=27000484;//kernel.Quaternion:484
            _this.w=1;
          }
          
        }
      },
      set :function _trc_Quaternion_set(q) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=27000526;//kernel.Quaternion:526
        _this.x=q.x;
        //$LASTPOS=27000538;//kernel.Quaternion:538
        _this.y=q.y;
        //$LASTPOS=27000550;//kernel.Quaternion:550
        _this.z=q.z;
        //$LASTPOS=27000562;//kernel.Quaternion:562
        _this.w=q.w;
        return _this;
      },
      fiber$set :function _trc_Quaternion_f_set(_thread,q) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=27000526;//kernel.Quaternion:526
        _this.x=q.x;
        //$LASTPOS=27000538;//kernel.Quaternion:538
        _this.y=q.y;
        //$LASTPOS=27000550;//kernel.Quaternion:550
        _this.z=q.z;
        //$LASTPOS=27000562;//kernel.Quaternion:562
        _this.w=q.w;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__length :function _trc_Quaternion___getter__length() {
        "use strict";
        var _this=this;
        
        return _this.sqrt(_this.lengthSQ);
      },
      __getter__lengthSQ :function _trc_Quaternion___getter__lengthSQ() {
        "use strict";
        var _this=this;
        
        return _this.x*_this.x+_this.y*_this.y+_this.z*_this.z+_this.w*_this.w;
      },
      clone :function _trc_Quaternion_clone() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.Quaternion({x: _this.x,y: _this.y,z: _this.z,w: _this.w});
      },
      fiber$clone :function _trc_Quaternion_f_clone(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=new Tonyu.classes.kernel.Quaternion({x: _this.x,y: _this.y,z: _this.z,w: _this.w});return;
        
        
        _thread.retVal=_this;return;
      },
      addX :function _trc_Quaternion_addX(q) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=27000757;//kernel.Quaternion:757
        _this.x+=q.x;
        //$LASTPOS=27000770;//kernel.Quaternion:770
        _this.y+=q.y;
        //$LASTPOS=27000783;//kernel.Quaternion:783
        _this.z+=q.z;
        //$LASTPOS=27000796;//kernel.Quaternion:796
        _this.w+=q.w;
        return _this;
      },
      fiber$addX :function _trc_Quaternion_f_addX(_thread,q) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=27000757;//kernel.Quaternion:757
        _this.x+=q.x;
        //$LASTPOS=27000770;//kernel.Quaternion:770
        _this.y+=q.y;
        //$LASTPOS=27000783;//kernel.Quaternion:783
        _this.z+=q.z;
        //$LASTPOS=27000796;//kernel.Quaternion:796
        _this.w+=q.w;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      add :function _trc_Quaternion_add(q) {
        "use strict";
        var _this=this;
        
        return _this.clone().addX(q);
      },
      fiber$add :function _trc_Quaternion_f_add(_thread,q) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().addX(q);return;
        
        
        _thread.retVal=_this;return;
      },
      subX :function _trc_Quaternion_subX(q) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=27000907;//kernel.Quaternion:907
        _this.x-=q.x;
        //$LASTPOS=27000920;//kernel.Quaternion:920
        _this.y-=q.y;
        //$LASTPOS=27000933;//kernel.Quaternion:933
        _this.z-=q.z;
        //$LASTPOS=27000946;//kernel.Quaternion:946
        _this.w-=q.w;
        return _this;
      },
      fiber$subX :function _trc_Quaternion_f_subX(_thread,q) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=27000907;//kernel.Quaternion:907
        _this.x-=q.x;
        //$LASTPOS=27000920;//kernel.Quaternion:920
        _this.y-=q.y;
        //$LASTPOS=27000933;//kernel.Quaternion:933
        _this.z-=q.z;
        //$LASTPOS=27000946;//kernel.Quaternion:946
        _this.w-=q.w;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      sub :function _trc_Quaternion_sub(q) {
        "use strict";
        var _this=this;
        
        return _this.clone().subX(q);
      },
      fiber$sub :function _trc_Quaternion_f_sub(_thread,q) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().subX(q);return;
        
        
        _thread.retVal=_this;return;
      },
      mulX :function _trc_Quaternion_mulX(k) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=27001055;//kernel.Quaternion:1055
        _this.x*=k;
        //$LASTPOS=27001066;//kernel.Quaternion:1066
        _this.y*=k;
        //$LASTPOS=27001077;//kernel.Quaternion:1077
        _this.z*=k;
        //$LASTPOS=27001088;//kernel.Quaternion:1088
        _this.w*=k;
        return _this;
      },
      fiber$mulX :function _trc_Quaternion_f_mulX(_thread,k) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=27001055;//kernel.Quaternion:1055
        _this.x*=k;
        //$LASTPOS=27001066;//kernel.Quaternion:1066
        _this.y*=k;
        //$LASTPOS=27001077;//kernel.Quaternion:1077
        _this.z*=k;
        //$LASTPOS=27001088;//kernel.Quaternion:1088
        _this.w*=k;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      mul :function _trc_Quaternion_mul(k) {
        "use strict";
        var _this=this;
        
        return _this.clone().mulX(k);
      },
      fiber$mul :function _trc_Quaternion_f_mul(_thread,k) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().mulX(k);return;
        
        
        _thread.retVal=_this;return;
      },
      product :function _trc_Quaternion_product(b,dst) {
        "use strict";
        var _this=this;
        var a;
        var qax;
        var qay;
        var qaz;
        var qaw;
        var qbx;
        var qby;
        var qbz;
        var qbw;
        
        //$LASTPOS=27001252;//kernel.Quaternion:1252
        a = _this;
        
        //$LASTPOS=27001271;//kernel.Quaternion:1271
        qax = a.x;
        qay = a.y;
        qaz = a.z;
        qaw = a.w;
        
        //$LASTPOS=27001324;//kernel.Quaternion:1324
        qbx = b.x;
        qby = b.y;
        qbz = b.z;
        qbw = b.w;
        
        //$LASTPOS=27001379;//kernel.Quaternion:1379
        if (! dst) {
          //$LASTPOS=27001389;//kernel.Quaternion:1389
          dst=new Tonyu.classes.kernel.Quaternion;
        }
        //$LASTPOS=27001414;//kernel.Quaternion:1414
        dst.x=qax*qbw+qaw*qbx+qay*qbz-qaz*qby;
        //$LASTPOS=27001474;//kernel.Quaternion:1474
        dst.y=qay*qbw+qaw*qby+qaz*qbx-qax*qbz;
        //$LASTPOS=27001534;//kernel.Quaternion:1534
        dst.z=qaz*qbw+qaw*qbz+qax*qby-qay*qbx;
        //$LASTPOS=27001594;//kernel.Quaternion:1594
        dst.w=qaw*qbw-qax*qbx-qay*qby-qaz*qbz;
        return dst;
      },
      fiber$product :function _trc_Quaternion_f_product(_thread,b,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var qax;
        var qay;
        var qaz;
        var qaw;
        var qbx;
        var qby;
        var qbz;
        var qbw;
        
        //$LASTPOS=27001252;//kernel.Quaternion:1252
        a = _this;
        
        //$LASTPOS=27001271;//kernel.Quaternion:1271
        qax = a.x;
        qay = a.y;
        qaz = a.z;
        qaw = a.w;
        
        //$LASTPOS=27001324;//kernel.Quaternion:1324
        qbx = b.x;
        qby = b.y;
        qbz = b.z;
        qbw = b.w;
        
        //$LASTPOS=27001379;//kernel.Quaternion:1379
        if (! dst) {
          //$LASTPOS=27001389;//kernel.Quaternion:1389
          dst=new Tonyu.classes.kernel.Quaternion;
        }
        //$LASTPOS=27001414;//kernel.Quaternion:1414
        dst.x=qax*qbw+qaw*qbx+qay*qbz-qaz*qby;
        //$LASTPOS=27001474;//kernel.Quaternion:1474
        dst.y=qay*qbw+qaw*qby+qaz*qbx-qax*qbz;
        //$LASTPOS=27001534;//kernel.Quaternion:1534
        dst.z=qaz*qbw+qaw*qbz+qax*qby-qay*qbx;
        //$LASTPOS=27001594;//kernel.Quaternion:1594
        dst.w=qaw*qbw-qax*qbx-qay*qby-qaz*qbz;
        _thread.retVal=dst;return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__inverse :function _trc_Quaternion___getter__inverse() {
        "use strict";
        var _this=this;
        
        return _this.conjugate.mulX(1/_this.lengthSQ);
      },
      __getter__conjugate :function _trc_Quaternion___getter__conjugate() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.Quaternion({x: - _this.x,y: - _this.y,z: - _this.z,w: _this.w});
      },
      rotate :function _trc_Quaternion_rotate(p,dst) {
        "use strict";
        var _this=this;
        var x;
        var y;
        var z;
        var q;
        var qx;
        var qy;
        var qz;
        var qw;
        var ix;
        var iy;
        var iz;
        var iw;
        
        //$LASTPOS=27001875;//kernel.Quaternion:1875
        x = p.x;
        y = p.y;
        z = p.z;
        
        //$LASTPOS=27001911;//kernel.Quaternion:1911
        q = _this;
        
        //$LASTPOS=27001928;//kernel.Quaternion:1928
        qx = q.x;
        qy = q.y;
        qz = q.z;
        qw = q.w;
        
        //$LASTPOS=27002013;//kernel.Quaternion:2013
        ix = qw*x+qy*z-qz*y;
        
        //$LASTPOS=27002053;//kernel.Quaternion:2053
        iy = qw*y+qz*x-qx*z;
        
        //$LASTPOS=27002093;//kernel.Quaternion:2093
        iz = qw*z+qx*y-qy*x;
        
        //$LASTPOS=27002133;//kernel.Quaternion:2133
        iw = - qx*x-qy*y-qz*z;
        
        //$LASTPOS=27002217;//kernel.Quaternion:2217
        if (! dst) {
          //$LASTPOS=27002238;//kernel.Quaternion:2238
          dst=new Tonyu.classes.kernel.Vec3;
          
        }
        //$LASTPOS=27002264;//kernel.Quaternion:2264
        dst.x=ix*qw+iw*- qx+iy*- qz-iz*- qy;
        //$LASTPOS=27002322;//kernel.Quaternion:2322
        dst.y=iy*qw+iw*- qy+iz*- qx-ix*- qz;
        //$LASTPOS=27002380;//kernel.Quaternion:2380
        dst.z=iz*qw+iw*- qz+ix*- qy-iy*- qx;
        return dst;
      },
      fiber$rotate :function _trc_Quaternion_f_rotate(_thread,p,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var x;
        var y;
        var z;
        var q;
        var qx;
        var qy;
        var qz;
        var qw;
        var ix;
        var iy;
        var iz;
        var iw;
        
        //$LASTPOS=27001875;//kernel.Quaternion:1875
        x = p.x;
        y = p.y;
        z = p.z;
        
        //$LASTPOS=27001911;//kernel.Quaternion:1911
        q = _this;
        
        //$LASTPOS=27001928;//kernel.Quaternion:1928
        qx = q.x;
        qy = q.y;
        qz = q.z;
        qw = q.w;
        
        //$LASTPOS=27002013;//kernel.Quaternion:2013
        ix = qw*x+qy*z-qz*y;
        
        //$LASTPOS=27002053;//kernel.Quaternion:2053
        iy = qw*y+qz*x-qx*z;
        
        //$LASTPOS=27002093;//kernel.Quaternion:2093
        iz = qw*z+qx*y-qy*x;
        
        //$LASTPOS=27002133;//kernel.Quaternion:2133
        iw = - qx*x-qy*y-qz*z;
        
        //$LASTPOS=27002217;//kernel.Quaternion:2217
        if (! dst) {
          //$LASTPOS=27002238;//kernel.Quaternion:2238
          dst=new Tonyu.classes.kernel.Vec3;
          
        }
        //$LASTPOS=27002264;//kernel.Quaternion:2264
        dst.x=ix*qw+iw*- qx+iy*- qz-iz*- qy;
        //$LASTPOS=27002322;//kernel.Quaternion:2322
        dst.y=iy*qw+iw*- qy+iz*- qx-ix*- qz;
        //$LASTPOS=27002380;//kernel.Quaternion:2380
        dst.z=iz*qw+iw*- qz+ix*- qy-iy*- qx;
        _thread.retVal=dst;return;
        
        
        _thread.retVal=_this;return;
      },
      calcTheta :function _trc_Quaternion_calcTheta() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=27002515;//kernel.Quaternion:2515
        _this.theta=_this.atanxy(_this.w,_this.sqrt(_this.x*_this.x+_this.y*_this.y+_this.z*_this.z));
        //$LASTPOS=27002555;//kernel.Quaternion:2555
        _this.r=_this.theta*2;
        return _this.theta;
      },
      fiber$calcTheta :function _trc_Quaternion_f_calcTheta(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=27002515;//kernel.Quaternion:2515
        _this.theta=_this.atanxy(_this.w,_this.sqrt(_this.x*_this.x+_this.y*_this.y+_this.z*_this.z));
        //$LASTPOS=27002555;//kernel.Quaternion:2555
        _this.r=_this.theta*2;
        _thread.retVal=_this.theta;return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"set":{"nowait":false},"__getter__length":{"nowait":true},"__getter__lengthSQ":{"nowait":true},"clone":{"nowait":false},"addX":{"nowait":false},"add":{"nowait":false},"subX":{"nowait":false},"sub":{"nowait":false},"mulX":{"nowait":false},"mul":{"nowait":false},"product":{"nowait":false},"__getter__inverse":{"nowait":true},"__getter__conjugate":{"nowait":true},"rotate":{"nowait":false},"calcTheta":{"nowait":false}},"fields":{"x":{},"y":{},"z":{},"w":{},"axis":{},"r":{},"theta":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.RectShape',
  shortName: 'RectShape',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_RectShape_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=28000018;//kernel.RectShape:18
        "field strict";
        
      },
      fiber$main :function _trc_RectShape_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=28000018;//kernel.RectShape:18
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      intersects :function _trc_RectShape_intersects(s) {
        "use strict";
        var _this=this;
        
        return s&&Math.abs(_this.x-s.x)*2<_this.width+s.width&&Math.abs(_this.y-s.y)*2<_this.height+s.height;
      },
      fiber$intersects :function _trc_RectShape_f_intersects(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=s&&Math.abs(_this.x-s.x)*2<_this.width+s.width&&Math.abs(_this.y-s.y)*2<_this.height+s.height;return;
        
        
        _thread.retVal=_this;return;
      },
      contains :function _trc_RectShape_contains(p) {
        "use strict";
        var _this=this;
        
        return p.x>=_this.xmin&&p.x<=_this.xmax&&p.y>=_this.ymin&&p.y<=_this.ymax;
      },
      fiber$contains :function _trc_RectShape_f_contains(_thread,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=p.x>=_this.xmin&&p.x<=_this.xmax&&p.y>=_this.ymin&&p.y<=_this.ymax;return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__xmin :function _trc_RectShape___getter__xmin() {
        "use strict";
        var _this=this;
        
        return _this.x-_this.width/2;
      },
      __getter__xmax :function _trc_RectShape___getter__xmax() {
        "use strict";
        var _this=this;
        
        return _this.x+_this.width/2;
      },
      __getter__ymin :function _trc_RectShape___getter__ymin() {
        "use strict";
        var _this=this;
        
        return _this.y-_this.height/2;
      },
      __getter__ymax :function _trc_RectShape___getter__ymax() {
        "use strict";
        var _this=this;
        
        return _this.y+_this.height/2;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"intersects":{"nowait":false},"contains":{"nowait":false},"__getter__xmin":{"nowait":true},"__getter__xmax":{"nowait":true},"__getter__ymin":{"nowait":true},"__getter__ymax":{"nowait":true}},"fields":{"x":{},"y":{},"width":{},"height":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Transform',
  shortName: 'Transform',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Transform_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=29000018;//kernel.Transform:18
        "field strict";
        
        
        
        
        
      },
      fiber$main :function _trc_Transform_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=29000018;//kernel.Transform:18
        "field strict";
        
        
        
        
        
        
        _thread.retVal=_this;return;
      },
      _static :function _trc_Transform__static() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=29000286;//kernel.Transform:286
        if (! Tonyu.classes.kernel.Transform._static) {
          //$LASTPOS=29000321;//kernel.Transform:321
          Tonyu.classes.kernel.Transform._static=true;
          //$LASTPOS=29000354;//kernel.Transform:354
          Tonyu.classes.kernel.Transform.IDSEQ=1;
          //$LASTPOS=29000382;//kernel.Transform:382
          Tonyu.classes.kernel.Transform.root=new Tonyu.classes.kernel.Transform;
          
        }
      },
      fiber$_static :function _trc_Transform_f__static(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=29000286;//kernel.Transform:286
        if (! Tonyu.classes.kernel.Transform._static) {
          //$LASTPOS=29000321;//kernel.Transform:321
          Tonyu.classes.kernel.Transform._static=true;
          //$LASTPOS=29000354;//kernel.Transform:354
          Tonyu.classes.kernel.Transform.IDSEQ=1;
          //$LASTPOS=29000382;//kernel.Transform:382
          Tonyu.classes.kernel.Transform.root=new Tonyu.classes.kernel.Transform;
          
        }
        
        _thread.retVal=_this;return;
      },
      __setter__parent :function _trc_Transform___setter__parent(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=29000440;//kernel.Transform:440
        if (_this._parent===p) {
          return _this;
        }
        //$LASTPOS=29000470;//kernel.Transform:470
        _this._parent=p;
      },
      __getter__parent :function _trc_Transform___getter__parent() {
        "use strict";
        var _this=this;
        
        return _this._parent;
      },
      __getter__quaternion :function _trc_Transform___getter__quaternion() {
        "use strict";
        var _this=this;
        
        return _this.direction.quaternion;
      },
      initialize :function _trc_Transform_initialize(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=29000660;//kernel.Transform:660
        _this._static();
        //$LASTPOS=29000676;//kernel.Transform:676
        __superClass.apply( _this, [param]);
        //$LASTPOS=29000695;//kernel.Transform:695
        _this.id=Tonyu.classes.kernel.Transform.IDSEQ++;
        //$LASTPOS=29000722;//kernel.Transform:722
        _this.scale=_this.scale||1;
        //$LASTPOS=29000743;//kernel.Transform:743
        _this.direction=_this.direction||new Tonyu.classes.kernel.Direction;
        //$LASTPOS=29000784;//kernel.Transform:784
        _this.position=_this.position||new Tonyu.classes.kernel.Vec3(0,0,0);
      },
      child :function _trc_Transform_child(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=29000885;//kernel.Transform:885
        param.parent=_this;
        return new Tonyu.classes.kernel.Transform(param);
      },
      fiber$child :function _trc_Transform_f_child(_thread,param) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=29000885;//kernel.Transform:885
        param.parent=_this;
        _thread.retVal=new Tonyu.classes.kernel.Transform(param);return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__isRoot :function _trc_Transform___getter__isRoot() {
        "use strict";
        var _this=this;
        
        return _this===Tonyu.classes.kernel.Transform.root;
      },
      clone :function _trc_Transform_clone() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.Transform().set(_this);
      },
      fiber$clone :function _trc_Transform_f_clone(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=new Tonyu.classes.kernel.Transform().set(_this);return;
        
        
        _thread.retVal=_this;return;
      },
      set :function _trc_Transform_set(t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=29001072;//kernel.Transform:1072
        _this.position.set(t.position);
        //$LASTPOS=29001103;//kernel.Transform:1103
        _this.direction.set(t.direction);
        //$LASTPOS=29001136;//kernel.Transform:1136
        _this.scale=t.scale;
        //$LASTPOS=29001156;//kernel.Transform:1156
        _this._parent=t.parent;
        return _this;
      },
      fiber$set :function _trc_Transform_f_set(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=29001072;//kernel.Transform:1072
        _this.position.set(t.position);
        //$LASTPOS=29001103;//kernel.Transform:1103
        _this.direction.set(t.direction);
        //$LASTPOS=29001136;//kernel.Transform:1136
        _this.scale=t.scale;
        //$LASTPOS=29001156;//kernel.Transform:1156
        _this._parent=t.parent;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      product :function _trc_Transform_product(t,dst) {
        "use strict";
        var _this=this;
        var writeToThis;
        
        
        //$LASTPOS=29001407;//kernel.Transform:1407
        if (dst===_this) {
          //$LASTPOS=29001434;//kernel.Transform:1434
          writeToThis=true;
          //$LASTPOS=29001461;//kernel.Transform:1461
          dst=false;
          
        }
        //$LASTPOS=29001484;//kernel.Transform:1484
        if (! dst) {
          //$LASTPOS=29001494;//kernel.Transform:1494
          dst=new Tonyu.classes.kernel.Transform;
        }
        //$LASTPOS=29001518;//kernel.Transform:1518
        _this.quaternion.product(t.quaternion,dst.quaternion);
        //$LASTPOS=29001572;//kernel.Transform:1572
        dst.scale=_this.scale*t.scale;
        //$LASTPOS=29001602;//kernel.Transform:1602
        _this.localToWorld(t.position,dst.position);
        //$LASTPOS=29001646;//kernel.Transform:1646
        if (writeToThis) {
          //$LASTPOS=29001674;//kernel.Transform:1674
          _this.set(dst);
          return _this;
          
        }
        return dst;
      },
      fiber$product :function _trc_Transform_f_product(_thread,t,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var writeToThis;
        
        
        //$LASTPOS=29001407;//kernel.Transform:1407
        if (dst===_this) {
          //$LASTPOS=29001434;//kernel.Transform:1434
          writeToThis=true;
          //$LASTPOS=29001461;//kernel.Transform:1461
          dst=false;
          
        }
        //$LASTPOS=29001484;//kernel.Transform:1484
        if (! dst) {
          //$LASTPOS=29001494;//kernel.Transform:1494
          dst=new Tonyu.classes.kernel.Transform;
        }
        //$LASTPOS=29001518;//kernel.Transform:1518
        _this.quaternion.product(t.quaternion,dst.quaternion);
        //$LASTPOS=29001572;//kernel.Transform:1572
        dst.scale=_this.scale*t.scale;
        
        _thread.enter(function _trc_Transform_ent_product(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=29001602;//kernel.Transform:1602
              _this.fiber$localToWorld(_thread, t.position, dst.position);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=29001646;//kernel.Transform:1646
              if (!(writeToThis)) { __pc=3     ; break; }
              //$LASTPOS=29001674;//kernel.Transform:1674
              _this.fiber$set(_thread, dst);
              __pc=2;return;
            case 2:
              
              _thread.exit(_this);return;
            case 3     :
              
              _thread.exit(dst);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      parentChanged :function _trc_Transform_parentChanged(to,dst) {
        "use strict";
        var _this=this;
        var p;
        
        //$LASTPOS=29001786;//kernel.Transform:1786
        p = new Tonyu.classes.kernel.ParentChanger(to);
        
        return p.change(_this,dst);
      },
      fiber$parentChanged :function _trc_Transform_f_parentChanged(_thread,to,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        
        //$LASTPOS=29001786;//kernel.Transform:1786
        p = new Tonyu.classes.kernel.ParentChanger(to);
        
        _thread.retVal=p.change(_this,dst);return;
        
        
        _thread.retVal=_this;return;
      },
      changeParent :function _trc_Transform_changeParent(to) {
        "use strict";
        var _this=this;
        var c;
        
        //$LASTPOS=29001886;//kernel.Transform:1886
        c = _this.parentChanged(to);
        
        return _this.set(c);
      },
      fiber$changeParent :function _trc_Transform_f_changeParent(_thread,to) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var c;
        
        
        _thread.enter(function _trc_Transform_ent_changeParent(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=29001886;//kernel.Transform:1886
              _this.fiber$parentChanged(_thread, to);
              __pc=1;return;
            case 1:
              c=_thread.retVal;
              
              _this.fiber$set(_thread, c);
              __pc=2;return;
            case 2:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      localToWorld :function _trc_Transform_localToWorld(local,dst) {
        "use strict";
        var _this=this;
        
        return _this.childToSibling(local,dst);
      },
      fiber$localToWorld :function _trc_Transform_f_localToWorld(_thread,local,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Transform_ent_localToWorld(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$childToSibling(_thread, local, dst);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      childToSibling :function _trc_Transform_childToSibling(child,dst) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=29002152;//kernel.Transform:2152
        if (Tonyu.is(child,Tonyu.classes.kernel.Transform)) {
          //$LASTPOS=29002273;//kernel.Transform:2273
          res = _this.product(child,dst);
          
          //$LASTPOS=29002310;//kernel.Transform:2310
          res._parent=_this.parent;
          return res;
          
        }
        //$LASTPOS=29002382;//kernel.Transform:2382
        dst=_this.direction.localToWorld(child,dst);
        //$LASTPOS=29002426;//kernel.Transform:2426
        dst.mulX(_this.scale);
        //$LASTPOS=29002448;//kernel.Transform:2448
        dst.addX_v(_this.position);
        return dst;
      },
      fiber$childToSibling :function _trc_Transform_f_childToSibling(_thread,child,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        
        
        _thread.enter(function _trc_Transform_ent_childToSibling(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=29002152;//kernel.Transform:2152
              if (!(Tonyu.is(child,Tonyu.classes.kernel.Transform))) { __pc=2     ; break; }
              //$LASTPOS=29002273;//kernel.Transform:2273
              _this.fiber$product(_thread, child, dst);
              __pc=1;return;
            case 1:
              res=_thread.retVal;
              
              //$LASTPOS=29002310;//kernel.Transform:2310
              res._parent=_this.parent;
              _thread.exit(res);return;
            case 2     :
              
              //$LASTPOS=29002382;//kernel.Transform:2382
              dst=_this.direction.localToWorld(child,dst);
              //$LASTPOS=29002426;//kernel.Transform:2426
              dst.mulX(_this.scale);
              //$LASTPOS=29002448;//kernel.Transform:2448
              dst.addX_v(_this.position);
              _thread.exit(dst);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      worldToLocal :function _trc_Transform_worldToLocal(local,dst) {
        "use strict";
        var _this=this;
        
        return _this.siblingToChild(local,dst);
      },
      fiber$worldToLocal :function _trc_Transform_f_worldToLocal(_thread,local,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Transform_ent_worldToLocal(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$siblingToChild(_thread, local, dst);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      siblingToChild :function _trc_Transform_siblingToChild(sibling,dst) {
        "use strict";
        var _this=this;
        var copyToSibling;
        
        
        //$LASTPOS=29002707;//kernel.Transform:2707
        if (Tonyu.is(sibling,Tonyu.classes.kernel.Transform)) {
          //$LASTPOS=29002822;//kernel.Transform:2822
          if (dst===sibling) {
            //$LASTPOS=29002856;//kernel.Transform:2856
            copyToSibling=true;
            //$LASTPOS=29002889;//kernel.Transform:2889
            dst=null;
            
          }
          //$LASTPOS=29002919;//kernel.Transform:2919
          if (! dst) {
            //$LASTPOS=29002929;//kernel.Transform:2929
            dst=new Tonyu.classes.kernel.Transform;
          }
          //$LASTPOS=29002957;//kernel.Transform:2957
          _this.siblingToChild(sibling.position,dst.position);
          //$LASTPOS=29003013;//kernel.Transform:3013
          _this.quaternion.inverse.product(sibling.quaternion,dst.quaternion);
          //$LASTPOS=29003085;//kernel.Transform:3085
          dst.scale=sibling.scale/_this.scale;
          //$LASTPOS=29003125;//kernel.Transform:3125
          dst._parent=_this;
          //$LASTPOS=29003152;//kernel.Transform:3152
          if (copyToSibling) {
            //$LASTPOS=29003186;//kernel.Transform:3186
            sibling.set(dst);
            return sibling;
            
          }
          return dst;
          
        }
        //$LASTPOS=29003390;//kernel.Transform:3390
        if (! dst) {
          //$LASTPOS=29003400;//kernel.Transform:3400
          dst=new Tonyu.classes.kernel.Vec3(0,0,0);
        }
        //$LASTPOS=29003426;//kernel.Transform:3426
        dst.set(sibling);
        //$LASTPOS=29003449;//kernel.Transform:3449
        dst.subX_v(_this.position);
        //$LASTPOS=29003476;//kernel.Transform:3476
        _this.direction.worldToLocal(dst,dst);
        //$LASTPOS=29003514;//kernel.Transform:3514
        dst.divX(_this.scale);
        return dst;
      },
      fiber$siblingToChild :function _trc_Transform_f_siblingToChild(_thread,sibling,dst) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var copyToSibling;
        
        
        
        _thread.enter(function _trc_Transform_ent_siblingToChild(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=29002707;//kernel.Transform:2707
              if (!(Tonyu.is(sibling,Tonyu.classes.kernel.Transform))) { __pc=3     ; break; }
              //$LASTPOS=29002822;//kernel.Transform:2822
              if (dst===sibling) {
                //$LASTPOS=29002856;//kernel.Transform:2856
                copyToSibling=true;
                //$LASTPOS=29002889;//kernel.Transform:2889
                dst=null;
                
              }
              //$LASTPOS=29002919;//kernel.Transform:2919
              if (! dst) {
                //$LASTPOS=29002929;//kernel.Transform:2929
                dst=new Tonyu.classes.kernel.Transform;
              }
              //$LASTPOS=29002957;//kernel.Transform:2957
              _this.fiber$siblingToChild(_thread, sibling.position, dst.position);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=29003013;//kernel.Transform:3013
              _this.quaternion.inverse.product(sibling.quaternion,dst.quaternion);
              //$LASTPOS=29003085;//kernel.Transform:3085
              dst.scale=sibling.scale/_this.scale;
              //$LASTPOS=29003125;//kernel.Transform:3125
              dst._parent=_this;
              //$LASTPOS=29003152;//kernel.Transform:3152
              if (!(copyToSibling)) { __pc=2     ; break; }
              //$LASTPOS=29003186;//kernel.Transform:3186
              sibling.set(dst);
              _thread.exit(sibling);return;
            case 2     :
              
              _thread.exit(dst);return;
            case 3     :
              
              //$LASTPOS=29003390;//kernel.Transform:3390
              if (! dst) {
                //$LASTPOS=29003400;//kernel.Transform:3400
                dst=new Tonyu.classes.kernel.Vec3(0,0,0);
              }
              //$LASTPOS=29003426;//kernel.Transform:3426
              dst.set(sibling);
              //$LASTPOS=29003449;//kernel.Transform:3449
              dst.subX_v(_this.position);
              //$LASTPOS=29003476;//kernel.Transform:3476
              _this.direction.worldToLocal(dst,dst);
              //$LASTPOS=29003514;//kernel.Transform:3514
              dst.divX(_this.scale);
              _thread.exit(dst);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      changeScale :function _trc_Transform_changeScale(vec,by) {
        "use strict";
        var _this=this;
        
        return vec.mulX(by);
      },
      fiber$changeScale :function _trc_Transform_f_changeScale(_thread,vec,by) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=vec.mulX(by);return;
        
        
        _thread.retVal=_this;return;
      },
      isSibling :function _trc_Transform_isSibling(sib) {
        "use strict";
        var _this=this;
        
        return sib.parent===_this.parent;
      },
      fiber$isSibling :function _trc_Transform_f_isSibling(_thread,sib) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=sib.parent===_this.parent;return;
        
        
        _thread.retVal=_this;return;
      },
      isParentOf :function _trc_Transform_isParentOf(child) {
        "use strict";
        var _this=this;
        
        return child.parent===_this;
      },
      fiber$isParentOf :function _trc_Transform_f_isParentOf(_thread,child) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=child.parent===_this;return;
        
        
        _thread.retVal=_this;return;
      },
      isChildOf :function _trc_Transform_isChildOf(parent) {
        "use strict";
        var _this=this;
        
        return _this.parent===parent;
      },
      fiber$isChildOf :function _trc_Transform_f_isChildOf(_thread,parent) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.parent===parent;return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__inverse :function _trc_Transform___getter__inverse() {
        "use strict";
        var _this=this;
        
        return _this.siblingToChild(new Tonyu.classes.kernel.Transform());
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"_static":{"nowait":false},"__setter__parent":{"nowait":true},"__getter__parent":{"nowait":true},"__getter__quaternion":{"nowait":true},"new":{"nowait":false},"child":{"nowait":false},"__getter__isRoot":{"nowait":true},"clone":{"nowait":false},"set":{"nowait":false},"product":{"nowait":false},"parentChanged":{"nowait":false},"changeParent":{"nowait":false},"localToWorld":{"nowait":false},"childToSibling":{"nowait":false},"worldToLocal":{"nowait":false},"siblingToChild":{"nowait":false},"changeScale":{"nowait":false},"isSibling":{"nowait":false},"isParentOf":{"nowait":false},"isChildOf":{"nowait":false},"__getter__inverse":{"nowait":true}},"fields":{"actor":{},"_parent":{},"direction":{},"position":{},"scale":{},"id":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Vec3',
  shortName: 'Vec3',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Vec3_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Vec3_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Vec3_initialize(x,y,z) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30000080;//kernel.Vec3:80
        if (typeof  x==="object") {
          //$LASTPOS=30000116;//kernel.Vec3:116
          z=x.z;
          //$LASTPOS=30000122;//kernel.Vec3:122
          y=x.y;
          //$LASTPOS=30000128;//kernel.Vec3:128
          x=x.x;
          
        }
        //$LASTPOS=30000147;//kernel.Vec3:147
        _this.x=(typeof  x==="number")?x:0;
        //$LASTPOS=30000189;//kernel.Vec3:189
        _this.y=(typeof  y==="number")?y:0;
        //$LASTPOS=30000231;//kernel.Vec3:231
        _this.z=(typeof  z==="number")?z:0;
      },
      checkNum :function _trc_Vec3_checkNum(o) {
        "use strict";
        var _this=this;
        var name;
        var val;
        var _it_232;
        
        //$LASTPOS=30000292;//kernel.Vec3:292
        _it_232=Tonyu.iterator(o,2);
        while(_it_232.next()) {
          name=_it_232[0];
          val=_it_232[1];
          
          //$LASTPOS=30000327;//kernel.Vec3:327
          if (typeof  val!=="number") {
            throw new Error(name+"("+val+")は数値ではありません．");
            
            
          }
          
        }
      },
      fiber$checkNum :function _trc_Vec3_f_checkNum(_thread,o) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var name;
        var val;
        var _it_232;
        
        //$LASTPOS=30000292;//kernel.Vec3:292
        _it_232=Tonyu.iterator(o,2);
        while(_it_232.next()) {
          name=_it_232[0];
          val=_it_232[1];
          
          //$LASTPOS=30000327;//kernel.Vec3:327
          if (typeof  val!=="number") {
            throw new Error(name+"("+val+")は数値ではありません．");
            
            
          }
          
        }
        
        _thread.retVal=_this;return;
      },
      parsePointArgs :function _trc_Vec3_parsePointArgs(args) {
        "use strict";
        var _this=this;
        var a;
        var p;
        
        //$LASTPOS=30000466;//kernel.Vec3:466
        a = new Tonyu.classes.kernel.ArgParser(args);
        
        //$LASTPOS=30000498;//kernel.Vec3:498
        p = a.shift(Object);
        
        //$LASTPOS=30000526;//kernel.Vec3:526
        if (! p) {
          //$LASTPOS=30000545;//kernel.Vec3:545
          p={};
          //$LASTPOS=30000560;//kernel.Vec3:560
          p.x=a.shift();
          //$LASTPOS=30000584;//kernel.Vec3:584
          p.y=a.shift();
          //$LASTPOS=30000608;//kernel.Vec3:608
          p.z=a.shift()||0;
          
        }
        return p;
      },
      fiber$parsePointArgs :function _trc_Vec3_f_parsePointArgs(_thread,args) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var p;
        
        //$LASTPOS=30000466;//kernel.Vec3:466
        a = new Tonyu.classes.kernel.ArgParser(args);
        
        //$LASTPOS=30000498;//kernel.Vec3:498
        p = a.shift(Object);
        
        //$LASTPOS=30000526;//kernel.Vec3:526
        if (! p) {
          //$LASTPOS=30000545;//kernel.Vec3:545
          p={};
          //$LASTPOS=30000560;//kernel.Vec3:560
          p.x=a.shift();
          //$LASTPOS=30000584;//kernel.Vec3:584
          p.y=a.shift();
          //$LASTPOS=30000608;//kernel.Vec3:608
          p.z=a.shift()||0;
          
        }
        _thread.retVal=p;return;
        
        
        _thread.retVal=_this;return;
      },
      addX :function _trc_Vec3_addX() {
        "use strict";
        var _this=this;
        var p;
        
        //$LASTPOS=30000675;//kernel.Vec3:675
        p = _this.parsePointArgs(arguments);
        
        //$LASTPOS=30000713;//kernel.Vec3:713
        _this.x+=p.x;
        //$LASTPOS=30000726;//kernel.Vec3:726
        _this.y+=p.y;
        //$LASTPOS=30000739;//kernel.Vec3:739
        _this.z+=p.z;
        return _this;
      },
      fiber$addX :function _trc_Vec3_f_addX(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        
        
        _thread.enter(function _trc_Vec3_ent_addX(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=30000675;//kernel.Vec3:675
              _this.fiber$parsePointArgs(_thread, _arguments);
              __pc=1;return;
            case 1:
              p=_thread.retVal;
              
              //$LASTPOS=30000713;//kernel.Vec3:713
              _this.x+=p.x;
              //$LASTPOS=30000726;//kernel.Vec3:726
              _this.y+=p.y;
              //$LASTPOS=30000739;//kernel.Vec3:739
              _this.z+=p.z;
              _thread.exit(_this);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      addX_v :function _trc_Vec3_addX_v(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30000802;//kernel.Vec3:802
        _this.x+=p.x;
        //$LASTPOS=30000815;//kernel.Vec3:815
        _this.y+=p.y;
        //$LASTPOS=30000828;//kernel.Vec3:828
        _this.z+=p.z;
        return _this;
      },
      fiber$addX_v :function _trc_Vec3_f_addX_v(_thread,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=30000802;//kernel.Vec3:802
        _this.x+=p.x;
        //$LASTPOS=30000815;//kernel.Vec3:815
        _this.y+=p.y;
        //$LASTPOS=30000828;//kernel.Vec3:828
        _this.z+=p.z;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      subX :function _trc_Vec3_subX() {
        "use strict";
        var _this=this;
        var p;
        
        //$LASTPOS=30000881;//kernel.Vec3:881
        p = _this.parsePointArgs(arguments);
        
        //$LASTPOS=30000919;//kernel.Vec3:919
        _this.x-=p.x;
        //$LASTPOS=30000932;//kernel.Vec3:932
        _this.y-=p.y;
        //$LASTPOS=30000945;//kernel.Vec3:945
        _this.z-=p.z;
        return _this;
      },
      fiber$subX :function _trc_Vec3_f_subX(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        
        
        _thread.enter(function _trc_Vec3_ent_subX(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=30000881;//kernel.Vec3:881
              _this.fiber$parsePointArgs(_thread, _arguments);
              __pc=1;return;
            case 1:
              p=_thread.retVal;
              
              //$LASTPOS=30000919;//kernel.Vec3:919
              _this.x-=p.x;
              //$LASTPOS=30000932;//kernel.Vec3:932
              _this.y-=p.y;
              //$LASTPOS=30000945;//kernel.Vec3:945
              _this.z-=p.z;
              _thread.exit(_this);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      subX_v :function _trc_Vec3_subX_v(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30001001;//kernel.Vec3:1001
        _this.x-=p.x;
        //$LASTPOS=30001014;//kernel.Vec3:1014
        _this.y-=p.y;
        //$LASTPOS=30001027;//kernel.Vec3:1027
        _this.z-=p.z;
        return _this;
      },
      fiber$subX_v :function _trc_Vec3_f_subX_v(_thread,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=30001001;//kernel.Vec3:1001
        _this.x-=p.x;
        //$LASTPOS=30001014;//kernel.Vec3:1014
        _this.y-=p.y;
        //$LASTPOS=30001027;//kernel.Vec3:1027
        _this.z-=p.z;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      mulX :function _trc_Vec3_mulX(k) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30001083;//kernel.Vec3:1083
        _this.x=_this.x*k;
        //$LASTPOS=30001095;//kernel.Vec3:1095
        _this.y=_this.y*k;
        //$LASTPOS=30001107;//kernel.Vec3:1107
        _this.z=_this.z*k;
        return _this;
      },
      fiber$mulX :function _trc_Vec3_f_mulX(_thread,k) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=30001083;//kernel.Vec3:1083
        _this.x=_this.x*k;
        //$LASTPOS=30001095;//kernel.Vec3:1095
        _this.y=_this.y*k;
        //$LASTPOS=30001107;//kernel.Vec3:1107
        _this.z=_this.z*k;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      divX :function _trc_Vec3_divX(k) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30001160;//kernel.Vec3:1160
        _this.x=_this.x/k;
        //$LASTPOS=30001172;//kernel.Vec3:1172
        _this.y=_this.y/k;
        //$LASTPOS=30001184;//kernel.Vec3:1184
        _this.z=_this.z/k;
        return _this;
      },
      fiber$divX :function _trc_Vec3_f_divX(_thread,k) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=30001160;//kernel.Vec3:1160
        _this.x=_this.x/k;
        //$LASTPOS=30001172;//kernel.Vec3:1172
        _this.y=_this.y/k;
        //$LASTPOS=30001184;//kernel.Vec3:1184
        _this.z=_this.z/k;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      add :function _trc_Vec3_add(x,y,z) {
        "use strict";
        var _this=this;
        
        return _this.clone().addX(x,y,z);
      },
      fiber$add :function _trc_Vec3_f_add(_thread,x,y,z) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().addX(x,y,z);return;
        
        
        _thread.retVal=_this;return;
      },
      sub :function _trc_Vec3_sub(x,y,z) {
        "use strict";
        var _this=this;
        
        return _this.clone().subX(x,y,z);
      },
      fiber$sub :function _trc_Vec3_f_sub(_thread,x,y,z) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().subX(x,y,z);return;
        
        
        _thread.retVal=_this;return;
      },
      mul :function _trc_Vec3_mul(k) {
        "use strict";
        var _this=this;
        
        return _this.clone().mulX(k);
      },
      fiber$mul :function _trc_Vec3_f_mul(_thread,k) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().mulX(k);return;
        
        
        _thread.retVal=_this;return;
      },
      div :function _trc_Vec3_div(k) {
        "use strict";
        var _this=this;
        
        return _this.clone().divX(k);
      },
      fiber$div :function _trc_Vec3_f_div(_thread,k) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().divX(k);return;
        
        
        _thread.retVal=_this;return;
      },
      clone :function _trc_Vec3_clone() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.Vec3(_this.x,_this.y,_this.z);
      },
      fiber$clone :function _trc_Vec3_f_clone(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=new Tonyu.classes.kernel.Vec3(_this.x,_this.y,_this.z);return;
        
        
        _thread.retVal=_this;return;
      },
      set :function _trc_Vec3_set(x,y,z) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30003163;//kernel.Vec3:3163
        if (typeof  x==="object") {
          //$LASTPOS=30003199;//kernel.Vec3:3199
          y=x.y;
          //$LASTPOS=30003215;//kernel.Vec3:3215
          z=x.z;
          //$LASTPOS=30003231;//kernel.Vec3:3231
          x=x.x;
          
        }
        //$LASTPOS=30003250;//kernel.Vec3:3250
        if (typeof  x==="number") {
          //$LASTPOS=30003275;//kernel.Vec3:3275
          _this.x=x;
        }
        //$LASTPOS=30003290;//kernel.Vec3:3290
        if (typeof  y==="number") {
          //$LASTPOS=30003315;//kernel.Vec3:3315
          _this.y=y;
        }
        //$LASTPOS=30003330;//kernel.Vec3:3330
        if (typeof  z==="number") {
          //$LASTPOS=30003355;//kernel.Vec3:3355
          _this.z=z;
        }
        return _this;
      },
      fiber$set :function _trc_Vec3_f_set(_thread,x,y,z) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=30003163;//kernel.Vec3:3163
        if (typeof  x==="object") {
          //$LASTPOS=30003199;//kernel.Vec3:3199
          y=x.y;
          //$LASTPOS=30003215;//kernel.Vec3:3215
          z=x.z;
          //$LASTPOS=30003231;//kernel.Vec3:3231
          x=x.x;
          
        }
        //$LASTPOS=30003250;//kernel.Vec3:3250
        if (typeof  x==="number") {
          //$LASTPOS=30003275;//kernel.Vec3:3275
          _this.x=x;
        }
        //$LASTPOS=30003290;//kernel.Vec3:3290
        if (typeof  y==="number") {
          //$LASTPOS=30003315;//kernel.Vec3:3315
          _this.y=y;
        }
        //$LASTPOS=30003330;//kernel.Vec3:3330
        if (typeof  z==="number") {
          //$LASTPOS=30003355;//kernel.Vec3:3355
          _this.z=z;
        }
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      setTo :function _trc_Vec3_setTo(t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30001587;//kernel.Vec3:1587
        t.x=_this.x;
        //$LASTPOS=30001599;//kernel.Vec3:1599
        t.y=_this.y;
        //$LASTPOS=30001611;//kernel.Vec3:1611
        t.z=_this.z;
      },
      fiber$setTo :function _trc_Vec3_f_setTo(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=30001587;//kernel.Vec3:1587
        t.x=_this.x;
        //$LASTPOS=30001599;//kernel.Vec3:1599
        t.y=_this.y;
        //$LASTPOS=30001611;//kernel.Vec3:1611
        t.z=_this.z;
        
        _thread.retVal=_this;return;
      },
      addTo :function _trc_Vec3_addTo(t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=30001639;//kernel.Vec3:1639
        t.x+=_this.x;
        //$LASTPOS=30001652;//kernel.Vec3:1652
        t.y+=_this.y;
        //$LASTPOS=30001665;//kernel.Vec3:1665
        t.z+=_this.z;
      },
      fiber$addTo :function _trc_Vec3_f_addTo(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=30001639;//kernel.Vec3:1639
        t.x+=_this.x;
        //$LASTPOS=30001652;//kernel.Vec3:1652
        t.y+=_this.y;
        //$LASTPOS=30001665;//kernel.Vec3:1665
        t.z+=_this.z;
        
        _thread.retVal=_this;return;
      },
      dist :function _trc_Vec3_dist(vec) {
        "use strict";
        var _this=this;
        var dx;
        var dy;
        var dz;
        
        //$LASTPOS=30001695;//kernel.Vec3:1695
        if (vec) {
          //$LASTPOS=30001715;//kernel.Vec3:1715
          dx = vec.x-_this.x;
          
          //$LASTPOS=30001740;//kernel.Vec3:1740
          dy = vec.y-_this.y;
          
          //$LASTPOS=30001765;//kernel.Vec3:1765
          dz = vec.z-_this.z;
          
          return _this.sqrt(dx*dx+dy*dy+dz*dz);
          
        }
        return _this.sqrt(_this.x*_this.x+_this.y*_this.y+_this.z*_this.z);
      },
      __getter__length :function _trc_Vec3___getter__length() {
        "use strict";
        var _this=this;
        
        return _this.sqrt(_this.x*_this.x+_this.y*_this.y+_this.z*_this.z);
      },
      __setter__length :function _trc_Vec3___setter__length(l) {
        "use strict";
        var _this=this;
        
        return _this.normalizeX(l);
      },
      lerp :function _trc_Vec3_lerp(to,t) {
        "use strict";
        var _this=this;
        
        return _this.mul(1-t).addX_v(to.mul(t));
      },
      fiber$lerp :function _trc_Vec3_f_lerp(_thread,to,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.mul(1-t).addX_v(to.mul(t));return;
        
        
        _thread.retVal=_this;return;
      },
      slerp :function _trc_Vec3_slerp(to,t) {
        "use strict";
        var _this=this;
        
        return _this.mul(1-t).addX_v(to.mul(t));
      },
      fiber$slerp :function _trc_Vec3_f_slerp(_thread,to,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.mul(1-t).addX_v(to.mul(t));return;
        
        
        _thread.retVal=_this;return;
      },
      normalizeX :function _trc_Vec3_normalizeX(len) {
        "use strict";
        var _this=this;
        var l;
        
        //$LASTPOS=30002121;//kernel.Vec3:2121
        l = _this.length;
        
        //$LASTPOS=30002137;//kernel.Vec3:2137
        if (l==0) {
          return _this;
        }
        //$LASTPOS=30002162;//kernel.Vec3:2162
        len=(typeof  len==="number")?len:1;
        //$LASTPOS=30002202;//kernel.Vec3:2202
        _this.x*=len/l;
        //$LASTPOS=30002217;//kernel.Vec3:2217
        _this.y*=len/l;
        //$LASTPOS=30002232;//kernel.Vec3:2232
        _this.z*=len/l;
        return _this;
      },
      fiber$normalizeX :function _trc_Vec3_f_normalizeX(_thread,len) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var l;
        
        //$LASTPOS=30002121;//kernel.Vec3:2121
        l = _this.length;
        
        //$LASTPOS=30002137;//kernel.Vec3:2137
        if (l==0) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=30002162;//kernel.Vec3:2162
        len=(typeof  len==="number")?len:1;
        //$LASTPOS=30002202;//kernel.Vec3:2202
        _this.x*=len/l;
        //$LASTPOS=30002217;//kernel.Vec3:2217
        _this.y*=len/l;
        //$LASTPOS=30002232;//kernel.Vec3:2232
        _this.z*=len/l;
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      normalize :function _trc_Vec3_normalize(len) {
        "use strict";
        var _this=this;
        
        return _this.clone().normalizeX(len);
      },
      fiber$normalize :function _trc_Vec3_f_normalize(_thread,len) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().normalizeX(len);return;
        
        
        _thread.retVal=_this;return;
      },
      productX :function _trc_Vec3_productX() {
        "use strict";
        var _this=this;
        var a;
        var b;
        var i;
        var j;
        var k;
        
        //$LASTPOS=30002365;//kernel.Vec3:2365
        a = _this;
        
        //$LASTPOS=30002382;//kernel.Vec3:2382
        b = _this.parsePointArgs(arguments);
        
        //$LASTPOS=30002420;//kernel.Vec3:2420
        i = a.y*b.z-a.z*b.y;
        
        //$LASTPOS=30002448;//kernel.Vec3:2448
        j = a.z*b.x-a.x*b.z;
        
        //$LASTPOS=30002476;//kernel.Vec3:2476
        k = a.x*b.y-a.y*b.x;
        
        //$LASTPOS=30002504;//kernel.Vec3:2504
        a.x=i;
        //$LASTPOS=30002516;//kernel.Vec3:2516
        a.y=j;
        //$LASTPOS=30002528;//kernel.Vec3:2528
        a.z=k;
        //$LASTPOS=30002540;//kernel.Vec3:2540
        if (Tonyu.globals.$fixProductOrder) {
          return a;
        }
        return a.mul(- 1);
      },
      fiber$productX :function _trc_Vec3_f_productX(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var b;
        var i;
        var j;
        var k;
        
        //$LASTPOS=30002365;//kernel.Vec3:2365
        a = _this;
        
        
        _thread.enter(function _trc_Vec3_ent_productX(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=30002382;//kernel.Vec3:2382
              _this.fiber$parsePointArgs(_thread, _arguments);
              __pc=1;return;
            case 1:
              b=_thread.retVal;
              
              //$LASTPOS=30002420;//kernel.Vec3:2420
              i = a.y*b.z-a.z*b.y;
              
              //$LASTPOS=30002448;//kernel.Vec3:2448
              j = a.z*b.x-a.x*b.z;
              
              //$LASTPOS=30002476;//kernel.Vec3:2476
              k = a.x*b.y-a.y*b.x;
              
              //$LASTPOS=30002504;//kernel.Vec3:2504
              a.x=i;
              //$LASTPOS=30002516;//kernel.Vec3:2516
              a.y=j;
              //$LASTPOS=30002528;//kernel.Vec3:2528
              a.z=k;
              //$LASTPOS=30002540;//kernel.Vec3:2540
              if (!(Tonyu.globals.$fixProductOrder)) { __pc=2     ; break; }
              _thread.exit(a);return;
            case 2     :
              
              _thread.exit(a.mul(- 1));return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      product :function _trc_Vec3_product(x,y,z) {
        "use strict";
        var _this=this;
        
        return _this.clone().productX(x,y,z);
      },
      fiber$product :function _trc_Vec3_f_product(_thread,x,y,z) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.clone().productX(x,y,z);return;
        
        
        _thread.retVal=_this;return;
      },
      innerProduct :function _trc_Vec3_innerProduct() {
        "use strict";
        var _this=this;
        var a;
        
        //$LASTPOS=30002681;//kernel.Vec3:2681
        a = _this.parsePointArgs(arguments);
        
        return _this.x*a.x+_this.y*a.y+_this.z*a.z;
      },
      fiber$innerProduct :function _trc_Vec3_f_innerProduct(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        
        
        _thread.enter(function _trc_Vec3_ent_innerProduct(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=30002681;//kernel.Vec3:2681
              _this.fiber$parsePointArgs(_thread, _arguments);
              __pc=1;return;
            case 1:
              a=_thread.retVal;
              
              _thread.exit(_this.x*a.x+_this.y*a.y+_this.z*a.z);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __getter__angleXY :function _trc_Vec3___getter__angleXY() {
        "use strict";
        var _this=this;
        
        return _this.atanxy(_this.x,_this.y);
      },
      __setter__angleXY :function _trc_Vec3___setter__angleXY(a) {
        "use strict";
        var _this=this;
        var l;
        
        //$LASTPOS=30002807;//kernel.Vec3:2807
        l = Tonyu.globals.$Math.sqrt(_this.x*_this.x+_this.y*_this.y);
        
        //$LASTPOS=30002839;//kernel.Vec3:2839
        _this.x=_this.cos(a)*l;
        //$LASTPOS=30002856;//kernel.Vec3:2856
        _this.y=_this.sin(a)*l;
        return a;
      },
      rotate :function _trc_Vec3_rotate(angle,axis) {
        "use strict";
        var _this=this;
        var v90;
        
        //$LASTPOS=30002917;//kernel.Vec3:2917
        if (! axis) {
          //$LASTPOS=30002928;//kernel.Vec3:2928
          axis=new Tonyu.classes.kernel.Vec3(0,0,Tonyu.globals.$fixProductOrder?- 1:1);
        }
        //$LASTPOS=30002975;//kernel.Vec3:2975
        v90 = _this.product(axis);
        
        //$LASTPOS=30003003;//kernel.Vec3:3003
        v90.length=_this.length;
        return _this.mul(_this.cos(angle)).add(v90.mul(_this.sin(angle)));
      },
      fiber$rotate :function _trc_Vec3_f_rotate(_thread,angle,axis) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var v90;
        
        //$LASTPOS=30002917;//kernel.Vec3:2917
        if (! axis) {
          //$LASTPOS=30002928;//kernel.Vec3:2928
          axis=new Tonyu.classes.kernel.Vec3(0,0,Tonyu.globals.$fixProductOrder?- 1:1);
        }
        
        _thread.enter(function _trc_Vec3_ent_rotate(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=30002975;//kernel.Vec3:2975
              _this.fiber$product(_thread, axis);
              __pc=1;return;
            case 1:
              v90=_thread.retVal;
              
              //$LASTPOS=30003003;//kernel.Vec3:3003
              v90.length=_this.length;
              _thread.exit(_this.mul(_this.cos(angle)).add(v90.mul(_this.sin(angle))));return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      rotateX :function _trc_Vec3_rotateX(angle,axis) {
        "use strict";
        var _this=this;
        
        return _this.set(_this.rotate(angle,axis));
      },
      fiber$rotateX :function _trc_Vec3_f_rotateX(_thread,angle,axis) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Vec3_ent_rotateX(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$set(_thread, _this.rotate(angle,axis));
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      toString :function _trc_Vec3_toString() {
        "use strict";
        var _this=this;
        
        return "("+[_this.x,_this.y,_this.z].join(",")+")";
      },
      fiber$toString :function _trc_Vec3_f_toString(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal="("+[_this.x,_this.y,_this.z].join(",")+")";return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"checkNum":{"nowait":false},"parsePointArgs":{"nowait":false},"addX":{"nowait":false},"addX_v":{"nowait":false},"subX":{"nowait":false},"subX_v":{"nowait":false},"mulX":{"nowait":false},"divX":{"nowait":false},"add":{"nowait":false},"sub":{"nowait":false},"mul":{"nowait":false},"div":{"nowait":false},"clone":{"nowait":false},"set":{"nowait":false},"setTo":{"nowait":false},"addTo":{"nowait":false},"dist":{"nowait":true},"__getter__length":{"nowait":true},"__setter__length":{"nowait":true},"lerp":{"nowait":false},"slerp":{"nowait":false},"normalizeX":{"nowait":false},"normalize":{"nowait":false},"productX":{"nowait":false},"product":{"nowait":false},"innerProduct":{"nowait":false},"__getter__angleXY":{"nowait":true},"__setter__angleXY":{"nowait":true},"rotate":{"nowait":false},"rotateX":{"nowait":false},"toString":{"nowait":false}},"fields":{"z":{},"Vector":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Vec3View',
  shortName: 'Vec3View',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Vec3,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Vec3View_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Vec3View_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Vec3View_initialize(target,attrs) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=31000060;//kernel.Vec3View:60
        _this.target=target;
        //$LASTPOS=31000085;//kernel.Vec3View:85
        _this.attrs=attrs||{x: "x",y: "y",z: "z"};
      },
      __getter__x :function _trc_Vec3View___getter__x() {
        "use strict";
        var _this=this;
        
        return _this.target[_this.attrs.x]||0;
      },
      __getter__y :function _trc_Vec3View___getter__y() {
        "use strict";
        var _this=this;
        
        return _this.target[_this.attrs.y]||0;
      },
      __getter__z :function _trc_Vec3View___getter__z() {
        "use strict";
        var _this=this;
        
        return _this.target[_this.attrs.z]||0;
      },
      __setter__x :function _trc_Vec3View___setter__x(v) {
        "use strict";
        var _this=this;
        
        return _this.target[_this.attrs.x]=v;
      },
      __setter__y :function _trc_Vec3View___setter__y(v) {
        "use strict";
        var _this=this;
        
        return _this.target[_this.attrs.y]=v;
      },
      __setter__z :function _trc_Vec3View___setter__z(v) {
        "use strict";
        var _this=this;
        
        return _this.target[_this.attrs.z]=v;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"__getter__x":{"nowait":true},"__getter__y":{"nowait":true},"__getter__z":{"nowait":true},"__setter__x":{"nowait":true},"__setter__y":{"nowait":true},"__setter__z":{"nowait":true}},"fields":{"target":{},"attrs":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ActorTouchStart',
  shortName: 'ActorTouchStart',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.EventHandler,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ActorTouchStart_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=32000025;//kernel.ActorTouchStart:25
        "field strict";
      },
      fiber$main :function _trc_ActorTouchStart_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=32000025;//kernel.ActorTouchStart:25
        "field strict";
        
        _thread.retVal=_this;return;
      },
      newListener :function _trc_ActorTouchStart_newListener(f) {
        "use strict";
        var _this=this;
        var ts;
        
        //$LASTPOS=32000096;//kernel.ActorTouchStart:96
        ts = Tonyu.globals.$Screen.multiLayerTouches;
        
        //$LASTPOS=32000135;//kernel.ActorTouchStart:135
        ts.add(_this.target);
        return {dispose: (function anonymous_183() {
          
          //$LASTPOS=32000199;//kernel.ActorTouchStart:199
          ts.remove(_this.target);
        })};
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"newListener":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.AnimMod',
  shortName: 'AnimMod',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.SpriteMod,Tonyu.classes.kernel.SchedulerMod,Tonyu.classes.kernel.ParallelMod],
  methods: function (__superClass) {
    return {
      main :function _trc_AnimMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=33000061;//kernel.AnimMod:61
        "field strict";
        
      },
      fiber$main :function _trc_AnimMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=33000061;//kernel.AnimMod:61
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initAnimMod :function _trc_AnimMod_initAnimMod() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=33000139;//kernel.AnimMod:139
        if (_this.anim instanceof Array) {
          //$LASTPOS=33000176;//kernel.AnimMod:176
          _this.startAnim();
          
        } else {
          //$LASTPOS=33000210;//kernel.AnimMod:210
          _this.animMode=false;
          
        }
        //$LASTPOS=33000238;//kernel.AnimMod:238
        if (_this.animFps==null) {
          //$LASTPOS=33000257;//kernel.AnimMod:257
          _this.animFps=1;
        }
      },
      fiber$initAnimMod :function _trc_AnimMod_f_initAnimMod(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=33000139;//kernel.AnimMod:139
        if (_this.anim instanceof Array) {
          //$LASTPOS=33000176;//kernel.AnimMod:176
          _this.startAnim();
          
        } else {
          //$LASTPOS=33000210;//kernel.AnimMod:210
          _this.animMode=false;
          
        }
        //$LASTPOS=33000238;//kernel.AnimMod:238
        if (_this.animFps==null) {
          //$LASTPOS=33000257;//kernel.AnimMod:257
          _this.animFps=1;
        }
        
        _thread.retVal=_this;return;
      },
      setAnimFps :function _trc_AnimMod_setAnimFps(f) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=33000300;//kernel.AnimMod:300
        _this.animFps=f;
        //$LASTPOS=33000316;//kernel.AnimMod:316
        _this.animFrame=0;
        //$LASTPOS=33000334;//kernel.AnimMod:334
        _this.startAnim();
      },
      startAnim :function _trc_AnimMod_startAnim() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=33000377;//kernel.AnimMod:377
        if (! _this.animMode) {
          //$LASTPOS=33000403;//kernel.AnimMod:403
          _this.animMode=_this.parallel(Tonyu.bindFunc(_this,_this._animation));
          //$LASTPOS=33000443;//kernel.AnimMod:443
          _this.animFrame=_this.animFrame||0;
          
        }
      },
      stopAnim :function _trc_AnimMod_stopAnim() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=33000503;//kernel.AnimMod:503
        if (_this.animMode) {
          //$LASTPOS=33000528;//kernel.AnimMod:528
          _this.animMode.kill();
          //$LASTPOS=33000554;//kernel.AnimMod:554
          _this.animMode=null;
          
        }
      },
      _animation :function _trc_AnimMod__animation() {
        "use strict";
        var _this=this;
        var age;
        
        //$LASTPOS=33000600;//kernel.AnimMod:600
        age = 0;
        
        //$LASTPOS=33000616;//kernel.AnimMod:616
        while (true) {
          //$LASTPOS=33000639;//kernel.AnimMod:639
          age++;
          //$LASTPOS=33000655;//kernel.AnimMod:655
          if (age%_this.animFps==0&&_this.anim instanceof Array) {
            //$LASTPOS=33000714;//kernel.AnimMod:714
            _this.p=_this.anim[_this.animFrame%_this.anim.length];
            //$LASTPOS=33000758;//kernel.AnimMod:758
            _this.animFrame++;
            
          }
          //$LASTPOS=33000791;//kernel.AnimMod:791
          _this.update();
          
        }
      },
      fiber$_animation :function _trc_AnimMod_f__animation(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var age;
        
        //$LASTPOS=33000600;//kernel.AnimMod:600
        age = 0;
        
        
        _thread.enter(function _trc_AnimMod_ent__animation(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=33000616;//kernel.AnimMod:616
            case 1:
              //$LASTPOS=33000639;//kernel.AnimMod:639
              age++;
              //$LASTPOS=33000655;//kernel.AnimMod:655
              if (age%_this.animFps==0&&_this.anim instanceof Array) {
                //$LASTPOS=33000714;//kernel.AnimMod:714
                _this.p=_this.anim[_this.animFrame%_this.anim.length];
                //$LASTPOS=33000758;//kernel.AnimMod:758
                _this.animFrame++;
                
              }
              //$LASTPOS=33000791;//kernel.AnimMod:791
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initAnimMod":{"nowait":false},"setAnimFps":{"nowait":true},"startAnim":{"nowait":true},"stopAnim":{"nowait":true},"_animation":{"nowait":false}},"fields":{"anim":{},"animMode":{},"animFrame":{},"animFps":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Color',
  shortName: 'Color',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Color_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Color_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Color_initialize() {
        "use strict";
        var _this=this;
        var a;
        var s;
        var rgba;
        var p;
        var x;
        var y;
        
        //$LASTPOS=34000061;//kernel.Color:61
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        
        
        //$LASTPOS=34000116;//kernel.Color:116
        _this.maxs={r: 255,g: 255,b: 255,a: 255,h: 360,s: 1,l: 1};
        //$LASTPOS=34000164;//kernel.Color:164
        p = a.peek(0);
        
        //$LASTPOS=34000183;//kernel.Color:183
        if (p&&p.height&&p.width&&p.data) {
          //$LASTPOS=34000228;//kernel.Color:228
          _this.imageData=a.shift();
          //$LASTPOS=34000252;//kernel.Color:252
          x = a.shift();
          
          //$LASTPOS=34000272;//kernel.Color:272
          y = a.shift();
          
          //$LASTPOS=34000292;//kernel.Color:292
          _this.index=(x+y*p.width)*4;
          //$LASTPOS=34000318;//kernel.Color:318
          _this.value={};
          return _this;
          
        }
        //$LASTPOS=34000345;//kernel.Color:345
        if (s=a.shift("string")) {
          //$LASTPOS=34000375;//kernel.Color:375
          _this.type="name";
          //$LASTPOS=34000391;//kernel.Color:391
          _this.value={name: s};
          
        } else {
          //$LASTPOS=34000416;//kernel.Color:416
          if (s=a.shift("object")) {
            //$LASTPOS=34000446;//kernel.Color:446
            if (typeof  s.r=="number") {
              //$LASTPOS=34000478;//kernel.Color:478
              _this.type="rgba";
              //$LASTPOS=34000495;//kernel.Color:495
              _this.value=s;
              //$LASTPOS=34000508;//kernel.Color:508
              _this.fillNum("g","b","a");
              
            } else {
              //$LASTPOS=34000540;//kernel.Color:540
              if (typeof  s.h=="number") {
                //$LASTPOS=34000572;//kernel.Color:572
                _this.type="hsl";
                //$LASTPOS=34000588;//kernel.Color:588
                _this.value=s;
                //$LASTPOS=34000601;//kernel.Color:601
                _this.fillNum("s","l","a");
                
              } else {
                throw new Error("Invalid color spec");
                
                
              }
            }
            
          } else {
            //$LASTPOS=34000692;//kernel.Color:692
            if ((s=a.shift("number"))!=null) {
              //$LASTPOS=34000732;//kernel.Color:732
              _this.type="rgba";
              //$LASTPOS=34000748;//kernel.Color:748
              _this.value={r: s};
              //$LASTPOS=34000764;//kernel.Color:764
              _this.value.g=a.shift();
              //$LASTPOS=34000786;//kernel.Color:786
              _this.value.b=a.shift();
              //$LASTPOS=34000808;//kernel.Color:808
              _this.value.a=a.shift();
              //$LASTPOS=34000830;//kernel.Color:830
              _this.fillNum("g","b","a");
              
            } else {
              throw new Error("Invalid color spec");
              
              
            }
          }
        }
      },
      fillNum :function _trc_Color_fillNum() {
        "use strict";
        var _this=this;
        var a;
        var k;
        var _it_260;
        
        //$LASTPOS=34000928;//kernel.Color:928
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=34000962;//kernel.Color:962
        _it_260=Tonyu.iterator(a.toArray(),1);
        while(_it_260.next()) {
          k=_it_260[0];
          
          //$LASTPOS=34000994;//kernel.Color:994
          if (_this.value[k]==null) {
            //$LASTPOS=34001014;//kernel.Color:1014
            _this.value[k]=(k=="a"?_this.maxs.a:0);
          }
          
        }
      },
      fiber$fillNum :function _trc_Color_f_fillNum(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var k;
        var _it_260;
        
        //$LASTPOS=34000928;//kernel.Color:928
        a = new Tonyu.classes.kernel.ArgParser(_arguments);
        
        //$LASTPOS=34000962;//kernel.Color:962
        _it_260=Tonyu.iterator(a.toArray(),1);
        while(_it_260.next()) {
          k=_it_260[0];
          
          //$LASTPOS=34000994;//kernel.Color:994
          if (_this.value[k]==null) {
            //$LASTPOS=34001014;//kernel.Color:1014
            _this.value[k]=(k=="a"?_this.maxs.a:0);
          }
          
        }
        
        _thread.retVal=_this;return;
      },
      __getter__r :function _trc_Color___getter__r() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001057;//kernel.Color:1057
        _this.makeRGBA();
        //$LASTPOS=34001071;//kernel.Color:1071
        if (_this.imageData) {
          return _this.imageData.data[_this.index];
        }
        return _this.value.r;
      },
      __getter__g :function _trc_Color___getter__g() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001145;//kernel.Color:1145
        _this.makeRGBA();
        //$LASTPOS=34001159;//kernel.Color:1159
        if (_this.imageData) {
          return _this.imageData.data[_this.index+1];
        }
        return _this.value.g;
      },
      __getter__b :function _trc_Color___getter__b() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001235;//kernel.Color:1235
        _this.makeRGBA();
        //$LASTPOS=34001249;//kernel.Color:1249
        if (_this.imageData) {
          return _this.imageData.data[_this.index+2];
        }
        return _this.value.b;
      },
      __getter__a :function _trc_Color___getter__a() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001325;//kernel.Color:1325
        if (_this.imageData) {
          return _this.imageData.data[_this.index+3];
        }
        return _this.value.a;
      },
      __setter__a :function _trc_Color___setter__a(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001403;//kernel.Color:1403
        _this.clearName();
        //$LASTPOS=34001418;//kernel.Color:1418
        v=_this.clamp(v,0,_this.maxs.a);
        //$LASTPOS=34001441;//kernel.Color:1441
        if (_this.imageData) {
          //$LASTPOS=34001456;//kernel.Color:1456
          _this.imageData.data[_this.index+3]=v;
        } else {
          //$LASTPOS=34001490;//kernel.Color:1490
          _this.value.a=v;
        }
      },
      __setter__r :function _trc_Color___setter__r(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001516;//kernel.Color:1516
        _this.makeRGBA();
        //$LASTPOS=34001530;//kernel.Color:1530
        _this.clearName();
        //$LASTPOS=34001545;//kernel.Color:1545
        _this.clearHSLA();
        //$LASTPOS=34001560;//kernel.Color:1560
        v=_this.clamp(v,0,_this.maxs.r);
        //$LASTPOS=34001583;//kernel.Color:1583
        if (_this.imageData) {
          //$LASTPOS=34001598;//kernel.Color:1598
          _this.imageData.data[_this.index]=v;
        } else {
          //$LASTPOS=34001630;//kernel.Color:1630
          _this.value.r=v;
        }
      },
      __setter__g :function _trc_Color___setter__g(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001654;//kernel.Color:1654
        _this.makeRGBA();
        //$LASTPOS=34001668;//kernel.Color:1668
        _this.clearName();
        //$LASTPOS=34001683;//kernel.Color:1683
        _this.clearHSLA();
        //$LASTPOS=34001698;//kernel.Color:1698
        v=_this.clamp(v,0,_this.maxs.g);
        //$LASTPOS=34001721;//kernel.Color:1721
        if (_this.imageData) {
          //$LASTPOS=34001736;//kernel.Color:1736
          _this.imageData.data[_this.index+1]=v;
        }
        //$LASTPOS=34001765;//kernel.Color:1765
        _this.value.g=v;
      },
      __setter__b :function _trc_Color___setter__b(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001789;//kernel.Color:1789
        _this.makeRGBA();
        //$LASTPOS=34001803;//kernel.Color:1803
        _this.clearName();
        //$LASTPOS=34001818;//kernel.Color:1818
        _this.clearHSLA();
        //$LASTPOS=34001833;//kernel.Color:1833
        v=_this.clamp(v,0,_this.maxs.b);
        //$LASTPOS=34001856;//kernel.Color:1856
        if (_this.imageData) {
          //$LASTPOS=34001871;//kernel.Color:1871
          _this.imageData.data[_this.index+2]=v;
        }
        //$LASTPOS=34001900;//kernel.Color:1900
        _this.value.b=v;
      },
      __getter__h :function _trc_Color___getter__h() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001924;//kernel.Color:1924
        _this.makeHSLA();
        return _this.value.h;
      },
      __getter__s :function _trc_Color___getter__s() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34001965;//kernel.Color:1965
        _this.makeHSLA();
        return _this.value.s;
      },
      __getter__l :function _trc_Color___getter__l() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34002006;//kernel.Color:2006
        _this.makeHSLA();
        return _this.value.l;
      },
      __setter__h :function _trc_Color___setter__h(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34002049;//kernel.Color:2049
        _this.makeHSLA();
        //$LASTPOS=34002063;//kernel.Color:2063
        _this.clearName();
        //$LASTPOS=34002078;//kernel.Color:2078
        _this.value.h=_this.amod(v,360);
        //$LASTPOS=34002101;//kernel.Color:2101
        if (_this.imageData) {
          //$LASTPOS=34002116;//kernel.Color:2116
          _this.makeRGBA(true);
        } else {
          //$LASTPOS=34002139;//kernel.Color:2139
          _this.clearRGBA();
        }
      },
      __setter__s :function _trc_Color___setter__s(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34002165;//kernel.Color:2165
        _this.makeHSLA();
        //$LASTPOS=34002179;//kernel.Color:2179
        _this.clearName();
        //$LASTPOS=34002194;//kernel.Color:2194
        _this.value.s=_this.clamp(v,0,_this.maxs.s);
        //$LASTPOS=34002223;//kernel.Color:2223
        if (_this.imageData) {
          //$LASTPOS=34002238;//kernel.Color:2238
          _this.makeRGBA(true);
        } else {
          //$LASTPOS=34002261;//kernel.Color:2261
          _this.clearRGBA();
        }
      },
      __setter__l :function _trc_Color___setter__l(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34002287;//kernel.Color:2287
        _this.makeHSLA();
        //$LASTPOS=34002301;//kernel.Color:2301
        _this.clearName();
        //$LASTPOS=34002316;//kernel.Color:2316
        _this.value.l=_this.clamp(v,0,_this.maxs.l);
        //$LASTPOS=34002345;//kernel.Color:2345
        if (_this.imageData) {
          //$LASTPOS=34002360;//kernel.Color:2360
          _this.makeRGBA(true);
        } else {
          //$LASTPOS=34002383;//kernel.Color:2383
          _this.clearRGBA();
        }
      },
      setHSLA :function _trc_Color_setHSLA(h,s,l,a) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34002422;//kernel.Color:2422
        _this.value.h=h;
        //$LASTPOS=34002435;//kernel.Color:2435
        _this.value.s=s;
        //$LASTPOS=34002448;//kernel.Color:2448
        _this.value.l=l;
        //$LASTPOS=34002461;//kernel.Color:2461
        if (typeof  a==="number") {
          //$LASTPOS=34002490;//kernel.Color:2490
          if (_this.imageData) {
            //$LASTPOS=34002511;//kernel.Color:2511
            _this.imageData.data[_this.index+3]=a;
            
          } else {
            //$LASTPOS=34002548;//kernel.Color:2548
            _this.value.a=a;
          }
          
        }
        //$LASTPOS=34002565;//kernel.Color:2565
        if (_this.imageData) {
          //$LASTPOS=34002580;//kernel.Color:2580
          _this.makeRGBA(true);
        } else {
          //$LASTPOS=34002603;//kernel.Color:2603
          _this.clearRGBA();
        }
        return true;
      },
      fiber$setHSLA :function _trc_Color_f_setHSLA(_thread,h,s,l,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=34002422;//kernel.Color:2422
        _this.value.h=h;
        //$LASTPOS=34002435;//kernel.Color:2435
        _this.value.s=s;
        //$LASTPOS=34002448;//kernel.Color:2448
        _this.value.l=l;
        //$LASTPOS=34002461;//kernel.Color:2461
        if (typeof  a==="number") {
          //$LASTPOS=34002490;//kernel.Color:2490
          if (_this.imageData) {
            //$LASTPOS=34002511;//kernel.Color:2511
            _this.imageData.data[_this.index+3]=a;
            
          } else {
            //$LASTPOS=34002548;//kernel.Color:2548
            _this.value.a=a;
          }
          
        }
        
        _thread.enter(function _trc_Color_ent_setHSLA(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=34002565;//kernel.Color:2565
              if (!(_this.imageData)) { __pc=2     ; break; }
              //$LASTPOS=34002580;//kernel.Color:2580
              _this.fiber$makeRGBA(_thread, true);
              __pc=1;return;
            case 1:
              
              __pc=4     ;break;
            case 2     :
              //$LASTPOS=34002603;//kernel.Color:2603
              _this.fiber$clearRGBA(_thread);
              __pc=3;return;
            case 3:
              
            case 4     :
              
              _thread.exit(true);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      setRGBA :function _trc_Color_setRGBA(r,g,b,a) {
        "use strict";
        var _this=this;
        var n;
        var i;
        
        //$LASTPOS=34002657;//kernel.Color:2657
        if (_this.imageData) {
          //$LASTPOS=34002677;//kernel.Color:2677
          n = ((typeof  a==="number")?4:3);
          
          //$LASTPOS=34002715;//kernel.Color:2715
          //$LASTPOS=34002719;//kernel.Color:2719
          i = 0;
          for (; i<n ; i++) {
            //$LASTPOS=34002736;//kernel.Color:2736
            _this.imageData.data[_this.index+i]=[r,g,b,a][i];
          }
          
        } else {
          //$LASTPOS=34002788;//kernel.Color:2788
          _this.value.r=r;
          //$LASTPOS=34002802;//kernel.Color:2802
          _this.value.g=g;
          //$LASTPOS=34002816;//kernel.Color:2816
          _this.value.b=b;
          //$LASTPOS=34002830;//kernel.Color:2830
          if (typeof  a==="number") {
            //$LASTPOS=34002854;//kernel.Color:2854
            _this.value.a=a;
          }
          //$LASTPOS=34002868;//kernel.Color:2868
          _this.clearHSLA();
          //$LASTPOS=34002884;//kernel.Color:2884
          _this.clearName();
          
        }
      },
      fiber$setRGBA :function _trc_Color_f_setRGBA(_thread,r,g,b,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var n;
        var i;
        
        
        _thread.enter(function _trc_Color_ent_setRGBA(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=34002657;//kernel.Color:2657
              if (!(_this.imageData)) { __pc=1     ; break; }
              {
                //$LASTPOS=34002677;//kernel.Color:2677
                n = ((typeof  a==="number")?4:3);
                
                //$LASTPOS=34002715;//kernel.Color:2715
                //$LASTPOS=34002719;//kernel.Color:2719
                i = 0;
                for (; i<n ; i++) {
                  //$LASTPOS=34002736;//kernel.Color:2736
                  _this.imageData.data[_this.index+i]=[r,g,b,a][i];
                }
              }
              __pc=4     ;break;
            case 1     :
              //$LASTPOS=34002788;//kernel.Color:2788
              _this.value.r=r;
              //$LASTPOS=34002802;//kernel.Color:2802
              _this.value.g=g;
              //$LASTPOS=34002816;//kernel.Color:2816
              _this.value.b=b;
              //$LASTPOS=34002830;//kernel.Color:2830
              if (typeof  a==="number") {
                //$LASTPOS=34002854;//kernel.Color:2854
                _this.value.a=a;
              }
              //$LASTPOS=34002868;//kernel.Color:2868
              _this.fiber$clearHSLA(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=34002884;//kernel.Color:2884
              _this.fiber$clearName(_thread);
              __pc=3;return;
            case 3:
              
            case 4     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      hasRGBA :function _trc_Color_hasRGBA() {
        "use strict";
        var _this=this;
        
        return _this.imageData||typeof  (_this.value.r)==="number";
      },
      fiber$hasRGBA :function _trc_Color_f_hasRGBA(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.imageData||typeof  (_this.value.r)==="number";return;
        
        
        _thread.retVal=_this;return;
      },
      hasHSLA :function _trc_Color_hasHSLA() {
        "use strict";
        var _this=this;
        
        return typeof  (_this.value.h)==="number";
      },
      fiber$hasHSLA :function _trc_Color_f_hasHSLA(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=typeof  (_this.value.h)==="number";return;
        
        
        _thread.retVal=_this;return;
      },
      hasName :function _trc_Color_hasName() {
        "use strict";
        var _this=this;
        
        return typeof  (_this.value.name)==="string";
      },
      fiber$hasName :function _trc_Color_f_hasName(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=typeof  (_this.value.name)==="string";return;
        
        
        _thread.retVal=_this;return;
      },
      clearRGBA :function _trc_Color_clearRGBA() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34003105;//kernel.Color:3105
        delete _this.value.r;
      },
      fiber$clearRGBA :function _trc_Color_f_clearRGBA(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=34003105;//kernel.Color:3105
        delete _this.value.r;
        
        _thread.retVal=_this;return;
      },
      clearHSLA :function _trc_Color_clearHSLA() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34003142;//kernel.Color:3142
        delete _this.value.h;
      },
      fiber$clearHSLA :function _trc_Color_f_clearHSLA(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=34003142;//kernel.Color:3142
        delete _this.value.h;
        
        _thread.retVal=_this;return;
      },
      clearName :function _trc_Color_clearName() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34003179;//kernel.Color:3179
        delete _this.value.name;
      },
      fiber$clearName :function _trc_Color_f_clearName(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=34003179;//kernel.Color:3179
        delete _this.value.name;
        
        _thread.retVal=_this;return;
      },
      lerpRGBA :function _trc_Color_lerpRGBA(c,t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34003221;//kernel.Color:3221
        t=t||0;
        return new Tonyu.classes.kernel.Color(_this.r*(1-t)+c.r*t,_this.g*(1-t)+c.g*t,_this.b*(1-t)+c.b*t,_this.a*(1-t)+c.a*t);
      },
      fiber$lerpRGBA :function _trc_Color_f_lerpRGBA(_thread,c,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=34003221;//kernel.Color:3221
        t=t||0;
        _thread.retVal=new Tonyu.classes.kernel.Color(_this.r*(1-t)+c.r*t,_this.g*(1-t)+c.g*t,_this.b*(1-t)+c.b*t,_this.a*(1-t)+c.a*t);return;
        
        
        _thread.retVal=_this;return;
      },
      distRGBA :function _trc_Color_distRGBA(other) {
        "use strict";
        var _this=this;
        var dr;
        var dg;
        var db;
        var da;
        
        //$LASTPOS=34003344;//kernel.Color:3344
        if (Tonyu.is(other,Tonyu.classes.kernel.Color)) {
          
          
        } else {
          //$LASTPOS=34003376;//kernel.Color:3376
          other=new Tonyu.classes.kernel.Color(other+"");
          
        }
        //$LASTPOS=34003409;//kernel.Color:3409
        dr = (_this.r/_this.maxs.r-other.r/other.maxs.r);
        
        //$LASTPOS=34003451;//kernel.Color:3451
        dg = (_this.g/_this.maxs.g-other.g/other.maxs.g);
        
        //$LASTPOS=34003493;//kernel.Color:3493
        db = (_this.b/_this.maxs.b-other.b/other.maxs.b);
        
        //$LASTPOS=34003535;//kernel.Color:3535
        da = (_this.a/_this.maxs.a-other.a/other.maxs.a);
        
        return _this.sqrt(dr*dr+dg*dg+db*db+da*da);
      },
      fiber$distRGBA :function _trc_Color_f_distRGBA(_thread,other) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var dr;
        var dg;
        var db;
        var da;
        
        //$LASTPOS=34003344;//kernel.Color:3344
        if (Tonyu.is(other,Tonyu.classes.kernel.Color)) {
          
          
        } else {
          //$LASTPOS=34003376;//kernel.Color:3376
          other=new Tonyu.classes.kernel.Color(other+"");
          
        }
        //$LASTPOS=34003409;//kernel.Color:3409
        dr = (_this.r/_this.maxs.r-other.r/other.maxs.r);
        
        //$LASTPOS=34003451;//kernel.Color:3451
        dg = (_this.g/_this.maxs.g-other.g/other.maxs.g);
        
        //$LASTPOS=34003493;//kernel.Color:3493
        db = (_this.b/_this.maxs.b-other.b/other.maxs.b);
        
        //$LASTPOS=34003535;//kernel.Color:3535
        da = (_this.a/_this.maxs.a-other.a/other.maxs.a);
        
        _thread.retVal=_this.sqrt(dr*dr+dg*dg+db*db+da*da);return;
        
        
        _thread.retVal=_this;return;
      },
      distHSLA :function _trc_Color_distHSLA(other) {
        "use strict";
        var _this=this;
        var dh;
        var ds;
        var dl;
        var da;
        
        //$LASTPOS=34003640;//kernel.Color:3640
        if (Tonyu.is(other,Tonyu.classes.kernel.Color)) {
          
          
        } else {
          //$LASTPOS=34003672;//kernel.Color:3672
          other=new Tonyu.classes.kernel.Color(other+"");
          
        }
        //$LASTPOS=34003705;//kernel.Color:3705
        dh = _this.angleDiff(_this.h,other.h)/180;
        
        //$LASTPOS=34003740;//kernel.Color:3740
        ds = (_this.s/_this.maxs.s-other.s/other.maxs.s);
        
        //$LASTPOS=34003782;//kernel.Color:3782
        dl = (_this.l/_this.maxs.l-other.l/other.maxs.l);
        
        //$LASTPOS=34003824;//kernel.Color:3824
        da = (_this.a/_this.maxs.a-other.a/other.maxs.a);
        
        return _this.sqrt(dh*dh+ds*ds+dl*dl+da*da);
      },
      fiber$distHSLA :function _trc_Color_f_distHSLA(_thread,other) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var dh;
        var ds;
        var dl;
        var da;
        
        //$LASTPOS=34003640;//kernel.Color:3640
        if (Tonyu.is(other,Tonyu.classes.kernel.Color)) {
          
          
        } else {
          //$LASTPOS=34003672;//kernel.Color:3672
          other=new Tonyu.classes.kernel.Color(other+"");
          
        }
        //$LASTPOS=34003705;//kernel.Color:3705
        dh = _this.angleDiff(_this.h,other.h)/180;
        
        //$LASTPOS=34003740;//kernel.Color:3740
        ds = (_this.s/_this.maxs.s-other.s/other.maxs.s);
        
        //$LASTPOS=34003782;//kernel.Color:3782
        dl = (_this.l/_this.maxs.l-other.l/other.maxs.l);
        
        //$LASTPOS=34003824;//kernel.Color:3824
        da = (_this.a/_this.maxs.a-other.a/other.maxs.a);
        
        _thread.retVal=_this.sqrt(dh*dh+ds*ds+dl*dl+da*da);return;
        
        
        _thread.retVal=_this;return;
      },
      makeRGBA :function _trc_Color_makeRGBA(force) {
        "use strict";
        var _this=this;
        var rgb;
        var i;
        
        //$LASTPOS=34003933;//kernel.Color:3933
        if (! force&&_this.hasRGBA()) {
          return _this;
        }
        //$LASTPOS=34003968;//kernel.Color:3968
        if (_this.hasHSLA()) {
          //$LASTPOS=34003988;//kernel.Color:3988
          rgb = _this.HSLToRGB(_this.value.h,_this.value.s,_this.value.l);
          
          //$LASTPOS=34004034;//kernel.Color:4034
          if (_this.imageData) {
            //$LASTPOS=34004055;//kernel.Color:4055
            //$LASTPOS=34004059;//kernel.Color:4059
            i = 0;
            for (; i<3 ; i++) {
              //$LASTPOS=34004076;//kernel.Color:4076
              _this.imageData.data[_this.index+i]=rgb[i]*_this.maxs.r;
            }
            
          } else {
            //$LASTPOS=34004170;//kernel.Color:4170
            _this.value.r=rgb[0]*_this.maxs.r;
            //$LASTPOS=34004197;//kernel.Color:4197
            _this.value.g=rgb[1]*_this.maxs.g;
            //$LASTPOS=34004224;//kernel.Color:4224
            _this.value.b=rgb[2]*_this.maxs.b;
            
          }
          return _this;
          
        }
        //$LASTPOS=34004269;//kernel.Color:4269
        _this.nameToRGB();
      },
      fiber$makeRGBA :function _trc_Color_f_makeRGBA(_thread,force) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var rgb;
        var i;
        
        //$LASTPOS=34003933;//kernel.Color:3933
        if (! force&&_this.hasRGBA()) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_Color_ent_makeRGBA(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=34003968;//kernel.Color:3968
              if (!(_this.hasHSLA())) { __pc=2     ; break; }
              //$LASTPOS=34003988;//kernel.Color:3988
              _this.fiber$HSLToRGB(_thread, _this.value.h, _this.value.s, _this.value.l);
              __pc=1;return;
            case 1:
              rgb=_thread.retVal;
              
              //$LASTPOS=34004034;//kernel.Color:4034
              if (_this.imageData) {
                //$LASTPOS=34004055;//kernel.Color:4055
                //$LASTPOS=34004059;//kernel.Color:4059
                i = 0;
                for (; i<3 ; i++) {
                  //$LASTPOS=34004076;//kernel.Color:4076
                  _this.imageData.data[_this.index+i]=rgb[i]*_this.maxs.r;
                }
                
              } else {
                //$LASTPOS=34004170;//kernel.Color:4170
                _this.value.r=rgb[0]*_this.maxs.r;
                //$LASTPOS=34004197;//kernel.Color:4197
                _this.value.g=rgb[1]*_this.maxs.g;
                //$LASTPOS=34004224;//kernel.Color:4224
                _this.value.b=rgb[2]*_this.maxs.b;
                
              }
              _thread.exit(_this);return;
            case 2     :
              
              //$LASTPOS=34004269;//kernel.Color:4269
              _this.fiber$nameToRGB(_thread);
              __pc=3;return;
            case 3:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      nameToRGB :function _trc_Color_nameToRGB() {
        "use strict";
        var _this=this;
        var ctx;
        var d;
        var i;
        
        //$LASTPOS=34004303;//kernel.Color:4303
        ctx = _this.tmpCanvas();
        
        //$LASTPOS=34004326;//kernel.Color:4326
        ctx.fillStyle=_this.value.name;
        //$LASTPOS=34004354;//kernel.Color:4354
        ctx.fillRect(0,0,1,1);
        //$LASTPOS=34004379;//kernel.Color:4379
        d = ctx.getImageData(0,0,1,1);
        
        //$LASTPOS=34004414;//kernel.Color:4414
        d=d.data;
        //$LASTPOS=34004426;//kernel.Color:4426
        if (_this.imageData) {
          //$LASTPOS=34004446;//kernel.Color:4446
          //$LASTPOS=34004450;//kernel.Color:4450
          i = 0;
          for (; i<4 ; i++) {
            //$LASTPOS=34004467;//kernel.Color:4467
            _this.imageData.data[_this.index+i]=d[i];
          }
          
        } else {
          //$LASTPOS=34004511;//kernel.Color:4511
          _this.value.r=d[0];
          //$LASTPOS=34004528;//kernel.Color:4528
          _this.value.g=d[1];
          //$LASTPOS=34004545;//kernel.Color:4545
          _this.value.b=d[2];
          //$LASTPOS=34004562;//kernel.Color:4562
          _this.value.a=d[3];
          
        }
      },
      fiber$nameToRGB :function _trc_Color_f_nameToRGB(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        var d;
        var i;
        
        
        _thread.enter(function _trc_Color_ent_nameToRGB(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=34004303;//kernel.Color:4303
              _this.fiber$tmpCanvas(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=34004326;//kernel.Color:4326
              ctx.fillStyle=_this.value.name;
              //$LASTPOS=34004354;//kernel.Color:4354
              ctx.fillRect(0,0,1,1);
              //$LASTPOS=34004379;//kernel.Color:4379
              d = ctx.getImageData(0,0,1,1);
              
              //$LASTPOS=34004414;//kernel.Color:4414
              d=d.data;
              //$LASTPOS=34004426;//kernel.Color:4426
              if (_this.imageData) {
                //$LASTPOS=34004446;//kernel.Color:4446
                //$LASTPOS=34004450;//kernel.Color:4450
                i = 0;
                for (; i<4 ; i++) {
                  //$LASTPOS=34004467;//kernel.Color:4467
                  _this.imageData.data[_this.index+i]=d[i];
                }
                
              } else {
                //$LASTPOS=34004511;//kernel.Color:4511
                _this.value.r=d[0];
                //$LASTPOS=34004528;//kernel.Color:4528
                _this.value.g=d[1];
                //$LASTPOS=34004545;//kernel.Color:4545
                _this.value.b=d[2];
                //$LASTPOS=34004562;//kernel.Color:4562
                _this.value.a=d[3];
                
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      makeHSLA :function _trc_Color_makeHSLA() {
        "use strict";
        var _this=this;
        var hsl;
        
        //$LASTPOS=34004600;//kernel.Color:4600
        if (_this.hasHSLA()) {
          return _this;
        }
        //$LASTPOS=34004625;//kernel.Color:4625
        if (! _this.hasRGBA()) {
          //$LASTPOS=34004641;//kernel.Color:4641
          _this.nameToRGB();
        }
        
        //$LASTPOS=34004667;//kernel.Color:4667
        if (_this.imageData) {
          //$LASTPOS=34004687;//kernel.Color:4687
          hsl=_this.RGBToHSL(_this.imageData.data[_this.index]/_this.maxs.r,_this.imageData.data[_this.index+1]/_this.maxs.g,_this.imageData.data[_this.index+2]/_this.maxs.b);
          
        } else {
          //$LASTPOS=34004815;//kernel.Color:4815
          hsl=_this.RGBToHSL(_this.value.r/_this.maxs.r,_this.value.g/_this.maxs.g,_this.value.b/_this.maxs.b);
          
        }
        //$LASTPOS=34004881;//kernel.Color:4881
        _this.value.h=hsl[0];
        //$LASTPOS=34004899;//kernel.Color:4899
        _this.value.s=hsl[1];
        //$LASTPOS=34004917;//kernel.Color:4917
        _this.value.l=hsl[2];
        return _this;
      },
      fiber$makeHSLA :function _trc_Color_f_makeHSLA(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var hsl;
        
        //$LASTPOS=34004600;//kernel.Color:4600
        if (_this.hasHSLA()) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_Color_ent_makeHSLA(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=34004625;//kernel.Color:4625
              if (!(! _this.hasRGBA())) { __pc=2     ; break; }
              //$LASTPOS=34004641;//kernel.Color:4641
              _this.fiber$nameToRGB(_thread);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              
              //$LASTPOS=34004667;//kernel.Color:4667
              if (!(_this.imageData)) { __pc=4     ; break; }
              //$LASTPOS=34004687;//kernel.Color:4687
              _this.fiber$RGBToHSL(_thread, _this.imageData.data[_this.index]/_this.maxs.r, _this.imageData.data[_this.index+1]/_this.maxs.g, _this.imageData.data[_this.index+2]/_this.maxs.b);
              __pc=3;return;
            case 3:
              hsl=_thread.retVal;
              
              __pc=6     ;break;
            case 4     :
              //$LASTPOS=34004815;//kernel.Color:4815
              _this.fiber$RGBToHSL(_thread, _this.value.r/_this.maxs.r, _this.value.g/_this.maxs.g, _this.value.b/_this.maxs.b);
              __pc=5;return;
            case 5:
              hsl=_thread.retVal;
              
            case 6     :
              
              //$LASTPOS=34004881;//kernel.Color:4881
              _this.value.h=hsl[0];
              //$LASTPOS=34004899;//kernel.Color:4899
              _this.value.s=hsl[1];
              //$LASTPOS=34004917;//kernel.Color:4917
              _this.value.l=hsl[2];
              _thread.exit(_this);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      makeName :function _trc_Color_makeName(type) {
        "use strict";
        var _this=this;
        function p(r) {
          
          return _this.floor(r*100)+"%";
        }
        //$LASTPOS=34004967;//kernel.Color:4967
        if (_this.hasName()) {
          return _this;
        }
        //$LASTPOS=34004992;//kernel.Color:4992
        type=type||"rgb";
        //$LASTPOS=34005012;//kernel.Color:5012
        if (type=="rgb") {
          //$LASTPOS=34005034;//kernel.Color:5034
          _this.makeRGBA();
          //$LASTPOS=34005049;//kernel.Color:5049
          if (_this.imageData) {
            //$LASTPOS=34005070;//kernel.Color:5070
            _this.value.name="rgba("+[_this.floor(_this.imageData.data[_this.index]),_this.floor(_this.imageData.data[_this.index+1]),_this.floor(_this.imageData.data[_this.index+2]),_this.imageData.data[_this.index+3]/_this.maxs.a].join(",")+")";
            
          } else {
            //$LASTPOS=34005244;//kernel.Color:5244
            _this.value.name="rgba("+[_this.floor(_this.value.r),_this.floor(_this.value.g),_this.floor(_this.value.b),_this.value.a/_this.maxs.a].join(",")+")";
            
          }
          
        }
        //$LASTPOS=34005351;//kernel.Color:5351
        if (type=="hsl") {
          //$LASTPOS=34005373;//kernel.Color:5373
          _this.makeHSLA();
          //$LASTPOS=34005388;//kernel.Color:5388
          _this.value.name="hsla("+[_this.floor(_this.value.h),p(_this.value.s),p(_this.value.l),_this.value.a/_this.maxs.a].join(",")+")";
          
        }
        
      },
      fiber$makeName :function _trc_Color_f_makeName(_thread,type) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        function p(r) {
          
          return _this.floor(r*100)+"%";
        }
        //$LASTPOS=34004967;//kernel.Color:4967
        if (_this.hasName()) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=34004992;//kernel.Color:4992
        type=type||"rgb";
        
        _thread.enter(function _trc_Color_ent_makeName(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=34005012;//kernel.Color:5012
              if (!(type=="rgb")) { __pc=2     ; break; }
              //$LASTPOS=34005034;//kernel.Color:5034
              _this.fiber$makeRGBA(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=34005049;//kernel.Color:5049
              if (_this.imageData) {
                //$LASTPOS=34005070;//kernel.Color:5070
                _this.value.name="rgba("+[_this.floor(_this.imageData.data[_this.index]),_this.floor(_this.imageData.data[_this.index+1]),_this.floor(_this.imageData.data[_this.index+2]),_this.imageData.data[_this.index+3]/_this.maxs.a].join(",")+")";
                
              } else {
                //$LASTPOS=34005244;//kernel.Color:5244
                _this.value.name="rgba("+[_this.floor(_this.value.r),_this.floor(_this.value.g),_this.floor(_this.value.b),_this.value.a/_this.maxs.a].join(",")+")";
                
              }
            case 2     :
              
              //$LASTPOS=34005351;//kernel.Color:5351
              if (!(type=="hsl")) { __pc=4     ; break; }
              //$LASTPOS=34005373;//kernel.Color:5373
              _this.fiber$makeHSLA(_thread);
              __pc=3;return;
            case 3:
              
              //$LASTPOS=34005388;//kernel.Color:5388
              _this.value.name="hsla("+[_this.floor(_this.value.h),p(_this.value.s),p(_this.value.l),_this.value.a/_this.maxs.a].join(",")+")";
            case 4     :
              
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      toString :function _trc_Color_toString() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=34005549;//kernel.Color:5549
        _this.makeName();
        return _this.value.name;
      },
      tmpCanvas :function _trc_Color_tmpCanvas() {
        "use strict";
        var _this=this;
        var cv;
        
        //$LASTPOS=34005603;//kernel.Color:5603
        if (Tonyu.classes.kernel.Color.ctx) {
          return Tonyu.classes.kernel.Color.ctx;
        }
        //$LASTPOS=34005638;//kernel.Color:5638
        cv = $("<canvas>").attr({width: 1,height: 1}).css({display: "none"}).appendTo("body");
        
        //$LASTPOS=34005722;//kernel.Color:5722
        Tonyu.classes.kernel.Color.ctx=cv[0].getContext("2d");
        return Tonyu.classes.kernel.Color.ctx;
      },
      fiber$tmpCanvas :function _trc_Color_f_tmpCanvas(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var cv;
        
        //$LASTPOS=34005603;//kernel.Color:5603
        if (Tonyu.classes.kernel.Color.ctx) {
          _thread.retVal=Tonyu.classes.kernel.Color.ctx;return;
          
        }
        //$LASTPOS=34005638;//kernel.Color:5638
        cv = $("<canvas>").attr({width: 1,height: 1}).css({display: "none"}).appendTo("body");
        
        //$LASTPOS=34005722;//kernel.Color:5722
        Tonyu.classes.kernel.Color.ctx=cv[0].getContext("2d");
        _thread.retVal=Tonyu.classes.kernel.Color.ctx;return;
        
        
        _thread.retVal=_this;return;
      },
      RGBToHSL :function _trc_Color_RGBToHSL(r,g,b) {
        "use strict";
        var _this=this;
        var min;
        var max;
        var diff;
        var h;
        var s;
        var l;
        
        //$LASTPOS=34005862;//kernel.Color:5862
        min = Tonyu.globals.$Math.min(r,g,b);
        max = Tonyu.globals.$Math.max(r,g,b);
        diff = max-min;
        h = 0;
        s = 0;
        l = (min+max)/2;
        
        //$LASTPOS=34005983;//kernel.Color:5983
        if (diff!=0) {
          //$LASTPOS=34006003;//kernel.Color:6003
          s=l<0.5?diff/(max+min):diff/(2-max-min);
          //$LASTPOS=34006067;//kernel.Color:6067
          h=(r==max?(g-b)/diff:g==max?2+(b-r)/diff:4+(r-g)/diff)*60;
          
        }
        return [h,s,l];
      },
      fiber$RGBToHSL :function _trc_Color_f_RGBToHSL(_thread,r,g,b) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var min;
        var max;
        var diff;
        var h;
        var s;
        var l;
        
        //$LASTPOS=34005862;//kernel.Color:5862
        min = Tonyu.globals.$Math.min(r,g,b);
        max = Tonyu.globals.$Math.max(r,g,b);
        diff = max-min;
        h = 0;
        s = 0;
        l = (min+max)/2;
        
        //$LASTPOS=34005983;//kernel.Color:5983
        if (diff!=0) {
          //$LASTPOS=34006003;//kernel.Color:6003
          s=l<0.5?diff/(max+min):diff/(2-max-min);
          //$LASTPOS=34006067;//kernel.Color:6067
          h=(r==max?(g-b)/diff:g==max?2+(b-r)/diff:4+(r-g)/diff)*60;
          
        }
        _thread.retVal=[h,s,l];return;
        
        
        _thread.retVal=_this;return;
      },
      HSLToRGB :function _trc_Color_HSLToRGB(h,s,l) {
        "use strict";
        var _this=this;
        var temp2;
        var temp1;
        var rtemp;
        var gtemp;
        var btemp;
        var rgb;
        var i;
        
        //$LASTPOS=34006221;//kernel.Color:6221
        if (s==0) {
          return [l,l,l];
          
        }
        //$LASTPOS=34006264;//kernel.Color:6264
        temp2 = l<0.5?l*(1+s):l+s-l*s;
        
        //$LASTPOS=34006317;//kernel.Color:6317
        temp1 = 2*l-temp2;
        
        //$LASTPOS=34006348;//kernel.Color:6348
        h/=360;
        //$LASTPOS=34006362;//kernel.Color:6362
        rtemp = (h+1/3)%1;
        gtemp = h;
        btemp = (h+2/3)%1;
        rgb = [rtemp,gtemp,btemp];
        i = 0;
        
        //$LASTPOS=34006477;//kernel.Color:6477
        ;
        
        while(i<3) {
          {
            //$LASTPOS=34006501;//kernel.Color:6501
            rgb[i]=rgb[i]<1/6?temp1+(temp2-temp1)*6*rgb[i]:rgb[i]<1/2?temp2:rgb[i]<2/3?temp1+(temp2-temp1)*6*(2/3-rgb[i]):temp1;
          }
          ++ i;
        }
        return rgb;
      },
      fiber$HSLToRGB :function _trc_Color_f_HSLToRGB(_thread,h,s,l) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var temp2;
        var temp1;
        var rtemp;
        var gtemp;
        var btemp;
        var rgb;
        var i;
        
        //$LASTPOS=34006221;//kernel.Color:6221
        if (s==0) {
          _thread.retVal=[l,l,l];return;
          
          
        }
        //$LASTPOS=34006264;//kernel.Color:6264
        temp2 = l<0.5?l*(1+s):l+s-l*s;
        
        //$LASTPOS=34006317;//kernel.Color:6317
        temp1 = 2*l-temp2;
        
        //$LASTPOS=34006348;//kernel.Color:6348
        h/=360;
        //$LASTPOS=34006362;//kernel.Color:6362
        rtemp = (h+1/3)%1;
        gtemp = h;
        btemp = (h+2/3)%1;
        rgb = [rtemp,gtemp,btemp];
        i = 0;
        
        //$LASTPOS=34006477;//kernel.Color:6477
        ;
        
        while(i<3) {
          {
            //$LASTPOS=34006501;//kernel.Color:6501
            rgb[i]=rgb[i]<1/6?temp1+(temp2-temp1)*6*rgb[i]:rgb[i]<1/2?temp2:rgb[i]<2/3?temp1+(temp2-temp1)*6*(2/3-rgb[i]):temp1;
          }
          ++ i;
        }
        _thread.retVal=rgb;return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"fillNum":{"nowait":false},"__getter__r":{"nowait":true},"__getter__g":{"nowait":true},"__getter__b":{"nowait":true},"__getter__a":{"nowait":true},"__setter__a":{"nowait":true},"__setter__r":{"nowait":true},"__setter__g":{"nowait":true},"__setter__b":{"nowait":true},"__getter__h":{"nowait":true},"__getter__s":{"nowait":true},"__getter__l":{"nowait":true},"__setter__h":{"nowait":true},"__setter__s":{"nowait":true},"__setter__l":{"nowait":true},"setHSLA":{"nowait":false},"setRGBA":{"nowait":false},"hasRGBA":{"nowait":false},"hasHSLA":{"nowait":false},"hasName":{"nowait":false},"clearRGBA":{"nowait":false},"clearHSLA":{"nowait":false},"clearName":{"nowait":false},"lerpRGBA":{"nowait":false},"distRGBA":{"nowait":false},"distHSLA":{"nowait":false},"makeRGBA":{"nowait":false},"nameToRGB":{"nowait":false},"makeHSLA":{"nowait":false},"makeName":{"nowait":false},"toString":{"nowait":true},"tmpCanvas":{"nowait":false},"RGBToHSL":{"nowait":false},"HSLToRGB":{"nowait":false}},"fields":{"maxs":{},"imageData":{},"index":{},"value":{},"type":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Context3D',
  shortName: 'Context3D',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Context3D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35000018;//kernel.Context3D:18
        "field strict";
        
        
        
        
      },
      fiber$main :function _trc_Context3D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=35000018;//kernel.Context3D:18
        "field strict";
        
        
        
        
        
        _thread.retVal=_this;return;
      },
      addSprite2D :function _trc_Context3D_addSprite2D(s) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35000234;//kernel.Context3D:234
        if (! (Tonyu.is(s,Tonyu.classes.kernel.ActorSprite))) {
          //$LASTPOS=35000259;//kernel.Context3D:259
          s=new Tonyu.classes.kernel.ActorSprite(s);
        }
        //$LASTPOS=35000286;//kernel.Context3D:286
        _this.sprites2D.push(s);
      },
      fiber$addSprite2D :function _trc_Context3D_f_addSprite2D(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=35000234;//kernel.Context3D:234
        if (! (Tonyu.is(s,Tonyu.classes.kernel.ActorSprite))) {
          //$LASTPOS=35000259;//kernel.Context3D:259
          s=new Tonyu.classes.kernel.ActorSprite(s);
        }
        //$LASTPOS=35000286;//kernel.Context3D:286
        _this.sprites2D.push(s);
        
        _thread.retVal=_this;return;
      },
      addSprite3D :function _trc_Context3D_addSprite3D(s) {
        "use strict";
        var _this=this;
        var pos3d;
        var pt;
        var scl;
        
        //$LASTPOS=35000332;//kernel.Context3D:332
        pos3d = s.transform?s.transform.position:(s.position||new Tonyu.classes.kernel.Vec3(s.x||0,s.y||0,s.z||0));
        
        //$LASTPOS=35000439;//kernel.Context3D:439
        pt = _this.to2D(pos3d);
        
        //$LASTPOS=35000464;//kernel.Context3D:464
        if (pt) {
          //$LASTPOS=35000483;//kernel.Context3D:483
          scl = (s.transform?s.transform.scale:(s.scale||1))*pt.scale;
          
          //$LASTPOS=35000559;//kernel.Context3D:559
          _this.addSprite2D({x: pt.x,y: pt.y,zOrder: pt.z,scaleX: (s.scaleX||1)*scl,scaleY: (s.scaleY||s.scaleX||1)*scl,p: s.p,text: s.text,fillStyle: s.fillStyle,width: s.width,height: s.height,radius: s.radius,rotation: s.rotation||0,alpha: s.alpha||255});
          
        }
      },
      fiber$addSprite3D :function _trc_Context3D_f_addSprite3D(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var pos3d;
        var pt;
        var scl;
        
        //$LASTPOS=35000332;//kernel.Context3D:332
        pos3d = s.transform?s.transform.position:(s.position||new Tonyu.classes.kernel.Vec3(s.x||0,s.y||0,s.z||0));
        
        
        _thread.enter(function _trc_Context3D_ent_addSprite3D(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=35000439;//kernel.Context3D:439
              _this.fiber$to2D(_thread, pos3d);
              __pc=1;return;
            case 1:
              pt=_thread.retVal;
              
              //$LASTPOS=35000464;//kernel.Context3D:464
              if (!(pt)) { __pc=3     ; break; }
              //$LASTPOS=35000483;//kernel.Context3D:483
              scl = (s.transform?s.transform.scale:(s.scale||1))*pt.scale;
              
              //$LASTPOS=35000559;//kernel.Context3D:559
              _this.fiber$addSprite2D(_thread, {x: pt.x,y: pt.y,zOrder: pt.z,scaleX: (s.scaleX||1)*scl,scaleY: (s.scaleY||s.scaleX||1)*scl,p: s.p,text: s.text,fillStyle: s.fillStyle,width: s.width,height: s.height,radius: s.radius,rotation: s.rotation||0,alpha: s.alpha||255});
              __pc=2;return;
            case 2:
              
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initialize :function _trc_Context3D_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35000940;//kernel.Context3D:940
        __superClass.apply( _this, [p]);
        //$LASTPOS=35000955;//kernel.Context3D:955
        _this.sprites2D=[];
        //$LASTPOS=35001032;//kernel.Context3D:1032
        _this.curTransform=_this.camera.transform.inverse;
        //$LASTPOS=35001125;//kernel.Context3D:1125
        _this.stack=[];
      },
      to2D :function _trc_Context3D_to2D(pos) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35001157;//kernel.Context3D:1157
        if (! pos) {
          return _this.camera.to2D(_this.curTransform.position);
          
        }
        return _this.camera.to2D(_this.curTransform.childToSibling(pos));
      },
      fiber$to2D :function _trc_Context3D_f_to2D(_thread,pos) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=35001157;//kernel.Context3D:1157
        if (! pos) {
          _thread.retVal=_this.camera.to2D(_this.curTransform.position);return;
          
          
        }
        _thread.retVal=_this.camera.to2D(_this.curTransform.childToSibling(pos));return;
        
        
        _thread.retVal=_this;return;
      },
      setTransform :function _trc_Context3D_setTransform(t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35001315;//kernel.Context3D:1315
        _this.curTransform=t;
      },
      fiber$setTransform :function _trc_Context3D_f_setTransform(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=35001315;//kernel.Context3D:1315
        _this.curTransform=t;
        
        _thread.retVal=_this;return;
      },
      transform :function _trc_Context3D_transform(t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35001356;//kernel.Context3D:1356
        _this.curTransform=_this.curTransform.childToSibling(t);
      },
      fiber$transform :function _trc_Context3D_f_transform(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=35001356;//kernel.Context3D:1356
        _this.curTransform=_this.curTransform.childToSibling(t);
        
        _thread.retVal=_this;return;
      },
      save :function _trc_Context3D_save() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35001420;//kernel.Context3D:1420
        _this.stack.push({curTransform: _this.curTransform});
      },
      fiber$save :function _trc_Context3D_f_save(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=35001420;//kernel.Context3D:1420
        _this.stack.push({curTransform: _this.curTransform});
        
        _thread.retVal=_this;return;
      },
      restore :function _trc_Context3D_restore() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=35001468;//kernel.Context3D:1468
        _this.extend(_this.stack.pop());
      },
      fiber$restore :function _trc_Context3D_f_restore(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=35001468;//kernel.Context3D:1468
        _this.extend(_this.stack.pop());
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"addSprite2D":{"nowait":false},"addSprite3D":{"nowait":false},"new":{"nowait":false},"to2D":{"nowait":false},"setTransform":{"nowait":false},"transform":{"nowait":false},"save":{"nowait":false},"restore":{"nowait":false}},"fields":{"camera":{},"sprites2D":{},"curTransform":{},"stack":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.GIFWriter',
  shortName: 'GIFWriter',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.ParallelMod,Tonyu.classes.kernel.MathMod,Tonyu.classes.kernel.FileMod,Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.ThreadGroupMod],
  methods: function (__superClass) {
    return {
      main :function _trc_GIFWriter_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_GIFWriter_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_GIFWriter_initialize(params) {
        "use strict";
        var _this=this;
        var cnt;
        var wevt;
        
        //$LASTPOS=36000240;//kernel.GIFWriter:240
        __superClass.apply( _this, [params]);
        //$LASTPOS=36000260;//kernel.GIFWriter:260
        Tonyu.globals.$currentProject.requestPlugin("gif");
        //$LASTPOS=36000343;//kernel.GIFWriter:343
        _this.target=_this.target||Tonyu.globals.$Screen;
        //$LASTPOS=36000374;//kernel.GIFWriter:374
        _this.fps=_this.fps||15;
        //$LASTPOS=36000394;//kernel.GIFWriter:394
        _this.interval=_this.interval||_this.floor(Tonyu.globals.$Boot.getFrameRate()/_this.fps);
        //$LASTPOS=36000459;//kernel.GIFWriter:459
        _this.duration=(1000/Tonyu.globals.$Boot.getFrameRate())*_this.interval;
        //$LASTPOS=36000513;//kernel.GIFWriter:513
        if (! _this.manual) {
          //$LASTPOS=36000537;//kernel.GIFWriter:537
          if (_this.delay) {
            //$LASTPOS=36000563;//kernel.GIFWriter:563
            cnt = 0;
            
            
            //$LASTPOS=36000610;//kernel.GIFWriter:610
            wevt=Tonyu.globals.$Boot.on("afterDraw",(function anonymous_637() {
              
              //$LASTPOS=36000657;//kernel.GIFWriter:657
              cnt++;
              //$LASTPOS=36000681;//kernel.GIFWriter:681
              if (cnt>=_this.delay) {
                //$LASTPOS=36000720;//kernel.GIFWriter:720
                wevt.remove();
                //$LASTPOS=36000756;//kernel.GIFWriter:756
                _this.start();
                
              }
            }));
            
          } else {
            //$LASTPOS=36000816;//kernel.GIFWriter:816
            _this.start();
          }
          
        }
      },
      start :function _trc_GIFWriter_start() {
        "use strict";
        var _this=this;
        var cnt;
        
        //$LASTPOS=36000852;//kernel.GIFWriter:852
        if (_this.e) {
          return _this;
        }
        //$LASTPOS=36000872;//kernel.GIFWriter:872
        _this.frames=[];
        //$LASTPOS=36000888;//kernel.GIFWriter:888
        _this.e=new GIF({workerScript: GIF_WORKER_URL,workers: 2,quality: 10});
        //$LASTPOS=36001135;//kernel.GIFWriter:1135
        _this.encoded=0;
        //$LASTPOS=36001151;//kernel.GIFWriter:1151
        if (! _this.manual) {
          //$LASTPOS=36001175;//kernel.GIFWriter:1175
          cnt = 0;
          
          //$LASTPOS=36001195;//kernel.GIFWriter:1195
          _this.evt=Tonyu.globals.$Boot.on("afterDraw",(function anonymous_1221(e) {
            var drawn;
            
            //$LASTPOS=36001241;//kernel.GIFWriter:1241
            drawn = e.drawn;
            
            //$LASTPOS=36001273;//kernel.GIFWriter:1273
            cnt++;
            //$LASTPOS=36001293;//kernel.GIFWriter:1293
            if (cnt>=_this.interval) {
              //$LASTPOS=36001331;//kernel.GIFWriter:1331
              cnt=0;
              //$LASTPOS=36001355;//kernel.GIFWriter:1355
              _this.addFrame();
              
            }
            //$LASTPOS=36001395;//kernel.GIFWriter:1395
            if (typeof  _this.length==="number") {
              //$LASTPOS=36001444;//kernel.GIFWriter:1444
              _this.length--;
              //$LASTPOS=36001471;//kernel.GIFWriter:1471
              if (_this.length<=0) {
                switch (_this.after) {
                case "save":
                  return _this.save()["catch"]((function anonymous_1583(e) {
                    
                    //$LASTPOS=36001590;//kernel.GIFWriter:1590
                    console.error(e);
                  }));
                case "download":
                  return _this.download();
                }
                
              }
              
            }
          }));
          
        }
      },
      fiber$start :function _trc_GIFWriter_f_start(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var cnt;
        
        //$LASTPOS=36000852;//kernel.GIFWriter:852
        if (_this.e) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=36000872;//kernel.GIFWriter:872
        _this.frames=[];
        //$LASTPOS=36000888;//kernel.GIFWriter:888
        _this.e=new GIF({workerScript: GIF_WORKER_URL,workers: 2,quality: 10});
        //$LASTPOS=36001135;//kernel.GIFWriter:1135
        _this.encoded=0;
        
        _thread.enter(function _trc_GIFWriter_ent_start(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=36001151;//kernel.GIFWriter:1151
              if (!(! _this.manual)) { __pc=1     ; break; }
              //$LASTPOS=36001175;//kernel.GIFWriter:1175
              cnt = 0;
              
              //$LASTPOS=36001195;//kernel.GIFWriter:1195
              _this.evt=Tonyu.globals.$Boot.on("afterDraw",(function anonymous_1221(e) {
                var drawn;
                
                //$LASTPOS=36001241;//kernel.GIFWriter:1241
                drawn = e.drawn;
                
                //$LASTPOS=36001273;//kernel.GIFWriter:1273
                cnt++;
                //$LASTPOS=36001293;//kernel.GIFWriter:1293
                if (cnt>=_this.interval) {
                  //$LASTPOS=36001331;//kernel.GIFWriter:1331
                  cnt=0;
                  //$LASTPOS=36001355;//kernel.GIFWriter:1355
                  _this.addFrame();
                  
                }
                //$LASTPOS=36001395;//kernel.GIFWriter:1395
                if (typeof  _this.length==="number") {
                  //$LASTPOS=36001444;//kernel.GIFWriter:1444
                  _this.length--;
                  //$LASTPOS=36001471;//kernel.GIFWriter:1471
                  if (_this.length<=0) {
                    switch (_this.after) {
                    case "save":
                      return _this.save()["catch"]((function anonymous_1583(e) {
                        
                        //$LASTPOS=36001590;//kernel.GIFWriter:1590
                        console.error(e);
                      }));
                    case "download":
                      return _this.download();
                    }
                    
                  }
                  
                }
              }));
            case 1     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      addFrame :function _trc_GIFWriter_addFrame() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=36001768;//kernel.GIFWriter:1768
        if (! _this.e) {
          //$LASTPOS=36001776;//kernel.GIFWriter:1776
          _this.start();
        }
        //$LASTPOS=36001790;//kernel.GIFWriter:1790
        _this.e.addFrame(_this.target.image,{delay: _this.duration,copy: true});
      },
      fiber$addFrame :function _trc_GIFWriter_f_addFrame(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_GIFWriter_ent_addFrame(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=36001768;//kernel.GIFWriter:1768
              if (!(! _this.e)) { __pc=2     ; break; }
              //$LASTPOS=36001776;//kernel.GIFWriter:1776
              _this.fiber$start(_thread);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              //$LASTPOS=36001790;//kernel.GIFWriter:1790
              _this.e.addFrame(_this.target.image,{delay: _this.duration,copy: true});
              _thread.exit(_this);return;
            }
          }
        });
      },
      finish :function _trc_GIFWriter_finish() {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=36001999;//kernel.GIFWriter:1999
        r = _this.runPromise((function anonymous_2016(onFinish,fail) {
          
          //$LASTPOS=36002044;//kernel.GIFWriter:2044
          if (_this.evt) {
            //$LASTPOS=36002068;//kernel.GIFWriter:2068
            _this.evt.remove();
            //$LASTPOS=36002095;//kernel.GIFWriter:2095
            _this.evt=null;
            
          }
          //$LASTPOS=36002125;//kernel.GIFWriter:2125
          _this.e.on('finished',onFinish);
          //$LASTPOS=36002162;//kernel.GIFWriter:2162
          _this.e.render();
        }));
        
        return r;
      },
      fiber$finish :function _trc_GIFWriter_f_finish(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        
        _thread.enter(function _trc_GIFWriter_ent_finish(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=36001999;//kernel.GIFWriter:1999
              _this.fiber$runPromise(_thread, (function anonymous_2016(onFinish,fail) {
                
                //$LASTPOS=36002044;//kernel.GIFWriter:2044
                if (_this.evt) {
                  //$LASTPOS=36002068;//kernel.GIFWriter:2068
                  _this.evt.remove();
                  //$LASTPOS=36002095;//kernel.GIFWriter:2095
                  _this.evt=null;
                  
                }
                //$LASTPOS=36002125;//kernel.GIFWriter:2125
                _this.e.on('finished',onFinish);
                //$LASTPOS=36002162;//kernel.GIFWriter:2162
                _this.e.render();
              }));
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              _thread.exit(r);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      download :function _trc_GIFWriter_download(f) {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=36002221;//kernel.GIFWriter:2221
        f=f||_this.filename||"download.gif";
        //$LASTPOS=36002257;//kernel.GIFWriter:2257
        console.log("DL",f);
        //$LASTPOS=36002283;//kernel.GIFWriter:2283
        r = _this.runPromise((function anonymous_2300(succ,err) {
          
          //$LASTPOS=36002323;//kernel.GIFWriter:2323
          _this.finish().then((function anonymous_2337(blob) {
            
            //$LASTPOS=36002360;//kernel.GIFWriter:2360
            FS.Content.download(blob,f);
            //$LASTPOS=36002402;//kernel.GIFWriter:2402
            _this.e=null;
          })).then((function anonymous_2427() {
            
            //$LASTPOS=36002429;//kernel.GIFWriter:2429
            console.log("DL OK");
          }),err);
        }));
        
        return r;
      },
      fiber$download :function _trc_GIFWriter_f_download(_thread,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        //$LASTPOS=36002221;//kernel.GIFWriter:2221
        f=f||_this.filename||"download.gif";
        //$LASTPOS=36002257;//kernel.GIFWriter:2257
        console.log("DL",f);
        
        _thread.enter(function _trc_GIFWriter_ent_download(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=36002283;//kernel.GIFWriter:2283
              _this.fiber$runPromise(_thread, (function anonymous_2300(succ,err) {
                
                //$LASTPOS=36002323;//kernel.GIFWriter:2323
                _this.finish().then((function anonymous_2337(blob) {
                  
                  //$LASTPOS=36002360;//kernel.GIFWriter:2360
                  FS.Content.download(blob,f);
                  //$LASTPOS=36002402;//kernel.GIFWriter:2402
                  _this.e=null;
                })).then((function anonymous_2427() {
                  
                  //$LASTPOS=36002429;//kernel.GIFWriter:2429
                  console.log("DL OK");
                }),err);
              }));
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              _thread.exit(r);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      save :function _trc_GIFWriter_save(f) {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=36002502;//kernel.GIFWriter:2502
        console.log("Save",f);
        //$LASTPOS=36002530;//kernel.GIFWriter:2530
        r = _this.runPromise((function anonymous_2547(succ,err) {
          
          //$LASTPOS=36002570;//kernel.GIFWriter:2570
          _this.finish().then((function anonymous_2584(blob) {
            
            //$LASTPOS=36002607;//kernel.GIFWriter:2607
            f=_this.file(f||_this.filename);
            return f.setBlob(blob);
          })).then((function anonymous_2681() {
            
            //$LASTPOS=36002697;//kernel.GIFWriter:2697
            _this.e=null;
            //$LASTPOS=36002718;//kernel.GIFWriter:2718
            succ();
          })).then((function anonymous_2743() {
            
            //$LASTPOS=36002745;//kernel.GIFWriter:2745
            console.log("Save OK");
          }),err);
        }));
        
        return r;
      },
      fiber$save :function _trc_GIFWriter_f_save(_thread,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        //$LASTPOS=36002502;//kernel.GIFWriter:2502
        console.log("Save",f);
        
        _thread.enter(function _trc_GIFWriter_ent_save(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=36002530;//kernel.GIFWriter:2530
              _this.fiber$runPromise(_thread, (function anonymous_2547(succ,err) {
                
                //$LASTPOS=36002570;//kernel.GIFWriter:2570
                _this.finish().then((function anonymous_2584(blob) {
                  
                  //$LASTPOS=36002607;//kernel.GIFWriter:2607
                  f=_this.file(f||_this.filename);
                  return f.setBlob(blob);
                })).then((function anonymous_2681() {
                  
                  //$LASTPOS=36002697;//kernel.GIFWriter:2697
                  _this.e=null;
                  //$LASTPOS=36002718;//kernel.GIFWriter:2718
                  succ();
                })).then((function anonymous_2743() {
                  
                  //$LASTPOS=36002745;//kernel.GIFWriter:2745
                  console.log("Save OK");
                }),err);
              }));
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              _thread.exit(r);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"start":{"nowait":false},"addFrame":{"nowait":false},"finish":{"nowait":false},"download":{"nowait":false},"save":{"nowait":false}},"fields":{"target":{},"fps":{},"interval":{},"duration":{},"manual":{},"delay":{},"e":{},"frames":{},"encoded":{},"evt":{},"length":{},"after":{},"filename":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.MultiLayerTouches',
  shortName: 'MultiLayerTouches',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_MultiLayerTouches_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=37000020;//kernel.MultiLayerTouches:20
        "field strict";
        
      },
      fiber$main :function _trc_MultiLayerTouches_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=37000020;//kernel.MultiLayerTouches:20
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      add :function _trc_MultiLayerTouches_add(a) {
        "use strict";
        var _this=this;
        var layer;
        var ts;
        
        //$LASTPOS=37000071;//kernel.MultiLayerTouches:71
        layer = _this.screen.findLayer(a.getSpriteGroup());
        
        //$LASTPOS=37000126;//kernel.MultiLayerTouches:126
        ts = _this.getOrNewTouchables(layer);
        
        //$LASTPOS=37000165;//kernel.MultiLayerTouches:165
        if (ts.indexOf(a)<0) {
          //$LASTPOS=37000186;//kernel.MultiLayerTouches:186
          ts.push(a);
        }
      },
      fiber$add :function _trc_MultiLayerTouches_f_add(_thread,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var layer;
        var ts;
        
        //$LASTPOS=37000071;//kernel.MultiLayerTouches:71
        layer = _this.screen.findLayer(a.getSpriteGroup());
        
        
        _thread.enter(function _trc_MultiLayerTouches_ent_add(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=37000126;//kernel.MultiLayerTouches:126
              _this.fiber$getOrNewTouchables(_thread, layer);
              __pc=1;return;
            case 1:
              ts=_thread.retVal;
              
              //$LASTPOS=37000165;//kernel.MultiLayerTouches:165
              if (ts.indexOf(a)<0) {
                //$LASTPOS=37000186;//kernel.MultiLayerTouches:186
                ts.push(a);
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      remove :function _trc_MultiLayerTouches_remove(a) {
        "use strict";
        var _this=this;
        var layer;
        var ts;
        var idx;
        
        //$LASTPOS=37000226;//kernel.MultiLayerTouches:226
        layer = _this.screen.findLayer(a.getSpriteGroup());
        
        //$LASTPOS=37000281;//kernel.MultiLayerTouches:281
        ts = _this.getOrNewTouchables(layer);
        
        //$LASTPOS=37000320;//kernel.MultiLayerTouches:320
        idx = ts.indexOf(a);
        
        //$LASTPOS=37000348;//kernel.MultiLayerTouches:348
        if (idx>=0) {
          //$LASTPOS=37000360;//kernel.MultiLayerTouches:360
          ts.splice(idx,1);
        }
      },
      fiber$remove :function _trc_MultiLayerTouches_f_remove(_thread,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var layer;
        var ts;
        var idx;
        
        //$LASTPOS=37000226;//kernel.MultiLayerTouches:226
        layer = _this.screen.findLayer(a.getSpriteGroup());
        
        
        _thread.enter(function _trc_MultiLayerTouches_ent_remove(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=37000281;//kernel.MultiLayerTouches:281
              _this.fiber$getOrNewTouchables(_thread, layer);
              __pc=1;return;
            case 1:
              ts=_thread.retVal;
              
              //$LASTPOS=37000320;//kernel.MultiLayerTouches:320
              idx = ts.indexOf(a);
              
              //$LASTPOS=37000348;//kernel.MultiLayerTouches:348
              if (idx>=0) {
                //$LASTPOS=37000360;//kernel.MultiLayerTouches:360
                ts.splice(idx,1);
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      getOrNewTouchables :function _trc_MultiLayerTouches_getOrNewTouchables(layer) {
        "use strict";
        var _this=this;
        
        return layer.__touchables=layer.__touchables||[];
      },
      fiber$getOrNewTouchables :function _trc_MultiLayerTouches_f_getOrNewTouchables(_thread,layer) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=layer.__touchables=layer.__touchables||[];return;
        
        
        _thread.retVal=_this;return;
      },
      getTouchables :function _trc_MultiLayerTouches_getTouchables(layer) {
        "use strict";
        var _this=this;
        
        return layer.__touchables;
      },
      fiber$getTouchables :function _trc_MultiLayerTouches_f_getTouchables(_thread,layer) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=layer.__touchables;return;
        
        
        _thread.retVal=_this;return;
      },
      findActor :function _trc_MultiLayerTouches_findActor(p) {
        "use strict";
        var _this=this;
        var layer;
        var _it_321;
        var pp;
        var ts;
        var t;
        var _it_322;
        var c;
        
        //$LASTPOS=37000663;//kernel.MultiLayerTouches:663
        _it_321=Tonyu.iterator(_this.screen.layers,1);
        while(_it_321.next()) {
          layer=_it_321[0];
          
          //$LASTPOS=37000707;//kernel.MultiLayerTouches:707
          pp = p;
          
          //$LASTPOS=37000753;//kernel.MultiLayerTouches:753
          ts = _this.getTouchables(layer);
          
          //$LASTPOS=37000791;//kernel.MultiLayerTouches:791
          if (! ts) {
            continue;
            
          }
          //$LASTPOS=37000819;//kernel.MultiLayerTouches:819
          p.layer=layer;
          //$LASTPOS=37000843;//kernel.MultiLayerTouches:843
          ts=ts.sort((function anonymous_853(a,b) {
            
            return a.zOrder-b.zOrder;
          }));
          //$LASTPOS=37000898;//kernel.MultiLayerTouches:898
          _it_322=Tonyu.iterator(ts,1);
          while(_it_322.next()) {
            t=_it_322[0];
            
            //$LASTPOS=37000931;//kernel.MultiLayerTouches:931
            c = t.getTouchShape();
            
            //$LASTPOS=37000969;//kernel.MultiLayerTouches:969
            if (c.contains(pp)) {
              return t;
            }
            
          }
          
        }
        return null;
      },
      fiber$findActor :function _trc_MultiLayerTouches_f_findActor(_thread,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var layer;
        var _it_321;
        var pp;
        var ts;
        var t;
        var _it_322;
        var c;
        
        
        _thread.enter(function _trc_MultiLayerTouches_ent_findActor(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=37000663;//kernel.MultiLayerTouches:663
              _it_321=Tonyu.iterator(_this.screen.layers,1);
            case 1:
              if (!(_it_321.next())) { __pc=7     ; break; }
              layer=_it_321[0];
              
              //$LASTPOS=37000707;//kernel.MultiLayerTouches:707
              pp = p;
              
              //$LASTPOS=37000753;//kernel.MultiLayerTouches:753
              _this.fiber$getTouchables(_thread, layer);
              __pc=2;return;
            case 2:
              ts=_thread.retVal;
              
              //$LASTPOS=37000791;//kernel.MultiLayerTouches:791
              if (!(! ts)) { __pc=3     ; break; }
              __pc=1; break;
              
            case 3     :
              
              //$LASTPOS=37000819;//kernel.MultiLayerTouches:819
              p.layer=layer;
              //$LASTPOS=37000843;//kernel.MultiLayerTouches:843
              ts=ts.sort((function anonymous_853(a,b) {
                
                return a.zOrder-b.zOrder;
              }));
              //$LASTPOS=37000898;//kernel.MultiLayerTouches:898
              _it_322=Tonyu.iterator(ts,1);
            case 4:
              if (!(_it_322.next())) { __pc=6     ; break; }
              t=_it_322[0];
              
              //$LASTPOS=37000931;//kernel.MultiLayerTouches:931
              c = t.getTouchShape();
              
              //$LASTPOS=37000969;//kernel.MultiLayerTouches:969
              if (!(c.contains(pp))) { __pc=5     ; break; }
              _thread.exit(t);return;
            case 5     :
              
              __pc=4;break;
            case 6     :
              
              __pc=1;break;
            case 7     :
              
              _thread.exit(null);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"add":{"nowait":false},"remove":{"nowait":false},"getOrNewTouchables":{"nowait":false},"getTouchables":{"nowait":false},"findActor":{"nowait":false}},"fields":{"screen":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.OneframeSprite',
  shortName: 'OneframeSprite',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_OneframeSprite_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_OneframeSprite_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_OneframeSprite_initialize(params) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=38000054;//kernel.OneframeSprite:54
        _this.extend(params);
        //$LASTPOS=38000075;//kernel.OneframeSprite:75
        if (_this.layer&&typeof  _this.layer.add=="function") {
          //$LASTPOS=38000127;//kernel.OneframeSprite:127
          _this.layer.add(_this);
          
        } else {
          //$LASTPOS=38000165;//kernel.OneframeSprite:165
          Tonyu.globals.$Sprites.add(_this);
          
        }
      },
      die :function _trc_OneframeSprite_die() {
        "use strict";
        var _this=this;
        
      },
      fiber$die :function _trc_OneframeSprite_f_die(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      isDead :function _trc_OneframeSprite_isDead() {
        "use strict";
        var _this=this;
        
      },
      fiber$isDead :function _trc_OneframeSprite_f_isDead(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"die":{"nowait":false},"isDead":{"nowait":false}},"fields":{"layer":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.PanelTouchStart',
  shortName: 'PanelTouchStart',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.EventHandler,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_PanelTouchStart_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=39000025;//kernel.PanelTouchStart:25
        "field strict";
      },
      fiber$main :function _trc_PanelTouchStart_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=39000025;//kernel.PanelTouchStart:25
        "field strict";
        
        _thread.retVal=_this;return;
      },
      newListener :function _trc_PanelTouchStart_newListener(f) {
        "use strict";
        var _this=this;
        var h;
        
        //$LASTPOS=39000082;//kernel.PanelTouchStart:82
        h = Tonyu.globals.$InputDevice.on("touchstart",(function anonymous_118(e) {
          
          //$LASTPOS=39000219;//kernel.PanelTouchStart:219
          e.finger.layer=_this.target;
          return f(e);
        }));
        
        return {dispose: (function anonymous_382(e) {
          
          //$LASTPOS=39000401;//kernel.PanelTouchStart:401
          h.remove();
        }),action: (function anonymous_442() {
          
        })};
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"newListener":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.ScreenLayer',
  shortName: 'ScreenLayer',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.EventMod],
  methods: function (__superClass) {
    return {
      main :function _trc_ScreenLayer_main() {
        "use strict";
        var _this=this;
        
        
      },
      fiber$main :function _trc_ScreenLayer_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_ScreenLayer_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=40000067;//kernel.ScreenLayer:67
        __superClass.apply( _this, [p]);
      },
      addSubsprite :function _trc_ScreenLayer_addSubsprite() {
        "use strict";
        var _this=this;
        
        return _this.group.addSubsprite.apply(_this.group,arguments);
      },
      fiber$addSubsprite :function _trc_ScreenLayer_f_addSubsprite(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.group.addSubsprite.apply(_this.group,_arguments);return;
        
        
        _thread.retVal=_this;return;
      },
      all :function _trc_ScreenLayer_all() {
        "use strict";
        var _this=this;
        
        return _this.group.all.apply(_this.group,arguments);
      },
      fiber$all :function _trc_ScreenLayer_f_all(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.group.all.apply(_this.group,_arguments);return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"addSubsprite":{"nowait":false},"all":{"nowait":false}},"fields":{"group":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.SpriteGroup',
  shortName: 'SpriteGroup',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_SpriteGroup_main() {
        "use strict";
        var _this=this;
        
        
        
      },
      fiber$main :function _trc_SpriteGroup_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        
        
        _thread.retVal=_this;return;
      },
      get :function _trc_SpriteGroup_get(i) {
        "use strict";
        var _this=this;
        
        return _this.sprites[i];
      },
      fiber$get :function _trc_SpriteGroup_f_get(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.sprites[i];return;
        
        
        _thread.retVal=_this;return;
      },
      addSubsprite :function _trc_SpriteGroup_addSubsprite() {
        "use strict";
        var _this=this;
        
        return Tonyu.bindFunc(_this,_this.add).apply(_this,arguments);
      },
      fiber$addSubsprite :function _trc_SpriteGroup_f_addSubsprite(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.bindFunc(_this,_this.add).apply(_this,_arguments);return;
        
        
        _thread.retVal=_this;return;
      },
      add :function _trc_SpriteGroup_add() {
        "use strict";
        var _this=this;
        
        throw new Error("SpriteGroup::add abstract");
        
      },
      fiber$add :function _trc_SpriteGroup_f_add(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        throw new Error("SpriteGroup::add abstract");
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"get":{"nowait":false},"addSubsprite":{"nowait":false},"add":{"nowait":false}},"fields":{"sprites":{},"transform":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.SpriteMod2D',
  shortName: 'SpriteMod2D',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.SpriteMod,Tonyu.classes.kernel.TextRectMod],
  methods: function (__superClass) {
    return {
      main :function _trc_SpriteMod2D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=41000048;//kernel.SpriteMod2D:48
        "field strict";
        
      },
      fiber$main :function _trc_SpriteMod2D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=41000048;//kernel.SpriteMod2D:48
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      performTransform :function _trc_SpriteMod2D_performTransform(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=41000132;//kernel.SpriteMod2D:132
        if (_this.x!==_this.x||_this.y!==_this.y||_this.x==null||_this.y==null) {
          
          
        }
        //$LASTPOS=41000261;//kernel.SpriteMod2D:261
        ctx.translate(_this.x,_this.y);
        //$LASTPOS=41000286;//kernel.SpriteMod2D:286
        if (_this.rotation!=0) {
          //$LASTPOS=41000317;//kernel.SpriteMod2D:317
          ctx.rotate(_this.rotation/180*Math.PI);
          
        } else {
          //$LASTPOS=41000377;//kernel.SpriteMod2D:377
          ctx.rotate(_this.rotate/180*Math.PI);
          
        }
        //$LASTPOS=41000426;//kernel.SpriteMod2D:426
        if (typeof  _this.scaleY==="undefined") {
          //$LASTPOS=41000474;//kernel.SpriteMod2D:474
          ctx.scale(_this.scaleX,_this.scaleX);
          
        } else {
          //$LASTPOS=41000531;//kernel.SpriteMod2D:531
          ctx.scale(_this.scaleX,_this.scaleY);
          
        }
        //$LASTPOS=41000579;//kernel.SpriteMod2D:579
        ctx.globalAlpha=(_this.alpha<0?0:_this.alpha>255?255:_this.alpha)/255;
      },
      draw :function _trc_SpriteMod2D_draw(ctx) {
        "use strict";
        var _this=this;
        var t;
        
        //$LASTPOS=41000665;//kernel.SpriteMod2D:665
        if (_this.x==null||_this.y==null||_this._isInvisible) {
          return _this;
        }
        //$LASTPOS=41000718;//kernel.SpriteMod2D:718
        t = _this.detectSpriteType();
        
        //$LASTPOS=41000749;//kernel.SpriteMod2D:749
        _this["drawAs"+t](ctx);
        //$LASTPOS=41000777;//kernel.SpriteMod2D:777
        if (_this.subsprites&&_this.subsprites.draw) {
          //$LASTPOS=41000823;//kernel.SpriteMod2D:823
          ctx.save();
          //$LASTPOS=41000844;//kernel.SpriteMod2D:844
          _this.performTransform(ctx);
          //$LASTPOS=41000876;//kernel.SpriteMod2D:876
          _this.subsprites.draw(ctx);
          //$LASTPOS=41000907;//kernel.SpriteMod2D:907
          ctx.restore();
          
        }
      },
      drawAsText :function _trc_SpriteMod2D_drawAsText(ctx) {
        "use strict";
        var _this=this;
        var splitsText;
        var drawY;
        var textCount;
        var rect;
        
        //$LASTPOS=41000964;//kernel.SpriteMod2D:964
        splitsText = (_this.text+"").split("\n");
        
        //$LASTPOS=41001007;//kernel.SpriteMod2D:1007
        drawY = _this.y;
        
        //$LASTPOS=41001025;//kernel.SpriteMod2D:1025
        if (! _this.size) {
          //$LASTPOS=41001036;//kernel.SpriteMod2D:1036
          _this.size=15;
        }
        //$LASTPOS=41001050;//kernel.SpriteMod2D:1050
        if (! _this.align) {
          //$LASTPOS=41001062;//kernel.SpriteMod2D:1062
          _this.align="center";
        }
        //$LASTPOS=41001083;//kernel.SpriteMod2D:1083
        if (! _this.fillStyle) {
          //$LASTPOS=41001099;//kernel.SpriteMod2D:1099
          _this.fillStyle="white";
        }
        //$LASTPOS=41001123;//kernel.SpriteMod2D:1123
        if (_this.font) {
          //$LASTPOS=41001133;//kernel.SpriteMod2D:1133
          ctx.font=_this.size+"px "+_this.font;
        }
        //$LASTPOS=41001164;//kernel.SpriteMod2D:1164
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=41001197;//kernel.SpriteMod2D:1197
        ctx.globalAlpha=_this.alpha/255;
        //$LASTPOS=41001234;//kernel.SpriteMod2D:1234
        _this.height=0;
        //$LASTPOS=41001243;//kernel.SpriteMod2D:1243
        _this.width=0;
        //$LASTPOS=41001257;//kernel.SpriteMod2D:1257
        //$LASTPOS=41001261;//kernel.SpriteMod2D:1261
        textCount = 0;
        for (; textCount<splitsText.length ; textCount++) {
          {
            //$LASTPOS=41001328;//kernel.SpriteMod2D:1328
            rect = _this.drawTextRect(ctx,splitsText[textCount],_this.x,drawY,_this.size,_this.align,"fill");
            
            //$LASTPOS=41001420;//kernel.SpriteMod2D:1420
            if (_this.width<rect.w) {
              //$LASTPOS=41001437;//kernel.SpriteMod2D:1437
              _this.width=rect.w;
            }
            //$LASTPOS=41001460;//kernel.SpriteMod2D:1460
            _this.height+=rect.h;
            //$LASTPOS=41001485;//kernel.SpriteMod2D:1485
            drawY+=_this.size;
          }
        }
      },
      drawAsShape :function _trc_SpriteMod2D_drawAsShape(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=41001534;//kernel.SpriteMod2D:1534
        ctx.save();
        //$LASTPOS=41001551;//kernel.SpriteMod2D:1551
        _this.performTransform(ctx);
        //$LASTPOS=41001579;//kernel.SpriteMod2D:1579
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=41001612;//kernel.SpriteMod2D:1612
        if (_this.radius) {
          //$LASTPOS=41001635;//kernel.SpriteMod2D:1635
          ctx.beginPath();
          //$LASTPOS=41001661;//kernel.SpriteMod2D:1661
          ctx.arc(0,0,_this.radius,0,2*Math.PI);
          //$LASTPOS=41001703;//kernel.SpriteMod2D:1703
          ctx.fill();
          
        } else {
          //$LASTPOS=41001738;//kernel.SpriteMod2D:1738
          ctx.fillRect(- _this.width/2,- _this.height/2,_this.width,_this.height);
          
        }
        //$LASTPOS=41001797;//kernel.SpriteMod2D:1797
        ctx.restore();
      },
      fiber$drawAsShape :function _trc_SpriteMod2D_f_drawAsShape(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=41001534;//kernel.SpriteMod2D:1534
        ctx.save();
        //$LASTPOS=41001551;//kernel.SpriteMod2D:1551
        _this.performTransform(ctx);
        //$LASTPOS=41001579;//kernel.SpriteMod2D:1579
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=41001612;//kernel.SpriteMod2D:1612
        if (_this.radius) {
          //$LASTPOS=41001635;//kernel.SpriteMod2D:1635
          ctx.beginPath();
          //$LASTPOS=41001661;//kernel.SpriteMod2D:1661
          ctx.arc(0,0,_this.radius,0,2*Math.PI);
          //$LASTPOS=41001703;//kernel.SpriteMod2D:1703
          ctx.fill();
          
        } else {
          //$LASTPOS=41001738;//kernel.SpriteMod2D:1738
          ctx.fillRect(- _this.width/2,- _this.height/2,_this.width,_this.height);
          
        }
        //$LASTPOS=41001797;//kernel.SpriteMod2D:1797
        ctx.restore();
        
        _thread.retVal=_this;return;
      },
      drawAsCustom :function _trc_SpriteMod2D_drawAsCustom(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=41001842;//kernel.SpriteMod2D:1842
        ctx.save();
        //$LASTPOS=41001859;//kernel.SpriteMod2D:1859
        _this.performTransform(ctx);
        //$LASTPOS=41001887;//kernel.SpriteMod2D:1887
        _this.p.draw(ctx);
        //$LASTPOS=41001905;//kernel.SpriteMod2D:1905
        ctx.restore();
        //$LASTPOS=41001925;//kernel.SpriteMod2D:1925
        if (_this.p.width*_this.p.height>0) {
          //$LASTPOS=41001960;//kernel.SpriteMod2D:1960
          _this.width=_this.p.width;
          //$LASTPOS=41001984;//kernel.SpriteMod2D:1984
          _this.height=_this.p.height;
          
        }
      },
      fiber$drawAsCustom :function _trc_SpriteMod2D_f_drawAsCustom(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=41001842;//kernel.SpriteMod2D:1842
        ctx.save();
        //$LASTPOS=41001859;//kernel.SpriteMod2D:1859
        _this.performTransform(ctx);
        //$LASTPOS=41001887;//kernel.SpriteMod2D:1887
        _this.p.draw(ctx);
        //$LASTPOS=41001905;//kernel.SpriteMod2D:1905
        ctx.restore();
        //$LASTPOS=41001925;//kernel.SpriteMod2D:1925
        if (_this.p.width*_this.p.height>0) {
          //$LASTPOS=41001960;//kernel.SpriteMod2D:1960
          _this.width=_this.p.width;
          //$LASTPOS=41001984;//kernel.SpriteMod2D:1984
          _this.height=_this.p.height;
          
        }
        
        _thread.retVal=_this;return;
      },
      drawAsImage :function _trc_SpriteMod2D_drawAsImage(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=41002037;//kernel.SpriteMod2D:2037
        _this.prepareImage();
        //$LASTPOS=41002058;//kernel.SpriteMod2D:2058
        if (_this.pImg) {
          //$LASTPOS=41002104;//kernel.SpriteMod2D:2104
          ctx.save();
          //$LASTPOS=41002125;//kernel.SpriteMod2D:2125
          _this.performTransform(ctx);
          //$LASTPOS=41002157;//kernel.SpriteMod2D:2157
          ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,- _this.width/2,- _this.height/2,_this.width,_this.height);
          //$LASTPOS=41002289;//kernel.SpriteMod2D:2289
          ctx.restore();
          
        }
      },
      fiber$drawAsImage :function _trc_SpriteMod2D_f_drawAsImage(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=41002037;//kernel.SpriteMod2D:2037
        _this.prepareImage();
        //$LASTPOS=41002058;//kernel.SpriteMod2D:2058
        if (_this.pImg) {
          //$LASTPOS=41002104;//kernel.SpriteMod2D:2104
          ctx.save();
          //$LASTPOS=41002125;//kernel.SpriteMod2D:2125
          _this.performTransform(ctx);
          //$LASTPOS=41002157;//kernel.SpriteMod2D:2157
          ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,- _this.width/2,- _this.height/2,_this.width,_this.height);
          //$LASTPOS=41002289;//kernel.SpriteMod2D:2289
          ctx.restore();
          
        }
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"performTransform":{"nowait":true},"draw":{"nowait":true},"drawAsText":{"nowait":true},"drawAsShape":{"nowait":false},"drawAsCustom":{"nowait":false},"drawAsImage":{"nowait":false}},"fields":{"x":{},"y":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Sprites',
  shortName: 'Sprites',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.SpriteGroup,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Sprites_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=42000022;//kernel.Sprites:22
        "field strict";
        
        
      },
      fiber$main :function _trc_Sprites_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=42000022;//kernel.Sprites:22
        "field strict";
        
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Sprites_initialize() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=42000150;//kernel.Sprites:150
        _this.sprites=[];
        //$LASTPOS=42000167;//kernel.Sprites:167
        _this.imageList=[];
        //$LASTPOS=42000186;//kernel.Sprites:186
        _this.hitWatchers=[];
        //$LASTPOS=42000243;//kernel.Sprites:243
        _this.sx=0;
        //$LASTPOS=42000254;//kernel.Sprites:254
        _this.sy=0;
        //$LASTPOS=42000265;//kernel.Sprites:265
        _this.objId=0;
      },
      add :function _trc_Sprites_add(s) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=42000301;//kernel.Sprites:301
        if (Tonyu.globals.$Boot.newLimit) {
          //$LASTPOS=42000332;//kernel.Sprites:332
          Tonyu.globals.$Boot.newLimitCount--;
          //$LASTPOS=42000364;//kernel.Sprites:364
          if (Tonyu.globals.$Boot.newLimitCount<=0) {
            throw new Error("一度にたくさんのオブジェクトを作りすぎています\n"+"       $Boot.newLimitの値を変更すると、1フレーム間に生成できる オブジェクト+スレッドの合計数 を変更できます\n"+"       $Boot.newLimit="+Tonyu.globals.$Boot.newLimit+"; // 現在の オブジェクト数+スレッド数 の限度\n"+"       update(); // 次フレームから適用されます\n"+"       [参考] https://edit.tonyu.jp/doc/limitations.html\n");
            
          }
          
        }
        //$LASTPOS=42000745;//kernel.Sprites:745
        if (s.__addedToSprites) {
          return _this;
        }
        //$LASTPOS=42000782;//kernel.Sprites:782
        if (s instanceof Tonyu.classes.kernel.PlainChar) {
          //$LASTPOS=42000821;//kernel.Sprites:821
          _this.t1Sprites=_this.t1Sprites||[];
          
        }
        //$LASTPOS=42000858;//kernel.Sprites:858
        if (_this.drawing) {
          //$LASTPOS=42000882;//kernel.Sprites:882
          s.draw(_this.drawing);
          return _this;
          
        }
        //$LASTPOS=42000928;//kernel.Sprites:928
        _this.sprites.push(s);
        //$LASTPOS=42000950;//kernel.Sprites:950
        if (s.__genId==null) {
          //$LASTPOS=42000980;//kernel.Sprites:980
          s.__genId=_this.objId;
          //$LASTPOS=42001006;//kernel.Sprites:1006
          _this.objId++;
          
        }
        //$LASTPOS=42001027;//kernel.Sprites:1027
        s.__addedToSprites=_this;
        return s;
      },
      fiber$add :function _trc_Sprites_f_add(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=42000301;//kernel.Sprites:301
        if (Tonyu.globals.$Boot.newLimit) {
          //$LASTPOS=42000332;//kernel.Sprites:332
          Tonyu.globals.$Boot.newLimitCount--;
          //$LASTPOS=42000364;//kernel.Sprites:364
          if (Tonyu.globals.$Boot.newLimitCount<=0) {
            throw new Error("一度にたくさんのオブジェクトを作りすぎています\n"+"       $Boot.newLimitの値を変更すると、1フレーム間に生成できる オブジェクト+スレッドの合計数 を変更できます\n"+"       $Boot.newLimit="+Tonyu.globals.$Boot.newLimit+"; // 現在の オブジェクト数+スレッド数 の限度\n"+"       update(); // 次フレームから適用されます\n"+"       [参考] https://edit.tonyu.jp/doc/limitations.html\n");
            
          }
          
        }
        //$LASTPOS=42000745;//kernel.Sprites:745
        if (s.__addedToSprites) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=42000782;//kernel.Sprites:782
        if (s instanceof Tonyu.classes.kernel.PlainChar) {
          //$LASTPOS=42000821;//kernel.Sprites:821
          _this.t1Sprites=_this.t1Sprites||[];
          
        }
        //$LASTPOS=42000858;//kernel.Sprites:858
        if (_this.drawing) {
          //$LASTPOS=42000882;//kernel.Sprites:882
          s.draw(_this.drawing);
          _thread.retVal=_this;return;
          
          
        }
        //$LASTPOS=42000928;//kernel.Sprites:928
        _this.sprites.push(s);
        //$LASTPOS=42000950;//kernel.Sprites:950
        if (s.__genId==null) {
          //$LASTPOS=42000980;//kernel.Sprites:980
          s.__genId=_this.objId;
          //$LASTPOS=42001006;//kernel.Sprites:1006
          _this.objId++;
          
        }
        //$LASTPOS=42001027;//kernel.Sprites:1027
        s.__addedToSprites=_this;
        _thread.retVal=s;return;
        
        
        _thread.retVal=_this;return;
      },
      remove :function _trc_Sprites_remove(s) {
        "use strict";
        var _this=this;
        var idx;
        
        //$LASTPOS=42001097;//kernel.Sprites:1097
        idx = _this.sprites.indexOf(s);
        
        //$LASTPOS=42001130;//kernel.Sprites:1130
        if (idx<0) {
          return _this;
        }
        //$LASTPOS=42001154;//kernel.Sprites:1154
        _this.sprites.splice(idx,1);
        //$LASTPOS=42001182;//kernel.Sprites:1182
        delete s.__addedToSprites;
      },
      fiber$remove :function _trc_Sprites_f_remove(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var idx;
        
        //$LASTPOS=42001097;//kernel.Sprites:1097
        idx = _this.sprites.indexOf(s);
        
        //$LASTPOS=42001130;//kernel.Sprites:1130
        if (idx<0) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=42001154;//kernel.Sprites:1154
        _this.sprites.splice(idx,1);
        //$LASTPOS=42001182;//kernel.Sprites:1182
        delete s.__addedToSprites;
        
        _thread.retVal=_this;return;
      },
      removeOneframes :function _trc_Sprites_removeOneframes(drawn) {
        "use strict";
        var _this=this;
        var s;
        var i;
        
        
        //$LASTPOS=42001316;//kernel.Sprites:1316
        //$LASTPOS=42001321;//kernel.Sprites:1321
        i = _this.sprites.length-1;
        for (; i>=0 ; i--) {
          {
            //$LASTPOS=42001369;//kernel.Sprites:1369
            s=_this.sprites[i];
            //$LASTPOS=42001392;//kernel.Sprites:1392
            if (Tonyu.is(s,Tonyu.classes.kernel.OneframeSprite)&&(! drawn||s.drawn)) {
              //$LASTPOS=42001587;//kernel.Sprites:1587
              Tonyu.globals.$ObjectPool.poolList(s.getClassInfo().fullName).push(s);
              //$LASTPOS=42001659;//kernel.Sprites:1659
              _this.sprites.splice(i,1);
              
            }
          }
        }
      },
      fiber$removeOneframes :function _trc_Sprites_f_removeOneframes(_thread,drawn) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var s;
        var i;
        
        
        //$LASTPOS=42001316;//kernel.Sprites:1316
        //$LASTPOS=42001321;//kernel.Sprites:1321
        i = _this.sprites.length-1;
        for (; i>=0 ; i--) {
          {
            //$LASTPOS=42001369;//kernel.Sprites:1369
            s=_this.sprites[i];
            //$LASTPOS=42001392;//kernel.Sprites:1392
            if (Tonyu.is(s,Tonyu.classes.kernel.OneframeSprite)&&(! drawn||s.drawn)) {
              //$LASTPOS=42001587;//kernel.Sprites:1587
              Tonyu.globals.$ObjectPool.poolList(s.getClassInfo().fullName).push(s);
              //$LASTPOS=42001659;//kernel.Sprites:1659
              _this.sprites.splice(i,1);
              
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      clear :function _trc_Sprites_clear() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=42001720;//kernel.Sprites:1720
        _this.sprites.splice(0,_this.sprites.length);
      },
      fiber$clear :function _trc_Sprites_f_clear(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=42001720;//kernel.Sprites:1720
        _this.sprites.splice(0,_this.sprites.length);
        
        _thread.retVal=_this;return;
      },
      compOrder :function _trc_Sprites_compOrder(obj1,obj2) {
        "use strict";
        var _this=this;
        var val1;
        var val2;
        
        //$LASTPOS=42001793;//kernel.Sprites:1793
        val1 = obj1.zOrder||0;
        
        //$LASTPOS=42001823;//kernel.Sprites:1823
        val2 = obj2.zOrder||0;
        
        //$LASTPOS=42001853;//kernel.Sprites:1853
        if (val1>val2) {
          return - 1;
          
        } else {
          //$LASTPOS=42001899;//kernel.Sprites:1899
          if (val1<val2) {
            return 1;
            
          } else {
            //$LASTPOS=42001944;//kernel.Sprites:1944
            if (val1==val2) {
              //$LASTPOS=42001969;//kernel.Sprites:1969
              if (obj1.__genId>obj2.__genId) {
                return 1;
                
              } else {
                return - 1;
                
              }
              return 0;
              
            }
          }
        }
      },
      fiber$compOrder :function _trc_Sprites_f_compOrder(_thread,obj1,obj2) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var val1;
        var val2;
        
        //$LASTPOS=42001793;//kernel.Sprites:1793
        val1 = obj1.zOrder||0;
        
        //$LASTPOS=42001823;//kernel.Sprites:1823
        val2 = obj2.zOrder||0;
        
        //$LASTPOS=42001853;//kernel.Sprites:1853
        if (val1>val2) {
          _thread.retVal=- 1;return;
          
          
        } else {
          //$LASTPOS=42001899;//kernel.Sprites:1899
          if (val1<val2) {
            _thread.retVal=1;return;
            
            
          } else {
            //$LASTPOS=42001944;//kernel.Sprites:1944
            if (val1==val2) {
              //$LASTPOS=42001969;//kernel.Sprites:1969
              if (obj1.__genId>obj2.__genId) {
                _thread.retVal=1;return;
                
                
              } else {
                _thread.retVal=- 1;return;
                
                
              }
              _thread.retVal=0;return;
              
              
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_Sprites_draw(ctx,camera) {
        "use strict";
        var _this=this;
        var orderArray;
        
        //$LASTPOS=42002174;//kernel.Sprites:2174
        ctx.save();
        //$LASTPOS=42002191;//kernel.Sprites:2191
        orderArray = [];
        
        //$LASTPOS=42002215;//kernel.Sprites:2215
        if (_this.t1Sprites) {
          //$LASTPOS=42002241;//kernel.Sprites:2241
          _this.sprites.forEach((function anonymous_2257(s) {
            
            //$LASTPOS=42002277;//kernel.Sprites:2277
            if (s instanceof Tonyu.classes.kernel.PlainChar) {
              //$LASTPOS=42002324;//kernel.Sprites:2324
              s.draw();
              
            }
          }));
          //$LASTPOS=42002370;//kernel.Sprites:2370
          _this.sprites.forEach((function anonymous_2386(s) {
            
            //$LASTPOS=42002406;//kernel.Sprites:2406
            if (s instanceof Tonyu.classes.kernel.PlainChar) {
              
              
            } else {
              //$LASTPOS=42002456;//kernel.Sprites:2456
              orderArray.push(s);
            }
          }));
          
        } else {
          //$LASTPOS=42002511;//kernel.Sprites:2511
          orderArray=_this.sprites.slice();
          
        }
        //$LASTPOS=42002551;//kernel.Sprites:2551
        orderArray.sort(Tonyu.bindFunc(_this,_this.compOrder));
        //$LASTPOS=42002584;//kernel.Sprites:2584
        ctx.translate(- _this.sx,- _this.sy);
        //$LASTPOS=42002613;//kernel.Sprites:2613
        _this.drawing=ctx;
        //$LASTPOS=42002631;//kernel.Sprites:2631
        orderArray.forEach((function anonymous_2650(s) {
          
          //$LASTPOS=42002665;//kernel.Sprites:2665
          s.draw(ctx,camera);
        }));
        //$LASTPOS=42002700;//kernel.Sprites:2700
        _this.drawing=null;
        //$LASTPOS=42002719;//kernel.Sprites:2719
        ctx.restore();
      },
      fiber$draw :function _trc_Sprites_f_draw(_thread,ctx,camera) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var orderArray;
        
        //$LASTPOS=42002174;//kernel.Sprites:2174
        ctx.save();
        //$LASTPOS=42002191;//kernel.Sprites:2191
        orderArray = [];
        
        //$LASTPOS=42002215;//kernel.Sprites:2215
        if (_this.t1Sprites) {
          //$LASTPOS=42002241;//kernel.Sprites:2241
          _this.sprites.forEach((function anonymous_2257(s) {
            
            //$LASTPOS=42002277;//kernel.Sprites:2277
            if (s instanceof Tonyu.classes.kernel.PlainChar) {
              //$LASTPOS=42002324;//kernel.Sprites:2324
              s.draw();
              
            }
          }));
          //$LASTPOS=42002370;//kernel.Sprites:2370
          _this.sprites.forEach((function anonymous_2386(s) {
            
            //$LASTPOS=42002406;//kernel.Sprites:2406
            if (s instanceof Tonyu.classes.kernel.PlainChar) {
              
              
            } else {
              //$LASTPOS=42002456;//kernel.Sprites:2456
              orderArray.push(s);
            }
          }));
          
        } else {
          //$LASTPOS=42002511;//kernel.Sprites:2511
          orderArray=_this.sprites.slice();
          
        }
        //$LASTPOS=42002551;//kernel.Sprites:2551
        orderArray.sort(Tonyu.bindFunc(_this,_this.compOrder));
        //$LASTPOS=42002584;//kernel.Sprites:2584
        ctx.translate(- _this.sx,- _this.sy);
        //$LASTPOS=42002613;//kernel.Sprites:2613
        _this.drawing=ctx;
        //$LASTPOS=42002631;//kernel.Sprites:2631
        orderArray.forEach((function anonymous_2650(s) {
          
          //$LASTPOS=42002665;//kernel.Sprites:2665
          s.draw(ctx,camera);
        }));
        //$LASTPOS=42002700;//kernel.Sprites:2700
        _this.drawing=null;
        //$LASTPOS=42002719;//kernel.Sprites:2719
        ctx.restore();
        
        _thread.retVal=_this;return;
      },
      checkHit :function _trc_Sprites_checkHit() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=42002765;//kernel.Sprites:2765
        _this.hitWatchers.forEach((function anonymous_2785(w) {
          
          //$LASTPOS=42002809;//kernel.Sprites:2809
          _this.sprites.forEach((function anonymous_2825(a) {
            var a_owner;
            
            //$LASTPOS=42002897;//kernel.Sprites:2897
            a_owner = a;
            
            //$LASTPOS=42002939;//kernel.Sprites:2939
            if (! (a_owner instanceof w.A)) {
              return _this;
            }
            //$LASTPOS=42002992;//kernel.Sprites:2992
            _this.sprites.forEach((function anonymous_3008(b) {
              var b_owner;
              
              //$LASTPOS=42003040;//kernel.Sprites:3040
              b_owner = b;
              
              //$LASTPOS=42003086;//kernel.Sprites:3086
              if (a===b) {
                return _this;
              }
              //$LASTPOS=42003122;//kernel.Sprites:3122
              if (! (b_owner instanceof w.B)) {
                return _this;
              }
              //$LASTPOS=42003227;//kernel.Sprites:3227
              if (a.crashTo1(b)) {
                //$LASTPOS=42003330;//kernel.Sprites:3330
                w.h(a_owner,b_owner);
                
              }
            }));
          }));
        }));
      },
      fiber$checkHit :function _trc_Sprites_f_checkHit(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=42002765;//kernel.Sprites:2765
        _this.hitWatchers.forEach((function anonymous_2785(w) {
          
          //$LASTPOS=42002809;//kernel.Sprites:2809
          _this.sprites.forEach((function anonymous_2825(a) {
            var a_owner;
            
            //$LASTPOS=42002897;//kernel.Sprites:2897
            a_owner = a;
            
            //$LASTPOS=42002939;//kernel.Sprites:2939
            if (! (a_owner instanceof w.A)) {
              return _this;
            }
            //$LASTPOS=42002992;//kernel.Sprites:2992
            _this.sprites.forEach((function anonymous_3008(b) {
              var b_owner;
              
              //$LASTPOS=42003040;//kernel.Sprites:3040
              b_owner = b;
              
              //$LASTPOS=42003086;//kernel.Sprites:3086
              if (a===b) {
                return _this;
              }
              //$LASTPOS=42003122;//kernel.Sprites:3122
              if (! (b_owner instanceof w.B)) {
                return _this;
              }
              //$LASTPOS=42003227;//kernel.Sprites:3227
              if (a.crashTo1(b)) {
                //$LASTPOS=42003330;//kernel.Sprites:3330
                w.h(a_owner,b_owner);
                
              }
            }));
          }));
        }));
        
        _thread.retVal=_this;return;
      },
      watchHit :function _trc_Sprites_watchHit(typeA,typeB,onHit) {
        "use strict";
        var _this=this;
        var p;
        
        //$LASTPOS=42003460;//kernel.Sprites:3460
        p = {A: typeA,B: typeB,h: onHit};
        
        //$LASTPOS=42003524;//kernel.Sprites:3524
        _this.hitWatchers.push(p);
      },
      fiber$watchHit :function _trc_Sprites_f_watchHit(_thread,typeA,typeB,onHit) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        
        //$LASTPOS=42003460;//kernel.Sprites:3460
        p = {A: typeA,B: typeB,h: onHit};
        
        //$LASTPOS=42003524;//kernel.Sprites:3524
        _this.hitWatchers.push(p);
        
        _thread.retVal=_this;return;
      },
      drawGrid :function _trc_Sprites_drawGrid(c) {
        "use strict";
        var _this=this;
        var ctx;
        var i;
        
        //$LASTPOS=42003577;//kernel.Sprites:3577
        ctx = c.getContext("2d");
        
        //$LASTPOS=42003610;//kernel.Sprites:3610
        ctx.textBaseline="top";
        //$LASTPOS=42003639;//kernel.Sprites:3639
        ctx.save();
        //$LASTPOS=42003656;//kernel.Sprites:3656
        ctx.strokeStyle="rgb(40,100,200)";
        //$LASTPOS=42003696;//kernel.Sprites:3696
        //$LASTPOS=42003701;//kernel.Sprites:3701
        i = 0;
        for (; i<c.width ; i+=10) {
          {
            //$LASTPOS=42003741;//kernel.Sprites:3741
            ctx.beginPath();
            //$LASTPOS=42003767;//kernel.Sprites:3767
            ctx.lineWidth=(i%100==0?4:1);
            //$LASTPOS=42003813;//kernel.Sprites:3813
            ctx.moveTo(i,0);
            //$LASTPOS=42003839;//kernel.Sprites:3839
            ctx.lineTo(i,c.height);
            //$LASTPOS=42003872;//kernel.Sprites:3872
            ctx.closePath();
            //$LASTPOS=42003898;//kernel.Sprites:3898
            ctx.stroke();
          }
        }
        //$LASTPOS=42003926;//kernel.Sprites:3926
        //$LASTPOS=42003931;//kernel.Sprites:3931
        i = 0;
        for (; i<c.height ; i+=10) {
          {
            //$LASTPOS=42003972;//kernel.Sprites:3972
            ctx.beginPath();
            //$LASTPOS=42003998;//kernel.Sprites:3998
            ctx.lineWidth=(i%100==0?4:1);
            //$LASTPOS=42004044;//kernel.Sprites:4044
            ctx.moveTo(0,i);
            //$LASTPOS=42004070;//kernel.Sprites:4070
            ctx.lineTo(c.width,i);
            //$LASTPOS=42004102;//kernel.Sprites:4102
            ctx.closePath();
            //$LASTPOS=42004128;//kernel.Sprites:4128
            ctx.stroke();
          }
        }
        //$LASTPOS=42004154;//kernel.Sprites:4154
        ctx.fillStyle="white";
        //$LASTPOS=42004182;//kernel.Sprites:4182
        ctx.font="15px monospaced";
        //$LASTPOS=42004215;//kernel.Sprites:4215
        //$LASTPOS=42004220;//kernel.Sprites:4220
        i = 100;
        for (; i<c.width ; i+=100) {
          {
            //$LASTPOS=42004263;//kernel.Sprites:4263
            ctx.fillText(i,i,0);
          }
        }
        //$LASTPOS=42004297;//kernel.Sprites:4297
        //$LASTPOS=42004302;//kernel.Sprites:4302
        i = 100;
        for (; i<c.height ; i+=100) {
          {
            //$LASTPOS=42004346;//kernel.Sprites:4346
            ctx.fillText(i,0,i);
          }
        }
        //$LASTPOS=42004380;//kernel.Sprites:4380
        ctx.restore();
      },
      fiber$drawGrid :function _trc_Sprites_f_drawGrid(_thread,c) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        var i;
        
        //$LASTPOS=42003577;//kernel.Sprites:3577
        ctx = c.getContext("2d");
        
        //$LASTPOS=42003610;//kernel.Sprites:3610
        ctx.textBaseline="top";
        //$LASTPOS=42003639;//kernel.Sprites:3639
        ctx.save();
        //$LASTPOS=42003656;//kernel.Sprites:3656
        ctx.strokeStyle="rgb(40,100,200)";
        //$LASTPOS=42003696;//kernel.Sprites:3696
        //$LASTPOS=42003701;//kernel.Sprites:3701
        i = 0;
        for (; i<c.width ; i+=10) {
          {
            //$LASTPOS=42003741;//kernel.Sprites:3741
            ctx.beginPath();
            //$LASTPOS=42003767;//kernel.Sprites:3767
            ctx.lineWidth=(i%100==0?4:1);
            //$LASTPOS=42003813;//kernel.Sprites:3813
            ctx.moveTo(i,0);
            //$LASTPOS=42003839;//kernel.Sprites:3839
            ctx.lineTo(i,c.height);
            //$LASTPOS=42003872;//kernel.Sprites:3872
            ctx.closePath();
            //$LASTPOS=42003898;//kernel.Sprites:3898
            ctx.stroke();
          }
        }
        //$LASTPOS=42003926;//kernel.Sprites:3926
        //$LASTPOS=42003931;//kernel.Sprites:3931
        i = 0;
        for (; i<c.height ; i+=10) {
          {
            //$LASTPOS=42003972;//kernel.Sprites:3972
            ctx.beginPath();
            //$LASTPOS=42003998;//kernel.Sprites:3998
            ctx.lineWidth=(i%100==0?4:1);
            //$LASTPOS=42004044;//kernel.Sprites:4044
            ctx.moveTo(0,i);
            //$LASTPOS=42004070;//kernel.Sprites:4070
            ctx.lineTo(c.width,i);
            //$LASTPOS=42004102;//kernel.Sprites:4102
            ctx.closePath();
            //$LASTPOS=42004128;//kernel.Sprites:4128
            ctx.stroke();
          }
        }
        //$LASTPOS=42004154;//kernel.Sprites:4154
        ctx.fillStyle="white";
        //$LASTPOS=42004182;//kernel.Sprites:4182
        ctx.font="15px monospaced";
        //$LASTPOS=42004215;//kernel.Sprites:4215
        //$LASTPOS=42004220;//kernel.Sprites:4220
        i = 100;
        for (; i<c.width ; i+=100) {
          {
            //$LASTPOS=42004263;//kernel.Sprites:4263
            ctx.fillText(i,i,0);
          }
        }
        //$LASTPOS=42004297;//kernel.Sprites:4297
        //$LASTPOS=42004302;//kernel.Sprites:4302
        i = 100;
        for (; i<c.height ; i+=100) {
          {
            //$LASTPOS=42004346;//kernel.Sprites:4346
            ctx.fillText(i,0,i);
          }
        }
        //$LASTPOS=42004380;//kernel.Sprites:4380
        ctx.restore();
        
        _thread.retVal=_this;return;
      },
      scrollTo :function _trc_Sprites_scrollTo(scrollX,scrollY) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=42004440;//kernel.Sprites:4440
        _this.sx=scrollX;
        //$LASTPOS=42004457;//kernel.Sprites:4457
        _this.sy=scrollY;
      },
      fiber$scrollTo :function _trc_Sprites_f_scrollTo(_thread,scrollX,scrollY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=42004440;//kernel.Sprites:4440
        _this.sx=scrollX;
        //$LASTPOS=42004457;//kernel.Sprites:4457
        _this.sy=scrollY;
        
        _thread.retVal=_this;return;
      },
      all :function _trc_Sprites_all(c) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=42004497;//kernel.Sprites:4497
        res = new Tonyu.classes.kernel.TQuery;
        
        //$LASTPOS=42004522;//kernel.Sprites:4522
        if (arguments.length>0&&typeof  c!="function") {
          return res;
          
        }
        //$LASTPOS=42004605;//kernel.Sprites:4605
        _this.sprites.forEach((function anonymous_4621(s) {
          
          //$LASTPOS=42004637;//kernel.Sprites:4637
          if (s===_this) {
            return _this;
          }
          //$LASTPOS=42004668;//kernel.Sprites:4668
          if (! c||s instanceof c) {
            //$LASTPOS=42004709;//kernel.Sprites:4709
            res.push(s);
            
          }
        }));
        return res;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"add":{"nowait":false},"remove":{"nowait":false},"removeOneframes":{"nowait":false},"clear":{"nowait":false},"compOrder":{"nowait":false},"draw":{"nowait":false},"checkHit":{"nowait":false},"watchHit":{"nowait":false},"drawGrid":{"nowait":false},"scrollTo":{"nowait":false},"all":{"nowait":true}},"fields":{"imageList":{},"hitWatchers":{},"objId":{},"t1Sprites":{},"drawing":{},"sx":{},"sy":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Sprites3D',
  shortName: 'Sprites3D',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.SpriteGroup,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Sprites3D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=43000039;//kernel.Sprites3D:39
        "field strict";
      },
      fiber$main :function _trc_Sprites3D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=43000039;//kernel.Sprites3D:39
        "field strict";
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Sprites3D_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=43000071;//kernel.Sprites3D:71
        __superClass.apply( _this, [p]);
        //$LASTPOS=43000086;//kernel.Sprites3D:86
        _this.sprites=[];
        //$LASTPOS=43000103;//kernel.Sprites3D:103
        _this.transform=_this.transform||new Tonyu.classes.kernel.Transform;
      },
      add :function _trc_Sprites3D_add(a) {
        "use strict";
        var _this=this;
        var curLayer;
        
        //$LASTPOS=43000166;//kernel.Sprites3D:166
        curLayer = a.getSpriteGroup();
        
        //$LASTPOS=43000204;//kernel.Sprites3D:204
        if (curLayer) {
          //$LASTPOS=43000229;//kernel.Sprites3D:229
          curLayer.remove(a);
          
        }
        //$LASTPOS=43000261;//kernel.Sprites3D:261
        if (! a.transform.parent) {
          //$LASTPOS=43000297;//kernel.Sprites3D:297
          a.transform.parent=_this.transform;
          
        } else {
          //$LASTPOS=43000350;//kernel.Sprites3D:350
          a.transform.changeParent(_this.transform);
          
        }
        //$LASTPOS=43000600;//kernel.Sprites3D:600
        _this.sprites.push(a);
        //$LASTPOS=43000622;//kernel.Sprites3D:622
        a.__addedToSprites=_this;
      },
      fiber$add :function _trc_Sprites3D_f_add(_thread,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var curLayer;
        
        //$LASTPOS=43000166;//kernel.Sprites3D:166
        curLayer = a.getSpriteGroup();
        
        //$LASTPOS=43000204;//kernel.Sprites3D:204
        if (curLayer) {
          //$LASTPOS=43000229;//kernel.Sprites3D:229
          curLayer.remove(a);
          
        }
        //$LASTPOS=43000261;//kernel.Sprites3D:261
        if (! a.transform.parent) {
          //$LASTPOS=43000297;//kernel.Sprites3D:297
          a.transform.parent=_this.transform;
          
        } else {
          //$LASTPOS=43000350;//kernel.Sprites3D:350
          a.transform.changeParent(_this.transform);
          
        }
        //$LASTPOS=43000600;//kernel.Sprites3D:600
        _this.sprites.push(a);
        //$LASTPOS=43000622;//kernel.Sprites3D:622
        a.__addedToSprites=_this;
        
        _thread.retVal=_this;return;
      },
      draw3D :function _trc_Sprites3D_draw3D(ctx) {
        "use strict";
        var _this=this;
        var s;
        var _it_360;
        
        //$LASTPOS=43000681;//kernel.Sprites3D:681
        _it_360=Tonyu.iterator(_this.sprites,1);
        while(_it_360.next()) {
          s=_it_360[0];
          
          //$LASTPOS=43000715;//kernel.Sprites3D:715
          s.draw3D(ctx);
          
        }
      },
      fiber$draw3D :function _trc_Sprites3D_f_draw3D(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var s;
        var _it_360;
        
        //$LASTPOS=43000681;//kernel.Sprites3D:681
        _it_360=Tonyu.iterator(_this.sprites,1);
        while(_it_360.next()) {
          s=_it_360[0];
          
          //$LASTPOS=43000715;//kernel.Sprites3D:715
          s.draw3D(ctx);
          
        }
        
        _thread.retVal=_this;return;
      },
      remove :function _trc_Sprites3D_remove(s) {
        "use strict";
        var _this=this;
        var idx;
        
        //$LASTPOS=43000801;//kernel.Sprites3D:801
        idx = _this.sprites.indexOf(s);
        
        //$LASTPOS=43000864;//kernel.Sprites3D:864
        if (idx<0) {
          return _this;
        }
        //$LASTPOS=43000888;//kernel.Sprites3D:888
        _this.sprites.splice(idx,1);
        //$LASTPOS=43000916;//kernel.Sprites3D:916
        delete s.__addedToSprites;
      },
      all :function _trc_Sprites3D_all(c) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=43001007;//kernel.Sprites3D:1007
        res = new Tonyu.classes.kernel.TQuery;
        
        //$LASTPOS=43001032;//kernel.Sprites3D:1032
        if (arguments.length>0&&typeof  c!="function") {
          return res;
          
        }
        //$LASTPOS=43001115;//kernel.Sprites3D:1115
        _this.sprites.forEach((function anonymous_1131(s) {
          
          //$LASTPOS=43001147;//kernel.Sprites3D:1147
          if (s===_this) {
            return _this;
          }
          //$LASTPOS=43001178;//kernel.Sprites3D:1178
          if (! c||s instanceof c) {
            //$LASTPOS=43001219;//kernel.Sprites3D:1219
            res.push(s);
            
          }
        }));
        return res;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"add":{"nowait":false},"draw3D":{"nowait":false},"remove":{"nowait":true},"all":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.MML',
  shortName: 'MML',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_MML_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=44000050;//kernel.MML:50
        _this.mmlBuf=[];
      },
      fiber$main :function _trc_MML_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=44000050;//kernel.MML:50
        _this.mmlBuf=[];
        
        _thread.retVal=_this;return;
      },
      play :function _trc_MML_play(mmls) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=44000081;//kernel.MML:81
        _this.mmlBuf.push(mmls);
        //$LASTPOS=44000105;//kernel.MML:105
        if (! _this.isPlaying()) {
          //$LASTPOS=44000134;//kernel.MML:134
          _this.playNext();
          
        }
      },
      fiber$play :function _trc_MML_f_play(_thread,mmls) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=44000081;//kernel.MML:81
        _this.mmlBuf.push(mmls);
        
        _thread.enter(function _trc_MML_ent_play(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=44000105;//kernel.MML:105
              if (!(! _this.isPlaying())) { __pc=2     ; break; }
              //$LASTPOS=44000134;//kernel.MML:134
              _this.fiber$playNext(_thread);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      playNext :function _trc_MML_playNext() {
        "use strict";
        var _this=this;
        var mml;
        
        //$LASTPOS=44000220;//kernel.MML:220
        if (_this.cTimeBase==null) {
          //$LASTPOS=44000241;//kernel.MML:241
          _this.cTimeBase=0;
        }
        //$LASTPOS=44000259;//kernel.MML:259
        if (_this.m) {
          //$LASTPOS=44000277;//kernel.MML:277
          _this.cTimeBase+=_this.m.currentTime;
          
        }
        //$LASTPOS=44000348;//kernel.MML:348
        mml = _this.mmlBuf.shift();
        
        //$LASTPOS=44000377;//kernel.MML:377
        if (! mml) {
          //$LASTPOS=44000398;//kernel.MML:398
          _this.m=null;
          //$LASTPOS=44000415;//kernel.MML:415
          _this.cTimeBase=0;
          return _this;
          
        }
        //$LASTPOS=44000457;//kernel.MML:457
        _this.mwav=Tonyu.globals.$WaveTable.get(0,0).play();
        //$LASTPOS=44000495;//kernel.MML:495
        _this.m=T("mml",{mml: mml},_this.mwav);
        //$LASTPOS=44000525;//kernel.MML:525
        _this.m.on("ended",Tonyu.bindFunc(_this,_this.playNext));
        //$LASTPOS=44000555;//kernel.MML:555
        _this.m.start();
        //$LASTPOS=44000571;//kernel.MML:571
        Tonyu.globals.$MMLS[_this.id()]=_this;
      },
      fiber$playNext :function _trc_MML_f_playNext(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var mml;
        
        //$LASTPOS=44000220;//kernel.MML:220
        if (_this.cTimeBase==null) {
          //$LASTPOS=44000241;//kernel.MML:241
          _this.cTimeBase=0;
        }
        //$LASTPOS=44000259;//kernel.MML:259
        if (_this.m) {
          //$LASTPOS=44000277;//kernel.MML:277
          _this.cTimeBase+=_this.m.currentTime;
          
        }
        //$LASTPOS=44000348;//kernel.MML:348
        mml = _this.mmlBuf.shift();
        
        //$LASTPOS=44000377;//kernel.MML:377
        if (! mml) {
          //$LASTPOS=44000398;//kernel.MML:398
          _this.m=null;
          //$LASTPOS=44000415;//kernel.MML:415
          _this.cTimeBase=0;
          _thread.retVal=_this;return;
          
          
        }
        //$LASTPOS=44000457;//kernel.MML:457
        _this.mwav=Tonyu.globals.$WaveTable.get(0,0).play();
        //$LASTPOS=44000495;//kernel.MML:495
        _this.m=T("mml",{mml: mml},_this.mwav);
        //$LASTPOS=44000525;//kernel.MML:525
        _this.m.on("ended",Tonyu.bindFunc(_this,_this.playNext));
        //$LASTPOS=44000555;//kernel.MML:555
        _this.m.start();
        //$LASTPOS=44000571;//kernel.MML:571
        Tonyu.globals.$MMLS[_this.id()]=_this;
        
        _thread.retVal=_this;return;
      },
      id :function _trc_MML_id() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=44000606;//kernel.MML:606
        if (! _this._id) {
          //$LASTPOS=44000616;//kernel.MML:616
          _this._id=_this.rnd()+"";
        }
        return _this._id;
      },
      fiber$id :function _trc_MML_f_id(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=44000606;//kernel.MML:606
        if (! _this._id) {
          //$LASTPOS=44000616;//kernel.MML:616
          _this._id=_this.rnd()+"";
        }
        _thread.retVal=_this._id;return;
        
        
        _thread.retVal=_this;return;
      },
      bufferCount :function _trc_MML_bufferCount() {
        "use strict";
        var _this=this;
        
        return _this.mmlBuf.length;
      },
      fiber$bufferCount :function _trc_MML_f_bufferCount(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.mmlBuf.length;return;
        
        
        _thread.retVal=_this;return;
      },
      isPlaying :function _trc_MML_isPlaying() {
        "use strict";
        var _this=this;
        
        return _this.m;
      },
      fiber$isPlaying :function _trc_MML_f_isPlaying(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.m;return;
        
        
        _thread.retVal=_this;return;
      },
      currentTime :function _trc_MML_currentTime() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=44000755;//kernel.MML:755
        if (_this.m) {
          return _this.m.currentTime+_this.cTimeBase;
        }
        return - 1;
      },
      fiber$currentTime :function _trc_MML_f_currentTime(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=44000755;//kernel.MML:755
        if (_this.m) {
          _thread.retVal=_this.m.currentTime+_this.cTimeBase;return;
          
        }
        _thread.retVal=- 1;return;
        
        
        _thread.retVal=_this;return;
      },
      stop :function _trc_MML_stop() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=44000829;//kernel.MML:829
        if (_this.m) {
          //$LASTPOS=44000847;//kernel.MML:847
          if (_this.mwav) {
            //$LASTPOS=44000872;//kernel.MML:872
            _this.mwav.pause();
            //$LASTPOS=44000899;//kernel.MML:899
            _this.mwav.stop();
            
          }
          //$LASTPOS=44000932;//kernel.MML:932
          _this.m.pause();
          //$LASTPOS=44000952;//kernel.MML:952
          _this.m.stop();
          //$LASTPOS=44000971;//kernel.MML:971
          _this.m=null;
          //$LASTPOS=44000988;//kernel.MML:988
          _this.mmlBuf=[];
          //$LASTPOS=44001056;//kernel.MML:1056
          delete Tonyu.globals.$MMLS[_this.id()];
          
        }
      },
      fiber$stop :function _trc_MML_f_stop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=44000829;//kernel.MML:829
        if (_this.m) {
          //$LASTPOS=44000847;//kernel.MML:847
          if (_this.mwav) {
            //$LASTPOS=44000872;//kernel.MML:872
            _this.mwav.pause();
            //$LASTPOS=44000899;//kernel.MML:899
            _this.mwav.stop();
            
          }
          //$LASTPOS=44000932;//kernel.MML:932
          _this.m.pause();
          //$LASTPOS=44000952;//kernel.MML:952
          _this.m.stop();
          //$LASTPOS=44000971;//kernel.MML:971
          _this.m=null;
          //$LASTPOS=44000988;//kernel.MML:988
          _this.mmlBuf=[];
          //$LASTPOS=44001056;//kernel.MML:1056
          delete Tonyu.globals.$MMLS[_this.id()];
          
        }
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"play":{"nowait":false},"playNext":{"nowait":false},"id":{"nowait":false},"bufferCount":{"nowait":false},"isPlaying":{"nowait":false},"currentTime":{"nowait":false},"stop":{"nowait":false}},"fields":{"mmlBuf":{},"cTimeBase":{},"m":{},"mwav":{},"_id":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.WaveTable',
  shortName: 'WaveTable',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_WaveTable_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=45000031;//kernel.WaveTable:31
        _this.wav={};
        //$LASTPOS=45000040;//kernel.WaveTable:40
        _this.env={};
        //$LASTPOS=45000335;//kernel.WaveTable:335
        if (typeof  T!=="undefined") {
          //$LASTPOS=45000416;//kernel.WaveTable:416
          _this.env=T("env",{table: [1,[0.6,50],[0,100]],releaseNode: 2});
          //$LASTPOS=45000485;//kernel.WaveTable:485
          _this.setEnv(0,_this.env);
          //$LASTPOS=45000506;//kernel.WaveTable:506
          _this.setWav(0,T("pulse"));
          
        }
      },
      fiber$main :function _trc_WaveTable_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=45000031;//kernel.WaveTable:31
        _this.wav={};
        //$LASTPOS=45000040;//kernel.WaveTable:40
        _this.env={};
        
        _thread.enter(function _trc_WaveTable_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=45000335;//kernel.WaveTable:335
              if (!(typeof  T!=="undefined")) { __pc=3     ; break; }
              //$LASTPOS=45000416;//kernel.WaveTable:416
              _this.env=T("env",{table: [1,[0.6,50],[0,100]],releaseNode: 2});
              //$LASTPOS=45000485;//kernel.WaveTable:485
              _this.fiber$setEnv(_thread, 0, _this.env);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=45000506;//kernel.WaveTable:506
              _this.fiber$setWav(_thread, 0, T("pulse"));
              __pc=2;return;
            case 2:
              
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      setWav :function _trc_WaveTable_setWav(num,synth) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=45000076;//kernel.WaveTable:76
        _this.wav[num]=synth;
      },
      fiber$setWav :function _trc_WaveTable_f_setWav(_thread,num,synth) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=45000076;//kernel.WaveTable:76
        _this.wav[num]=synth;
        
        _thread.retVal=_this;return;
      },
      setEnv :function _trc_WaveTable_setEnv(num,synth) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=45000123;//kernel.WaveTable:123
        _this.env[num]=synth;
      },
      fiber$setEnv :function _trc_WaveTable_f_setEnv(_thread,num,synth) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=45000123;//kernel.WaveTable:123
        _this.env[num]=synth;
        
        _thread.retVal=_this;return;
      },
      get :function _trc_WaveTable_get(w,e) {
        "use strict";
        var _this=this;
        var synth;
        
        //$LASTPOS=45000160;//kernel.WaveTable:160
        synth = T("OscGen",{osc: _this.wav[w],env: _this.env[e],mul: 0.25});
        
        return synth;
      },
      fiber$get :function _trc_WaveTable_f_get(_thread,w,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var synth;
        
        //$LASTPOS=45000160;//kernel.WaveTable:160
        synth = T("OscGen",{osc: _this.wav[w],env: _this.env[e],mul: 0.25});
        
        _thread.retVal=synth;return;
        
        
        _thread.retVal=_this;return;
      },
      stop :function _trc_WaveTable_stop() {
        "use strict";
        var _this=this;
        
      },
      fiber$stop :function _trc_WaveTable_f_stop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"setWav":{"nowait":false},"setEnv":{"nowait":false},"get":{"nowait":false},"stop":{"nowait":false}},"fields":{"wav":{},"env":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.T1Line',
  shortName: 'T1Line',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.OneframeSprite,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T1Line_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T1Line_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_T1Line_draw(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=46000043;//kernel.T1Line:43
        ctx.strokeStyle=_this.col+"";
        //$LASTPOS=46000072;//kernel.T1Line:72
        ctx.beginPath();
        //$LASTPOS=46000094;//kernel.T1Line:94
        ctx.moveTo(_this.x,_this.y);
        //$LASTPOS=46000116;//kernel.T1Line:116
        ctx.lineTo(_this.tx,_this.ty);
        //$LASTPOS=46000140;//kernel.T1Line:140
        ctx.stroke();
        //$LASTPOS=46000159;//kernel.T1Line:159
        _this.drawn=true;
      },
      fiber$draw :function _trc_T1Line_f_draw(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=46000043;//kernel.T1Line:43
        ctx.strokeStyle=_this.col+"";
        //$LASTPOS=46000072;//kernel.T1Line:72
        ctx.beginPath();
        //$LASTPOS=46000094;//kernel.T1Line:94
        ctx.moveTo(_this.x,_this.y);
        //$LASTPOS=46000116;//kernel.T1Line:116
        ctx.lineTo(_this.tx,_this.ty);
        //$LASTPOS=46000140;//kernel.T1Line:140
        ctx.stroke();
        //$LASTPOS=46000159;//kernel.T1Line:159
        _this.drawn=true;
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"draw":{"nowait":false}},"fields":{"col":{},"x":{},"y":{},"tx":{},"ty":{},"drawn":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.T1Rect',
  shortName: 'T1Rect',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.OneframeSprite,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T1Rect_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T1Rect_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_T1Rect_draw(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=47000041;//kernel.T1Rect:41
        ctx.fillStyle=_this.col+"";
        //$LASTPOS=47000067;//kernel.T1Rect:67
        ctx.fillRect(_this.x,_this.y,_this.w,_this.h);
        //$LASTPOS=47000094;//kernel.T1Rect:94
        _this.drawn=true;
      },
      fiber$draw :function _trc_T1Rect_f_draw(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=47000041;//kernel.T1Rect:41
        ctx.fillStyle=_this.col+"";
        //$LASTPOS=47000067;//kernel.T1Rect:67
        ctx.fillRect(_this.x,_this.y,_this.w,_this.h);
        //$LASTPOS=47000094;//kernel.T1Rect:94
        _this.drawn=true;
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"draw":{"nowait":false}},"fields":{"col":{},"x":{},"y":{},"w":{},"h":{},"drawn":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.T1Sprite',
  shortName: 'T1Sprite',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.OneframeSprite,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T1Sprite_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T1Sprite_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_T1Sprite_draw(ctx) {
        "use strict";
        var _this=this;
        var sgn;
        
        //$LASTPOS=48000057;//kernel.T1Sprite:57
        _this.pImg=Tonyu.globals.$imageList[Math.floor(_this.p||0)];
        //$LASTPOS=48000097;//kernel.T1Sprite:97
        if (! _this.pImg) {
          return _this;
        }
        //$LASTPOS=48000121;//kernel.T1Sprite:121
        ctx.save();
        //$LASTPOS=48000138;//kernel.T1Sprite:138
        ctx.translate(_this.x,_this.y);
        //$LASTPOS=48000163;//kernel.T1Sprite:163
        ctx.rotate(_this.angle/180*Math.PI);
        //$LASTPOS=48000204;//kernel.T1Sprite:204
        sgn = (_this.f?- 1:1);
        
        //$LASTPOS=48000227;//kernel.T1Sprite:227
        if (typeof  _this.scaleY==="undefined") {
          //$LASTPOS=48000275;//kernel.T1Sprite:275
          ctx.scale(_this.scaleX*sgn,_this.scaleX);
          
        } else {
          //$LASTPOS=48000336;//kernel.T1Sprite:336
          ctx.scale(_this.scaleX*sgn,_this.scaleY);
          
        }
        //$LASTPOS=48000388;//kernel.T1Sprite:388
        ctx.globalAlpha=_this.alpha/255;
        //$LASTPOS=48000425;//kernel.T1Sprite:425
        ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,- _this.pImg.width/2,- _this.pImg.height/2,_this.pImg.width,_this.pImg.height);
        //$LASTPOS=48000565;//kernel.T1Sprite:565
        ctx.restore();
        //$LASTPOS=48000585;//kernel.T1Sprite:585
        _this.drawn=true;
      },
      fiber$draw :function _trc_T1Sprite_f_draw(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var sgn;
        
        //$LASTPOS=48000057;//kernel.T1Sprite:57
        _this.pImg=Tonyu.globals.$imageList[Math.floor(_this.p||0)];
        //$LASTPOS=48000097;//kernel.T1Sprite:97
        if (! _this.pImg) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=48000121;//kernel.T1Sprite:121
        ctx.save();
        //$LASTPOS=48000138;//kernel.T1Sprite:138
        ctx.translate(_this.x,_this.y);
        //$LASTPOS=48000163;//kernel.T1Sprite:163
        ctx.rotate(_this.angle/180*Math.PI);
        //$LASTPOS=48000204;//kernel.T1Sprite:204
        sgn = (_this.f?- 1:1);
        
        //$LASTPOS=48000227;//kernel.T1Sprite:227
        if (typeof  _this.scaleY==="undefined") {
          //$LASTPOS=48000275;//kernel.T1Sprite:275
          ctx.scale(_this.scaleX*sgn,_this.scaleX);
          
        } else {
          //$LASTPOS=48000336;//kernel.T1Sprite:336
          ctx.scale(_this.scaleX*sgn,_this.scaleY);
          
        }
        //$LASTPOS=48000388;//kernel.T1Sprite:388
        ctx.globalAlpha=_this.alpha/255;
        //$LASTPOS=48000425;//kernel.T1Sprite:425
        ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,- _this.pImg.width/2,- _this.pImg.height/2,_this.pImg.width,_this.pImg.height);
        //$LASTPOS=48000565;//kernel.T1Sprite:565
        ctx.restore();
        //$LASTPOS=48000585;//kernel.T1Sprite:585
        _this.drawn=true;
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"draw":{"nowait":false}},"fields":{"pImg":{},"p":{},"x":{},"y":{},"f":{},"drawn":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.T1Text',
  shortName: 'T1Text',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.OneframeSprite,
  includes: [Tonyu.classes.kernel.TextRectMod],
  methods: function (__superClass) {
    return {
      main :function _trc_T1Text_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T1Text_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_T1Text_draw(ctx) {
        "use strict";
        var _this=this;
        var splitsText;
        var drawY;
        var textCount;
        var rect;
        
        //$LASTPOS=49000066;//kernel.T1Text:66
        ctx.font=_this.size+"px 'ＭＳ Ｐゴシック'";
        //$LASTPOS=49000102;//kernel.T1Text:102
        splitsText = (_this.text+"").split("\n");
        
        //$LASTPOS=49000145;//kernel.T1Text:145
        drawY = _this.y;
        
        //$LASTPOS=49000163;//kernel.T1Text:163
        if (! _this.size) {
          //$LASTPOS=49000174;//kernel.T1Text:174
          _this.size=15;
        }
        //$LASTPOS=49000188;//kernel.T1Text:188
        if (! _this.align) {
          //$LASTPOS=49000200;//kernel.T1Text:200
          _this.align="left";
        }
        //$LASTPOS=49000219;//kernel.T1Text:219
        if (! _this.fillStyle) {
          //$LASTPOS=49000235;//kernel.T1Text:235
          _this.fillStyle="white";
        }
        //$LASTPOS=49000259;//kernel.T1Text:259
        ctx.fillStyle=_this.col+"";
        //$LASTPOS=49000286;//kernel.T1Text:286
        ctx.globalAlpha=_this.alpha/255;
        //$LASTPOS=49000323;//kernel.T1Text:323
        _this.height=0;
        //$LASTPOS=49000332;//kernel.T1Text:332
        _this.width=0;
        //$LASTPOS=49000346;//kernel.T1Text:346
        //$LASTPOS=49000350;//kernel.T1Text:350
        textCount = 0;
        for (; textCount<splitsText.length ; textCount++) {
          {
            //$LASTPOS=49000417;//kernel.T1Text:417
            rect = _this.drawTextRect(ctx,splitsText[textCount],_this.x,drawY,_this.size,_this.align,"fill");
            
            //$LASTPOS=49000509;//kernel.T1Text:509
            if (_this.width<rect.w) {
              //$LASTPOS=49000526;//kernel.T1Text:526
              _this.width=rect.w;
            }
            //$LASTPOS=49000549;//kernel.T1Text:549
            _this.height+=rect.h;
            //$LASTPOS=49000574;//kernel.T1Text:574
            drawY+=_this.size;
          }
        }
        //$LASTPOS=49000599;//kernel.T1Text:599
        _this.owner.width=_this.width;
        //$LASTPOS=49000623;//kernel.T1Text:623
        _this.owner.height=_this.height;
        //$LASTPOS=49000649;//kernel.T1Text:649
        _this.drawn=true;
      },
      fiber$draw :function _trc_T1Text_f_draw(_thread,ctx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var splitsText;
        var drawY;
        var textCount;
        var rect;
        
        //$LASTPOS=49000066;//kernel.T1Text:66
        ctx.font=_this.size+"px 'ＭＳ Ｐゴシック'";
        //$LASTPOS=49000102;//kernel.T1Text:102
        splitsText = (_this.text+"").split("\n");
        
        //$LASTPOS=49000145;//kernel.T1Text:145
        drawY = _this.y;
        
        //$LASTPOS=49000163;//kernel.T1Text:163
        if (! _this.size) {
          //$LASTPOS=49000174;//kernel.T1Text:174
          _this.size=15;
        }
        //$LASTPOS=49000188;//kernel.T1Text:188
        if (! _this.align) {
          //$LASTPOS=49000200;//kernel.T1Text:200
          _this.align="left";
        }
        //$LASTPOS=49000219;//kernel.T1Text:219
        if (! _this.fillStyle) {
          //$LASTPOS=49000235;//kernel.T1Text:235
          _this.fillStyle="white";
        }
        //$LASTPOS=49000259;//kernel.T1Text:259
        ctx.fillStyle=_this.col+"";
        //$LASTPOS=49000286;//kernel.T1Text:286
        ctx.globalAlpha=_this.alpha/255;
        //$LASTPOS=49000323;//kernel.T1Text:323
        _this.height=0;
        //$LASTPOS=49000332;//kernel.T1Text:332
        _this.width=0;
        //$LASTPOS=49000346;//kernel.T1Text:346
        //$LASTPOS=49000350;//kernel.T1Text:350
        textCount = 0;
        for (; textCount<splitsText.length ; textCount++) {
          {
            //$LASTPOS=49000417;//kernel.T1Text:417
            rect = _this.drawTextRect(ctx,splitsText[textCount],_this.x,drawY,_this.size,_this.align,"fill");
            
            //$LASTPOS=49000509;//kernel.T1Text:509
            if (_this.width<rect.w) {
              //$LASTPOS=49000526;//kernel.T1Text:526
              _this.width=rect.w;
            }
            //$LASTPOS=49000549;//kernel.T1Text:549
            _this.height+=rect.h;
            //$LASTPOS=49000574;//kernel.T1Text:574
            drawY+=_this.size;
          }
        }
        //$LASTPOS=49000599;//kernel.T1Text:599
        _this.owner.width=_this.width;
        //$LASTPOS=49000623;//kernel.T1Text:623
        _this.owner.height=_this.height;
        //$LASTPOS=49000649;//kernel.T1Text:649
        _this.drawn=true;
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"draw":{"nowait":false}},"fields":{"size":{},"text":{},"y":{},"align":{},"fillStyle":{},"col":{},"height":{},"width":{},"x":{},"owner":{},"drawn":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Scheduler',
  shortName: 'Scheduler',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Scheduler_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=50000097;//kernel.Scheduler:97
        if (typeof  performance==="undefined") {
          //$LASTPOS=50000142;//kernel.Scheduler:142
          _this.window.performance={};
          
        }
        //$LASTPOS=50000171;//kernel.Scheduler:171
        if (! performance.now) {
          //$LASTPOS=50000200;//kernel.Scheduler:200
          performance.now=(function now() {
            
            return Date.now();
          });
          
        }
        //$LASTPOS=50000277;//kernel.Scheduler:277
        _this.cur=[];
        //$LASTPOS=50000286;//kernel.Scheduler:286
        _this.next=[];
      },
      fiber$main :function _trc_Scheduler_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=50000097;//kernel.Scheduler:97
        if (typeof  performance==="undefined") {
          //$LASTPOS=50000142;//kernel.Scheduler:142
          _this.window.performance={};
          
        }
        //$LASTPOS=50000171;//kernel.Scheduler:171
        if (! performance.now) {
          //$LASTPOS=50000200;//kernel.Scheduler:200
          performance.now=(function now() {
            
            return Date.now();
          });
          
        }
        //$LASTPOS=50000277;//kernel.Scheduler:277
        _this.cur=[];
        //$LASTPOS=50000286;//kernel.Scheduler:286
        _this.next=[];
        
        _thread.retVal=_this;return;
      },
      addObj :function _trc_Scheduler_addObj(obj,name,args) {
        "use strict";
        var _this=this;
        
        return _this.newThread(obj,name,args);
      },
      fiber$addObj :function _trc_Scheduler_f_addObj(_thread,obj,name,args) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Scheduler_ent_addObj(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$newThread(_thread, obj, name, args);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      newThread :function _trc_Scheduler_newThread(obj,name,args,options) {
        "use strict";
        var _this=this;
        var th;
        
        //$LASTPOS=50000441;//kernel.Scheduler:441
        name=name||"main";
        //$LASTPOS=50000465;//kernel.Scheduler:465
        args=args||[];
        //$LASTPOS=50000485;//kernel.Scheduler:485
        th = Tonyu.thread();
        
        //$LASTPOS=50000513;//kernel.Scheduler:513
        th.apply(obj,name,args);
        //$LASTPOS=50000543;//kernel.Scheduler:543
        th.name=(obj.getClassInfo?obj.getClassInfo().shortName:"Unknown")+"::"+name;
        //$LASTPOS=50000626;//kernel.Scheduler:626
        _this.addToCur(th);
        return th;
      },
      fiber$newThread :function _trc_Scheduler_f_newThread(_thread,obj,name,args,options) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var th;
        
        //$LASTPOS=50000441;//kernel.Scheduler:441
        name=name||"main";
        //$LASTPOS=50000465;//kernel.Scheduler:465
        args=args||[];
        //$LASTPOS=50000485;//kernel.Scheduler:485
        th = Tonyu.thread();
        
        //$LASTPOS=50000513;//kernel.Scheduler:513
        th.apply(obj,name,args);
        //$LASTPOS=50000543;//kernel.Scheduler:543
        th.name=(obj.getClassInfo?obj.getClassInfo().shortName:"Unknown")+"::"+name;
        
        _thread.enter(function _trc_Scheduler_ent_newThread(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=50000626;//kernel.Scheduler:626
              _this.fiber$addToCur(_thread, th);
              __pc=1;return;
            case 1:
              
              _thread.exit(th);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      addToCur :function _trc_Scheduler_addToCur(th) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=50000681;//kernel.Scheduler:681
        if (th.scheduled) {
          return _this;
        }
        //$LASTPOS=50000712;//kernel.Scheduler:712
        _this.cur.push(th);
        //$LASTPOS=50000731;//kernel.Scheduler:731
        th.scheduled=_this;
        //$LASTPOS=50000755;//kernel.Scheduler:755
        if (Tonyu.globals.$Boot.newLimit) {
          //$LASTPOS=50000786;//kernel.Scheduler:786
          Tonyu.globals.$Boot.newLimitCount--;
          //$LASTPOS=50000818;//kernel.Scheduler:818
          if (Tonyu.globals.$Boot.newLimitCount<=0) {
            throw new Error("一度にたくさんのスレッドを作りすぎています\n"+"       $Boot.newLimitの値を変更すると、1フレーム間に生成できる オブジェクト+スレッドの合計数 を変更できます\n"+"       $Boot.newLimit="+Tonyu.globals.$Boot.newLimit+"; // 現在の オブジェクト数+スレッド数 の限度\n"+"       update(); // 次フレームから適用されます\n"+"       [参考] https://edit.tonyu.jp/doc/limitations.html\n");
            
          }
          
        }
      },
      fiber$addToCur :function _trc_Scheduler_f_addToCur(_thread,th) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=50000681;//kernel.Scheduler:681
        if (th.scheduled) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=50000712;//kernel.Scheduler:712
        _this.cur.push(th);
        //$LASTPOS=50000731;//kernel.Scheduler:731
        th.scheduled=_this;
        //$LASTPOS=50000755;//kernel.Scheduler:755
        if (Tonyu.globals.$Boot.newLimit) {
          //$LASTPOS=50000786;//kernel.Scheduler:786
          Tonyu.globals.$Boot.newLimitCount--;
          //$LASTPOS=50000818;//kernel.Scheduler:818
          if (Tonyu.globals.$Boot.newLimitCount<=0) {
            throw new Error("一度にたくさんのスレッドを作りすぎています\n"+"       $Boot.newLimitの値を変更すると、1フレーム間に生成できる オブジェクト+スレッドの合計数 を変更できます\n"+"       $Boot.newLimit="+Tonyu.globals.$Boot.newLimit+"; // 現在の オブジェクト数+スレッド数 の限度\n"+"       update(); // 次フレームから適用されます\n"+"       [参考] https://edit.tonyu.jp/doc/limitations.html\n");
            
          }
          
        }
        
        _thread.retVal=_this;return;
      },
      addToNext :function _trc_Scheduler_addToNext(th) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=50001218;//kernel.Scheduler:1218
        if (th.scheduled) {
          return _this;
        }
        //$LASTPOS=50001249;//kernel.Scheduler:1249
        _this.next.push(th);
        //$LASTPOS=50001269;//kernel.Scheduler:1269
        th.scheduled=_this;
      },
      fiber$addToNext :function _trc_Scheduler_f_addToNext(_thread,th) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=50001218;//kernel.Scheduler:1218
        if (th.scheduled) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=50001249;//kernel.Scheduler:1249
        _this.next.push(th);
        //$LASTPOS=50001269;//kernel.Scheduler:1269
        th.scheduled=_this;
        
        _thread.retVal=_this;return;
      },
      unschedule :function _trc_Scheduler_unschedule(th) {
        "use strict";
        var _this=this;
        var i;
        
        //$LASTPOS=50001315;//kernel.Scheduler:1315
        i = _this.cur.indexOf(th);
        
        //$LASTPOS=50001343;//kernel.Scheduler:1343
        if (i>=0) {
          //$LASTPOS=50001364;//kernel.Scheduler:1364
          _this.cur.splice(i,1);
          //$LASTPOS=50001390;//kernel.Scheduler:1390
          delete th.scheduled;
          
        } else {
          //$LASTPOS=50001431;//kernel.Scheduler:1431
          i=_this.next.indexOf(th);
          //$LASTPOS=50001457;//kernel.Scheduler:1457
          if (i>=0) {
            //$LASTPOS=50001478;//kernel.Scheduler:1478
            _this.next.splice(i,1);
            //$LASTPOS=50001508;//kernel.Scheduler:1508
            delete th.scheduled;
            
          }
          
        }
      },
      fiber$unschedule :function _trc_Scheduler_f_unschedule(_thread,th) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        
        //$LASTPOS=50001315;//kernel.Scheduler:1315
        i = _this.cur.indexOf(th);
        
        //$LASTPOS=50001343;//kernel.Scheduler:1343
        if (i>=0) {
          //$LASTPOS=50001364;//kernel.Scheduler:1364
          _this.cur.splice(i,1);
          //$LASTPOS=50001390;//kernel.Scheduler:1390
          delete th.scheduled;
          
        } else {
          //$LASTPOS=50001431;//kernel.Scheduler:1431
          i=_this.next.indexOf(th);
          //$LASTPOS=50001457;//kernel.Scheduler:1457
          if (i>=0) {
            //$LASTPOS=50001478;//kernel.Scheduler:1478
            _this.next.splice(i,1);
            //$LASTPOS=50001508;//kernel.Scheduler:1508
            delete th.scheduled;
            
          }
          
        }
        
        _thread.retVal=_this;return;
      },
      checkTimeout :function _trc_Scheduler_checkTimeout() {
        "use strict";
        var _this=this;
        var now;
        
        //$LASTPOS=50001571;//kernel.Scheduler:1571
        now = performance.now();
        
        //$LASTPOS=50001603;//kernel.Scheduler:1603
        if (now-_this.lastSteps>1000) {
          throw new Error("待機不能モードでupdateが呼ばれています．ブラウザが固まるのを防ぐために停止します．");
          
          
        }
      },
      fiber$checkTimeout :function _trc_Scheduler_f_checkTimeout(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var now;
        
        //$LASTPOS=50001571;//kernel.Scheduler:1571
        now = performance.now();
        
        //$LASTPOS=50001603;//kernel.Scheduler:1603
        if (now-_this.lastSteps>1000) {
          throw new Error("待機不能モードでupdateが呼ばれています．ブラウザが固まるのを防ぐために停止します．");
          
          
        }
        
        _thread.retVal=_this;return;
      },
      checkDuplicate :function _trc_Scheduler_checkDuplicate() {
        "use strict";
        var _this=this;
        var dupc;
        var t;
        var _it_376;
        var _it_377;
        
        //$LASTPOS=50001739;//kernel.Scheduler:1739
        dupc = {};
        
        //$LASTPOS=50001757;//kernel.Scheduler:1757
        _it_376=Tonyu.iterator(_this.cur,1);
        while(_it_376.next()) {
          t=_it_376[0];
          
          //$LASTPOS=50001787;//kernel.Scheduler:1787
          if (dupc[t.id]) {
            //$LASTPOS=50001818;//kernel.Scheduler:1818
            console.log("WARNING","Scheduler: duplicate thread detected in cur",t);
            
          }
          //$LASTPOS=50001910;//kernel.Scheduler:1910
          dupc[t.id]="cur";
          
        }
        //$LASTPOS=50001940;//kernel.Scheduler:1940
        _it_377=Tonyu.iterator(_this.next,1);
        while(_it_377.next()) {
          t=_it_377[0];
          
          //$LASTPOS=50001971;//kernel.Scheduler:1971
          if (dupc[t.id]) {
            //$LASTPOS=50002002;//kernel.Scheduler:2002
            console.log("WARNING","Scheduler: duplicate thread detected in next and "+dupc[t.id],t);
            
          }
          //$LASTPOS=50002111;//kernel.Scheduler:2111
          dupc[t.id]="next";
          
        }
      },
      fiber$checkDuplicate :function _trc_Scheduler_f_checkDuplicate(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var dupc;
        var t;
        var _it_376;
        var _it_377;
        
        //$LASTPOS=50001739;//kernel.Scheduler:1739
        dupc = {};
        
        //$LASTPOS=50001757;//kernel.Scheduler:1757
        _it_376=Tonyu.iterator(_this.cur,1);
        while(_it_376.next()) {
          t=_it_376[0];
          
          //$LASTPOS=50001787;//kernel.Scheduler:1787
          if (dupc[t.id]) {
            //$LASTPOS=50001818;//kernel.Scheduler:1818
            console.log("WARNING","Scheduler: duplicate thread detected in cur",t);
            
          }
          //$LASTPOS=50001910;//kernel.Scheduler:1910
          dupc[t.id]="cur";
          
        }
        //$LASTPOS=50001940;//kernel.Scheduler:1940
        _it_377=Tonyu.iterator(_this.next,1);
        while(_it_377.next()) {
          t=_it_377[0];
          
          //$LASTPOS=50001971;//kernel.Scheduler:1971
          if (dupc[t.id]) {
            //$LASTPOS=50002002;//kernel.Scheduler:2002
            console.log("WARNING","Scheduler: duplicate thread detected in next and "+dupc[t.id],t);
            
          }
          //$LASTPOS=50002111;//kernel.Scheduler:2111
          dupc[t.id]="next";
          
        }
        
        _thread.retVal=_this;return;
      },
      doTimeStop :function _trc_Scheduler_doTimeStop() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=50002162;//kernel.Scheduler:2162
        _this.next=_this.allThreads;
        //$LASTPOS=50002184;//kernel.Scheduler:2184
        _this.cur=[];
        return _this.next;
      },
      fiber$doTimeStop :function _trc_Scheduler_f_doTimeStop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=50002162;//kernel.Scheduler:2162
        _this.next=_this.allThreads;
        //$LASTPOS=50002184;//kernel.Scheduler:2184
        _this.cur=[];
        _thread.retVal=_this.next;return;
        
        
        _thread.retVal=_this;return;
      },
      stepsAll :function _trc_Scheduler_stepsAll() {
        "use strict";
        var _this=this;
        var dupc;
        var t;
        
        //$LASTPOS=50002233;//kernel.Scheduler:2233
        _this.lastSteps=performance.now();
        //$LASTPOS=50002267;//kernel.Scheduler:2267
        dupc = {};
        
        //$LASTPOS=50002285;//kernel.Scheduler:2285
        while (_this.cur.length) {
          //$LASTPOS=50002314;//kernel.Scheduler:2314
          t = _this.cur.shift();
          
          //$LASTPOS=50002342;//kernel.Scheduler:2342
          if (dupc[t.id]) {
            //$LASTPOS=50002373;//kernel.Scheduler:2373
            console.log("WARNING","Scheduler: duplicate thread detected",t);
            continue;
            
            
          }
          //$LASTPOS=50002481;//kernel.Scheduler:2481
          dupc[t.id]=t;
          //$LASTPOS=50002501;//kernel.Scheduler:2501
          delete t.scheduled;
          //$LASTPOS=50002527;//kernel.Scheduler:2527
          if (t.waitCount) {
            //$LASTPOS=50002556;//kernel.Scheduler:2556
            t.waitCount--;
            //$LASTPOS=50002584;//kernel.Scheduler:2584
            _this.addToNext(t);
            
          } else {
            //$LASTPOS=50002673;//kernel.Scheduler:2673
            t.steps();
            //$LASTPOS=50002747;//kernel.Scheduler:2747
            if (t.preempted) {
              //$LASTPOS=50002832;//kernel.Scheduler:2832
              _this.addToNext(t);
              
            }
            
          }
          
        }
        //$LASTPOS=50002884;//kernel.Scheduler:2884
        _this.cur=_this.next;
        //$LASTPOS=50002899;//kernel.Scheduler:2899
        _this.next=[];
        return _this.cur.length;
      },
      fiber$stepsAll :function _trc_Scheduler_f_stepsAll(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var dupc;
        var t;
        
        //$LASTPOS=50002233;//kernel.Scheduler:2233
        _this.lastSteps=performance.now();
        //$LASTPOS=50002267;//kernel.Scheduler:2267
        dupc = {};
        
        
        _thread.enter(function _trc_Scheduler_ent_stepsAll(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=50002285;//kernel.Scheduler:2285
            case 1:
              if (!(_this.cur.length)) { __pc=8     ; break; }
              //$LASTPOS=50002314;//kernel.Scheduler:2314
              t = _this.cur.shift();
              
              //$LASTPOS=50002342;//kernel.Scheduler:2342
              if (!(dupc[t.id])) { __pc=2     ; break; }
              //$LASTPOS=50002373;//kernel.Scheduler:2373
              console.log("WARNING","Scheduler: duplicate thread detected",t);
              __pc=1; break;
              
            case 2     :
              
              //$LASTPOS=50002481;//kernel.Scheduler:2481
              dupc[t.id]=t;
              //$LASTPOS=50002501;//kernel.Scheduler:2501
              delete t.scheduled;
              //$LASTPOS=50002527;//kernel.Scheduler:2527
              if (!(t.waitCount)) { __pc=4     ; break; }
              //$LASTPOS=50002556;//kernel.Scheduler:2556
              t.waitCount--;
              //$LASTPOS=50002584;//kernel.Scheduler:2584
              _this.fiber$addToNext(_thread, t);
              __pc=3;return;
            case 3:
              
              __pc=7     ;break;
            case 4     :
              //$LASTPOS=50002673;//kernel.Scheduler:2673
              t.steps();
              //$LASTPOS=50002747;//kernel.Scheduler:2747
              if (!(t.preempted)) { __pc=6     ; break; }
              //$LASTPOS=50002832;//kernel.Scheduler:2832
              _this.fiber$addToNext(_thread, t);
              __pc=5;return;
            case 5:
              
            case 6     :
              
            case 7     :
              
              __pc=1;break;
            case 8     :
              
              //$LASTPOS=50002884;//kernel.Scheduler:2884
              _this.cur=_this.next;
              //$LASTPOS=50002899;//kernel.Scheduler:2899
              _this.next=[];
              _thread.exit(_this.cur.length);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __getter__allThreads :function _trc_Scheduler___getter__allThreads() {
        "use strict";
        var _this=this;
        
        return _this.cur.concat(_this.next);
      },
      findByThreadGroup :function _trc_Scheduler_findByThreadGroup(o) {
        "use strict";
        var _this=this;
        
        return _this.allThreads.filter((function anonymous_3038(t) {
          
          return t._threadGroup===o;
        }));
      },
      fiber$findByThreadGroup :function _trc_Scheduler_f_findByThreadGroup(_thread,o) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.allThreads.filter((function anonymous_3038(t) {
          
          return t._threadGroup===o;
        }));return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__isEmpty :function _trc_Scheduler___getter__isEmpty() {
        "use strict";
        var _this=this;
        
        return _this.allThreads.length==0;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"addObj":{"nowait":false},"newThread":{"nowait":false},"addToCur":{"nowait":false},"addToNext":{"nowait":false},"unschedule":{"nowait":false},"checkTimeout":{"nowait":false},"checkDuplicate":{"nowait":false},"doTimeStop":{"nowait":false},"stepsAll":{"nowait":false},"__getter__allThreads":{"nowait":true},"findByThreadGroup":{"nowait":false},"__getter__isEmpty":{"nowait":true}},"fields":{"window":{},"cur":{},"next":{},"lastSteps":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.DialogMod',
  shortName: 'DialogMod',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_DialogMod_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_DialogMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      prompt :function _trc_DialogMod_prompt(mesg,val,geom) {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=51000060;//kernel.DialogMod:60
        Tonyu.globals.$currentProject.requestPlugin("jquery_ui");
        
        //$LASTPOS=51000118;//kernel.DialogMod:118
        r=_this.waitFor(Tonyu.globals.$InputBox.prompt(mesg,val,geom));
        return r;
      },
      fiber$prompt :function _trc_DialogMod_f_prompt(_thread,mesg,val,geom) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        //$LASTPOS=51000060;//kernel.DialogMod:60
        Tonyu.globals.$currentProject.requestPlugin("jquery_ui");
        
        
        _thread.enter(function _trc_DialogMod_ent_prompt(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=51000118;//kernel.DialogMod:118
              _this.fiber$waitFor(_thread, Tonyu.globals.$InputBox.prompt(mesg,val,geom));
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              _thread.exit(r);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      waitInput :function _trc_DialogMod_waitInput(title,mesg,val,geom) {
        "use strict";
        var _this=this;
        
        return _this.prompt({title: title,body: mesg},val,geom);
      },
      fiber$waitInput :function _trc_DialogMod_f_waitInput(_thread,title,mesg,val,geom) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_DialogMod_ent_waitInput(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$prompt(_thread, {title: title,body: mesg}, val, geom);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      promptNumber :function _trc_DialogMod_promptNumber(mesg,val,geom) {
        "use strict";
        var _this=this;
        var r;
        
        
        //$LASTPOS=51000312;//kernel.DialogMod:312
        r=_this.prompt(mesg,val,geom);
        return r-0;
      },
      fiber$promptNumber :function _trc_DialogMod_f_promptNumber(_thread,mesg,val,geom) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        
        
        _thread.enter(function _trc_DialogMod_ent_promptNumber(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=51000312;//kernel.DialogMod:312
              _this.fiber$prompt(_thread, mesg, val, geom);
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              _thread.exit(r-0);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      confirm :function _trc_DialogMod_confirm(mesg) {
        "use strict";
        var _this=this;
        var r;
        
        
        //$LASTPOS=51000392;//kernel.DialogMod:392
        Tonyu.globals.$currentProject.requestPlugin("jquery_ui");
        //$LASTPOS=51000438;//kernel.DialogMod:438
        r=_this.waitFor(Tonyu.globals.$InputBox.confirm(mesg));
        return r;
      },
      fiber$confirm :function _trc_DialogMod_f_confirm(_thread,mesg) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        
        //$LASTPOS=51000392;//kernel.DialogMod:392
        Tonyu.globals.$currentProject.requestPlugin("jquery_ui");
        
        _thread.enter(function _trc_DialogMod_ent_confirm(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=51000438;//kernel.DialogMod:438
              _this.fiber$waitFor(_thread, Tonyu.globals.$InputBox.confirm(mesg));
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              _thread.exit(r);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      alert :function _trc_DialogMod_alert(mesg) {
        "use strict";
        var _this=this;
        var r;
        
        
        //$LASTPOS=51000522;//kernel.DialogMod:522
        Tonyu.globals.$currentProject.requestPlugin("jquery_ui");
        //$LASTPOS=51000568;//kernel.DialogMod:568
        r=_this.waitFor(Tonyu.globals.$InputBox.alert(mesg));
        return r;
      },
      fiber$alert :function _trc_DialogMod_f_alert(_thread,mesg) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        
        //$LASTPOS=51000522;//kernel.DialogMod:522
        Tonyu.globals.$currentProject.requestPlugin("jquery_ui");
        
        _thread.enter(function _trc_DialogMod_ent_alert(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=51000568;//kernel.DialogMod:568
              _this.fiber$waitFor(_thread, Tonyu.globals.$InputBox.alert(mesg));
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              _thread.exit(r);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"prompt":{"nowait":false},"waitInput":{"nowait":false},"promptNumber":{"nowait":false},"confirm":{"nowait":false},"alert":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.Keys',
  shortName: 'Keys',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Keys_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=52000106;//kernel.Keys:106
        _this.stats={};
        //$LASTPOS=52000117;//kernel.Keys:117
        _this.codes={left: 37,up: 38,right: 39,down: 40,space: 32,enter: 13,shift: 16,ctrl: 17,alt: 18,mouseleft: 1,mouseright: 2,mousewheel: 4};
        //$LASTPOS=52000273;//kernel.Keys:273
        //$LASTPOS=52000278;//kernel.Keys:278
        _this.i = 65;
        for (; _this.i<65+26 ; _this.i++) {
          {
            //$LASTPOS=52000310;//kernel.Keys:310
            _this.codes[String.fromCharCode(_this.i).toLowerCase()]=_this.i;
          }
        }
        //$LASTPOS=52000361;//kernel.Keys:361
        //$LASTPOS=52000366;//kernel.Keys:366
        _this.i = 48;
        for (; _this.i<58 ; _this.i++) {
          {
            //$LASTPOS=52000395;//kernel.Keys:395
            _this.codes[String.fromCharCode(_this.i)]=_this.i;
          }
        }
        //$LASTPOS=52000432;//kernel.Keys:432
        if (! $.data(document,"key_event")) {
          //$LASTPOS=52000474;//kernel.Keys:474
          _this.bmap = [1,4,2];
          
          //$LASTPOS=52000497;//kernel.Keys:497
          $.data(document,"key_event",true);
          //$LASTPOS=52000537;//kernel.Keys:537
          $(document).keydown((function anonymous_557(e) {
            
            //$LASTPOS=52000563;//kernel.Keys:563
            Tonyu.globals.$Keys.keydown(e);
          }));
          //$LASTPOS=52000588;//kernel.Keys:588
          $(document).keyup((function anonymous_606(e) {
            
            //$LASTPOS=52000612;//kernel.Keys:612
            Tonyu.globals.$Keys.keyup(e);
          }));
          //$LASTPOS=52000635;//kernel.Keys:635
          $(document).mousedown((function anonymous_657(e) {
            
            //$LASTPOS=52000673;//kernel.Keys:673
            _this.lastMouseDown=Tonyu.globals.$frameCount;
            //$LASTPOS=52000844;//kernel.Keys:844
            Tonyu.globals.$Keys.keydown({keyCode: _this.bmap[e.button]||1});
          }));
          //$LASTPOS=52000899;//kernel.Keys:899
          $(document).mouseup((function anonymous_919(e) {
            var a;
            
            //$LASTPOS=52000935;//kernel.Keys:935
            a = (function anonymous_941() {
              
              //$LASTPOS=52001108;//kernel.Keys:1108
              Tonyu.globals.$Keys.keyup({keyCode: _this.bmap[e.button]||1});
            });
            
            //$LASTPOS=52001169;//kernel.Keys:1169
            if (_this.lastMouseDown==Tonyu.globals.$frameCount&&! _this.reservedAction) {
              //$LASTPOS=52001235;//kernel.Keys:1235
              _this.reservedAction={at: Tonyu.globals.$frameCount+2,action: a};
              
            } else {
              //$LASTPOS=52001310;//kernel.Keys:1310
              a();
              
            }
          }));
          
        }
      },
      fiber$main :function _trc_Keys_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=52000106;//kernel.Keys:106
        _this.stats={};
        //$LASTPOS=52000117;//kernel.Keys:117
        _this.codes={left: 37,up: 38,right: 39,down: 40,space: 32,enter: 13,shift: 16,ctrl: 17,alt: 18,mouseleft: 1,mouseright: 2,mousewheel: 4};
        //$LASTPOS=52000273;//kernel.Keys:273
        //$LASTPOS=52000278;//kernel.Keys:278
        _this.i = 65;
        for (; _this.i<65+26 ; _this.i++) {
          {
            //$LASTPOS=52000310;//kernel.Keys:310
            _this.codes[String.fromCharCode(_this.i).toLowerCase()]=_this.i;
          }
        }
        //$LASTPOS=52000361;//kernel.Keys:361
        //$LASTPOS=52000366;//kernel.Keys:366
        _this.i = 48;
        for (; _this.i<58 ; _this.i++) {
          {
            //$LASTPOS=52000395;//kernel.Keys:395
            _this.codes[String.fromCharCode(_this.i)]=_this.i;
          }
        }
        //$LASTPOS=52000432;//kernel.Keys:432
        if (! $.data(document,"key_event")) {
          //$LASTPOS=52000474;//kernel.Keys:474
          _this.bmap = [1,4,2];
          
          //$LASTPOS=52000497;//kernel.Keys:497
          $.data(document,"key_event",true);
          //$LASTPOS=52000537;//kernel.Keys:537
          $(document).keydown((function anonymous_557(e) {
            
            //$LASTPOS=52000563;//kernel.Keys:563
            Tonyu.globals.$Keys.keydown(e);
          }));
          //$LASTPOS=52000588;//kernel.Keys:588
          $(document).keyup((function anonymous_606(e) {
            
            //$LASTPOS=52000612;//kernel.Keys:612
            Tonyu.globals.$Keys.keyup(e);
          }));
          //$LASTPOS=52000635;//kernel.Keys:635
          $(document).mousedown((function anonymous_657(e) {
            
            //$LASTPOS=52000673;//kernel.Keys:673
            _this.lastMouseDown=Tonyu.globals.$frameCount;
            //$LASTPOS=52000844;//kernel.Keys:844
            Tonyu.globals.$Keys.keydown({keyCode: _this.bmap[e.button]||1});
          }));
          //$LASTPOS=52000899;//kernel.Keys:899
          $(document).mouseup((function anonymous_919(e) {
            var a;
            
            //$LASTPOS=52000935;//kernel.Keys:935
            a = (function anonymous_941() {
              
              //$LASTPOS=52001108;//kernel.Keys:1108
              Tonyu.globals.$Keys.keyup({keyCode: _this.bmap[e.button]||1});
            });
            
            //$LASTPOS=52001169;//kernel.Keys:1169
            if (_this.lastMouseDown==Tonyu.globals.$frameCount&&! _this.reservedAction) {
              //$LASTPOS=52001235;//kernel.Keys:1235
              _this.reservedAction={at: Tonyu.globals.$frameCount+2,action: a};
              
            } else {
              //$LASTPOS=52001310;//kernel.Keys:1310
              a();
              
            }
          }));
          
        }
        
        _thread.retVal=_this;return;
      },
      getkey :function _trc_Keys_getkey(code) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=52001367;//kernel.Keys:1367
        if (typeof  code=="string") {
          //$LASTPOS=52001405;//kernel.Keys:1405
          code=_this.codes[code.toLowerCase()];
          
        }
        //$LASTPOS=52001449;//kernel.Keys:1449
        if (! code) {
          return 0;
        }
        //$LASTPOS=52001475;//kernel.Keys:1475
        if (_this.stats[code]==- 1) {
          return 0;
        }
        //$LASTPOS=52001511;//kernel.Keys:1511
        if (! _this.stats[code]) {
          //$LASTPOS=52001529;//kernel.Keys:1529
          _this.stats[code]=0;
        }
        return _this.stats[code];
      },
      fiber$getkey :function _trc_Keys_f_getkey(_thread,code) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=52001367;//kernel.Keys:1367
        if (typeof  code=="string") {
          //$LASTPOS=52001405;//kernel.Keys:1405
          code=_this.codes[code.toLowerCase()];
          
        }
        //$LASTPOS=52001449;//kernel.Keys:1449
        if (! code) {
          _thread.retVal=0;return;
          
        }
        //$LASTPOS=52001475;//kernel.Keys:1475
        if (_this.stats[code]==- 1) {
          _thread.retVal=0;return;
          
        }
        //$LASTPOS=52001511;//kernel.Keys:1511
        if (! _this.stats[code]) {
          //$LASTPOS=52001529;//kernel.Keys:1529
          _this.stats[code]=0;
        }
        _thread.retVal=_this.stats[code];return;
        
        
        _thread.retVal=_this;return;
      },
      update :function _trc_Keys_update() {
        "use strict";
        var _this=this;
        var i;
        var _it_394;
        
        //$LASTPOS=52001598;//kernel.Keys:1598
        _it_394=Tonyu.iterator(_this.stats,1);
        while(_it_394.next()) {
          i=_it_394[0];
          
          //$LASTPOS=52001630;//kernel.Keys:1630
          if (_this.stats[i]>0) {
            //$LASTPOS=52001647;//kernel.Keys:1647
            _this.stats[i]++;
            
          }
          //$LASTPOS=52001669;//kernel.Keys:1669
          if (_this.stats[i]==- 1) {
            //$LASTPOS=52001687;//kernel.Keys:1687
            _this.stats[i]=1;
          }
          
        }
        //$LASTPOS=52001711;//kernel.Keys:1711
        if (_this.reservedAction&&_this.reservedAction.at==Tonyu.globals.$frameCount) {
          //$LASTPOS=52001776;//kernel.Keys:1776
          _this.reservedAction.action();
          //$LASTPOS=52001810;//kernel.Keys:1810
          _this.reservedAction=null;
          
        }
      },
      fiber$update :function _trc_Keys_f_update(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        var _it_394;
        
        //$LASTPOS=52001598;//kernel.Keys:1598
        _it_394=Tonyu.iterator(_this.stats,1);
        while(_it_394.next()) {
          i=_it_394[0];
          
          //$LASTPOS=52001630;//kernel.Keys:1630
          if (_this.stats[i]>0) {
            //$LASTPOS=52001647;//kernel.Keys:1647
            _this.stats[i]++;
            
          }
          //$LASTPOS=52001669;//kernel.Keys:1669
          if (_this.stats[i]==- 1) {
            //$LASTPOS=52001687;//kernel.Keys:1687
            _this.stats[i]=1;
          }
          
        }
        //$LASTPOS=52001711;//kernel.Keys:1711
        if (_this.reservedAction&&_this.reservedAction.at==Tonyu.globals.$frameCount) {
          //$LASTPOS=52001776;//kernel.Keys:1776
          _this.reservedAction.action();
          //$LASTPOS=52001810;//kernel.Keys:1810
          _this.reservedAction=null;
          
        }
        
        _thread.retVal=_this;return;
      },
      keydown :function _trc_Keys_keydown(e) {
        "use strict";
        var _this=this;
        var s;
        
        //$LASTPOS=52001910;//kernel.Keys:1910
        if (Tonyu.globals.$t2MediaLib) {
          //$LASTPOS=52001927;//kernel.Keys:1927
          Tonyu.globals.$t2MediaLib.activate();
        }
        //$LASTPOS=52001956;//kernel.Keys:1956
        s = _this.stats[e.keyCode];
        
        //$LASTPOS=52001985;//kernel.Keys:1985
        if (! s) {
          //$LASTPOS=52002004;//kernel.Keys:2004
          _this.stats[e.keyCode]=1;
          
        }
        //$LASTPOS=52002036;//kernel.Keys:2036
        Tonyu.globals.$InputDevice.handleListeners();
      },
      fiber$keydown :function _trc_Keys_f_keydown(_thread,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var s;
        
        //$LASTPOS=52001910;//kernel.Keys:1910
        if (Tonyu.globals.$t2MediaLib) {
          //$LASTPOS=52001927;//kernel.Keys:1927
          Tonyu.globals.$t2MediaLib.activate();
        }
        //$LASTPOS=52001956;//kernel.Keys:1956
        s = _this.stats[e.keyCode];
        
        //$LASTPOS=52001985;//kernel.Keys:1985
        if (! s) {
          //$LASTPOS=52002004;//kernel.Keys:2004
          _this.stats[e.keyCode]=1;
          
        }
        //$LASTPOS=52002036;//kernel.Keys:2036
        Tonyu.globals.$InputDevice.handleListeners();
        
        _thread.retVal=_this;return;
      },
      keyup :function _trc_Keys_keyup(e) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=52002138;//kernel.Keys:2138
        if (Tonyu.globals.$t2MediaLib) {
          //$LASTPOS=52002155;//kernel.Keys:2155
          Tonyu.globals.$t2MediaLib.activate();
        }
        //$LASTPOS=52002184;//kernel.Keys:2184
        _this.stats[e.keyCode]=0;
        //$LASTPOS=52002209;//kernel.Keys:2209
        Tonyu.globals.$InputDevice.handleListeners();
      },
      fiber$keyup :function _trc_Keys_f_keyup(_thread,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=52002138;//kernel.Keys:2138
        if (Tonyu.globals.$t2MediaLib) {
          //$LASTPOS=52002155;//kernel.Keys:2155
          Tonyu.globals.$t2MediaLib.activate();
        }
        //$LASTPOS=52002184;//kernel.Keys:2184
        _this.stats[e.keyCode]=0;
        //$LASTPOS=52002209;//kernel.Keys:2209
        Tonyu.globals.$InputDevice.handleListeners();
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"getkey":{"nowait":false},"update":{"nowait":false},"keydown":{"nowait":false},"keyup":{"nowait":false}},"fields":{"i":{},"bmap":{},"stats":{},"codes":{},"lastMouseDown":{},"reservedAction":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.TouchFinger',
  shortName: 'TouchFinger',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod,Tonyu.classes.kernel.EventMod],
  methods: function (__superClass) {
    return {
      main :function _trc_TouchFinger_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=53000046;//kernel.TouchFinger:46
        "field strict";
        
        
        
      },
      fiber$main :function _trc_TouchFinger_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=53000046;//kernel.TouchFinger:46
        "field strict";
        
        
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_TouchFinger_initialize(layer,screen,index) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=53000204;//kernel.TouchFinger:204
        _this.reset();
        //$LASTPOS=53000218;//kernel.TouchFinger:218
        _this._layer=layer;
        //$LASTPOS=53000237;//kernel.TouchFinger:237
        Tonyu.classes.kernel.TouchFinger.seq=Tonyu.classes.kernel.TouchFinger.seq||0;
        //$LASTPOS=53000278;//kernel.TouchFinger:278
        _this.oid=Tonyu.classes.kernel.TouchFinger.seq++;
        //$LASTPOS=53000306;//kernel.TouchFinger:306
        _this.screen=screen||Tonyu.globals.$Screen;
        //$LASTPOS=53000340;//kernel.TouchFinger:340
        _this.index=index;
      },
      reset :function _trc_TouchFinger_reset() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=53000378;//kernel.TouchFinger:378
        _this.identifier=- 1;
        //$LASTPOS=53000398;//kernel.TouchFinger:398
        _this.px=_this.py=0;
        //$LASTPOS=53000412;//kernel.TouchFinger:412
        _this.x=_this.y=_this.vx=_this.vy=_this.touched=0;
        //$LASTPOS=53000438;//kernel.TouchFinger:438
        _this.ended=false;
      },
      fiber$reset :function _trc_TouchFinger_f_reset(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=53000378;//kernel.TouchFinger:378
        _this.identifier=- 1;
        //$LASTPOS=53000398;//kernel.TouchFinger:398
        _this.px=_this.py=0;
        //$LASTPOS=53000412;//kernel.TouchFinger:412
        _this.x=_this.y=_this.vx=_this.vy=_this.touched=0;
        //$LASTPOS=53000438;//kernel.TouchFinger:438
        _this.ended=false;
        
        _thread.retVal=_this;return;
      },
      __getter__layer :function _trc_TouchFinger___getter__layer() {
        "use strict";
        var _this=this;
        
        return _this._layer;
      },
      __setter__layer :function _trc_TouchFinger___setter__layer(toLayer) {
        "use strict";
        var _this=this;
        var p;
        
        //$LASTPOS=53000510;//kernel.TouchFinger:510
        if (_this._layer===toLayer) {
          return _this;
        }
        //$LASTPOS=53000545;//kernel.TouchFinger:545
        p = _this.screen.convert(_this,toLayer);
        
        //$LASTPOS=53000586;//kernel.TouchFinger:586
        if (! p) {
          //$LASTPOS=53000605;//kernel.TouchFinger:605
          console.log("Screen convert failed",_this.screen,_this,toLayer,p);
          throw new Error("Screen convert failed");
          
          
        }
        //$LASTPOS=53000728;//kernel.TouchFinger:728
        _this.x=p.x;
        //$LASTPOS=53000740;//kernel.TouchFinger:740
        _this.y=p.y;
        //$LASTPOS=53000752;//kernel.TouchFinger:752
        _this.px=_this.x;
        //$LASTPOS=53000763;//kernel.TouchFinger:763
        _this.py=_this.y;
        //$LASTPOS=53000774;//kernel.TouchFinger:774
        _this._layer=p.layer;
        //$LASTPOS=53000795;//kernel.TouchFinger:795
        _this.vx=_this.vy=0;
      },
      update :function _trc_TouchFinger_update() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=53001150;//kernel.TouchFinger:1150
        if (_this.touched>0) {
          //$LASTPOS=53001166;//kernel.TouchFinger:1166
          _this.touched++;
          
        } else {
          //$LASTPOS=53001188;//kernel.TouchFinger:1188
          if (_this.touched==- 1) {
            //$LASTPOS=53001205;//kernel.TouchFinger:1205
            _this.touched=1;
          } else {
            
            
          }
        }
        //$LASTPOS=53001280;//kernel.TouchFinger:1280
        if (_this.touched>0) {
          //$LASTPOS=53001345;//kernel.TouchFinger:1345
          if (typeof  _this.px=="number") {
            //$LASTPOS=53001385;//kernel.TouchFinger:1385
            _this.vx=_this.x-_this.px||0;
            //$LASTPOS=53001412;//kernel.TouchFinger:1412
            _this.vy=_this.y-_this.py||0;
            
          }
          //$LASTPOS=53001446;//kernel.TouchFinger:1446
          _this.px=_this.x;
          //$LASTPOS=53001461;//kernel.TouchFinger:1461
          _this.py=_this.y;
          
        }
      },
      fiber$update :function _trc_TouchFinger_f_update(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=53001150;//kernel.TouchFinger:1150
        if (_this.touched>0) {
          //$LASTPOS=53001166;//kernel.TouchFinger:1166
          _this.touched++;
          
        } else {
          //$LASTPOS=53001188;//kernel.TouchFinger:1188
          if (_this.touched==- 1) {
            //$LASTPOS=53001205;//kernel.TouchFinger:1205
            _this.touched=1;
          } else {
            
            
          }
        }
        //$LASTPOS=53001280;//kernel.TouchFinger:1280
        if (_this.touched>0) {
          //$LASTPOS=53001345;//kernel.TouchFinger:1345
          if (typeof  _this.px=="number") {
            //$LASTPOS=53001385;//kernel.TouchFinger:1385
            _this.vx=_this.x-_this.px||0;
            //$LASTPOS=53001412;//kernel.TouchFinger:1412
            _this.vy=_this.y-_this.py||0;
            
          }
          //$LASTPOS=53001446;//kernel.TouchFinger:1446
          _this.px=_this.x;
          //$LASTPOS=53001461;//kernel.TouchFinger:1461
          _this.py=_this.y;
          
        }
        
        _thread.retVal=_this;return;
      },
      show :function _trc_TouchFinger_show() {
        "use strict";
        var _this=this;
        
        return "["+_this.oid+":"+_this.floor(_this.x*100)/100+","+_this.floor(_this.px*100)/100+"]";
      },
      fiber$show :function _trc_TouchFinger_f_show(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal="["+_this.oid+":"+_this.floor(_this.x*100)/100+","+_this.floor(_this.px*100)/100+"]";return;
        
        
        _thread.retVal=_this;return;
      },
      doStart :function _trc_TouchFinger_doStart(id,point) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=53001622;//kernel.TouchFinger:1622
        _this.identifier=id;
        //$LASTPOS=53001642;//kernel.TouchFinger:1642
        _this.px=_this.x=point.x;
        //$LASTPOS=53001661;//kernel.TouchFinger:1661
        _this.py=_this.y=point.y;
        //$LASTPOS=53001680;//kernel.TouchFinger:1680
        _this._layer=point.layer;
        //$LASTPOS=53001705;//kernel.TouchFinger:1705
        _this.vx=_this.vy=0;
        //$LASTPOS=53001719;//kernel.TouchFinger:1719
        _this.touched=1;
        //$LASTPOS=53001735;//kernel.TouchFinger:1735
        _this.ended=false;
        //$LASTPOS=53001753;//kernel.TouchFinger:1753
        if (_this.bound) {
          //$LASTPOS=53001775;//kernel.TouchFinger:1775
          _this.bound.doStart(id,point);
          
        }
      },
      fiber$doStart :function _trc_TouchFinger_f_doStart(_thread,id,point) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=53001622;//kernel.TouchFinger:1622
        _this.identifier=id;
        //$LASTPOS=53001642;//kernel.TouchFinger:1642
        _this.px=_this.x=point.x;
        //$LASTPOS=53001661;//kernel.TouchFinger:1661
        _this.py=_this.y=point.y;
        //$LASTPOS=53001680;//kernel.TouchFinger:1680
        _this._layer=point.layer;
        //$LASTPOS=53001705;//kernel.TouchFinger:1705
        _this.vx=_this.vy=0;
        //$LASTPOS=53001719;//kernel.TouchFinger:1719
        _this.touched=1;
        //$LASTPOS=53001735;//kernel.TouchFinger:1735
        _this.ended=false;
        //$LASTPOS=53001753;//kernel.TouchFinger:1753
        if (_this.bound) {
          //$LASTPOS=53001775;//kernel.TouchFinger:1775
          _this.bound.doStart(id,point);
          
        }
        
        _thread.retVal=_this;return;
      },
      doMove :function _trc_TouchFinger_doMove(point) {
        "use strict";
        var _this=this;
        var p;
        var px;
        var py;
        var e;
        
        //$LASTPOS=53001833;//kernel.TouchFinger:1833
        p = _this.screen.convert(point,_this.layer);
        
        //$LASTPOS=53001873;//kernel.TouchFinger:1873
        px = _this.x;
        py = _this.y;
        
        //$LASTPOS=53001893;//kernel.TouchFinger:1893
        _this.x=p.x;
        //$LASTPOS=53001905;//kernel.TouchFinger:1905
        _this.y=p.y;
        //$LASTPOS=53001952;//kernel.TouchFinger:1952
        if (_this.bound) {
          //$LASTPOS=53001974;//kernel.TouchFinger:1974
          _this.bound.doMove(p);
          
        }
        //$LASTPOS=53002043;//kernel.TouchFinger:2043
        e = {px: px,py: py,x: _this.x,y: _this.y,vx: _this.x-px,vy: _this.y-py,finger: _this};
        
        //$LASTPOS=53002095;//kernel.TouchFinger:2095
        _this.fireEvent("move",e);
      },
      fiber$doMove :function _trc_TouchFinger_f_doMove(_thread,point) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        var px;
        var py;
        var e;
        
        //$LASTPOS=53001833;//kernel.TouchFinger:1833
        p = _this.screen.convert(point,_this.layer);
        
        //$LASTPOS=53001873;//kernel.TouchFinger:1873
        px = _this.x;
        py = _this.y;
        
        //$LASTPOS=53001893;//kernel.TouchFinger:1893
        _this.x=p.x;
        //$LASTPOS=53001905;//kernel.TouchFinger:1905
        _this.y=p.y;
        //$LASTPOS=53001952;//kernel.TouchFinger:1952
        if (_this.bound) {
          //$LASTPOS=53001974;//kernel.TouchFinger:1974
          _this.bound.doMove(p);
          
        }
        //$LASTPOS=53002043;//kernel.TouchFinger:2043
        e = {px: px,py: py,x: _this.x,y: _this.y,vx: _this.x-px,vy: _this.y-py,finger: _this};
        
        //$LASTPOS=53002095;//kernel.TouchFinger:2095
        _this.fireEvent("move",e);
        
        _thread.retVal=_this;return;
      },
      doEnd :function _trc_TouchFinger_doEnd() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=53002135;//kernel.TouchFinger:2135
        _this.vx=_this.vy=_this.touched=0;
        //$LASTPOS=53002157;//kernel.TouchFinger:2157
        _this.ended=true;
        //$LASTPOS=53002174;//kernel.TouchFinger:2174
        if (_this.bound) {
          //$LASTPOS=53002196;//kernel.TouchFinger:2196
          _this.bound.doEnd();
          //$LASTPOS=53002220;//kernel.TouchFinger:2220
          delete _this.bound;
          
        }
        //$LASTPOS=53002251;//kernel.TouchFinger:2251
        _this.fireEvent("end",{finger: _this,x: _this.x,y: _this.y});
      },
      fiber$doEnd :function _trc_TouchFinger_f_doEnd(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=53002135;//kernel.TouchFinger:2135
        _this.vx=_this.vy=_this.touched=0;
        //$LASTPOS=53002157;//kernel.TouchFinger:2157
        _this.ended=true;
        //$LASTPOS=53002174;//kernel.TouchFinger:2174
        if (_this.bound) {
          //$LASTPOS=53002196;//kernel.TouchFinger:2196
          _this.bound.doEnd();
          //$LASTPOS=53002220;//kernel.TouchFinger:2220
          delete _this.bound;
          
        }
        //$LASTPOS=53002251;//kernel.TouchFinger:2251
        _this.fireEvent("end",{finger: _this,x: _this.x,y: _this.y});
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"reset":{"nowait":false},"__getter__layer":{"nowait":true},"__setter__layer":{"nowait":true},"update":{"nowait":false},"show":{"nowait":false},"doStart":{"nowait":false},"doMove":{"nowait":false},"doEnd":{"nowait":false}},"fields":{"identifier":{},"index":{},"oid":{},"bound":{},"px":{},"py":{},"x":{},"y":{},"vx":{},"vy":{},"touched":{},"ended":{},"screen":{},"_layer":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.TouchFingers',
  shortName: 'TouchFingers',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_TouchFingers_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_TouchFingers_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_TouchFingers_initialize(dev) {
        "use strict";
        var _this=this;
        var i;
        
        //$LASTPOS=54000067;//kernel.TouchFingers:67
        _this.inputDevice=dev;
        //$LASTPOS=54000089;//kernel.TouchFingers:89
        _this.fingerSet={};
        //$LASTPOS=54000137;//kernel.TouchFingers:137
        _this.fingerArray=[];
        //$LASTPOS=54000181;//kernel.TouchFingers:181
        _this.fingerArray.findById=(function anonymous_202(id) {
          
          return _this.fingerSet[id];
        });
        //$LASTPOS=54000254;//kernel.TouchFingers:254
        _this.fingerArray.findWithin=(function anonymous_277(o,d) {
          var j;
          var t;
          var _it_407;
          
          //$LASTPOS=54000303;//kernel.TouchFingers:303
          _it_407=Tonyu.iterator(_this.fingerSet,2);
          while(_it_407.next()) {
            j=_it_407[0];
            t=_it_407[1];
            
            //$LASTPOS=54000345;//kernel.TouchFingers:345
            if (o.within(t,d)) {
              return t;
              
            }
            
          }
        });
        //$LASTPOS=54000432;//kernel.TouchFingers:432
        _this.fingerArray.findTouch=(function anonymous_454(f) {
          var j;
          var t;
          var _it_412;
          
          //$LASTPOS=54000478;//kernel.TouchFingers:478
          _it_412=Tonyu.iterator(_this.fingerSet,2);
          while(_it_412.next()) {
            j=_it_412[0];
            t=_it_412[1];
            
            //$LASTPOS=54000520;//kernel.TouchFingers:520
            if (f(t)) {
              return t;
              
            }
            
          }
        });
        //$LASTPOS=54000598;//kernel.TouchFingers:598
        //$LASTPOS=54000603;//kernel.TouchFingers:603
        i = 0;
        for (; i<5 ; i++) {
          //$LASTPOS=54000620;//kernel.TouchFingers:620
          _this.fingerArray.push(new Tonyu.classes.kernel.TouchFinger(_this.inputDevice.defaultLayer,Tonyu.globals.$Screen,i));
        }
      },
      handleStart :function _trc_TouchFingers_handleStart(e) {
        "use strict";
        var _this=this;
        var p;
        var ts;
        var dst;
        var i;
        var src;
        var j;
        var mp;
        
        //$LASTPOS=54000720;//kernel.TouchFingers:720
        Tonyu.resetLoopCheck();
        //$LASTPOS=54000749;//kernel.TouchFingers:749
        Tonyu.globals.$t2MediaLib.activate();
        //$LASTPOS=54000778;//kernel.TouchFingers:778
        p = _this.inputDevice.rootCanvas.offset();
        
        //$LASTPOS=54000822;//kernel.TouchFingers:822
        e.preventDefault();
        //$LASTPOS=54000847;//kernel.TouchFingers:847
        ts = e.originalEvent.changedTouches;
        
        
        //$LASTPOS=54000905;//kernel.TouchFingers:905
        //$LASTPOS=54000910;//kernel.TouchFingers:910
        i = 0;
        for (; i<ts.length ; i++) {
          {
            //$LASTPOS=54000951;//kernel.TouchFingers:951
            src = ts[i];
            
            //$LASTPOS=54000975;//kernel.TouchFingers:975
            dst=new Tonyu.classes.kernel.TouchFinger(_this.inputDevice.defaultLayer,Tonyu.globals.$Screen);
            //$LASTPOS=54001040;//kernel.TouchFingers:1040
            _this.fingerSet[src.identifier]=dst;
            //$LASTPOS=54001082;//kernel.TouchFingers:1082
            //$LASTPOS=54001087;//kernel.TouchFingers:1087
            j = 0;
            for (; j<_this.fingerArray.length ; j++) {
              {
                //$LASTPOS=54001140;//kernel.TouchFingers:1140
                if (! _this.fingerArray[j].touched) {
                  //$LASTPOS=54001188;//kernel.TouchFingers:1188
                  dst.bound=_this.fingerArray[j];
                  break;
                  
                  
                }
              }
            }
            //$LASTPOS=54001273;//kernel.TouchFingers:1273
            mp = {x: src.pageX-p.left,y: src.pageY-p.top,layer: Tonyu.globals.$Screen.layer};
            
            //$LASTPOS=54001350;//kernel.TouchFingers:1350
            mp=Tonyu.globals.$Screen.convert(mp,_this.inputDevice.defaultLayer);
            //$LASTPOS=54001408;//kernel.TouchFingers:1408
            dst.doStart(src.identifier,mp);
          }
        }
        //$LASTPOS=54001452;//kernel.TouchFingers:1452
        Tonyu.globals.$mouseX=_this.fingerArray[0].x;
        //$LASTPOS=54001483;//kernel.TouchFingers:1483
        Tonyu.globals.$mouseY=_this.fingerArray[0].y;
        //$LASTPOS=54001514;//kernel.TouchFingers:1514
        _this.inputDevice.handleListeners("touchstart",{finger: dst,index: dst.bound&&dst.bound.index});
      },
      fiber$handleStart :function _trc_TouchFingers_f_handleStart(_thread,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        var ts;
        var dst;
        var i;
        var src;
        var j;
        var mp;
        
        //$LASTPOS=54000720;//kernel.TouchFingers:720
        Tonyu.resetLoopCheck();
        //$LASTPOS=54000749;//kernel.TouchFingers:749
        Tonyu.globals.$t2MediaLib.activate();
        //$LASTPOS=54000778;//kernel.TouchFingers:778
        p = _this.inputDevice.rootCanvas.offset();
        
        //$LASTPOS=54000822;//kernel.TouchFingers:822
        e.preventDefault();
        //$LASTPOS=54000847;//kernel.TouchFingers:847
        ts = e.originalEvent.changedTouches;
        
        
        //$LASTPOS=54000905;//kernel.TouchFingers:905
        //$LASTPOS=54000910;//kernel.TouchFingers:910
        i = 0;
        for (; i<ts.length ; i++) {
          {
            //$LASTPOS=54000951;//kernel.TouchFingers:951
            src = ts[i];
            
            //$LASTPOS=54000975;//kernel.TouchFingers:975
            dst=new Tonyu.classes.kernel.TouchFinger(_this.inputDevice.defaultLayer,Tonyu.globals.$Screen);
            //$LASTPOS=54001040;//kernel.TouchFingers:1040
            _this.fingerSet[src.identifier]=dst;
            //$LASTPOS=54001082;//kernel.TouchFingers:1082
            //$LASTPOS=54001087;//kernel.TouchFingers:1087
            j = 0;
            for (; j<_this.fingerArray.length ; j++) {
              {
                //$LASTPOS=54001140;//kernel.TouchFingers:1140
                if (! _this.fingerArray[j].touched) {
                  //$LASTPOS=54001188;//kernel.TouchFingers:1188
                  dst.bound=_this.fingerArray[j];
                  break;
                  
                  
                }
              }
            }
            //$LASTPOS=54001273;//kernel.TouchFingers:1273
            mp = {x: src.pageX-p.left,y: src.pageY-p.top,layer: Tonyu.globals.$Screen.layer};
            
            //$LASTPOS=54001350;//kernel.TouchFingers:1350
            mp=Tonyu.globals.$Screen.convert(mp,_this.inputDevice.defaultLayer);
            //$LASTPOS=54001408;//kernel.TouchFingers:1408
            dst.doStart(src.identifier,mp);
          }
        }
        //$LASTPOS=54001452;//kernel.TouchFingers:1452
        Tonyu.globals.$mouseX=_this.fingerArray[0].x;
        //$LASTPOS=54001483;//kernel.TouchFingers:1483
        Tonyu.globals.$mouseY=_this.fingerArray[0].y;
        //$LASTPOS=54001514;//kernel.TouchFingers:1514
        _this.inputDevice.handleListeners("touchstart",{finger: dst,index: dst.bound&&dst.bound.index});
        
        _thread.retVal=_this;return;
      },
      handleMove :function _trc_TouchFingers_handleMove(e) {
        "use strict";
        var _this=this;
        var p;
        var ts;
        var dst;
        var i;
        var src;
        
        //$LASTPOS=54001649;//kernel.TouchFingers:1649
        Tonyu.resetLoopCheck();
        //$LASTPOS=54001678;//kernel.TouchFingers:1678
        Tonyu.globals.$t2MediaLib.activate();
        //$LASTPOS=54001707;//kernel.TouchFingers:1707
        p = _this.inputDevice.rootCanvas.offset();
        
        //$LASTPOS=54001751;//kernel.TouchFingers:1751
        e.preventDefault();
        //$LASTPOS=54001776;//kernel.TouchFingers:1776
        ts = e.originalEvent.changedTouches;
        
        
        //$LASTPOS=54001834;//kernel.TouchFingers:1834
        //$LASTPOS=54001839;//kernel.TouchFingers:1839
        i = 0;
        for (; i<ts.length ; i++) {
          {
            //$LASTPOS=54001880;//kernel.TouchFingers:1880
            src = ts[i];
            
            //$LASTPOS=54001904;//kernel.TouchFingers:1904
            dst = _this.fingerSet[src.identifier];
            
            //$LASTPOS=54001948;//kernel.TouchFingers:1948
            if (dst) {
              //$LASTPOS=54001972;//kernel.TouchFingers:1972
              _this.mp={x: src.pageX-p.left,y: src.pageY-p.top,layer: Tonyu.globals.$Screen.layer};
              //$LASTPOS=54002124;//kernel.TouchFingers:2124
              dst.doMove(_this.mp);
              //$LASTPOS=54002210;//kernel.TouchFingers:2210
              _this.inputDevice.handleListeners("touchmove",{finger: dst,index: dst.bound&&dst.bound.index});
              
            }
          }
        }
        //$LASTPOS=54002357;//kernel.TouchFingers:2357
        Tonyu.globals.$mouseX=_this.fingerArray[0].x;
        //$LASTPOS=54002388;//kernel.TouchFingers:2388
        Tonyu.globals.$mouseY=_this.fingerArray[0].y;
      },
      fiber$handleMove :function _trc_TouchFingers_f_handleMove(_thread,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        var ts;
        var dst;
        var i;
        var src;
        
        //$LASTPOS=54001649;//kernel.TouchFingers:1649
        Tonyu.resetLoopCheck();
        //$LASTPOS=54001678;//kernel.TouchFingers:1678
        Tonyu.globals.$t2MediaLib.activate();
        //$LASTPOS=54001707;//kernel.TouchFingers:1707
        p = _this.inputDevice.rootCanvas.offset();
        
        //$LASTPOS=54001751;//kernel.TouchFingers:1751
        e.preventDefault();
        //$LASTPOS=54001776;//kernel.TouchFingers:1776
        ts = e.originalEvent.changedTouches;
        
        
        //$LASTPOS=54001834;//kernel.TouchFingers:1834
        //$LASTPOS=54001839;//kernel.TouchFingers:1839
        i = 0;
        for (; i<ts.length ; i++) {
          {
            //$LASTPOS=54001880;//kernel.TouchFingers:1880
            src = ts[i];
            
            //$LASTPOS=54001904;//kernel.TouchFingers:1904
            dst = _this.fingerSet[src.identifier];
            
            //$LASTPOS=54001948;//kernel.TouchFingers:1948
            if (dst) {
              //$LASTPOS=54001972;//kernel.TouchFingers:1972
              _this.mp={x: src.pageX-p.left,y: src.pageY-p.top,layer: Tonyu.globals.$Screen.layer};
              //$LASTPOS=54002124;//kernel.TouchFingers:2124
              dst.doMove(_this.mp);
              //$LASTPOS=54002210;//kernel.TouchFingers:2210
              _this.inputDevice.handleListeners("touchmove",{finger: dst,index: dst.bound&&dst.bound.index});
              
            }
          }
        }
        //$LASTPOS=54002357;//kernel.TouchFingers:2357
        Tonyu.globals.$mouseX=_this.fingerArray[0].x;
        //$LASTPOS=54002388;//kernel.TouchFingers:2388
        Tonyu.globals.$mouseY=_this.fingerArray[0].y;
        
        _thread.retVal=_this;return;
      },
      handleEnd :function _trc_TouchFingers_handleEnd(e) {
        "use strict";
        var _this=this;
        var ts;
        var i;
        var src;
        var dst;
        
        //$LASTPOS=54002439;//kernel.TouchFingers:2439
        Tonyu.resetLoopCheck();
        //$LASTPOS=54002468;//kernel.TouchFingers:2468
        Tonyu.globals.$t2MediaLib.activate();
        //$LASTPOS=54002497;//kernel.TouchFingers:2497
        ts = e.originalEvent.changedTouches;
        
        //$LASTPOS=54002541;//kernel.TouchFingers:2541
        //$LASTPOS=54002546;//kernel.TouchFingers:2546
        i = 0;
        for (; i<ts.length ; i++) {
          {
            //$LASTPOS=54002587;//kernel.TouchFingers:2587
            src = ts[i];
            
            //$LASTPOS=54002611;//kernel.TouchFingers:2611
            dst = _this.fingerSet[src.identifier];
            
            //$LASTPOS=54002655;//kernel.TouchFingers:2655
            if (dst) {
              //$LASTPOS=54002679;//kernel.TouchFingers:2679
              delete _this.fingerSet[src.identifier];
              //$LASTPOS=54002726;//kernel.TouchFingers:2726
              dst.doEnd();
              //$LASTPOS=54002752;//kernel.TouchFingers:2752
              _this.inputDevice.handleListeners("touchend",{finger: dst,index: dst.bound&&dst.bound.index});
              
            }
          }
        }
      },
      fiber$handleEnd :function _trc_TouchFingers_f_handleEnd(_thread,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ts;
        var i;
        var src;
        var dst;
        
        //$LASTPOS=54002439;//kernel.TouchFingers:2439
        Tonyu.resetLoopCheck();
        //$LASTPOS=54002468;//kernel.TouchFingers:2468
        Tonyu.globals.$t2MediaLib.activate();
        //$LASTPOS=54002497;//kernel.TouchFingers:2497
        ts = e.originalEvent.changedTouches;
        
        //$LASTPOS=54002541;//kernel.TouchFingers:2541
        //$LASTPOS=54002546;//kernel.TouchFingers:2546
        i = 0;
        for (; i<ts.length ; i++) {
          {
            //$LASTPOS=54002587;//kernel.TouchFingers:2587
            src = ts[i];
            
            //$LASTPOS=54002611;//kernel.TouchFingers:2611
            dst = _this.fingerSet[src.identifier];
            
            //$LASTPOS=54002655;//kernel.TouchFingers:2655
            if (dst) {
              //$LASTPOS=54002679;//kernel.TouchFingers:2679
              delete _this.fingerSet[src.identifier];
              //$LASTPOS=54002726;//kernel.TouchFingers:2726
              dst.doEnd();
              //$LASTPOS=54002752;//kernel.TouchFingers:2752
              _this.inputDevice.handleListeners("touchend",{finger: dst,index: dst.bound&&dst.bound.index});
              
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      unsetEmu :function _trc_TouchFingers_unsetEmu(ID_MOUSE) {
        "use strict";
        var _this=this;
        var t;
        var _it_432;
        var i;
        var _it_433;
        
        //$LASTPOS=54002924;//kernel.TouchFingers:2924
        _it_432=Tonyu.iterator(_this.fingerArray,1);
        while(_it_432.next()) {
          t=_it_432[0];
          
          //$LASTPOS=54002962;//kernel.TouchFingers:2962
          if (t.identifier==ID_MOUSE) {
            //$LASTPOS=54003005;//kernel.TouchFingers:3005
            t.reset();
            
          }
          
        }
        //$LASTPOS=54003039;//kernel.TouchFingers:3039
        _it_433=Tonyu.iterator(_this.fingerSet,2);
        while(_it_433.next()) {
          i=_it_433[0];
          t=_it_433[1];
          
          //$LASTPOS=54003077;//kernel.TouchFingers:3077
          if (t.identifier==ID_MOUSE) {
            //$LASTPOS=54003120;//kernel.TouchFingers:3120
            t.reset();
            
          }
          
        }
      },
      fiber$unsetEmu :function _trc_TouchFingers_f_unsetEmu(_thread,ID_MOUSE) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var t;
        var _it_432;
        var i;
        var _it_433;
        
        //$LASTPOS=54002924;//kernel.TouchFingers:2924
        _it_432=Tonyu.iterator(_this.fingerArray,1);
        while(_it_432.next()) {
          t=_it_432[0];
          
          //$LASTPOS=54002962;//kernel.TouchFingers:2962
          if (t.identifier==ID_MOUSE) {
            //$LASTPOS=54003005;//kernel.TouchFingers:3005
            t.reset();
            
          }
          
        }
        //$LASTPOS=54003039;//kernel.TouchFingers:3039
        _it_433=Tonyu.iterator(_this.fingerSet,2);
        while(_it_433.next()) {
          i=_it_433[0];
          t=_it_433[1];
          
          //$LASTPOS=54003077;//kernel.TouchFingers:3077
          if (t.identifier==ID_MOUSE) {
            //$LASTPOS=54003120;//kernel.TouchFingers:3120
            t.reset();
            
          }
          
        }
        
        _thread.retVal=_this;return;
      },
      updateFingers :function _trc_TouchFingers_updateFingers() {
        "use strict";
        var _this=this;
        var t;
        var _it_438;
        var i;
        var _it_439;
        
        //$LASTPOS=54003177;//kernel.TouchFingers:3177
        _it_438=Tonyu.iterator(_this.fingerArray,1);
        while(_it_438.next()) {
          t=_it_438[0];
          
          //$LASTPOS=54003215;//kernel.TouchFingers:3215
          t.update();
          
        }
        //$LASTPOS=54003239;//kernel.TouchFingers:3239
        _it_439=Tonyu.iterator(_this.fingerSet,2);
        while(_it_439.next()) {
          i=_it_439[0];
          t=_it_439[1];
          
          //$LASTPOS=54003277;//kernel.TouchFingers:3277
          t.update();
          
        }
      },
      fiber$updateFingers :function _trc_TouchFingers_f_updateFingers(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var t;
        var _it_438;
        var i;
        var _it_439;
        
        //$LASTPOS=54003177;//kernel.TouchFingers:3177
        _it_438=Tonyu.iterator(_this.fingerArray,1);
        while(_it_438.next()) {
          t=_it_438[0];
          
          //$LASTPOS=54003215;//kernel.TouchFingers:3215
          t.update();
          
        }
        //$LASTPOS=54003239;//kernel.TouchFingers:3239
        _it_439=Tonyu.iterator(_this.fingerSet,2);
        while(_it_439.next()) {
          i=_it_439[0];
          t=_it_439[1];
          
          //$LASTPOS=54003277;//kernel.TouchFingers:3277
          t.update();
          
        }
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"handleStart":{"nowait":false},"handleMove":{"nowait":false},"handleEnd":{"nowait":false},"unsetEmu":{"nowait":false},"updateFingers":{"nowait":false}},"fields":{"inputDevice":{},"fingerSet":{},"fingerArray":{},"mp":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.LifeCycleMod',
  shortName: 'LifeCycleMod',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.EventHandlerCaller,Tonyu.classes.kernel.MathMod,Tonyu.classes.kernel.ThreadGroupMod],
  methods: function (__superClass) {
    return {
      main :function _trc_LifeCycleMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55000077;//kernel.LifeCycleMod:77
        "field strict";
        
      },
      fiber$main :function _trc_LifeCycleMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=55000077;//kernel.LifeCycleMod:77
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      hide :function _trc_LifeCycleMod_hide() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55000263;//kernel.LifeCycleMod:263
        if (Tonyu.is(_this.layer,Tonyu.classes.kernel.SpriteGroup)) {
          //$LASTPOS=55000299;//kernel.LifeCycleMod:299
          _this.layer.remove(_this);
          
        } else {
          //$LASTPOS=55000331;//kernel.LifeCycleMod:331
          if (Tonyu.is(_this.__addedToSprites,Tonyu.classes.kernel.SpriteGroup)) {
            //$LASTPOS=55000384;//kernel.LifeCycleMod:384
            _this.__addedToSprites.remove(_this);
            
          } else {
            
            
          }
        }
      },
      show :function _trc_LifeCycleMod_show(x,y,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55000723;//kernel.LifeCycleMod:723
        _this.layer.add(_this);
        //$LASTPOS=55000745;//kernel.LifeCycleMod:745
        if (x!=null) {
          //$LASTPOS=55000758;//kernel.LifeCycleMod:758
          _this.x=x;
        }
        //$LASTPOS=55000773;//kernel.LifeCycleMod:773
        if (y!=null) {
          //$LASTPOS=55000786;//kernel.LifeCycleMod:786
          _this.y=y;
        }
        //$LASTPOS=55000801;//kernel.LifeCycleMod:801
        if (p!=null) {
          //$LASTPOS=55000814;//kernel.LifeCycleMod:814
          _this.p=p;
        }
      },
      die :function _trc_LifeCycleMod_die() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55000851;//kernel.LifeCycleMod:851
        _this.killThreadGroup();
        //$LASTPOS=55000875;//kernel.LifeCycleMod:875
        _this.hide();
        //$LASTPOS=55000888;//kernel.LifeCycleMod:888
        if (! _this._isDead) {
          //$LASTPOS=55000913;//kernel.LifeCycleMod:913
          _this.fireEvent("die");
          //$LASTPOS=55000940;//kernel.LifeCycleMod:940
          _this._isDead=true;
          //$LASTPOS=55000963;//kernel.LifeCycleMod:963
          if (_this._poolArray) {
            //$LASTPOS=55000994;//kernel.LifeCycleMod:994
            _this._poolArray.push(_this);
            //$LASTPOS=55001030;//kernel.LifeCycleMod:1030
            _this.objectPoolAge=(_this.objectPoolAge||0)+1;
            
          }
          
        }
      },
      __setter__lifeKeeper :function _trc_LifeCycleMod___setter__lifeKeeper(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55001111;//kernel.LifeCycleMod:1111
        _this._lifeKeeper=v;
        //$LASTPOS=55001131;//kernel.LifeCycleMod:1131
        if (v&&typeof  v.on==="function") {
          //$LASTPOS=55001177;//kernel.LifeCycleMod:1177
          v.on("die",Tonyu.bindFunc(_this,_this.die));
          
        }
      },
      __getter__lifeKeeper :function _trc_LifeCycleMod___getter__lifeKeeper() {
        "use strict";
        var _this=this;
        
        return _this._lifeKeeper;
      },
      isDead :function _trc_LifeCycleMod_isDead() {
        "use strict";
        var _this=this;
        
        return _this._isDead;
      },
      __setter__useObjectPool :function _trc_LifeCycleMod___setter__useObjectPool(value) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55001326;//kernel.LifeCycleMod:1326
        if (value) {
          //$LASTPOS=55001348;//kernel.LifeCycleMod:1348
          _this._poolArray=Tonyu.globals.$ObjectPool.poolList(_this.getClassInfo().fullName);
          
        }
      },
      appear :function _trc_LifeCycleMod_appear(o,param) {
        "use strict";
        var _this=this;
        var p;
        var k;
        var _it_444;
        
        //$LASTPOS=55001446;//kernel.LifeCycleMod:1446
        if (typeof  o=="function") {
          //$LASTPOS=55001483;//kernel.LifeCycleMod:1483
          if (param) {
            //$LASTPOS=55001496;//kernel.LifeCycleMod:1496
            param.layer=param.layer||_this.layer;
            
          }
          //$LASTPOS=55001539;//kernel.LifeCycleMod:1539
          p = Tonyu.globals.$ObjectPool.withdraw(o.meta.fullName);
          
          //$LASTPOS=55001593;//kernel.LifeCycleMod:1593
          if (p) {
            //$LASTPOS=55001612;//kernel.LifeCycleMod:1612
            _it_444=Tonyu.iterator(Object.keys(p),1);
            while(_it_444.next()) {
              k=_it_444[0];
              
              //$LASTPOS=55001657;//kernel.LifeCycleMod:1657
              if (k!="objectPoolAge") {
                //$LASTPOS=55001681;//kernel.LifeCycleMod:1681
                delete p[k];
              }
              
            }
            //$LASTPOS=55001710;//kernel.LifeCycleMod:1710
            o.call(p,param);
            return p;
            
          } else {
            return new o(param);
            
          }
          
        } else {
          return o;
          
        }
      },
      fiber$appear :function _trc_LifeCycleMod_f_appear(_thread,o,param) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        var k;
        var _it_444;
        
        //$LASTPOS=55001446;//kernel.LifeCycleMod:1446
        if (typeof  o=="function") {
          //$LASTPOS=55001483;//kernel.LifeCycleMod:1483
          if (param) {
            //$LASTPOS=55001496;//kernel.LifeCycleMod:1496
            param.layer=param.layer||_this.layer;
            
          }
          //$LASTPOS=55001539;//kernel.LifeCycleMod:1539
          p = Tonyu.globals.$ObjectPool.withdraw(o.meta.fullName);
          
          //$LASTPOS=55001593;//kernel.LifeCycleMod:1593
          if (p) {
            //$LASTPOS=55001612;//kernel.LifeCycleMod:1612
            _it_444=Tonyu.iterator(Object.keys(p),1);
            while(_it_444.next()) {
              k=_it_444[0];
              
              //$LASTPOS=55001657;//kernel.LifeCycleMod:1657
              if (k!="objectPoolAge") {
                //$LASTPOS=55001681;//kernel.LifeCycleMod:1681
                delete p[k];
              }
              
            }
            //$LASTPOS=55001710;//kernel.LifeCycleMod:1710
            o.call(p,param);
            _thread.retVal=p;return;
            
            
          } else {
            _thread.retVal=new o(param);return;
            
            
          }
          
        } else {
          _thread.retVal=o;return;
          
          
        }
        
        _thread.retVal=_this;return;
      },
      getSpriteGroup :function _trc_LifeCycleMod_getSpriteGroup() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55001870;//kernel.LifeCycleMod:1870
        if (Tonyu.is(_this.__addedToSprites,Tonyu.classes.kernel.SpriteGroup)) {
          return _this.__addedToSprites;
          
        }
        //$LASTPOS=55001965;//kernel.LifeCycleMod:1965
        if (Tonyu.is(_this.layer,Tonyu.classes.kernel.SpriteGroup)) {
          return _this.layer;
          
        }
        return null;
      },
      fiber$getSpriteGroup :function _trc_LifeCycleMod_f_getSpriteGroup(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=55001870;//kernel.LifeCycleMod:1870
        if (Tonyu.is(_this.__addedToSprites,Tonyu.classes.kernel.SpriteGroup)) {
          _thread.retVal=_this.__addedToSprites;return;
          
          
        }
        //$LASTPOS=55001965;//kernel.LifeCycleMod:1965
        if (Tonyu.is(_this.layer,Tonyu.classes.kernel.SpriteGroup)) {
          _thread.retVal=_this.layer;return;
          
          
        }
        _thread.retVal=null;return;
        
        
        _thread.retVal=_this;return;
      },
      addToLayer :function _trc_LifeCycleMod_addToLayer() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=55002099;//kernel.LifeCycleMod:2099
        if (_this.layer&&typeof  _this.layer.addSubsprite==="function") {
          //$LASTPOS=55002161;//kernel.LifeCycleMod:2161
          _this.layer.addSubsprite(_this);
          
        } else {
          //$LASTPOS=55002199;//kernel.LifeCycleMod:2199
          if (Tonyu.is(_this.layer,Tonyu.classes.kernel.SpriteGroup)) {
            //$LASTPOS=55002234;//kernel.LifeCycleMod:2234
            _this.layer.add(_this);
            
          } else {
            //$LASTPOS=55002263;//kernel.LifeCycleMod:2263
            if (Tonyu.is(_this.layer,Tonyu.classes.kernel.ScreenLayer)) {
              //$LASTPOS=55002298;//kernel.LifeCycleMod:2298
              _this.layer.group.add(_this);
              
            } else {
              //$LASTPOS=55002378;//kernel.LifeCycleMod:2378
              Tonyu.globals.$Sprites.add(_this);
              
            }
          }
        }
        //$LASTPOS=55002410;//kernel.LifeCycleMod:2410
        _this.onAppear();
      },
      fiber$addToLayer :function _trc_LifeCycleMod_f_addToLayer(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=55002099;//kernel.LifeCycleMod:2099
        if (_this.layer&&typeof  _this.layer.addSubsprite==="function") {
          //$LASTPOS=55002161;//kernel.LifeCycleMod:2161
          _this.layer.addSubsprite(_this);
          
        } else {
          //$LASTPOS=55002199;//kernel.LifeCycleMod:2199
          if (Tonyu.is(_this.layer,Tonyu.classes.kernel.SpriteGroup)) {
            //$LASTPOS=55002234;//kernel.LifeCycleMod:2234
            _this.layer.add(_this);
            
          } else {
            //$LASTPOS=55002263;//kernel.LifeCycleMod:2263
            if (Tonyu.is(_this.layer,Tonyu.classes.kernel.ScreenLayer)) {
              //$LASTPOS=55002298;//kernel.LifeCycleMod:2298
              _this.layer.group.add(_this);
              
            } else {
              //$LASTPOS=55002378;//kernel.LifeCycleMod:2378
              Tonyu.globals.$Sprites.add(_this);
              
            }
          }
        }
        
        _thread.enter(function _trc_LifeCycleMod_ent_addToLayer(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=55002410;//kernel.LifeCycleMod:2410
              _this.fiber$onAppear(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      changeLayer :function _trc_LifeCycleMod_changeLayer(l) {
        "use strict";
        var _this=this;
        var curLayer;
        
        //$LASTPOS=55002449;//kernel.LifeCycleMod:2449
        if (! l||typeof  l.addSubsprite!=="function") {
          return _this;
        }
        //$LASTPOS=55002508;//kernel.LifeCycleMod:2508
        curLayer = _this.getSpriteGroup();
        
        //$LASTPOS=55002544;//kernel.LifeCycleMod:2544
        if (curLayer) {
          //$LASTPOS=55002569;//kernel.LifeCycleMod:2569
          curLayer.remove(_this);
          
        }
        //$LASTPOS=55002642;//kernel.LifeCycleMod:2642
        l.addSubsprite(_this);
        //$LASTPOS=55002669;//kernel.LifeCycleMod:2669
        _this.layer=l;
      },
      fiber$changeLayer :function _trc_LifeCycleMod_f_changeLayer(_thread,l) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var curLayer;
        
        //$LASTPOS=55002449;//kernel.LifeCycleMod:2449
        if (! l||typeof  l.addSubsprite!=="function") {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_LifeCycleMod_ent_changeLayer(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=55002508;//kernel.LifeCycleMod:2508
              _this.fiber$getSpriteGroup(_thread);
              __pc=1;return;
            case 1:
              curLayer=_thread.retVal;
              
              //$LASTPOS=55002544;//kernel.LifeCycleMod:2544
              if (curLayer) {
                //$LASTPOS=55002569;//kernel.LifeCycleMod:2569
                curLayer.remove(_this);
                
              }
              //$LASTPOS=55002642;//kernel.LifeCycleMod:2642
              l.addSubsprite(_this);
              //$LASTPOS=55002669;//kernel.LifeCycleMod:2669
              _this.layer=l;
              _thread.exit(_this);return;
            }
          }
        });
      },
      onAppear :function _trc_LifeCycleMod_onAppear() {
        "use strict";
        var _this=this;
        
      },
      fiber$onAppear :function _trc_LifeCycleMod_f_onAppear(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"hide":{"nowait":true},"show":{"nowait":true},"die":{"nowait":true},"__setter__lifeKeeper":{"nowait":true},"__getter__lifeKeeper":{"nowait":true},"isDead":{"nowait":true},"__setter__useObjectPool":{"nowait":true},"appear":{"nowait":false},"getSpriteGroup":{"nowait":false},"addToLayer":{"nowait":false},"changeLayer":{"nowait":false},"onAppear":{"nowait":false}},"fields":{"layer":{},"_isDead":{},"_poolArray":{},"objectPoolAge":{},"_lifeKeeper":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Matrix',
  shortName: 'Matrix',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod,Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.FileMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Matrix_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Matrix_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Matrix_initialize(d) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=56000071;//kernel.Matrix:71
        _this.data={}||d;
      },
      load :function _trc_Matrix_load(csvFile) {
        "use strict";
        var _this=this;
        var f;
        var x;
        var y;
        var SEP;
        var lines;
        var l;
        var _it_449;
        var _it_450;
        
        //$LASTPOS=56000109;//kernel.Matrix:109
        f = _this.file(csvFile);
        
        //$LASTPOS=56000135;//kernel.Matrix:135
        x = 0;
        y = 0;
        
        //$LASTPOS=56000153;//kernel.Matrix:153
        SEP = ",";
        
        //$LASTPOS=56000171;//kernel.Matrix:171
        lines = f.lines();
        
        //$LASTPOS=56000218;//kernel.Matrix:218
        _it_449=Tonyu.iterator(lines,1);
        while(_it_449.next()) {
          l=_it_449[0];
          
          //$LASTPOS=56000250;//kernel.Matrix:250
          _this.row=l.split(SEP);
          //$LASTPOS=56000277;//kernel.Matrix:277
          x=0;
          //$LASTPOS=56000291;//kernel.Matrix:291
          _it_450=Tonyu.iterator(_this.row,1);
          while(_it_450.next()) {
            _this.cell=_it_450[0];
            
            //$LASTPOS=56000324;//kernel.Matrix:324
            _this.set(x,y,_this.cell);
            //$LASTPOS=56000352;//kernel.Matrix:352
            x++;
            
          }
          //$LASTPOS=56000377;//kernel.Matrix:377
          y++;
          
        }
      },
      fiber$load :function _trc_Matrix_f_load(_thread,csvFile) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var f;
        var x;
        var y;
        var SEP;
        var lines;
        var l;
        var _it_449;
        var _it_450;
        
        
        _thread.enter(function _trc_Matrix_ent_load(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56000109;//kernel.Matrix:109
              _this.fiber$file(_thread, csvFile);
              __pc=1;return;
            case 1:
              f=_thread.retVal;
              
              //$LASTPOS=56000135;//kernel.Matrix:135
              x = 0;
              y = 0;
              
              //$LASTPOS=56000153;//kernel.Matrix:153
              SEP = ",";
              
              //$LASTPOS=56000171;//kernel.Matrix:171
              lines = f.lines();
              
              //$LASTPOS=56000218;//kernel.Matrix:218
              _it_449=Tonyu.iterator(lines,1);
            case 2:
              if (!(_it_449.next())) { __pc=6     ; break; }
              l=_it_449[0];
              
              //$LASTPOS=56000250;//kernel.Matrix:250
              _this.row=l.split(SEP);
              //$LASTPOS=56000277;//kernel.Matrix:277
              x=0;
              //$LASTPOS=56000291;//kernel.Matrix:291
              _it_450=Tonyu.iterator(_this.row,1);
            case 3:
              if (!(_it_450.next())) { __pc=5     ; break; }
              _this.cell=_it_450[0];
              
              //$LASTPOS=56000324;//kernel.Matrix:324
              _this.fiber$set(_thread, x, y, _this.cell);
              __pc=4;return;
            case 4:
              
              //$LASTPOS=56000352;//kernel.Matrix:352
              x++;
              __pc=3;break;
            case 5     :
              
              //$LASTPOS=56000377;//kernel.Matrix:377
              y++;
              __pc=2;break;
            case 6     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      cross :function _trc_Matrix_cross(col,row) {
        "use strict";
        var _this=this;
        var colr;
        var rowr;
        
        //$LASTPOS=56000416;//kernel.Matrix:416
        colr = _this.find(col);
        
        //$LASTPOS=56000441;//kernel.Matrix:441
        rowr = _this.find(row);
        
        return _this.get(colr.x,rowr.y);
      },
      fiber$cross :function _trc_Matrix_f_cross(_thread,col,row) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var colr;
        var rowr;
        
        
        _thread.enter(function _trc_Matrix_ent_cross(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56000416;//kernel.Matrix:416
              _this.fiber$find(_thread, col);
              __pc=1;return;
            case 1:
              colr=_thread.retVal;
              
              //$LASTPOS=56000441;//kernel.Matrix:441
              _this.fiber$find(_thread, row);
              __pc=2;return;
            case 2:
              rowr=_thread.retVal;
              
              _this.fiber$get(_thread, colr.x, rowr.y);
              __pc=3;return;
            case 3:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      search :function _trc_Matrix_search(cell,options) {
        "use strict";
        var _this=this;
        var k;
        var v;
        var _it_461;
        
        //$LASTPOS=56000526;//kernel.Matrix:526
        _it_461=Tonyu.iterator(_this.data,2);
        while(_it_461.next()) {
          k=_it_461[0];
          v=_it_461[1];
          
          //$LASTPOS=56000559;//kernel.Matrix:559
          if (v===cell) {
            return _this.unkey(k);
            
          }
          
        }
      },
      fiber$search :function _trc_Matrix_f_search(_thread,cell,options) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var k;
        var v;
        var _it_461;
        
        
        _thread.enter(function _trc_Matrix_ent_search(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56000526;//kernel.Matrix:526
              _it_461=Tonyu.iterator(_this.data,2);
            case 1:
              if (!(_it_461.next())) { __pc=4     ; break; }
              k=_it_461[0];
              v=_it_461[1];
              
              //$LASTPOS=56000559;//kernel.Matrix:559
              if (!(v===cell)) { __pc=3     ; break; }
              _this.fiber$unkey(_thread, k);
              __pc=2;return;
            case 2:
              _thread.exit(_thread.retVal);return;
              
            case 3     :
              
              __pc=1;break;
            case 4     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      find :function _trc_Matrix_find() {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=56000642;//kernel.Matrix:642
        r = Tonyu.bindFunc(_this,_this.search).apply(_this,arguments);
        
        //$LASTPOS=56000683;//kernel.Matrix:683
        if (r==null) {
          throw new Error(arguments[0]+" not found.");
          
          
        }
        return r;
      },
      fiber$find :function _trc_Matrix_f_find(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        //$LASTPOS=56000642;//kernel.Matrix:642
        r = Tonyu.bindFunc(_this,_this.search).apply(_this,_arguments);
        
        //$LASTPOS=56000683;//kernel.Matrix:683
        if (r==null) {
          throw new Error(_arguments[0]+" not found.");
          
          
        }
        _thread.retVal=r;return;
        
        
        _thread.retVal=_this;return;
      },
      crop :function _trc_Matrix_crop() {
        "use strict";
        var _this=this;
        var a;
        var o;
        var r;
        var y;
        var x;
        
        //$LASTPOS=56000793;//kernel.Matrix:793
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=56000830;//kernel.Matrix:830
        o = a.parseOptions("left,top,right,bottom,width,height,keepXY");
        
        //$LASTPOS=56000902;//kernel.Matrix:902
        r = new Tonyu.classes.kernel.Matrix;
        
        //$LASTPOS=56000925;//kernel.Matrix:925
        if (o.width) {
          //$LASTPOS=56000938;//kernel.Matrix:938
          o.right=o.left+o.width-1;
        }
        //$LASTPOS=56000969;//kernel.Matrix:969
        if (o.height) {
          //$LASTPOS=56000983;//kernel.Matrix:983
          o.bottom=o.top+o.height-1;
        }
        //$LASTPOS=56001015;//kernel.Matrix:1015
        if (o.right==null) {
          //$LASTPOS=56001034;//kernel.Matrix:1034
          o.right=_this.xmax;
        }
        //$LASTPOS=56001053;//kernel.Matrix:1053
        if (o.bottom==null) {
          //$LASTPOS=56001073;//kernel.Matrix:1073
          o.bottom=_this.ymax;
        }
        //$LASTPOS=56001093;//kernel.Matrix:1093
        //$LASTPOS=56001097;//kernel.Matrix:1097
        y = o.top;
        for (; y<=o.bottom ; y++) {
          {
            //$LASTPOS=56001137;//kernel.Matrix:1137
            //$LASTPOS=56001141;//kernel.Matrix:1141
            x = o.left;
            for (; x<=o.right ; x++) {
              {
                //$LASTPOS=56001184;//kernel.Matrix:1184
                if (o.keepXY) {
                  //$LASTPOS=56001217;//kernel.Matrix:1217
                  r.set(x,y,_this.get(x,y));
                  
                } else {
                  //$LASTPOS=56001277;//kernel.Matrix:1277
                  r.set(x-o.left,y-o.top,_this.get(x,y));
                  
                }
              }
            }
          }
        }
        return r;
      },
      fiber$crop :function _trc_Matrix_f_crop(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var o;
        var r;
        var y;
        var x;
        
        //$LASTPOS=56000793;//kernel.Matrix:793
        a = new Tonyu.classes.kernel.ArgParser(_arguments);
        
        //$LASTPOS=56000830;//kernel.Matrix:830
        o = a.parseOptions("left,top,right,bottom,width,height,keepXY");
        
        //$LASTPOS=56000902;//kernel.Matrix:902
        r = new Tonyu.classes.kernel.Matrix;
        
        //$LASTPOS=56000925;//kernel.Matrix:925
        if (o.width) {
          //$LASTPOS=56000938;//kernel.Matrix:938
          o.right=o.left+o.width-1;
        }
        //$LASTPOS=56000969;//kernel.Matrix:969
        if (o.height) {
          //$LASTPOS=56000983;//kernel.Matrix:983
          o.bottom=o.top+o.height-1;
        }
        //$LASTPOS=56001015;//kernel.Matrix:1015
        if (o.right==null) {
          //$LASTPOS=56001034;//kernel.Matrix:1034
          o.right=_this.xmax;
        }
        //$LASTPOS=56001053;//kernel.Matrix:1053
        if (o.bottom==null) {
          //$LASTPOS=56001073;//kernel.Matrix:1073
          o.bottom=_this.ymax;
        }
        //$LASTPOS=56001093;//kernel.Matrix:1093
        //$LASTPOS=56001097;//kernel.Matrix:1097
        y = o.top;
        for (; y<=o.bottom ; y++) {
          {
            //$LASTPOS=56001137;//kernel.Matrix:1137
            //$LASTPOS=56001141;//kernel.Matrix:1141
            x = o.left;
            for (; x<=o.right ; x++) {
              {
                //$LASTPOS=56001184;//kernel.Matrix:1184
                if (o.keepXY) {
                  //$LASTPOS=56001217;//kernel.Matrix:1217
                  r.set(x,y,_this.get(x,y));
                  
                } else {
                  //$LASTPOS=56001277;//kernel.Matrix:1277
                  r.set(x-o.left,y-o.top,_this.get(x,y));
                  
                }
              }
            }
          }
        }
        _thread.retVal=r;return;
        
        
        _thread.retVal=_this;return;
      },
      rev :function _trc_Matrix_rev(line) {
        "use strict";
        var _this=this;
        var res;
        var e;
        var _it_471;
        
        //$LASTPOS=56001565;//kernel.Matrix:1565
        res = [];
        
        //$LASTPOS=56001582;//kernel.Matrix:1582
        _it_471=Tonyu.iterator(line,1);
        while(_it_471.next()) {
          e=_it_471[0];
          
          //$LASTPOS=56001613;//kernel.Matrix:1613
          res.unshift(e);
          
        }
        return res;
      },
      fiber$rev :function _trc_Matrix_f_rev(_thread,line) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var e;
        var _it_471;
        
        //$LASTPOS=56001565;//kernel.Matrix:1565
        res = [];
        
        //$LASTPOS=56001582;//kernel.Matrix:1582
        _it_471=Tonyu.iterator(line,1);
        while(_it_471.next()) {
          e=_it_471[0];
          
          //$LASTPOS=56001613;//kernel.Matrix:1613
          res.unshift(e);
          
        }
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      keysIterator :function _trc_Matrix_keysIterator() {
        "use strict";
        var _this=this;
        
        return {tonyuIterator: Tonyu.bindFunc(_this,_this.tonyuIteratorKeys)};
      },
      fiber$keysIterator :function _trc_Matrix_f_keysIterator(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal={tonyuIterator: Tonyu.bindFunc(_this,_this.tonyuIteratorKeys)};return;
        
        
        _thread.retVal=_this;return;
      },
      rectIterator :function _trc_Matrix_rectIterator() {
        "use strict";
        var _this=this;
        
        return {tonyuIterator: Tonyu.bindFunc(_this,_this.tonyuIteratorRect)};
      },
      fiber$rectIterator :function _trc_Matrix_f_rectIterator(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal={tonyuIterator: Tonyu.bindFunc(_this,_this.tonyuIteratorRect)};return;
        
        
        _thread.retVal=_this;return;
      },
      tonyuIteratorKeys :function _trc_Matrix_tonyuIteratorKeys(arity) {
        "use strict";
        var _this=this;
        var res;
        var k;
        var v;
        var _it_475;
        
        //$LASTPOS=56001860;//kernel.Matrix:1860
        res = {i: 0,keys: []};
        
        //$LASTPOS=56001888;//kernel.Matrix:1888
        _it_475=Tonyu.iterator(_this.data,2);
        while(_it_475.next()) {
          k=_it_475[0];
          v=_it_475[1];
          
          //$LASTPOS=56001921;//kernel.Matrix:1921
          res.keys.push(k);
          
        }
        switch (arity) {
        case 3:
          //$LASTPOS=56001993;//kernel.Matrix:1993
          res.next=(function anonymous_2002() {
            var key;
            var xy;
            
            //$LASTPOS=56002018;//kernel.Matrix:2018
            if (res.i>=res.keys.length) {
              return false;
            }
            //$LASTPOS=56002073;//kernel.Matrix:2073
            key = res.keys[res.i];
            
            //$LASTPOS=56002111;//kernel.Matrix:2111
            res.i++;
            //$LASTPOS=56002133;//kernel.Matrix:2133
            xy = _this.unkey(key);
            
            //$LASTPOS=56002165;//kernel.Matrix:2165
            res[0]=xy.x;
            //$LASTPOS=56002191;//kernel.Matrix:2191
            res[1]=xy.y;
            //$LASTPOS=56002217;//kernel.Matrix:2217
            res[2]=_this.data[key];
            return true;
          });
          break;
          
        default:
          throw new Error("Matrix: in の前には3つの変数が必要です");
          
        }
        return res;
      },
      fiber$tonyuIteratorKeys :function _trc_Matrix_f_tonyuIteratorKeys(_thread,arity) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var k;
        var v;
        var _it_475;
        
        //$LASTPOS=56001860;//kernel.Matrix:1860
        res = {i: 0,keys: []};
        
        //$LASTPOS=56001888;//kernel.Matrix:1888
        _it_475=Tonyu.iterator(_this.data,2);
        while(_it_475.next()) {
          k=_it_475[0];
          v=_it_475[1];
          
          //$LASTPOS=56001921;//kernel.Matrix:1921
          res.keys.push(k);
          
        }
        
        _thread.enter(function _trc_Matrix_ent_tonyuIteratorKeys(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              switch (arity) {
              case 3:
                __pc=1     ;break;
              default:
                __pc=2     ;break;
                
              }
              break;
            case 1     :
              //$LASTPOS=56001993;//kernel.Matrix:1993
              res.next=(function anonymous_2002() {
                var key;
                var xy;
                
                //$LASTPOS=56002018;//kernel.Matrix:2018
                if (res.i>=res.keys.length) {
                  return false;
                }
                //$LASTPOS=56002073;//kernel.Matrix:2073
                key = res.keys[res.i];
                
                //$LASTPOS=56002111;//kernel.Matrix:2111
                res.i++;
                //$LASTPOS=56002133;//kernel.Matrix:2133
                xy = _this.unkey(key);
                
                //$LASTPOS=56002165;//kernel.Matrix:2165
                res[0]=xy.x;
                //$LASTPOS=56002191;//kernel.Matrix:2191
                res[1]=xy.y;
                //$LASTPOS=56002217;//kernel.Matrix:2217
                res[2]=_this.data[key];
                return true;
              });
              __pc=3     ; break;
              
            case 2     :
              throw new Error("Matrix: in の前には3つの変数が必要です");
              
              case 3     :
              
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      tonyuIterator :function _trc_Matrix_tonyuIterator(arity) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=56002419;//kernel.Matrix:2419
        if (_this.iterateMode==="keys") {
          return _this.tonyuIteratorKeys(arity);
        }
        return _this.tonyuIteratorRect(arity);
      },
      fiber$tonyuIterator :function _trc_Matrix_f_tonyuIterator(_thread,arity) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Matrix_ent_tonyuIterator(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56002419;//kernel.Matrix:2419
              if (!(_this.iterateMode==="keys")) { __pc=2     ; break; }
              _this.fiber$tonyuIteratorKeys(_thread, arity);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
            case 2     :
              
              _this.fiber$tonyuIteratorRect(_thread, arity);
              __pc=3;return;
            case 3:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      tonyuIteratorRect :function _trc_Matrix_tonyuIteratorRect(arity) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=56002553;//kernel.Matrix:2553
        res = {x: _this.xmin,y: _this.ymin,cnt: 0};
        
        //$LASTPOS=56002589;//kernel.Matrix:2589
        if (_this.xmin==null||_this.ymin==null||_this.xmax==null||_this.ymax==null) {
          //$LASTPOS=56002652;//kernel.Matrix:2652
          res.next=(function anonymous_2661() {
            
            return false;
          });
          return res;
          
        }
        switch (arity) {
        case 3:
          //$LASTPOS=56002754;//kernel.Matrix:2754
          res.next=(function anonymous_2763() {
            
            //$LASTPOS=56002890;//kernel.Matrix:2890
            if (res.x>_this.xmax) {
              //$LASTPOS=56002925;//kernel.Matrix:2925
              res.x=_this.xmin;
              //$LASTPOS=56002954;//kernel.Matrix:2954
              res.y++;
              
            }
            //$LASTPOS=56002991;//kernel.Matrix:2991
            if (res.y<=_this.ymax) {
              //$LASTPOS=56003023;//kernel.Matrix:3023
              res[0]=res.x;
              //$LASTPOS=56003050;//kernel.Matrix:3050
              res[1]=res.y;
              //$LASTPOS=56003077;//kernel.Matrix:3077
              res[2]=_this.get(res.x,res.y);
              //$LASTPOS=56003115;//kernel.Matrix:3115
              res.x++;
              return true;
              
            }
            return false;
          });
          break;
          
        default:
          throw new Error("Matrix: in の前には3つの変数が必要です");
          
        }
        return res;
      },
      fiber$tonyuIteratorRect :function _trc_Matrix_f_tonyuIteratorRect(_thread,arity) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        
        //$LASTPOS=56002553;//kernel.Matrix:2553
        res = {x: _this.xmin,y: _this.ymin,cnt: 0};
        
        //$LASTPOS=56002589;//kernel.Matrix:2589
        if (_this.xmin==null||_this.ymin==null||_this.xmax==null||_this.ymax==null) {
          //$LASTPOS=56002652;//kernel.Matrix:2652
          res.next=(function anonymous_2661() {
            
            return false;
          });
          _thread.retVal=res;return;
          
          
        }
        
        _thread.enter(function _trc_Matrix_ent_tonyuIteratorRect(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              switch (arity) {
              case 3:
                __pc=1     ;break;
              default:
                __pc=2     ;break;
                
              }
              break;
            case 1     :
              //$LASTPOS=56002754;//kernel.Matrix:2754
              res.next=(function anonymous_2763() {
                
                //$LASTPOS=56002890;//kernel.Matrix:2890
                if (res.x>_this.xmax) {
                  //$LASTPOS=56002925;//kernel.Matrix:2925
                  res.x=_this.xmin;
                  //$LASTPOS=56002954;//kernel.Matrix:2954
                  res.y++;
                  
                }
                //$LASTPOS=56002991;//kernel.Matrix:2991
                if (res.y<=_this.ymax) {
                  //$LASTPOS=56003023;//kernel.Matrix:3023
                  res[0]=res.x;
                  //$LASTPOS=56003050;//kernel.Matrix:3050
                  res[1]=res.y;
                  //$LASTPOS=56003077;//kernel.Matrix:3077
                  res[2]=_this.get(res.x,res.y);
                  //$LASTPOS=56003115;//kernel.Matrix:3115
                  res.x++;
                  return true;
                  
                }
                return false;
              });
              __pc=3     ; break;
              
            case 2     :
              throw new Error("Matrix: in の前には3つの変数が必要です");
              
              case 3     :
              
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      unkey :function _trc_Matrix_unkey(key) {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=56003340;//kernel.Matrix:3340
        r = key.split(",");
        
        return {x: r[0]-0,y: r[1]-0};
      },
      fiber$unkey :function _trc_Matrix_f_unkey(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        //$LASTPOS=56003340;//kernel.Matrix:3340
        r = key.split(",");
        
        _thread.retVal={x: r[0]-0,y: r[1]-0};return;
        
        
        _thread.retVal=_this;return;
      },
      key :function _trc_Matrix_key(x,y,updateRange) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=56003428;//kernel.Matrix:3428
        x=_this.floor(x)||0;
        //$LASTPOS=56003448;//kernel.Matrix:3448
        y=_this.floor(y)||0;
        //$LASTPOS=56003468;//kernel.Matrix:3468
        if (updateRange) {
          //$LASTPOS=56003496;//kernel.Matrix:3496
          if (_this.xmin==null||x<_this.xmin) {
            //$LASTPOS=56003522;//kernel.Matrix:3522
            _this.xmin=x;
          }
          //$LASTPOS=56003539;//kernel.Matrix:3539
          if (_this.xmax==null||x>_this.xmax) {
            //$LASTPOS=56003565;//kernel.Matrix:3565
            _this.xmax=x;
          }
          //$LASTPOS=56003582;//kernel.Matrix:3582
          if (_this.ymin==null||y<_this.ymin) {
            //$LASTPOS=56003608;//kernel.Matrix:3608
            _this.ymin=y;
          }
          //$LASTPOS=56003625;//kernel.Matrix:3625
          if (_this.ymax==null||y>_this.ymax) {
            //$LASTPOS=56003651;//kernel.Matrix:3651
            _this.ymax=y;
          }
          
        }
        return x+","+y;
      },
      fiber$key :function _trc_Matrix_f_key(_thread,x,y,updateRange) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=56003428;//kernel.Matrix:3428
        x=_this.floor(x)||0;
        //$LASTPOS=56003448;//kernel.Matrix:3448
        y=_this.floor(y)||0;
        //$LASTPOS=56003468;//kernel.Matrix:3468
        if (updateRange) {
          //$LASTPOS=56003496;//kernel.Matrix:3496
          if (_this.xmin==null||x<_this.xmin) {
            //$LASTPOS=56003522;//kernel.Matrix:3522
            _this.xmin=x;
          }
          //$LASTPOS=56003539;//kernel.Matrix:3539
          if (_this.xmax==null||x>_this.xmax) {
            //$LASTPOS=56003565;//kernel.Matrix:3565
            _this.xmax=x;
          }
          //$LASTPOS=56003582;//kernel.Matrix:3582
          if (_this.ymin==null||y<_this.ymin) {
            //$LASTPOS=56003608;//kernel.Matrix:3608
            _this.ymin=y;
          }
          //$LASTPOS=56003625;//kernel.Matrix:3625
          if (_this.ymax==null||y>_this.ymax) {
            //$LASTPOS=56003651;//kernel.Matrix:3651
            _this.ymax=y;
          }
          
        }
        _thread.retVal=x+","+y;return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__rows :function _trc_Matrix___getter__rows() {
        "use strict";
        var _this=this;
        
        return _this.xmax-_this.xmin+1;
      },
      __getter__cols :function _trc_Matrix___getter__cols() {
        "use strict";
        var _this=this;
        
        return _this.ymax-_this.ymin+1;
      },
      get :function _trc_Matrix_get(x,y) {
        "use strict";
        var _this=this;
        var res;
        var e;
        
        //$LASTPOS=56003782;//kernel.Matrix:3782
        res = _this.data[_this.key(x,y)];
        
        //$LASTPOS=56003811;//kernel.Matrix:3811
        if (res===undefined) {
          //$LASTPOS=56003843;//kernel.Matrix:3843
          e = {set: (function anonymous_3869(v) {
            
            //$LASTPOS=56003892;//kernel.Matrix:3892
            e.value=v;
            //$LASTPOS=56003920;//kernel.Matrix:3920
            _this.set(x,y,v);
          }),x: x,y: y};
          
          //$LASTPOS=56003973;//kernel.Matrix:3973
          _this.sendEvent("newCell",e);
          return e.value;
          
        }
        return res;
      },
      fiber$get :function _trc_Matrix_f_get(_thread,x,y) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var e;
        
        //$LASTPOS=56003782;//kernel.Matrix:3782
        res = _this.data[_this.key(x,y)];
        
        
        _thread.enter(function _trc_Matrix_ent_get(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56003811;//kernel.Matrix:3811
              if (!(res===undefined)) { __pc=1     ; break; }
              //$LASTPOS=56003843;//kernel.Matrix:3843
              e = {set: (function anonymous_3869(v) {
                
                //$LASTPOS=56003892;//kernel.Matrix:3892
                e.value=v;
                //$LASTPOS=56003920;//kernel.Matrix:3920
                _this.set(x,y,v);
              }),x: x,y: y};
              
              //$LASTPOS=56003973;//kernel.Matrix:3973
              _this.sendEvent("newCell",e);
              _thread.exit(e.value);return;
            case 1     :
              
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      exists :function _trc_Matrix_exists(x,y) {
        "use strict";
        var _this=this;
        
        return _this.data[_this.key(x,y)]!==undefined;
      },
      fiber$exists :function _trc_Matrix_f_exists(_thread,x,y) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.data[_this.key(x,y)]!==undefined;return;
        
        
        _thread.retVal=_this;return;
      },
      set :function _trc_Matrix_set(x,y,v) {
        "use strict";
        var _this=this;
        var k;
        
        
        //$LASTPOS=56004140;//kernel.Matrix:4140
        if (v===undefined) {
          //$LASTPOS=56004170;//kernel.Matrix:4170
          k=_this.key(x,y);
          //$LASTPOS=56004191;//kernel.Matrix:4191
          if (! _this.data[k]) {
            return v;
          }
          //$LASTPOS=56004224;//kernel.Matrix:4224
          _this.fireEvent("set",{x: x,y: y,value: v});
          //$LASTPOS=56004289;//kernel.Matrix:4289
          delete _this.data[k];
          
        } else {
          //$LASTPOS=56004328;//kernel.Matrix:4328
          k=_this.key(x,y,true);
          //$LASTPOS=56004354;//kernel.Matrix:4354
          if (_this.data[k]===v) {
            return v;
          }
          //$LASTPOS=56004390;//kernel.Matrix:4390
          _this.fireEvent("set",{x: x,y: y,value: v});
          return _this.data[k]=v;
          
        }
      },
      fiber$set :function _trc_Matrix_f_set(_thread,x,y,v) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var k;
        
        
        
        _thread.enter(function _trc_Matrix_ent_set(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56004140;//kernel.Matrix:4140
              if (!(v===undefined)) { __pc=3     ; break; }
              //$LASTPOS=56004170;//kernel.Matrix:4170
              _this.fiber$key(_thread, x, y);
              __pc=1;return;
            case 1:
              k=_thread.retVal;
              
              //$LASTPOS=56004191;//kernel.Matrix:4191
              if (!(! _this.data[k])) { __pc=2     ; break; }
              _thread.exit(v);return;
            case 2     :
              
              //$LASTPOS=56004224;//kernel.Matrix:4224
              _this.fireEvent("set",{x: x,y: y,value: v});
              //$LASTPOS=56004289;//kernel.Matrix:4289
              delete _this.data[k];
              __pc=6     ;break;
            case 3     :
              //$LASTPOS=56004328;//kernel.Matrix:4328
              _this.fiber$key(_thread, x, y, true);
              __pc=4;return;
            case 4:
              k=_thread.retVal;
              
              //$LASTPOS=56004354;//kernel.Matrix:4354
              if (!(_this.data[k]===v)) { __pc=5     ; break; }
              _thread.exit(v);return;
            case 5     :
              
              //$LASTPOS=56004390;//kernel.Matrix:4390
              _this.fireEvent("set",{x: x,y: y,value: v});
              _thread.exit(_this.data[k]=v);return;
            case 6     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      neighbors :function _trc_Matrix_neighbors(x,y,options) {
        "use strict";
        var _this=this;
        var dirs;
        var res;
        var dir;
        var _it_488;
        var i;
        var j;
        var r;
        
        //$LASTPOS=56004596;//kernel.Matrix:4596
        options=options||{dirs: _this.neighborDirs};
        //$LASTPOS=56004639;//kernel.Matrix:4639
        options.dirs=options.dirs||_this.neighborDirs||4;
        //$LASTPOS=56004688;//kernel.Matrix:4688
        dirs = [[0,- 1],[1,- 1],[1,0],[1,1],[0,1],[- 1,1],[- 1,0],[- 1,- 1]];
        
        //$LASTPOS=56004773;//kernel.Matrix:4773
        res = [];
        
        //$LASTPOS=56004790;//kernel.Matrix:4790
        _it_488=Tonyu.iterator(dirs,1);
        while(_it_488.next()) {
          dir=_it_488[0];
          
          //$LASTPOS=56004822;//kernel.Matrix:4822
          i = dir[1];
          j = dir[0];
          
          //$LASTPOS=56004854;//kernel.Matrix:4854
          if (i==0&&j==0) {
            continue;
            
          }
          //$LASTPOS=56004889;//kernel.Matrix:4889
          if (options.dirs==4) {
            //$LASTPOS=56004925;//kernel.Matrix:4925
            if (i*j!=0) {
              continue;
              
            }
            
          }
          
          //$LASTPOS=56004983;//kernel.Matrix:4983
          if (_this.exists(x+j,y+i)) {
            //$LASTPOS=56005019;//kernel.Matrix:5019
            r=_this.get(x+j,y+i);
            //$LASTPOS=56005048;//kernel.Matrix:5048
            res.push({x: x+j,y: y+i,ox: j,oy: i,value: r});
            
          } else {
            //$LASTPOS=56005105;//kernel.Matrix:5105
            if (options.includeEmpty) {
              //$LASTPOS=56005146;//kernel.Matrix:5146
              res.push({x: x+j,y: y+i,ox: j,oy: i});
              
            }
          }
          
        }
        return res;
      },
      fiber$neighbors :function _trc_Matrix_f_neighbors(_thread,x,y,options) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var dirs;
        var res;
        var dir;
        var _it_488;
        var i;
        var j;
        var r;
        
        //$LASTPOS=56004596;//kernel.Matrix:4596
        options=options||{dirs: _this.neighborDirs};
        //$LASTPOS=56004639;//kernel.Matrix:4639
        options.dirs=options.dirs||_this.neighborDirs||4;
        //$LASTPOS=56004688;//kernel.Matrix:4688
        dirs = [[0,- 1],[1,- 1],[1,0],[1,1],[0,1],[- 1,1],[- 1,0],[- 1,- 1]];
        
        //$LASTPOS=56004773;//kernel.Matrix:4773
        res = [];
        
        
        _thread.enter(function _trc_Matrix_ent_neighbors(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56004790;//kernel.Matrix:4790
              _it_488=Tonyu.iterator(dirs,1);
            case 1:
              if (!(_it_488.next())) { __pc=8     ; break; }
              dir=_it_488[0];
              
              //$LASTPOS=56004822;//kernel.Matrix:4822
              i = dir[1];
              j = dir[0];
              
              //$LASTPOS=56004854;//kernel.Matrix:4854
              if (!(i==0&&j==0)) { __pc=2     ; break; }
              __pc=1; break;
              
            case 2     :
              
              //$LASTPOS=56004889;//kernel.Matrix:4889
              if (!(options.dirs==4)) { __pc=4     ; break; }
              //$LASTPOS=56004925;//kernel.Matrix:4925
              if (!(i*j!=0)) { __pc=3     ; break; }
              __pc=1; break;
              
            case 3     :
              
            case 4     :
              
              
              //$LASTPOS=56004983;//kernel.Matrix:4983
              if (!(_this.exists(x+j,y+i))) { __pc=6     ; break; }
              //$LASTPOS=56005019;//kernel.Matrix:5019
              _this.fiber$get(_thread, x+j, y+i);
              __pc=5;return;
            case 5:
              r=_thread.retVal;
              
              //$LASTPOS=56005048;//kernel.Matrix:5048
              res.push({x: x+j,y: y+i,ox: j,oy: i,value: r});
              __pc=7     ;break;
            case 6     :
              //$LASTPOS=56005105;//kernel.Matrix:5105
              if (options.includeEmpty) {
                //$LASTPOS=56005146;//kernel.Matrix:5146
                res.push({x: x+j,y: y+i,ox: j,oy: i});
                
              }
            case 7     :
              
              __pc=1;break;
            case 8     :
              
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      fill :function _trc_Matrix_fill(left,top,cols,rows,data) {
        "use strict";
        var _this=this;
        var i;
        var j;
        var d;
        
        //$LASTPOS=56005256;//kernel.Matrix:5256
        data=data||{};
        //$LASTPOS=56005276;//kernel.Matrix:5276
        //$LASTPOS=56005281;//kernel.Matrix:5281
        i = top;
        for (; i<top+rows ; i++) {
          {
            //$LASTPOS=56005318;//kernel.Matrix:5318
            //$LASTPOS=56005323;//kernel.Matrix:5323
            j = left;
            for (; j<left+cols ; j++) {
              {
                //$LASTPOS=56005366;//kernel.Matrix:5366
                d = data;
                
                //$LASTPOS=56005391;//kernel.Matrix:5391
                if (typeof  data==="object") {
                  //$LASTPOS=56005438;//kernel.Matrix:5438
                  d=Object.create(data);
                  
                } else {
                  //$LASTPOS=56005481;//kernel.Matrix:5481
                  if (typeof  data==="function") {
                    //$LASTPOS=56005530;//kernel.Matrix:5530
                    d=data(j,i);
                    
                  }
                }
                //$LASTPOS=56005571;//kernel.Matrix:5571
                _this.set(j,i,d);
              }
            }
          }
        }
      },
      fiber$fill :function _trc_Matrix_f_fill(_thread,left,top,cols,rows,data) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        var j;
        var d;
        
        //$LASTPOS=56005256;//kernel.Matrix:5256
        data=data||{};
        
        _thread.enter(function _trc_Matrix_ent_fill(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=56005276;//kernel.Matrix:5276
              //$LASTPOS=56005281;//kernel.Matrix:5281
              i = top;
              
            case 1:
              if (!(i<top+rows)) { __pc=7     ; break; }
              //$LASTPOS=56005318;//kernel.Matrix:5318
              //$LASTPOS=56005323;//kernel.Matrix:5323
              j = left;
              
            case 2:
              if (!(j<left+cols)) { __pc=5     ; break; }
              //$LASTPOS=56005366;//kernel.Matrix:5366
              d = data;
              
              //$LASTPOS=56005391;//kernel.Matrix:5391
              if (typeof  data==="object") {
                //$LASTPOS=56005438;//kernel.Matrix:5438
                d=Object.create(data);
                
              } else {
                //$LASTPOS=56005481;//kernel.Matrix:5481
                if (typeof  data==="function") {
                  //$LASTPOS=56005530;//kernel.Matrix:5530
                  d=data(j,i);
                  
                }
              }
              //$LASTPOS=56005571;//kernel.Matrix:5571
              _this.fiber$set(_thread, j, i, d);
              __pc=3;return;
            case 3:
              
            case 4     :
              j++;
              __pc=2;break;
            case 5     :
              
            case 6     :
              i++;
              __pc=1;break;
            case 7     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"load":{"nowait":false},"cross":{"nowait":false},"search":{"nowait":false},"find":{"nowait":false},"crop":{"nowait":false},"rev":{"nowait":false},"keysIterator":{"nowait":false},"rectIterator":{"nowait":false},"tonyuIteratorKeys":{"nowait":false},"tonyuIterator":{"nowait":false},"tonyuIteratorRect":{"nowait":false},"unkey":{"nowait":false},"key":{"nowait":false},"__getter__rows":{"nowait":true},"__getter__cols":{"nowait":true},"get":{"nowait":false},"exists":{"nowait":false},"set":{"nowait":false},"neighbors":{"nowait":false},"fill":{"nowait":false}},"fields":{"data":{},"row":{},"cell":{},"xmax":{},"ymax":{},"iterateMode":{},"xmin":{},"ymin":{},"neighborDirs":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.QueryMod',
  shortName: 'QueryMod',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.SchedulerMod,Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.EventHandlerCaller,Tonyu.classes.kernel.MathMod,Tonyu.classes.kernel.LifeCycleMod,Tonyu.classes.kernel.SpriteMod],
  methods: function (__superClass) {
    return {
      main :function _trc_QueryMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=57000098;//kernel.QueryMod:98
        "field strict";
        
      },
      fiber$main :function _trc_QueryMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=57000098;//kernel.QueryMod:98
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      hitTo :function _trc_QueryMod_hitTo(t) {
        "use strict";
        var _this=this;
        
        return _this.crashTo(t);
      },
      all :function _trc_QueryMod_all(c) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=57000369;//kernel.QueryMod:369
        res = new Tonyu.classes.kernel.TQuery(_this);
        
        //$LASTPOS=57000400;//kernel.QueryMod:400
        if (arguments.length>0&&typeof  c!="function") {
          return res;
          
        }
        //$LASTPOS=57000483;//kernel.QueryMod:483
        _this.getSpriteGroup().sprites.forEach((function anonymous_516(s) {
          
          //$LASTPOS=57000532;//kernel.QueryMod:532
          if (s===_this) {
            return _this;
          }
          //$LASTPOS=57000563;//kernel.QueryMod:563
          if (! c||s instanceof c) {
            //$LASTPOS=57000604;//kernel.QueryMod:604
            res.push(s);
            
          }
        }));
        return res;
      },
      allCrash :function _trc_QueryMod_allCrash(t) {
        "use strict";
        var _this=this;
        var res;
        var sp;
        var t1;
        
        //$LASTPOS=57000689;//kernel.QueryMod:689
        res = new Tonyu.classes.kernel.TQuery(_this);
        
        //$LASTPOS=57000720;//kernel.QueryMod:720
        sp = _this;
        
        //$LASTPOS=57000738;//kernel.QueryMod:738
        t1 = _this.getCrashShape();
        
        //$LASTPOS=57000767;//kernel.QueryMod:767
        if (! t1) {
          return res;
        }
        //$LASTPOS=57000793;//kernel.QueryMod:793
        _this.getSpriteGroup().sprites.forEach((function anonymous_826(s) {
          var t2;
          
          
          //$LASTPOS=57000859;//kernel.QueryMod:859
          if (s!==_this&&! s.excludeFromAll&&s instanceof t&&(t2=s.getCrashShape())&&t1.intersects(t2)) {
            //$LASTPOS=57001001;//kernel.QueryMod:1001
            res.push(s);
            
          }
        }));
        return res;
      },
      getCrashShape :function _trc_QueryMod_getCrashShape() {
        "use strict";
        var _this=this;
        
        throw new Error("getCrashShape::abstract");
        
      },
      fiber$getCrashShape :function _trc_QueryMod_f_getCrashShape(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        throw new Error("getCrashShape::abstract");
        
        
        _thread.retVal=_this;return;
      },
      crashTo :function _trc_QueryMod_crashTo(t) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=57001157;//kernel.QueryMod:1157
        if (! t) {
          return false;
        }
        //$LASTPOS=57001184;//kernel.QueryMod:1184
        if (typeof  t=="function") {
          return _this.allCrash(t)[0];
          
        }
        return _this.crashTo1(t);
      },
      crashTo1 :function _trc_QueryMod_crashTo1(t) {
        "use strict";
        var _this=this;
        var t1;
        var t2;
        
        //$LASTPOS=57001312;//kernel.QueryMod:1312
        if (! t||t._isDead) {
          return false;
        }
        //$LASTPOS=57001352;//kernel.QueryMod:1352
        t1 = _this.getCrashShape();
        
        //$LASTPOS=57001381;//kernel.QueryMod:1381
        t2 = t.getCrashShape();
        
        return t1&&t1.intersects(t2);
      },
      crashToChecker :function _trc_QueryMod_crashToChecker(d,f) {
        "use strict";
        var _this=this;
        var obj;
        var _it_508;
        
        //$LASTPOS=57001480;//kernel.QueryMod:1480
        while (true) {
          //$LASTPOS=57001502;//kernel.QueryMod:1502
          if (typeof  d=="function") {
            //$LASTPOS=57001541;//kernel.QueryMod:1541
            _it_508=Tonyu.iterator(_this.allCrash(d),1);
            while(_it_508.next()) {
              obj=_it_508[0];
              
              //$LASTPOS=57001587;//kernel.QueryMod:1587
              _this.callEventHandler(f,[obj]);
              
            }
            
          } else {
            //$LASTPOS=57001644;//kernel.QueryMod:1644
            if (_this.crashTo(d)) {
              //$LASTPOS=57001673;//kernel.QueryMod:1673
              _this.callEventHandler(f,[d]);
              
            }
          }
          //$LASTPOS=57001718;//kernel.QueryMod:1718
          _this.update();
          
        }
      },
      fiber$crashToChecker :function _trc_QueryMod_f_crashToChecker(_thread,d,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var obj;
        var _it_508;
        
        
        _thread.enter(function _trc_QueryMod_ent_crashToChecker(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=57001480;//kernel.QueryMod:1480
            case 1:
              //$LASTPOS=57001502;//kernel.QueryMod:1502
              if (!(typeof  d=="function")) { __pc=5     ; break; }
              //$LASTPOS=57001541;//kernel.QueryMod:1541
              _it_508=Tonyu.iterator(_this.allCrash(d),1);
            case 2:
              if (!(_it_508.next())) { __pc=4     ; break; }
              obj=_it_508[0];
              
              //$LASTPOS=57001587;//kernel.QueryMod:1587
              _this.fiber$callEventHandler(_thread, f, [obj]);
              __pc=3;return;
            case 3:
              
              __pc=2;break;
            case 4     :
              
              __pc=8     ;break;
            case 5     :
              //$LASTPOS=57001644;//kernel.QueryMod:1644
              if (!(_this.crashTo(d))) { __pc=7     ; break; }
              //$LASTPOS=57001673;//kernel.QueryMod:1673
              _this.fiber$callEventHandler(_thread, f, [d]);
              __pc=6;return;
            case 6:
              
            case 7     :
              
            case 8     :
              
              //$LASTPOS=57001718;//kernel.QueryMod:1718
              _this.fiber$update(_thread);
              __pc=9;return;
            case 9:
              
              __pc=1;break;
            case 10    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      allWithin :function _trc_QueryMod_allWithin(t,distance) {
        "use strict";
        var _this=this;
        var res;
        var sp;
        
        //$LASTPOS=57001802;//kernel.QueryMod:1802
        res = new Tonyu.classes.kernel.TQuery(_this);
        
        //$LASTPOS=57001833;//kernel.QueryMod:1833
        sp = _this;
        
        //$LASTPOS=57001851;//kernel.QueryMod:1851
        if (typeof  t!=="function") {
          throw new Error("allWithinの第一引数はクラスにしてください");
          
        }
        //$LASTPOS=57001930;//kernel.QueryMod:1930
        _this.getSpriteGroup().sprites.forEach((function anonymous_1963(s) {
          
          //$LASTPOS=57001979;//kernel.QueryMod:1979
          if (s!==_this&&! s.excludeFromAll&&s instanceof t&&_this.dist(s)<distance) {
            //$LASTPOS=57002094;//kernel.QueryMod:2094
            res.push(s);
            
          }
        }));
        return res;
      },
      within :function _trc_QueryMod_within(t,distance) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=57002186;//kernel.QueryMod:2186
        if (! t) {
          return false;
        }
        //$LASTPOS=57002212;//kernel.QueryMod:2212
        if (typeof  t=="function") {
          return _this.allWithin(t,distance)[0];
          
        }
        return _this.within1(t,distance);
      },
      within1 :function _trc_QueryMod_within1(t,distance) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=57002382;//kernel.QueryMod:2382
        if (! t||t._isDead) {
          return false;
        }
        //$LASTPOS=57002421;//kernel.QueryMod:2421
        if (Math.sqrt(Math.abs(_this.x-t.x)*Math.abs(_this.x-t.x)+Math.abs(_this.y-t.y)*Math.abs(_this.y-t.y))<distance) {
          return t;
          
        }
        return false;
      },
      withinChecker :function _trc_QueryMod_withinChecker(d,r,f) {
        "use strict";
        var _this=this;
        var obj;
        var _it_514;
        
        //$LASTPOS=57002593;//kernel.QueryMod:2593
        while (true) {
          //$LASTPOS=57002615;//kernel.QueryMod:2615
          if (typeof  d=="function") {
            //$LASTPOS=57002654;//kernel.QueryMod:2654
            _it_514=Tonyu.iterator(_this.allWithin(d,r),1);
            while(_it_514.next()) {
              obj=_it_514[0];
              
              //$LASTPOS=57002703;//kernel.QueryMod:2703
              f(obj);
              
            }
            
          } else {
            //$LASTPOS=57002741;//kernel.QueryMod:2741
            if (_this.within(d,r)) {
              //$LASTPOS=57002771;//kernel.QueryMod:2771
              f(d);
              
            }
          }
          //$LASTPOS=57002797;//kernel.QueryMod:2797
          _this.update();
          
        }
      },
      fiber$withinChecker :function _trc_QueryMod_f_withinChecker(_thread,d,r,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var obj;
        var _it_514;
        
        
        _thread.enter(function _trc_QueryMod_ent_withinChecker(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=57002593;//kernel.QueryMod:2593
            case 1:
              //$LASTPOS=57002615;//kernel.QueryMod:2615
              if (typeof  d=="function") {
                //$LASTPOS=57002654;//kernel.QueryMod:2654
                _it_514=Tonyu.iterator(_this.allWithin(d,r),1);
                while(_it_514.next()) {
                  obj=_it_514[0];
                  
                  //$LASTPOS=57002703;//kernel.QueryMod:2703
                  f(obj);
                  
                }
                
              } else {
                //$LASTPOS=57002741;//kernel.QueryMod:2741
                if (_this.within(d,r)) {
                  //$LASTPOS=57002771;//kernel.QueryMod:2771
                  f(d);
                  
                }
              }
              //$LASTPOS=57002797;//kernel.QueryMod:2797
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      watchHit :function _trc_QueryMod_watchHit(typeA,typeB,onHit) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=57002866;//kernel.QueryMod:2866
        _this.getSpriteGroup().watchHit(typeA,typeB,(function anonymous_2907(a,b) {
          
          //$LASTPOS=57002925;//kernel.QueryMod:2925
          onHit.apply(_this,[a,b]);
        }));
      },
      screenOutChecker :function _trc_QueryMod_screenOutChecker(d,f) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=57002999;//kernel.QueryMod:2999
        while (true) {
          //$LASTPOS=57003021;//kernel.QueryMod:3021
          while (true) {
            //$LASTPOS=57003047;//kernel.QueryMod:3047
            if (_this.screenOut()>d) {
              //$LASTPOS=57003083;//kernel.QueryMod:3083
              f();
              break;
              
              
            }
            //$LASTPOS=57003140;//kernel.QueryMod:3140
            _this.update();
            
          }
          //$LASTPOS=57003170;//kernel.QueryMod:3170
          while (true) {
            //$LASTPOS=57003196;//kernel.QueryMod:3196
            if (_this.screenOut()<=d) {
              break;
              
              
            }
            //$LASTPOS=57003268;//kernel.QueryMod:3268
            _this.update();
            
          }
          //$LASTPOS=57003298;//kernel.QueryMod:3298
          _this.update();
          
        }
      },
      fiber$screenOutChecker :function _trc_QueryMod_f_screenOutChecker(_thread,d,f) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_QueryMod_ent_screenOutChecker(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=57002999;//kernel.QueryMod:2999
            case 1:
              //$LASTPOS=57003021;//kernel.QueryMod:3021
            case 2:
              //$LASTPOS=57003047;//kernel.QueryMod:3047
              if (!(_this.screenOut()>d)) { __pc=3     ; break; }
              //$LASTPOS=57003083;//kernel.QueryMod:3083
              f();
              __pc=5     ; break;
              
            case 3     :
              
              //$LASTPOS=57003140;//kernel.QueryMod:3140
              _this.fiber$update(_thread);
              __pc=4;return;
            case 4:
              
              __pc=2;break;
            case 5     :
              
              //$LASTPOS=57003170;//kernel.QueryMod:3170
            case 6:
              //$LASTPOS=57003196;//kernel.QueryMod:3196
              if (!(_this.screenOut()<=d)) { __pc=7     ; break; }
              __pc=9     ; break;
              
            case 7     :
              
              //$LASTPOS=57003268;//kernel.QueryMod:3268
              _this.fiber$update(_thread);
              __pc=8;return;
            case 8:
              
              __pc=6;break;
            case 9     :
              
              //$LASTPOS=57003298;//kernel.QueryMod:3298
              _this.fiber$update(_thread);
              __pc=10;return;
            case 10:
              
              __pc=1;break;
            case 11    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      screenOut :function _trc_QueryMod_screenOut() {
        "use strict";
        var _this=this;
        
        throw new Error("screenOut::abstract");
        
      },
      fiber$screenOut :function _trc_QueryMod_f_screenOut(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        throw new Error("screenOut::abstract");
        
        
        _thread.retVal=_this;return;
      },
      findEventHandlerClass :function _trc_QueryMod_findEventHandlerClass(type) {
        "use strict";
        var _this=this;
        var eventTypes;
        
        //$LASTPOS=57003425;//kernel.QueryMod:3425
        eventTypes = {"screenOut": Tonyu.classes.kernel.ScreenOutHandler,"crashTo": Tonyu.classes.kernel.CrashToHandler,"within": Tonyu.classes.kernel.WithinHandler};
        
        //$LASTPOS=57003561;//kernel.QueryMod:3561
        if (eventTypes[type]) {
          return eventTypes[type];
        }
        return __superClass.prototype.findEventHandlerClass.apply( _this, [type]);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"hitTo":{"nowait":true},"all":{"nowait":true},"allCrash":{"nowait":true},"getCrashShape":{"nowait":false},"crashTo":{"nowait":true},"crashTo1":{"nowait":true},"crashToChecker":{"nowait":false},"allWithin":{"nowait":true},"within":{"nowait":true},"within1":{"nowait":true},"withinChecker":{"nowait":false},"watchHit":{"nowait":true},"screenOutChecker":{"nowait":false},"screenOut":{"nowait":false},"findEventHandlerClass":{"nowait":true}},"fields":{"crashScale":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.QueryMod2D',
  shortName: 'QueryMod2D',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.QueryMod],
  methods: function (__superClass) {
    return {
      main :function _trc_QueryMod2D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=58000049;//kernel.QueryMod2D:49
        "field strict";
      },
      fiber$main :function _trc_QueryMod2D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=58000049;//kernel.QueryMod2D:49
        "field strict";
        
        _thread.retVal=_this;return;
      },
      getCrashShape :function _trc_QueryMod2D_getCrashShape() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.RectShape(_this.getCrashRect());
      },
      fiber$getCrashShape :function _trc_QueryMod2D_f_getCrashShape(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=new Tonyu.classes.kernel.RectShape(_this.getCrashRect());return;
        
        
        _thread.retVal=_this;return;
      },
      getCrashRect :function _trc_QueryMod2D_getCrashRect() {
        "use strict";
        var _this=this;
        var actWidth;
        var actHeight;
        
        //$LASTPOS=58000213;//kernel.QueryMod2D:213
        actWidth = (_this.width||_this.radius*2)*_this.scaleX*_this.crashScale;
        
        //$LASTPOS=58000279;//kernel.QueryMod2D:279
        if (typeof  _this.scaleY==="undefined") {
          //$LASTPOS=58000321;//kernel.QueryMod2D:321
          actHeight=(_this.height||_this.radius*2)*_this.scaleX*_this.crashScale;
          
        } else {
          //$LASTPOS=58000390;//kernel.QueryMod2D:390
          actHeight=(_this.height||_this.radius*2)*_this.scaleY*_this.crashScale;
          
        }
        return typeof  _this.x=="number"&&typeof  _this.y=="number"&&typeof  actWidth=="number"&&typeof  actHeight=="number"&&{x: _this.x,y: _this.y,width: Math.abs(actWidth),height: Math.abs(actHeight)};
      },
      getTouchShape :function _trc_QueryMod2D_getTouchShape() {
        "use strict";
        var _this=this;
        
        return new Tonyu.classes.kernel.RectShape(_this.getTouchRect());
      },
      fiber$getTouchShape :function _trc_QueryMod2D_f_getTouchShape(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=new Tonyu.classes.kernel.RectShape(_this.getTouchRect());return;
        
        
        _thread.retVal=_this;return;
      },
      getTouchRect :function _trc_QueryMod2D_getTouchRect() {
        "use strict";
        var _this=this;
        
        return _this.getCrashRect();
      },
      fiber$getTouchRect :function _trc_QueryMod2D_f_getTouchRect(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.getCrashRect();return;
        
        
        _thread.retVal=_this;return;
      },
      screenOut :function _trc_QueryMod2D_screenOut(a) {
        "use strict";
        var _this=this;
        var cp;
        
        //$LASTPOS=58000783;//kernel.QueryMod2D:783
        if (! a) {
          //$LASTPOS=58000791;//kernel.QueryMod2D:791
          a=0;
        }
        //$LASTPOS=58000801;//kernel.QueryMod2D:801
        cp = Tonyu.globals.$Screen.convert(_this,Tonyu.globals.$Screen);
        
        return _this.abs(_this.clamped(cp.x,- a,Tonyu.globals.$screenWidth+a))+_this.abs(_this.clamped(cp.y,- a,Tonyu.globals.$screenHeight+a));
      },
      fiber$screenOut :function _trc_QueryMod2D_f_screenOut(_thread,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var cp;
        
        //$LASTPOS=58000783;//kernel.QueryMod2D:783
        if (! a) {
          //$LASTPOS=58000791;//kernel.QueryMod2D:791
          a=0;
        }
        //$LASTPOS=58000801;//kernel.QueryMod2D:801
        cp = Tonyu.globals.$Screen.convert(_this,Tonyu.globals.$Screen);
        
        _thread.retVal=_this.abs(_this.clamped(cp.x,- a,Tonyu.globals.$screenWidth+a))+_this.abs(_this.clamped(cp.y,- a,Tonyu.globals.$screenHeight+a));return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"getCrashShape":{"nowait":false},"getCrashRect":{"nowait":true},"getTouchShape":{"nowait":false},"getTouchRect":{"nowait":false},"screenOut":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.QueryMod3D',
  shortName: 'QueryMod3D',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.QueryMod,Tonyu.classes.kernel.SpriteMod3D],
  methods: function (__superClass) {
    return {
      main :function _trc_QueryMod3D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=59000061;//kernel.QueryMod3D:61
        "field strict";
      },
      fiber$main :function _trc_QueryMod3D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=59000061;//kernel.QueryMod3D:61
        "field strict";
        
        _thread.retVal=_this;return;
      },
      getCrashShape :function _trc_QueryMod3D_getCrashShape() {
        "use strict";
        var _this=this;
        var actWidth;
        var actHeight;
        
        //$LASTPOS=59000107;//kernel.QueryMod3D:107
        actWidth = (_this.width||_this.radius*2)*_this.scaleX*_this.crashScale;
        
        //$LASTPOS=59000173;//kernel.QueryMod3D:173
        if (typeof  _this.scaleY==="undefined") {
          //$LASTPOS=59000215;//kernel.QueryMod3D:215
          actHeight=(_this.height||_this.radius*2)*_this.scaleX*_this.crashScale;
          
        } else {
          //$LASTPOS=59000284;//kernel.QueryMod3D:284
          actHeight=(_this.height||_this.radius*2)*_this.scaleY*_this.crashScale;
          
        }
        return typeof  _this.x=="number"&&typeof  _this.y=="number"&&typeof  actWidth=="number"&&typeof  actHeight=="number"&&new Tonyu.classes.kernel.CubeShape({x: _this.x,y: _this.y,z: _this.z,width: Math.abs(actWidth),height: Math.abs(actHeight),depth: (Math.abs(actWidth)+Math.abs(actHeight))/2});
      },
      fiber$getCrashShape :function _trc_QueryMod3D_f_getCrashShape(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var actWidth;
        var actHeight;
        
        //$LASTPOS=59000107;//kernel.QueryMod3D:107
        actWidth = (_this.width||_this.radius*2)*_this.scaleX*_this.crashScale;
        
        //$LASTPOS=59000173;//kernel.QueryMod3D:173
        if (typeof  _this.scaleY==="undefined") {
          //$LASTPOS=59000215;//kernel.QueryMod3D:215
          actHeight=(_this.height||_this.radius*2)*_this.scaleX*_this.crashScale;
          
        } else {
          //$LASTPOS=59000284;//kernel.QueryMod3D:284
          actHeight=(_this.height||_this.radius*2)*_this.scaleY*_this.crashScale;
          
        }
        _thread.retVal=typeof  _this.x=="number"&&typeof  _this.y=="number"&&typeof  actWidth=="number"&&typeof  actHeight=="number"&&new Tonyu.classes.kernel.CubeShape({x: _this.x,y: _this.y,z: _this.z,width: Math.abs(actWidth),height: Math.abs(actHeight),depth: (Math.abs(actWidth)+Math.abs(actHeight))/2});return;
        
        
        _thread.retVal=_this;return;
      },
      screenOut :function _trc_QueryMod3D_screenOut(a) {
        "use strict";
        var _this=this;
        var cp;
        
        //$LASTPOS=59000662;//kernel.QueryMod3D:662
        if (! a) {
          //$LASTPOS=59000670;//kernel.QueryMod3D:670
          a=0;
        }
        return false;
        //$LASTPOS=59000706;//kernel.QueryMod3D:706
        cp = Tonyu.globals.$Screen.convert(_this,Tonyu.globals.$Screen);
        
        return _this.abs(_this.clamped(cp.x,- a,Tonyu.globals.$screenWidth+a))+_this.abs(_this.clamped(cp.y,- a,Tonyu.globals.$screenHeight+a));
      },
      fiber$screenOut :function _trc_QueryMod3D_f_screenOut(_thread,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var cp;
        
        //$LASTPOS=59000662;//kernel.QueryMod3D:662
        if (! a) {
          //$LASTPOS=59000670;//kernel.QueryMod3D:670
          a=0;
        }
        _thread.retVal=false;return;
        
        //$LASTPOS=59000706;//kernel.QueryMod3D:706
        cp = Tonyu.globals.$Screen.convert(_this,Tonyu.globals.$Screen);
        
        _thread.retVal=_this.abs(_this.clamped(cp.x,- a,Tonyu.globals.$screenWidth+a))+_this.abs(_this.clamped(cp.y,- a,Tonyu.globals.$screenHeight+a));return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"getCrashShape":{"nowait":false},"screenOut":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.Random',
  shortName: 'Random',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Random_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Random_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Random_initialize(seed) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=60000072;//kernel.Random:72
        _this.x=123456789;
        //$LASTPOS=60000092;//kernel.Random:92
        _this.y=362436069;
        //$LASTPOS=60000112;//kernel.Random:112
        _this.z=521288629;
        //$LASTPOS=60000132;//kernel.Random:132
        _this.MAX=2147483648;
        //$LASTPOS=60000153;//kernel.Random:153
        _this.MIN=- _this.MAX;
        //$LASTPOS=60000168;//kernel.Random:168
        _this.w=seed||new Date().getTime();
      },
      next :function _trc_Random_next() {
        "use strict";
        var _this=this;
        var t;
        
        //$LASTPOS=60000230;//kernel.Random:230
        t = _this.x^(_this.x<<11);
        
        //$LASTPOS=60000258;//kernel.Random:258
        _this.x=_this.y;
        //$LASTPOS=60000265;//kernel.Random:265
        _this.y=_this.z;
        //$LASTPOS=60000272;//kernel.Random:272
        _this.z=_this.w;
        return _this.w=(_this.w^(_this.w>>>19))^(t^(t>>>8));
      },
      nextInt :function _trc_Random_nextInt(min,max) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=60000370;//kernel.Random:370
        res = _this.floor(min+_this.next01()*(max-min));
        
        return res;
      },
      next01 :function _trc_Random_next01() {
        "use strict";
        var _this=this;
        
        return (_this.next()-_this.MIN)/(_this.MAX-_this.MIN);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"next":{"nowait":true},"nextInt":{"nowait":true},"next01":{"nowait":true}},"fields":{"z":{},"MAX":{},"MIN":{},"w":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.CrashToHandler',
  shortName: 'CrashToHandler',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.EventHandler,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_CrashToHandler_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_CrashToHandler_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      addListener :function _trc_CrashToHandler_addListener(d,f) {
        "use strict";
        var _this=this;
        var retThread;
        
        //$LASTPOS=61000049;//kernel.CrashToHandler:49
        retThread = _this.target.parallel("crashToChecker",d,_this.toListener(f));
        
        return {remove: (function anonymous_145() {
          
          //$LASTPOS=61000161;//kernel.CrashToHandler:161
          retThread.kill();
        })};
      },
      initialize :function _trc_CrashToHandler_initialize(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=61000221;//kernel.CrashToHandler:221
        __superClass.apply( _this, [param]);
        //$LASTPOS=61000240;//kernel.CrashToHandler:240
        _this.id=(Tonyu.globals.$idseq=(Tonyu.globals.$idseq||0)+1);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"addListener":{"nowait":true},"new":{"nowait":false}},"fields":{"id":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ComputedVec3',
  shortName: 'ComputedVec3',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Vec3,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_ComputedVec3_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ComputedVec3_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_ComputedVec3_initialize(func) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=62000052;//kernel.ComputedVec3:52
        _this.computer=func;
      },
      requestCompute :function _trc_ComputedVec3_requestCompute() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=62000096;//kernel.ComputedVec3:96
        _this.computed=null;
      },
      fiber$requestCompute :function _trc_ComputedVec3_f_requestCompute(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=62000096;//kernel.ComputedVec3:96
        _this.computed=null;
        
        _thread.retVal=_this;return;
      },
      compute :function _trc_ComputedVec3_compute() {
        "use strict";
        var _this=this;
        var c;
        
        //$LASTPOS=62000133;//kernel.ComputedVec3:133
        if (_this.computed) {
          return _this.computed;
        }
        //$LASTPOS=62000169;//kernel.ComputedVec3:169
        c = _this.computer(_this);
        
        return _this.computed||c;
      },
      fiber$compute :function _trc_ComputedVec3_f_compute(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var c;
        
        //$LASTPOS=62000133;//kernel.ComputedVec3:133
        if (_this.computed) {
          _thread.retVal=_this.computed;return;
          
        }
        //$LASTPOS=62000169;//kernel.ComputedVec3:169
        c = _this.computer(_this);
        
        _thread.retVal=_this.computed||c;return;
        
        
        _thread.retVal=_this;return;
      },
      keep :function _trc_ComputedVec3_keep(c) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=62000236;//kernel.ComputedVec3:236
        _this.computed=c;
        return c;
      },
      fiber$keep :function _trc_ComputedVec3_f_keep(_thread,c) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=62000236;//kernel.ComputedVec3:236
        _this.computed=c;
        _thread.retVal=c;return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__x :function _trc_ComputedVec3___getter__x() {
        "use strict";
        var _this=this;
        
        return _this.compute().x;
      },
      __getter__y :function _trc_ComputedVec3___getter__y() {
        "use strict";
        var _this=this;
        
        return _this.compute().y;
      },
      __getter__z :function _trc_ComputedVec3___getter__z() {
        "use strict";
        var _this=this;
        
        return _this.compute().z;
      },
      __setter__x :function _trc_ComputedVec3___setter__x(v) {
        "use strict";
        var _this=this;
        
        throw new Error("ComputedVec3: read only");
        
      },
      __setter__y :function _trc_ComputedVec3___setter__y(v) {
        "use strict";
        var _this=this;
        
        throw new Error("ComputedVec3: read only");
        
      },
      __setter__z :function _trc_ComputedVec3___setter__z(v) {
        "use strict";
        var _this=this;
        
        throw new Error("ComputedVec3: read only");
        
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"requestCompute":{"nowait":false},"compute":{"nowait":false},"keep":{"nowait":false},"__getter__x":{"nowait":true},"__getter__y":{"nowait":true},"__getter__z":{"nowait":true},"__setter__x":{"nowait":true},"__setter__y":{"nowait":true},"__setter__z":{"nowait":true}},"fields":{"computer":{},"computed":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ActorSprite',
  shortName: 'ActorSprite',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.SpriteMod2D],
  methods: function (__superClass) {
    return {
      main :function _trc_ActorSprite_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ActorSprite_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_ActorSprite_initialize(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=63000062;//kernel.ActorSprite:62
        __superClass.apply( _this, [param]);
        //$LASTPOS=63000081;//kernel.ActorSprite:81
        _this.initSpriteMod();
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.Layer2D',
  shortName: 'Layer2D',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.ScreenLayer,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Layer2D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=64000041;//kernel.Layer2D:41
        "field strict";
        
      },
      fiber$main :function _trc_Layer2D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=64000041;//kernel.Layer2D:41
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_Layer2D_draw(c) {
        "use strict";
        var _this=this;
        var rt;
        var sc;
        var wpOnSX;
        var wpOnSY;
        
        //$LASTPOS=64000120;//kernel.Layer2D:120
        c.save();
        //$LASTPOS=64000135;//kernel.Layer2D:135
        rt = _this.rotation;
        sc = _this.scale;
        
        //$LASTPOS=64000235;//kernel.Layer2D:235
        wpOnSX = (_this.cos(rt)*_this.wpx+_this.cos(rt+90)*_this.wpy)*sc;
        
        //$LASTPOS=64000284;//kernel.Layer2D:284
        wpOnSY = (_this.sin(rt)*_this.wpx+_this.sin(rt+90)*_this.wpy)*sc;
        
        //$LASTPOS=64000368;//kernel.Layer2D:368
        c.translate(- wpOnSX+_this.spx,- wpOnSY+_this.spy);
        //$LASTPOS=64000411;//kernel.Layer2D:411
        c.rotate(_this.rad(rt));
        //$LASTPOS=64000435;//kernel.Layer2D:435
        c.scale(sc,sc);
        //$LASTPOS=64000456;//kernel.Layer2D:456
        _this.group.draw(c,_this);
        //$LASTPOS=64000481;//kernel.Layer2D:481
        c.restore();
      },
      fiber$draw :function _trc_Layer2D_f_draw(_thread,c) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var rt;
        var sc;
        var wpOnSX;
        var wpOnSY;
        
        //$LASTPOS=64000120;//kernel.Layer2D:120
        c.save();
        //$LASTPOS=64000135;//kernel.Layer2D:135
        rt = _this.rotation;
        sc = _this.scale;
        
        //$LASTPOS=64000235;//kernel.Layer2D:235
        wpOnSX = (_this.cos(rt)*_this.wpx+_this.cos(rt+90)*_this.wpy)*sc;
        
        //$LASTPOS=64000284;//kernel.Layer2D:284
        wpOnSY = (_this.sin(rt)*_this.wpx+_this.sin(rt+90)*_this.wpy)*sc;
        
        //$LASTPOS=64000368;//kernel.Layer2D:368
        c.translate(- wpOnSX+_this.spx,- wpOnSY+_this.spy);
        //$LASTPOS=64000411;//kernel.Layer2D:411
        c.rotate(_this.rad(rt));
        //$LASTPOS=64000435;//kernel.Layer2D:435
        c.scale(sc,sc);
        //$LASTPOS=64000456;//kernel.Layer2D:456
        _this.group.draw(c,_this);
        //$LASTPOS=64000481;//kernel.Layer2D:481
        c.restore();
        
        _thread.retVal=_this;return;
      },
      world2screen :function _trc_Layer2D_world2screen(obj) {
        "use strict";
        var _this=this;
        var dx;
        var dy;
        var rt;
        var x;
        var y;
        
        //$LASTPOS=64000565;//kernel.Layer2D:565
        dx = obj.x-_this.wpx;
        
        //$LASTPOS=64000588;//kernel.Layer2D:588
        dy = obj.y-_this.wpy;
        
        //$LASTPOS=64000611;//kernel.Layer2D:611
        rt = _this.rotation;
        
        //$LASTPOS=64000779;//kernel.Layer2D:779
        x = _this.spx+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)*_this.scale;
        
        //$LASTPOS=64000830;//kernel.Layer2D:830
        y = _this.spy+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)*_this.scale;
        
        return {x: x,y: y,rotation: obj.rotation,scale: obj.scale,layer: _this.screen};
      },
      fiber$world2screen :function _trc_Layer2D_f_world2screen(_thread,obj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var dx;
        var dy;
        var rt;
        var x;
        var y;
        
        //$LASTPOS=64000565;//kernel.Layer2D:565
        dx = obj.x-_this.wpx;
        
        //$LASTPOS=64000588;//kernel.Layer2D:588
        dy = obj.y-_this.wpy;
        
        //$LASTPOS=64000611;//kernel.Layer2D:611
        rt = _this.rotation;
        
        //$LASTPOS=64000779;//kernel.Layer2D:779
        x = _this.spx+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)*_this.scale;
        
        //$LASTPOS=64000830;//kernel.Layer2D:830
        y = _this.spy+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)*_this.scale;
        
        _thread.retVal={x: x,y: y,rotation: obj.rotation,scale: obj.scale,layer: _this.screen};return;
        
        
        _thread.retVal=_this;return;
      },
      screen2world :function _trc_Layer2D_screen2world(obj) {
        "use strict";
        var _this=this;
        var rt;
        var dx;
        var dy;
        var x;
        var y;
        
        //$LASTPOS=64001039;//kernel.Layer2D:1039
        rt = - _this.rotation;
        
        //$LASTPOS=64001062;//kernel.Layer2D:1062
        dx = obj.x-_this.spx;
        
        //$LASTPOS=64001085;//kernel.Layer2D:1085
        dy = obj.y-_this.spy;
        
        //$LASTPOS=64001254;//kernel.Layer2D:1254
        x = _this.wpx+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)/_this.scale;
        
        //$LASTPOS=64001305;//kernel.Layer2D:1305
        y = _this.wpy+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)/_this.scale;
        
        return {x: x,y: y,rotation: rt,scale: 1/_this.scale,layer: _this.group};
      },
      fiber$screen2world :function _trc_Layer2D_f_screen2world(_thread,obj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var rt;
        var dx;
        var dy;
        var x;
        var y;
        
        //$LASTPOS=64001039;//kernel.Layer2D:1039
        rt = - _this.rotation;
        
        //$LASTPOS=64001062;//kernel.Layer2D:1062
        dx = obj.x-_this.spx;
        
        //$LASTPOS=64001085;//kernel.Layer2D:1085
        dy = obj.y-_this.spy;
        
        //$LASTPOS=64001254;//kernel.Layer2D:1254
        x = _this.wpx+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)/_this.scale;
        
        //$LASTPOS=64001305;//kernel.Layer2D:1305
        y = _this.wpy+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)/_this.scale;
        
        _thread.retVal={x: x,y: y,rotation: rt,scale: 1/_this.scale,layer: _this.group};return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"draw":{"nowait":false},"world2screen":{"nowait":false},"screen2world":{"nowait":false}},"fields":{"spx":{},"spy":{},"wpx":{},"wpy":{},"rotation":{},"scale":{},"screen":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Layer3D',
  shortName: 'Layer3D',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.ScreenLayer,
  includes: [Tonyu.classes.kernel.MathMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Layer3D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=65000058;//kernel.Layer3D:58
        "field strict";
        
      },
      fiber$main :function _trc_Layer3D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=65000058;//kernel.Layer3D:58
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Layer3D_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=65000120;//kernel.Layer3D:120
        __superClass.apply( _this, [p]);
        //$LASTPOS=65000135;//kernel.Layer3D:135
        _this.spx=_this.spx||Tonyu.globals.$screenWidth/2;
        //$LASTPOS=65000165;//kernel.Layer3D:165
        _this.spy=_this.spy||Tonyu.globals.$screenHeight/2;
      },
      draw :function _trc_Layer3D_draw(c2) {
        "use strict";
        var _this=this;
        var c3;
        var s2ds;
        var s2d;
        var _it_544;
        
        //$LASTPOS=65000212;//kernel.Layer3D:212
        c3 = new Tonyu.classes.kernel.Context3D({camera: _this.camera});
        
        //$LASTPOS=65000247;//kernel.Layer3D:247
        _this.group.draw3D(c3);
        //$LASTPOS=65000270;//kernel.Layer3D:270
        s2ds = c3.sprites2D.sort((function anonymous_297(a,b) {
          
          return b.zOrder-a.zOrder;
        }));
        
        //$LASTPOS=65000354;//kernel.Layer3D:354
        c2.save();
        //$LASTPOS=65000370;//kernel.Layer3D:370
        c2.translate(_this.spx,_this.spy);
        //$LASTPOS=65000477;//kernel.Layer3D:477
        _it_544=Tonyu.iterator(c3.sprites2D,1);
        while(_it_544.next()) {
          s2d=_it_544[0];
          
          //$LASTPOS=65000518;//kernel.Layer3D:518
          s2d.draw(c2);
          
        }
        //$LASTPOS=65000544;//kernel.Layer3D:544
        c2.restore();
      },
      fiber$draw :function _trc_Layer3D_f_draw(_thread,c2) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var c3;
        var s2ds;
        var s2d;
        var _it_544;
        
        //$LASTPOS=65000212;//kernel.Layer3D:212
        c3 = new Tonyu.classes.kernel.Context3D({camera: _this.camera});
        
        //$LASTPOS=65000247;//kernel.Layer3D:247
        _this.group.draw3D(c3);
        //$LASTPOS=65000270;//kernel.Layer3D:270
        s2ds = c3.sprites2D.sort((function anonymous_297(a,b) {
          
          return b.zOrder-a.zOrder;
        }));
        
        //$LASTPOS=65000354;//kernel.Layer3D:354
        c2.save();
        //$LASTPOS=65000370;//kernel.Layer3D:370
        c2.translate(_this.spx,_this.spy);
        //$LASTPOS=65000477;//kernel.Layer3D:477
        _it_544=Tonyu.iterator(c3.sprites2D,1);
        while(_it_544.next()) {
          s2d=_it_544[0];
          
          //$LASTPOS=65000518;//kernel.Layer3D:518
          s2d.draw(c2);
          
        }
        //$LASTPOS=65000544;//kernel.Layer3D:544
        c2.restore();
        
        _thread.retVal=_this;return;
      },
      world2screen :function _trc_Layer3D_world2screen(obj) {
        "use strict";
        var _this=this;
        
        throw new Error("cannot call world2screen for Layer3D");
        
      },
      fiber$world2screen :function _trc_Layer3D_f_world2screen(_thread,obj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        throw new Error("cannot call world2screen for Layer3D");
        
        
        _thread.retVal=_this;return;
      },
      screen2world :function _trc_Layer3D_screen2world(obj) {
        "use strict";
        var _this=this;
        
        throw new Error("cannot call screen2world for Layer3D");
        
      },
      fiber$screen2world :function _trc_Layer3D_f_screen2world(_thread,obj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        throw new Error("cannot call screen2world for Layer3D");
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"draw":{"nowait":false},"world2screen":{"nowait":false},"screen2world":{"nowait":false}},"fields":{"spx":{},"spy":{},"camera":{},"screen":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.PanelMod',
  shortName: 'PanelMod',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.TObject,
  includes: [Tonyu.classes.kernel.FileMod,Tonyu.classes.kernel.MathMod,Tonyu.classes.kernel.SpriteMod2D,Tonyu.classes.kernel.EventMod],
  methods: function (__superClass) {
    return {
      main :function _trc_PanelMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66000118;//kernel.PanelMod:118
        "field strict";
        
      },
      fiber$main :function _trc_PanelMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=66000118;//kernel.PanelMod:118
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initPanelMod :function _trc_PanelMod_initPanelMod() {
        "use strict";
        var _this=this;
        
        throw "Check overrides in spritesmod /oneframeSpritemod";
        
        //$LASTPOS=66000375;//kernel.PanelMod:375
        if (_this.canvas) {
          //$LASTPOS=66000398;//kernel.PanelMod:398
          _this.width=_this.canvas.width;
          //$LASTPOS=66000427;//kernel.PanelMod:427
          _this.height=_this.canvas.height;
          
        } else {
          //$LASTPOS=66000472;//kernel.PanelMod:472
          _this.setPanel(_this.width||Tonyu.globals.$screenWidth||465,_this.height||Tonyu.globals.$screenHeight||465);
          
        }
        //$LASTPOS=66000596;//kernel.PanelMod:596
        if (_this._fillStyle&&_this.canvas) {
          //$LASTPOS=66000622;//kernel.PanelMod:622
          _this.canvas.getContext("2d").fillStyle=_this._fillStyle+"";
        }
        //$LASTPOS=66000676;//kernel.PanelMod:676
        _this.x=_this.x||_this.width/2;
        //$LASTPOS=66000695;//kernel.PanelMod:695
        _this.y=_this.y||_this.height/2;
        //$LASTPOS=66000715;//kernel.PanelMod:715
        if (_this.align==null) {
          //$LASTPOS=66000731;//kernel.PanelMod:731
          _this.align="center";
        }
        //$LASTPOS=66000752;//kernel.PanelMod:752
        if (_this.alpha==null) {
          //$LASTPOS=66000768;//kernel.PanelMod:768
          _this.alpha=255;
        }
        //$LASTPOS=66000784;//kernel.PanelMod:784
        if (_this._drawn==null) {
          //$LASTPOS=66000801;//kernel.PanelMod:801
          _this._drawn=false;
        }
      },
      fiber$initPanelMod :function _trc_PanelMod_f_initPanelMod(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        throw "Check overrides in spritesmod /oneframeSpritemod";
        
        
        _thread.enter(function _trc_PanelMod_ent_initPanelMod(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66000375;//kernel.PanelMod:375
              if (!(_this.canvas)) { __pc=1     ; break; }
              {
                //$LASTPOS=66000398;//kernel.PanelMod:398
                _this.width=_this.canvas.width;
                //$LASTPOS=66000427;//kernel.PanelMod:427
                _this.height=_this.canvas.height;
              }
              __pc=3     ;break;
            case 1     :
              //$LASTPOS=66000472;//kernel.PanelMod:472
              _this.fiber$setPanel(_thread, _this.width||Tonyu.globals.$screenWidth||465, _this.height||Tonyu.globals.$screenHeight||465);
              __pc=2;return;
            case 2:
              
            case 3     :
              
              //$LASTPOS=66000596;//kernel.PanelMod:596
              if (_this._fillStyle&&_this.canvas) {
                //$LASTPOS=66000622;//kernel.PanelMod:622
                _this.canvas.getContext("2d").fillStyle=_this._fillStyle+"";
              }
              //$LASTPOS=66000676;//kernel.PanelMod:676
              _this.x=_this.x||_this.width/2;
              //$LASTPOS=66000695;//kernel.PanelMod:695
              _this.y=_this.y||_this.height/2;
              //$LASTPOS=66000715;//kernel.PanelMod:715
              if (_this.align==null) {
                //$LASTPOS=66000731;//kernel.PanelMod:731
                _this.align="center";
              }
              //$LASTPOS=66000752;//kernel.PanelMod:752
              if (_this.alpha==null) {
                //$LASTPOS=66000768;//kernel.PanelMod:768
                _this.alpha=255;
              }
              //$LASTPOS=66000784;//kernel.PanelMod:784
              if (_this._drawn==null) {
                //$LASTPOS=66000801;//kernel.PanelMod:801
                _this._drawn=false;
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      setPanel :function _trc_PanelMod_setPanel(width,height) {
        "use strict";
        var _this=this;
        var buf;
        
        //$LASTPOS=66000878;//kernel.PanelMod:878
        _this.width=_this.trunc(width);
        //$LASTPOS=66000908;//kernel.PanelMod:908
        _this.height=_this.trunc(height);
        //$LASTPOS=66000940;//kernel.PanelMod:940
        buf = $("<canvas>").attr({width: width,height: height});
        
        //$LASTPOS=66000987;//kernel.PanelMod:987
        _this.canvas=buf[0];
        //$LASTPOS=66001007;//kernel.PanelMod:1007
        _this.imageSmoothingEnabled=! Tonyu.globals.$imageSmoothingDisabled;
        //$LASTPOS=66001060;//kernel.PanelMod:1060
        _this._drawn=false;
        //$LASTPOS=66001079;//kernel.PanelMod:1079
        _this.fireEvent("resize",{width: width,height: height,force: true});
      },
      fiber$setPanel :function _trc_PanelMod_f_setPanel(_thread,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var buf;
        
        //$LASTPOS=66000878;//kernel.PanelMod:878
        _this.width=_this.trunc(width);
        //$LASTPOS=66000908;//kernel.PanelMod:908
        _this.height=_this.trunc(height);
        //$LASTPOS=66000940;//kernel.PanelMod:940
        buf = $("<canvas>").attr({width: width,height: height});
        
        //$LASTPOS=66000987;//kernel.PanelMod:987
        _this.canvas=buf[0];
        //$LASTPOS=66001007;//kernel.PanelMod:1007
        _this.imageSmoothingEnabled=! Tonyu.globals.$imageSmoothingDisabled;
        //$LASTPOS=66001060;//kernel.PanelMod:1060
        _this._drawn=false;
        //$LASTPOS=66001079;//kernel.PanelMod:1079
        _this.fireEvent("resize",{width: width,height: height,force: true});
        
        _thread.retVal=_this;return;
      },
      resize :function _trc_PanelMod_resize(width,height) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001158;//kernel.PanelMod:1158
        if (_this.width==width&&_this.height==height) {
          return _this;
        }
        //$LASTPOS=66001217;//kernel.PanelMod:1217
        _this.setPanel(width,height);
      },
      fiber$resize :function _trc_PanelMod_f_resize(_thread,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=66001158;//kernel.PanelMod:1158
        if (_this.width==width&&_this.height==height) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_PanelMod_ent_resize(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66001217;//kernel.PanelMod:1217
              _this.fiber$setPanel(_thread, width, height);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getContext :function _trc_PanelMod_getContext() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001265;//kernel.PanelMod:1265
        _this._drawn=true;
        return _this.canvas.getContext("2d");
      },
      fiber$getContext :function _trc_PanelMod_f_getContext(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=66001265;//kernel.PanelMod:1265
        _this._drawn=true;
        _thread.retVal=_this.canvas.getContext("2d");return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__context :function _trc_PanelMod___getter__context() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001335;//kernel.PanelMod:1335
        _this._drawn=true;
        return _this.canvas.getContext("2d");
      },
      __getter__image :function _trc_PanelMod___getter__image() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001403;//kernel.PanelMod:1403
        _this._drawn=true;
        return _this.canvas;
      },
      setFillStyle :function _trc_PanelMod_setFillStyle(color) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001467;//kernel.PanelMod:1467
        _this.fillStyle=color;
      },
      fiber$setFillStyle :function _trc_PanelMod_f_setFillStyle(_thread,color) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=66001467;//kernel.PanelMod:1467
        _this.fillStyle=color;
        
        _thread.retVal=_this;return;
      },
      __getter__fillStyle :function _trc_PanelMod___getter__fillStyle() {
        "use strict";
        var _this=this;
        
        return _this._fillStyle;
      },
      __setter__fillStyle :function _trc_PanelMod___setter__fillStyle(val) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001551;//kernel.PanelMod:1551
        _this._fillStyle=val;
        //$LASTPOS=66001572;//kernel.PanelMod:1572
        if (! _this.canvas) {
          return _this;
        }
        //$LASTPOS=66001598;//kernel.PanelMod:1598
        _this.context.fillStyle=val+"";
      },
      __setter__strokeStyle :function _trc_PanelMod___setter__strokeStyle(val) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001652;//kernel.PanelMod:1652
        _this.context.strokeStyle=val+"";
      },
      __setter__lineWidth :function _trc_PanelMod___setter__lineWidth(val) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66001706;//kernel.PanelMod:1706
        _this.context.lineWidth=val;
      },
      fillCircle :function _trc_PanelMod_fillCircle(x,y,r) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=66001759;//kernel.PanelMod:1759
        ctx = _this.context;
        
        //$LASTPOS=66001781;//kernel.PanelMod:1781
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=66001814;//kernel.PanelMod:1814
        ctx.beginPath();
        //$LASTPOS=66001836;//kernel.PanelMod:1836
        ctx.arc(x,y,r,0,2*Tonyu.globals.$Math.PI);
        //$LASTPOS=66001870;//kernel.PanelMod:1870
        ctx.closePath();
        //$LASTPOS=66001892;//kernel.PanelMod:1892
        ctx.fill();
      },
      fiber$fillCircle :function _trc_PanelMod_f_fillCircle(_thread,x,y,r) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        //$LASTPOS=66001759;//kernel.PanelMod:1759
        ctx = _this.context;
        
        //$LASTPOS=66001781;//kernel.PanelMod:1781
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=66001814;//kernel.PanelMod:1814
        ctx.beginPath();
        //$LASTPOS=66001836;//kernel.PanelMod:1836
        ctx.arc(x,y,r,0,2*Tonyu.globals.$Math.PI);
        //$LASTPOS=66001870;//kernel.PanelMod:1870
        ctx.closePath();
        //$LASTPOS=66001892;//kernel.PanelMod:1892
        ctx.fill();
        
        _thread.retVal=_this;return;
      },
      fillRect :function _trc_PanelMod_fillRect(x,y,w,h) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=66001933;//kernel.PanelMod:1933
        ctx = _this.getContext();
        
        //$LASTPOS=66002014;//kernel.PanelMod:2014
        ctx.fillRect(x,y,w,h);
      },
      fiber$fillRect :function _trc_PanelMod_f_fillRect(_thread,x,y,w,h) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        
        _thread.enter(function _trc_PanelMod_ent_fillRect(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66001933;//kernel.PanelMod:1933
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=66002014;//kernel.PanelMod:2014
              ctx.fillRect(x,y,w,h);
              _thread.exit(_this);return;
            }
          }
        });
      },
      fillText :function _trc_PanelMod_fillText(text,x,y,size,align) {
        "use strict";
        var _this=this;
        var ctx;
        var splits;
        var f;
        var colCount;
        
        //$LASTPOS=66002100;//kernel.PanelMod:2100
        ctx = _this.getContext();
        
        //$LASTPOS=66002127;//kernel.PanelMod:2127
        ctx.save();
        //$LASTPOS=66002144;//kernel.PanelMod:2144
        text=text+"";
        //$LASTPOS=66002163;//kernel.PanelMod:2163
        splits = text.split("\n");
        
        //$LASTPOS=66002249;//kernel.PanelMod:2249
        ctx.textAlign=align||"center";
        //$LASTPOS=66002288;//kernel.PanelMod:2288
        size=size||15;
        //$LASTPOS=66002308;//kernel.PanelMod:2308
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=66002341;//kernel.PanelMod:2341
        f = ctx.font.replace(/^[0-9\.]+/,"");
        
        //$LASTPOS=66002386;//kernel.PanelMod:2386
        ctx.font=size+f;
        //$LASTPOS=66002408;//kernel.PanelMod:2408
        //$LASTPOS=66002412;//kernel.PanelMod:2412
        colCount = 0;
        for (; colCount<splits.length ; colCount++) {
          {
            //$LASTPOS=66002472;//kernel.PanelMod:2472
            ctx.fillText(splits[colCount],x,y);
            //$LASTPOS=66002517;//kernel.PanelMod:2517
            y+=size;
          }
        }
        //$LASTPOS=66002538;//kernel.PanelMod:2538
        ctx.restore();
      },
      fiber$fillText :function _trc_PanelMod_f_fillText(_thread,text,x,y,size,align) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        var splits;
        var f;
        var colCount;
        
        
        _thread.enter(function _trc_PanelMod_ent_fillText(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66002100;//kernel.PanelMod:2100
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=66002127;//kernel.PanelMod:2127
              ctx.save();
              //$LASTPOS=66002144;//kernel.PanelMod:2144
              text=text+"";
              //$LASTPOS=66002163;//kernel.PanelMod:2163
              splits = text.split("\n");
              
              //$LASTPOS=66002249;//kernel.PanelMod:2249
              ctx.textAlign=align||"center";
              //$LASTPOS=66002288;//kernel.PanelMod:2288
              size=size||15;
              //$LASTPOS=66002308;//kernel.PanelMod:2308
              ctx.fillStyle=_this.fillStyle+"";
              //$LASTPOS=66002341;//kernel.PanelMod:2341
              f = ctx.font.replace(/^[0-9\.]+/,"");
              
              //$LASTPOS=66002386;//kernel.PanelMod:2386
              ctx.font=size+f;
              //$LASTPOS=66002408;//kernel.PanelMod:2408
              //$LASTPOS=66002412;//kernel.PanelMod:2412
              colCount = 0;
              for (; colCount<splits.length ; colCount++) {
                {
                  //$LASTPOS=66002472;//kernel.PanelMod:2472
                  ctx.fillText(splits[colCount],x,y);
                  //$LASTPOS=66002517;//kernel.PanelMod:2517
                  y+=size;
                }
              }
              //$LASTPOS=66002538;//kernel.PanelMod:2538
              ctx.restore();
              _thread.exit(_this);return;
            }
          }
        });
      },
      clearRect :function _trc_PanelMod_clearRect(clearX,clearY,clearW,clearH) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=66002603;//kernel.PanelMod:2603
        ctx = _this.getContext();
        
        //$LASTPOS=66002630;//kernel.PanelMod:2630
        ctx.save();
        //$LASTPOS=66002647;//kernel.PanelMod:2647
        ctx.clearRect(clearX||0,clearY||0,clearW||_this.width,clearH||_this.height);
        //$LASTPOS=66002717;//kernel.PanelMod:2717
        ctx.restore();
        //$LASTPOS=66002737;//kernel.PanelMod:2737
        if (arguments.length==0) {
          //$LASTPOS=66002762;//kernel.PanelMod:2762
          _this._drawn=false;
        }
      },
      fiber$clearRect :function _trc_PanelMod_f_clearRect(_thread,clearX,clearY,clearW,clearH) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        
        _thread.enter(function _trc_PanelMod_ent_clearRect(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66002603;//kernel.PanelMod:2603
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=66002630;//kernel.PanelMod:2630
              ctx.save();
              //$LASTPOS=66002647;//kernel.PanelMod:2647
              ctx.clearRect(clearX||0,clearY||0,clearW||_this.width,clearH||_this.height);
              //$LASTPOS=66002717;//kernel.PanelMod:2717
              ctx.restore();
              //$LASTPOS=66002737;//kernel.PanelMod:2737
              if (_arguments.length==0) {
                //$LASTPOS=66002762;//kernel.PanelMod:2762
                _this._drawn=false;
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      getPixel :function _trc_PanelMod_getPixel(getX,getY) {
        "use strict";
        var _this=this;
        var ctx;
        var imagedata;
        var colordata;
        
        
        //$LASTPOS=66002841;//kernel.PanelMod:2841
        if (typeof  getX=="number"&&! isNaN(getX)&&typeof  getY=="number"&&! isNaN(getY)) {
          //$LASTPOS=66002939;//kernel.PanelMod:2939
          ctx=_this.getContext();
          //$LASTPOS=66002966;//kernel.PanelMod:2966
          imagedata=ctx.getImageData(getX,getY,1,1);
          //$LASTPOS=66003018;//kernel.PanelMod:3018
          colordata=[imagedata.data[0],imagedata.data[1],imagedata.data[2],imagedata.data[3]];
          
        } else {
          //$LASTPOS=66003158;//kernel.PanelMod:3158
          colordata=[0,0,0,0];
          
        }
        return (colordata);
      },
      fiber$getPixel :function _trc_PanelMod_f_getPixel(_thread,getX,getY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        var imagedata;
        var colordata;
        
        
        
        _thread.enter(function _trc_PanelMod_ent_getPixel(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66002841;//kernel.PanelMod:2841
              if (!(typeof  getX=="number"&&! isNaN(getX)&&typeof  getY=="number"&&! isNaN(getY))) { __pc=2     ; break; }
              //$LASTPOS=66002939;//kernel.PanelMod:2939
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=66002966;//kernel.PanelMod:2966
              imagedata=ctx.getImageData(getX,getY,1,1);
              //$LASTPOS=66003018;//kernel.PanelMod:3018
              colordata=[imagedata.data[0],imagedata.data[1],imagedata.data[2],imagedata.data[3]];
              __pc=3     ;break;
            case 2     :
              {
                //$LASTPOS=66003158;//kernel.PanelMod:3158
                colordata=[0,0,0,0];
              }
            case 3     :
              
              _thread.exit((colordata));return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      scroll :function _trc_PanelMod_scroll(scrollX,scrollY) {
        "use strict";
        var _this=this;
        var ctx;
        var imagedata;
        
        //$LASTPOS=66003245;//kernel.PanelMod:3245
        ctx = _this.getContext();
        
        //$LASTPOS=66003272;//kernel.PanelMod:3272
        ctx.save();
        //$LASTPOS=66003289;//kernel.PanelMod:3289
        imagedata = ctx.getImageData(0,0,_this.width,_this.height);
        
        //$LASTPOS=66003354;//kernel.PanelMod:3354
        _this.clearRect(0,0,_this.width,_this.height);
        //$LASTPOS=66003388;//kernel.PanelMod:3388
        ctx.putImageData(imagedata,- scrollX,- scrollY);
        //$LASTPOS=66003440;//kernel.PanelMod:3440
        ctx.restore();
      },
      fiber$scroll :function _trc_PanelMod_f_scroll(_thread,scrollX,scrollY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        var imagedata;
        
        
        _thread.enter(function _trc_PanelMod_ent_scroll(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66003245;//kernel.PanelMod:3245
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=66003272;//kernel.PanelMod:3272
              ctx.save();
              //$LASTPOS=66003289;//kernel.PanelMod:3289
              imagedata = ctx.getImageData(0,0,_this.width,_this.height);
              
              //$LASTPOS=66003354;//kernel.PanelMod:3354
              _this.fiber$clearRect(_thread, 0, 0, _this.width, _this.height);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=66003388;//kernel.PanelMod:3388
              ctx.putImageData(imagedata,- scrollX,- scrollY);
              //$LASTPOS=66003440;//kernel.PanelMod:3440
              ctx.restore();
              _thread.exit(_this);return;
            }
          }
        });
      },
      draw :function _trc_PanelMod_draw(ctx) {
        "use strict";
        var _this=this;
        var pImg;
        
        //$LASTPOS=66003476;//kernel.PanelMod:3476
        if (_this._drawn) {
          //$LASTPOS=66003497;//kernel.PanelMod:3497
          pImg = _this.canvas;
          
          //$LASTPOS=66003523;//kernel.PanelMod:3523
          ctx.save();
          //$LASTPOS=66003544;//kernel.PanelMod:3544
          if (_this.align=="left") {
            //$LASTPOS=66003576;//kernel.PanelMod:3576
            ctx.translate(_this.x+_this.width/2,_this.y+_this.height/2);
            
          } else {
            //$LASTPOS=66003628;//kernel.PanelMod:3628
            if (_this.align=="center") {
              //$LASTPOS=66003662;//kernel.PanelMod:3662
              ctx.translate(_this.x,_this.y);
              
            } else {
              //$LASTPOS=66003697;//kernel.PanelMod:3697
              if (_this.align=="right") {
                //$LASTPOS=66003730;//kernel.PanelMod:3730
                ctx.translate(_this.x-_this.width/2,_this.y-_this.height/2);
                
              }
            }
          }
          //$LASTPOS=66003787;//kernel.PanelMod:3787
          if (_this.rotation!=0) {
            //$LASTPOS=66003822;//kernel.PanelMod:3822
            ctx.rotate(_this.rotation/180*Math.PI);
            
          } else {
            //$LASTPOS=66003890;//kernel.PanelMod:3890
            ctx.rotate(_this.rotate/180*Math.PI);
            
          }
          //$LASTPOS=66003947;//kernel.PanelMod:3947
          if (typeof  _this.scaleY==="undefined") {
            //$LASTPOS=66003999;//kernel.PanelMod:3999
            ctx.scale(_this.scaleX,_this.scaleX);
            
          } else {
            //$LASTPOS=66004064;//kernel.PanelMod:4064
            ctx.scale(_this.scaleX,_this.scaleY);
            
          }
          //$LASTPOS=66004120;//kernel.PanelMod:4120
          ctx.globalAlpha=_this.alpha/255;
          //$LASTPOS=66004161;//kernel.PanelMod:4161
          ctx.drawImage(pImg,0,0,_this.width,_this.height,- _this.width/2,- _this.height/2,_this.width,_this.height);
          //$LASTPOS=66004265;//kernel.PanelMod:4265
          ctx.restore();
          
        }
      },
      drawSprite :function _trc_PanelMod_drawSprite(x,y,p,options) {
        "use strict";
        var _this=this;
        var pImg;
        var scaleX;
        var scaleY;
        var rotation;
        var ctx;
        
        //$LASTPOS=66004332;//kernel.PanelMod:4332
        pImg = Tonyu.globals.$imageList[p];
        
        //$LASTPOS=66004361;//kernel.PanelMod:4361
        if (! pImg) {
          return _this;
        }
        //$LASTPOS=66004385;//kernel.PanelMod:4385
        if (options===true) {
          //$LASTPOS=66004405;//kernel.PanelMod:4405
          options={f: true};
        }
        //$LASTPOS=66004428;//kernel.PanelMod:4428
        options=options||{};
        //$LASTPOS=66004454;//kernel.PanelMod:4454
        scaleX = typeof  (options.scaleX)==="number"?options.scaleX:1;
        
        //$LASTPOS=66004523;//kernel.PanelMod:4523
        scaleY = typeof  (options.scaleY)==="number"?options.scaleY:scaleX;
        
        //$LASTPOS=66004597;//kernel.PanelMod:4597
        rotation = options.rotation||options.angle||0;
        
        //$LASTPOS=66004651;//kernel.PanelMod:4651
        ctx = _this.context;
        
        //$LASTPOS=66004673;//kernel.PanelMod:4673
        if (options.f) {
          //$LASTPOS=66004688;//kernel.PanelMod:4688
          scaleX*=- 1;
        }
        //$LASTPOS=66004707;//kernel.PanelMod:4707
        ctx.save();
        //$LASTPOS=66004724;//kernel.PanelMod:4724
        ctx.translate(x,y);
        //$LASTPOS=66004749;//kernel.PanelMod:4749
        ctx.rotate(rotation/180*Math.PI);
        //$LASTPOS=66004788;//kernel.PanelMod:4788
        ctx.scale(scaleX,scaleY);
        //$LASTPOS=66004819;//kernel.PanelMod:4819
        ctx.drawImage(pImg.image,pImg.x,pImg.y,pImg.width,pImg.height,- pImg.width/2,- pImg.height/2,pImg.width,pImg.height);
        //$LASTPOS=66004959;//kernel.PanelMod:4959
        ctx.restore();
      },
      copy :function _trc_PanelMod_copy() {
        "use strict";
        var _this=this;
        var sx;
        var sy;
        var sw;
        var sh;
        var dx;
        var dy;
        var dw;
        var dh;
        var a;
        var srcPanel;
        var params;
        
        
        //$LASTPOS=66005197;//kernel.PanelMod:5197
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=66005234;//kernel.PanelMod:5234
        srcPanel = a.shift(Tonyu.classes.kernel.Panel)||_this;
        
        //$LASTPOS=66005276;//kernel.PanelMod:5276
        if (a.length<=4) {
          //$LASTPOS=66005304;//kernel.PanelMod:5304
          dx=a.shift();
          //$LASTPOS=66005327;//kernel.PanelMod:5327
          dy=a.shift();
          //$LASTPOS=66005350;//kernel.PanelMod:5350
          if (a.length==0) {
            //$LASTPOS=66005382;//kernel.PanelMod:5382
            _this.context.drawImage(srcPanel.image,dx,dy);
            
          } else {
            //$LASTPOS=66005455;//kernel.PanelMod:5455
            dw=a.shift();
            //$LASTPOS=66005482;//kernel.PanelMod:5482
            dh=a.shift();
            //$LASTPOS=66005509;//kernel.PanelMod:5509
            if (dw*dh!=0) {
              //$LASTPOS=66005542;//kernel.PanelMod:5542
              _this.context.drawImage(srcPanel.image,dx,dy,dw,dh);
              
            }
            
          }
          
        } else {
          //$LASTPOS=66005638;//kernel.PanelMod:5638
          sx=a.shift();
          //$LASTPOS=66005661;//kernel.PanelMod:5661
          sy=a.shift();
          //$LASTPOS=66005684;//kernel.PanelMod:5684
          sw=a.shift();
          //$LASTPOS=66005707;//kernel.PanelMod:5707
          sh=a.shift();
          //$LASTPOS=66005730;//kernel.PanelMod:5730
          dx=a.shift();
          //$LASTPOS=66005753;//kernel.PanelMod:5753
          if (typeof  dx==="object") {
            //$LASTPOS=66005794;//kernel.PanelMod:5794
            params = dx;
            
            
          }
          //$LASTPOS=66005880;//kernel.PanelMod:5880
          dy=a.shift();
          //$LASTPOS=66005903;//kernel.PanelMod:5903
          dw=a.shift()||sw;
          //$LASTPOS=66005932;//kernel.PanelMod:5932
          dh=a.shift()||sh;
          //$LASTPOS=66006011;//kernel.PanelMod:6011
          if (sw*sh*dw*dh!=0) {
            //$LASTPOS=66006046;//kernel.PanelMod:6046
            _this.context.drawImage(srcPanel.image,sx,sy,sw,sh,dx,dy,dw,dh);
            
          }
          
        }
      },
      drawLine :function _trc_PanelMod_drawLine(x,y,dx,dy) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66006162;//kernel.PanelMod:6162
        if (dx==null&&dy==null) {
          //$LASTPOS=66006199;//kernel.PanelMod:6199
          if (x==null&&y==null) {
            //$LASTPOS=66006238;//kernel.PanelMod:6238
            _this.px=null;
            //$LASTPOS=66006246;//kernel.PanelMod:6246
            _this.py=null;
            return _this;
            
          }
          //$LASTPOS=66006282;//kernel.PanelMod:6282
          if (_this.px==null&&_this.py==null) {
            //$LASTPOS=66006323;//kernel.PanelMod:6323
            _this.px=x;
            //$LASTPOS=66006328;//kernel.PanelMod:6328
            _this.py=y;
            return _this;
            
          }
          //$LASTPOS=66006361;//kernel.PanelMod:6361
          dx=x;
          //$LASTPOS=66006366;//kernel.PanelMod:6366
          dy=y;
          //$LASTPOS=66006371;//kernel.PanelMod:6371
          x=_this.px;
          //$LASTPOS=66006376;//kernel.PanelMod:6376
          y=_this.py;
          //$LASTPOS=66006381;//kernel.PanelMod:6381
          _this.px=dx;
          //$LASTPOS=66006387;//kernel.PanelMod:6387
          _this.py=dy;
          
        }
        //$LASTPOS=66006406;//kernel.PanelMod:6406
        _this.context.beginPath();
        //$LASTPOS=66006432;//kernel.PanelMod:6432
        _this.context.moveTo(x,y);
        //$LASTPOS=66006458;//kernel.PanelMod:6458
        _this.context.lineTo(dx,dy);
        //$LASTPOS=66006486;//kernel.PanelMod:6486
        _this.context.stroke();
      },
      fiber$drawLine :function _trc_PanelMod_f_drawLine(_thread,x,y,dx,dy) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=66006162;//kernel.PanelMod:6162
        if (dx==null&&dy==null) {
          //$LASTPOS=66006199;//kernel.PanelMod:6199
          if (x==null&&y==null) {
            //$LASTPOS=66006238;//kernel.PanelMod:6238
            _this.px=null;
            //$LASTPOS=66006246;//kernel.PanelMod:6246
            _this.py=null;
            _thread.retVal=_this;return;
            
            
          }
          //$LASTPOS=66006282;//kernel.PanelMod:6282
          if (_this.px==null&&_this.py==null) {
            //$LASTPOS=66006323;//kernel.PanelMod:6323
            _this.px=x;
            //$LASTPOS=66006328;//kernel.PanelMod:6328
            _this.py=y;
            _thread.retVal=_this;return;
            
            
          }
          //$LASTPOS=66006361;//kernel.PanelMod:6361
          dx=x;
          //$LASTPOS=66006366;//kernel.PanelMod:6366
          dy=y;
          //$LASTPOS=66006371;//kernel.PanelMod:6371
          x=_this.px;
          //$LASTPOS=66006376;//kernel.PanelMod:6376
          y=_this.py;
          //$LASTPOS=66006381;//kernel.PanelMod:6381
          _this.px=dx;
          //$LASTPOS=66006387;//kernel.PanelMod:6387
          _this.py=dy;
          
        }
        //$LASTPOS=66006406;//kernel.PanelMod:6406
        _this.context.beginPath();
        //$LASTPOS=66006432;//kernel.PanelMod:6432
        _this.context.moveTo(x,y);
        //$LASTPOS=66006458;//kernel.PanelMod:6458
        _this.context.lineTo(dx,dy);
        //$LASTPOS=66006486;//kernel.PanelMod:6486
        _this.context.stroke();
        
        _thread.retVal=_this;return;
      },
      slicePattern :function _trc_PanelMod_slicePattern(x,y,width,height) {
        "use strict";
        var _this=this;
        
        return {image: _this.canvas,x: x,y: y,width: width,height: height};
      },
      fiber$slicePattern :function _trc_PanelMod_f_slicePattern(_thread,x,y,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal={image: _this.canvas,x: x,y: y,width: width,height: height};return;
        
        
        _thread.retVal=_this;return;
      },
      addPattern :function _trc_PanelMod_addPattern(x,y,width,height) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66006628;//kernel.PanelMod:6628
        Tonyu.globals.$imageList.push(_this.slicePattern(x,y,width,height));
        return Tonyu.globals.$imageList.length-1;
      },
      fiber$addPattern :function _trc_PanelMod_f_addPattern(_thread,x,y,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=66006628;//kernel.PanelMod:6628
        Tonyu.globals.$imageList.push(_this.slicePattern(x,y,width,height));
        _thread.retVal=Tonyu.globals.$imageList.length-1;return;
        
        
        _thread.retVal=_this;return;
      },
      getImageData :function _trc_PanelMod_getImageData(x,y,width,height) {
        "use strict";
        var _this=this;
        
        return _this.context.getImageData(x,y,width,height);
      },
      fiber$getImageData :function _trc_PanelMod_f_getImageData(_thread,x,y,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.context.getImageData(x,y,width,height);return;
        
        
        _thread.retVal=_this;return;
      },
      putImageData :function _trc_PanelMod_putImageData(data,x,y) {
        "use strict";
        var _this=this;
        
        return _this.context.putImageData(data,x,y);
      },
      fiber$putImageData :function _trc_PanelMod_f_putImageData(_thread,data,x,y) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.context.putImageData(data,x,y);return;
        
        
        _thread.retVal=_this;return;
      },
      save :function _trc_PanelMod_save(fn) {
        "use strict";
        var _this=this;
        var url;
        
        //$LASTPOS=66006897;//kernel.PanelMod:6897
        url = _this.canvas.toDataURL();
        
        //$LASTPOS=66006930;//kernel.PanelMod:6930
        if (typeof  fn==="string") {
          //$LASTPOS=66006956;//kernel.PanelMod:6956
          fn=_this.file(fn);
        }
        return fn.text(url);
      },
      fiber$save :function _trc_PanelMod_f_save(_thread,fn) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var url;
        
        //$LASTPOS=66006897;//kernel.PanelMod:6897
        url = _this.canvas.toDataURL();
        
        
        _thread.enter(function _trc_PanelMod_ent_save(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66006930;//kernel.PanelMod:6930
              if (!(typeof  fn==="string")) { __pc=2     ; break; }
              //$LASTPOS=66006956;//kernel.PanelMod:6956
              _this.fiber$file(_thread, fn);
              __pc=1;return;
            case 1:
              fn=_thread.retVal;
              
            case 2     :
              
              _thread.exit(fn.text(url));return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      load :function _trc_PanelMod_load(fn) {
        "use strict";
        var _this=this;
        var d;
        var url;
        var element;
        
        //$LASTPOS=66007018;//kernel.PanelMod:7018
        if (typeof  fn==="string") {
          //$LASTPOS=66007044;//kernel.PanelMod:7044
          fn=_this.file(fn);
        }
        //$LASTPOS=66007062;//kernel.PanelMod:7062
        d = new $.Deferred();
        
        //$LASTPOS=66007091;//kernel.PanelMod:7091
        url = fn.text();
        
        //$LASTPOS=66007115;//kernel.PanelMod:7115
        element = $("<img>").css({display: "none"}).appendTo("body");
        
        //$LASTPOS=66007181;//kernel.PanelMod:7181
        element.on("load",(function anonymous_7200() {
          var img;
          var width;
          var height;
          
          //$LASTPOS=66007212;//kernel.PanelMod:7212
          img = new Image();
          
          //$LASTPOS=66007244;//kernel.PanelMod:7244
          img.src=element.attr('src');
          //$LASTPOS=66007284;//kernel.PanelMod:7284
          width = img.width;
          
          //$LASTPOS=66007316;//kernel.PanelMod:7316
          height = img.height;
          
          //$LASTPOS=66007382;//kernel.PanelMod:7382
          _this.resize(width,height);
          //$LASTPOS=66007413;//kernel.PanelMod:7413
          _this.context.drawImage(img,0,0);
          //$LASTPOS=66007451;//kernel.PanelMod:7451
          d.resolve(_this);
        }));
        //$LASTPOS=66007481;//kernel.PanelMod:7481
        element.attr({src: url});
        return d.promise();
      },
      fiber$load :function _trc_PanelMod_f_load(_thread,fn) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var d;
        var url;
        var element;
        
        
        _thread.enter(function _trc_PanelMod_ent_load(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66007018;//kernel.PanelMod:7018
              if (!(typeof  fn==="string")) { __pc=2     ; break; }
              //$LASTPOS=66007044;//kernel.PanelMod:7044
              _this.fiber$file(_thread, fn);
              __pc=1;return;
            case 1:
              fn=_thread.retVal;
              
            case 2     :
              
              //$LASTPOS=66007062;//kernel.PanelMod:7062
              d = new $.Deferred();
              
              //$LASTPOS=66007091;//kernel.PanelMod:7091
              url = fn.text();
              
              //$LASTPOS=66007115;//kernel.PanelMod:7115
              element = $("<img>").css({display: "none"}).appendTo("body");
              
              //$LASTPOS=66007181;//kernel.PanelMod:7181
              element.on("load",(function anonymous_7200() {
                var img;
                var width;
                var height;
                
                //$LASTPOS=66007212;//kernel.PanelMod:7212
                img = new Image();
                
                //$LASTPOS=66007244;//kernel.PanelMod:7244
                img.src=element.attr('src');
                //$LASTPOS=66007284;//kernel.PanelMod:7284
                width = img.width;
                
                //$LASTPOS=66007316;//kernel.PanelMod:7316
                height = img.height;
                
                //$LASTPOS=66007382;//kernel.PanelMod:7382
                _this.resize(width,height);
                //$LASTPOS=66007413;//kernel.PanelMod:7413
                _this.context.drawImage(img,0,0);
                //$LASTPOS=66007451;//kernel.PanelMod:7451
                d.resolve(_this);
              }));
              //$LASTPOS=66007481;//kernel.PanelMod:7481
              element.attr({src: url});
              _thread.exit(d.promise());return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __setter__imageSmoothingEnabled :function _trc_PanelMod___setter__imageSmoothingEnabled(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66007565;//kernel.PanelMod:7565
        if (typeof  _this.context.msImageSmoothingEnabled==="boolean") {
          //$LASTPOS=66007632;//kernel.PanelMod:7632
          _this.context.msImageSmoothingEnabled=v;
          
        } else {
          //$LASTPOS=66007690;//kernel.PanelMod:7690
          _this.context.imageSmoothingEnabled=v;
          
        }
      },
      __getter__imageSmoothingEnabled :function _trc_PanelMod___getter__imageSmoothingEnabled() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=66007764;//kernel.PanelMod:7764
        if (typeof  _this.context.msImageSmoothingEnabled==="boolean") {
          return _this.context.msImageSmoothingEnabled;
          
        } else {
          return _this.context.imageSmoothingEnabled;
          
        }
      },
      replaceColor :function _trc_PanelMod_replaceColor() {
        "use strict";
        var _this=this;
        var a;
        var top;
        var left;
        var w;
        var h;
        var func;
        var ctx;
        var data;
        var i;
        var j;
        
        //$LASTPOS=66007966;//kernel.PanelMod:7966
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=66008003;//kernel.PanelMod:8003
        top = 0;
        left = 0;
        
        //$LASTPOS=66008026;//kernel.PanelMod:8026
        w = _this.width;
        h = _this.height;
        
        //$LASTPOS=66008054;//kernel.PanelMod:8054
        if (a.length>=4) {
          //$LASTPOS=66008082;//kernel.PanelMod:8082
          left=a.shift();
          //$LASTPOS=66008107;//kernel.PanelMod:8107
          top=a.shift();
          //$LASTPOS=66008131;//kernel.PanelMod:8131
          w=a.shift();
          //$LASTPOS=66008153;//kernel.PanelMod:8153
          h=a.shift();
          
        }
        //$LASTPOS=66008178;//kernel.PanelMod:8178
        func = a.shift();
        
        //$LASTPOS=66008203;//kernel.PanelMod:8203
        if (typeof  func!=="function") {
          //$LASTPOS=66008244;//kernel.PanelMod:8244
          ctx = _this.context;
          
          //$LASTPOS=66008270;//kernel.PanelMod:8270
          ctx.save();
          //$LASTPOS=66008291;//kernel.PanelMod:8291
          ctx.beginPath();
          //$LASTPOS=66008317;//kernel.PanelMod:8317
          ctx.moveTo(left,top);
          //$LASTPOS=66008348;//kernel.PanelMod:8348
          ctx.lineTo(left+w,top);
          //$LASTPOS=66008381;//kernel.PanelMod:8381
          ctx.lineTo(left+w,top+h);
          //$LASTPOS=66008416;//kernel.PanelMod:8416
          ctx.lineTo(left,top+h);
          //$LASTPOS=66008449;//kernel.PanelMod:8449
          ctx.closePath();
          //$LASTPOS=66008475;//kernel.PanelMod:8475
          ctx.clip();
          //$LASTPOS=66008496;//kernel.PanelMod:8496
          ctx.globalCompositeOperation="source-in";
          //$LASTPOS=66008547;//kernel.PanelMod:8547
          if (func) {
            //$LASTPOS=66008557;//kernel.PanelMod:8557
            _this.fillStyle=func;
          }
          //$LASTPOS=66008582;//kernel.PanelMod:8582
          ctx.fillRect(left,top,w,h);
          //$LASTPOS=66008619;//kernel.PanelMod:8619
          ctx.restore();
          return _this;
          
        }
        //$LASTPOS=66008663;//kernel.PanelMod:8663
        data = _this.getImageData(left,top,w,h);
        
        //$LASTPOS=66008705;//kernel.PanelMod:8705
        //$LASTPOS=66008710;//kernel.PanelMod:8710
        i = 0;
        for (; i<h ; i++) {
          {
            //$LASTPOS=66008738;//kernel.PanelMod:8738
            //$LASTPOS=66008743;//kernel.PanelMod:8743
            j = 0;
            for (; j<w ; j++) {
              {
                //$LASTPOS=66008775;//kernel.PanelMod:8775
                func(new Tonyu.classes.kernel.Color(data,j,i),left+j,top+i);
              }
            }
          }
        }
        //$LASTPOS=66008838;//kernel.PanelMod:8838
        _this.putImageData(data,left,top);
      },
      fiber$replaceColor :function _trc_PanelMod_f_replaceColor(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var top;
        var left;
        var w;
        var h;
        var func;
        var ctx;
        var data;
        var i;
        var j;
        
        //$LASTPOS=66007966;//kernel.PanelMod:7966
        a = new Tonyu.classes.kernel.ArgParser(_arguments);
        
        //$LASTPOS=66008003;//kernel.PanelMod:8003
        top = 0;
        left = 0;
        
        //$LASTPOS=66008026;//kernel.PanelMod:8026
        w = _this.width;
        h = _this.height;
        
        //$LASTPOS=66008054;//kernel.PanelMod:8054
        if (a.length>=4) {
          //$LASTPOS=66008082;//kernel.PanelMod:8082
          left=a.shift();
          //$LASTPOS=66008107;//kernel.PanelMod:8107
          top=a.shift();
          //$LASTPOS=66008131;//kernel.PanelMod:8131
          w=a.shift();
          //$LASTPOS=66008153;//kernel.PanelMod:8153
          h=a.shift();
          
        }
        //$LASTPOS=66008178;//kernel.PanelMod:8178
        func = a.shift();
        
        //$LASTPOS=66008203;//kernel.PanelMod:8203
        if (typeof  func!=="function") {
          //$LASTPOS=66008244;//kernel.PanelMod:8244
          ctx = _this.context;
          
          //$LASTPOS=66008270;//kernel.PanelMod:8270
          ctx.save();
          //$LASTPOS=66008291;//kernel.PanelMod:8291
          ctx.beginPath();
          //$LASTPOS=66008317;//kernel.PanelMod:8317
          ctx.moveTo(left,top);
          //$LASTPOS=66008348;//kernel.PanelMod:8348
          ctx.lineTo(left+w,top);
          //$LASTPOS=66008381;//kernel.PanelMod:8381
          ctx.lineTo(left+w,top+h);
          //$LASTPOS=66008416;//kernel.PanelMod:8416
          ctx.lineTo(left,top+h);
          //$LASTPOS=66008449;//kernel.PanelMod:8449
          ctx.closePath();
          //$LASTPOS=66008475;//kernel.PanelMod:8475
          ctx.clip();
          //$LASTPOS=66008496;//kernel.PanelMod:8496
          ctx.globalCompositeOperation="source-in";
          //$LASTPOS=66008547;//kernel.PanelMod:8547
          if (func) {
            //$LASTPOS=66008557;//kernel.PanelMod:8557
            _this.fillStyle=func;
          }
          //$LASTPOS=66008582;//kernel.PanelMod:8582
          ctx.fillRect(left,top,w,h);
          //$LASTPOS=66008619;//kernel.PanelMod:8619
          ctx.restore();
          _thread.retVal=_this;return;
          
          
        }
        
        _thread.enter(function _trc_PanelMod_ent_replaceColor(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=66008663;//kernel.PanelMod:8663
              _this.fiber$getImageData(_thread, left, top, w, h);
              __pc=1;return;
            case 1:
              data=_thread.retVal;
              
              //$LASTPOS=66008705;//kernel.PanelMod:8705
              //$LASTPOS=66008710;//kernel.PanelMod:8710
              i = 0;
              for (; i<h ; i++) {
                {
                  //$LASTPOS=66008738;//kernel.PanelMod:8738
                  //$LASTPOS=66008743;//kernel.PanelMod:8743
                  j = 0;
                  for (; j<w ; j++) {
                    {
                      //$LASTPOS=66008775;//kernel.PanelMod:8775
                      func(new Tonyu.classes.kernel.Color(data,j,i),left+j,top+i);
                    }
                  }
                }
              }
              //$LASTPOS=66008838;//kernel.PanelMod:8838
              _this.fiber$putImageData(_thread, data, left, top);
              __pc=2;return;
            case 2:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initPanelMod":{"nowait":false},"setPanel":{"nowait":false},"resize":{"nowait":false},"getContext":{"nowait":false},"__getter__context":{"nowait":true},"__getter__image":{"nowait":true},"setFillStyle":{"nowait":false},"__getter__fillStyle":{"nowait":true},"__setter__fillStyle":{"nowait":true},"__setter__strokeStyle":{"nowait":true},"__setter__lineWidth":{"nowait":true},"fillCircle":{"nowait":false},"fillRect":{"nowait":false},"fillText":{"nowait":false},"clearRect":{"nowait":false},"getPixel":{"nowait":false},"scroll":{"nowait":false},"draw":{"nowait":true},"drawSprite":{"nowait":true},"copy":{"nowait":true},"drawLine":{"nowait":false},"slicePattern":{"nowait":false},"addPattern":{"nowait":false},"getImageData":{"nowait":false},"putImageData":{"nowait":false},"save":{"nowait":false},"load":{"nowait":false},"__setter__imageSmoothingEnabled":{"nowait":true},"__getter__imageSmoothingEnabled":{"nowait":true},"replaceColor":{"nowait":false}},"fields":{"canvas":{},"_drawn":{},"_fillStyle":{},"px":{},"py":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.PlayMod',
  shortName: 'PlayMod',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.SchedulerMod,Tonyu.classes.kernel.LifeCycleMod],
  methods: function (__superClass) {
    return {
      main :function _trc_PlayMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=67000063;//kernel.PlayMod:63
        "field strict";
        
      },
      fiber$main :function _trc_PlayMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=67000063;//kernel.PlayMod:63
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initMML :function _trc_PlayMod_initMML() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=67000129;//kernel.PlayMod:129
        if (_this.mmlInited) {
          return _this;
        }
        //$LASTPOS=67000157;//kernel.PlayMod:157
        _this.mmlInited=true;
        //$LASTPOS=67000178;//kernel.PlayMod:178
        Tonyu.globals.$currentProject.requestPlugin("timbre");
        //$LASTPOS=67000224;//kernel.PlayMod:224
        if (! Tonyu.globals.$MMLS) {
          //$LASTPOS=67000246;//kernel.PlayMod:246
          Tonyu.globals.$MMLS={};
          //$LASTPOS=67000264;//kernel.PlayMod:264
          Tonyu.globals.$WaveTable=new Tonyu.classes.kernel.WaveTable;
          //$LASTPOS=67000298;//kernel.PlayMod:298
          Tonyu.globals.$Boot.on("stop",Tonyu.bindFunc(_this,_this.releaseMML));
          
        }
        //$LASTPOS=67000340;//kernel.PlayMod:340
        _this.on("die",(function anonymous_350() {
          
          //$LASTPOS=67000356;//kernel.PlayMod:356
          _this.play().stop();
        }));
      },
      releaseMML :function _trc_PlayMod_releaseMML() {
        "use strict";
        var _this=this;
        var k;
        var v;
        var _it_598;
        
        //$LASTPOS=67000406;//kernel.PlayMod:406
        if (Tonyu.globals.$MMLS) {
          //$LASTPOS=67000427;//kernel.PlayMod:427
          _it_598=Tonyu.iterator(Tonyu.globals.$MMLS,2);
          while(_it_598.next()) {
            k=_it_598[0];
            v=_it_598[1];
            
            //$LASTPOS=67000463;//kernel.PlayMod:463
            v.stop();
            
          }
          //$LASTPOS=67000491;//kernel.PlayMod:491
          Tonyu.globals.$MMLS=null;
          
        }
        //$LASTPOS=67000515;//kernel.PlayMod:515
        if (Tonyu.globals.$WaveTable) {
          //$LASTPOS=67000541;//kernel.PlayMod:541
          Tonyu.globals.$WaveTable.stop();
          //$LASTPOS=67000568;//kernel.PlayMod:568
          Tonyu.globals.$WaveTable=null;
          
        }
      },
      play :function _trc_PlayMod_play() {
        "use strict";
        var _this=this;
        var mmls;
        var i;
        
        //$LASTPOS=67000611;//kernel.PlayMod:611
        _this.initMML();
        //$LASTPOS=67000627;//kernel.PlayMod:627
        if (! _this._mml) {
          //$LASTPOS=67000638;//kernel.PlayMod:638
          _this._mml=new Tonyu.classes.kernel.MML;
        }
        //$LASTPOS=67000657;//kernel.PlayMod:657
        if (_this.isDead()||arguments.length==0) {
          return _this._mml;
        }
        //$LASTPOS=67000712;//kernel.PlayMod:712
        mmls = [];
        
        //$LASTPOS=67000730;//kernel.PlayMod:730
        //$LASTPOS=67000735;//kernel.PlayMod:735
        i = 0;
        for (; i<arguments.length ; i++) {
          {
            //$LASTPOS=67000780;//kernel.PlayMod:780
            mmls.push(arguments[i]);
          }
        }
        //$LASTPOS=67000817;//kernel.PlayMod:817
        _this._mml.play(mmls);
        //$LASTPOS=67000839;//kernel.PlayMod:839
        while (_this._mml.bufferCount()>2) {
          //$LASTPOS=67000879;//kernel.PlayMod:879
          _this.update();
          
        }
        return _this._mml;
      },
      fiber$play :function _trc_PlayMod_f_play(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var mmls;
        var i;
        
        //$LASTPOS=67000611;//kernel.PlayMod:611
        _this.initMML();
        //$LASTPOS=67000627;//kernel.PlayMod:627
        if (! _this._mml) {
          //$LASTPOS=67000638;//kernel.PlayMod:638
          _this._mml=new Tonyu.classes.kernel.MML;
        }
        //$LASTPOS=67000657;//kernel.PlayMod:657
        if (_this.isDead()||_arguments.length==0) {
          _thread.retVal=_this._mml;return;
          
        }
        //$LASTPOS=67000712;//kernel.PlayMod:712
        mmls = [];
        
        //$LASTPOS=67000730;//kernel.PlayMod:730
        //$LASTPOS=67000735;//kernel.PlayMod:735
        i = 0;
        for (; i<_arguments.length ; i++) {
          {
            //$LASTPOS=67000780;//kernel.PlayMod:780
            mmls.push(_arguments[i]);
          }
        }
        //$LASTPOS=67000817;//kernel.PlayMod:817
        _this._mml.play(mmls);
        
        _thread.enter(function _trc_PlayMod_ent_play(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=67000839;//kernel.PlayMod:839
            case 1:
              if (!(_this._mml.bufferCount()>2)) { __pc=3     ; break; }
              //$LASTPOS=67000879;//kernel.PlayMod:879
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this._mml);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      playSE :function _trc_PlayMod_playSE() {
        "use strict";
        var _this=this;
        var mml;
        var mmls;
        var i;
        
        //$LASTPOS=67000942;//kernel.PlayMod:942
        _this.initMML();
        //$LASTPOS=67000958;//kernel.PlayMod:958
        mml = new Tonyu.classes.kernel.MML;
        
        //$LASTPOS=67000980;//kernel.PlayMod:980
        mmls = [];
        
        //$LASTPOS=67000998;//kernel.PlayMod:998
        //$LASTPOS=67001003;//kernel.PlayMod:1003
        i = 0;
        for (; i<arguments.length ; i++) {
          {
            //$LASTPOS=67001048;//kernel.PlayMod:1048
            mmls.push(arguments[i]);
          }
        }
        //$LASTPOS=67001085;//kernel.PlayMod:1085
        mml.play(mmls);
        return mml;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initMML":{"nowait":true},"releaseMML":{"nowait":true},"play":{"nowait":false},"playSE":{"nowait":true}},"fields":{"mmlInited":{},"_mml":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.InputMod',
  shortName: 'InputMod',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.QueryMod],
  methods: function (__superClass) {
    return {
      main :function _trc_InputMod_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=68000045;//kernel.InputMod:45
        "field strict";
      },
      fiber$main :function _trc_InputMod_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=68000045;//kernel.InputMod:45
        "field strict";
        
        _thread.retVal=_this;return;
      },
      getkey :function _trc_InputMod_getkey(k) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$Keys.getkey(k);
      },
      waitInputDevice :function _trc_InputMod_waitInputDevice(fl) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=68000233;//kernel.InputMod:233
        _this.runAsync((function anonymous_242(f) {
          
          //$LASTPOS=68000257;//kernel.InputMod:257
          Tonyu.globals.$InputDevice.addOnetimeListener(f);
        }));
      },
      fiber$waitInputDevice :function _trc_InputMod_f_waitInputDevice(_thread,fl) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_InputMod_ent_waitInputDevice(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=68000233;//kernel.InputMod:233
              _this.fiber$runAsync(_thread, (function anonymous_242(f) {
                
                //$LASTPOS=68000257;//kernel.InputMod:257
                Tonyu.globals.$InputDevice.addOnetimeListener(f);
              }));
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      findTouch :function _trc_InputMod_findTouch(params) {
        "use strict";
        var _this=this;
        var r;
        var res;
        
        //$LASTPOS=68000338;//kernel.InputMod:338
        if (typeof  params==="number") {
          //$LASTPOS=68000368;//kernel.InputMod:368
          params={scale: params};
        }
        //$LASTPOS=68000396;//kernel.InputMod:396
        params=params||{};
        
        //$LASTPOS=68000432;//kernel.InputMod:432
        if (params.width&&params.height) {
          //$LASTPOS=68000478;//kernel.InputMod:478
          r={x: _this.x,y: _this.y,width: params.width,height: params.height};
          
        } else {
          //$LASTPOS=68000551;//kernel.InputMod:551
          params.scale=params.scale||2;
          //$LASTPOS=68000590;//kernel.InputMod:590
          r=_this.getCrashShape();
          //$LASTPOS=68000639;//kernel.InputMod:639
          if (! r) {
            return null;
          }
          //$LASTPOS=68000669;//kernel.InputMod:669
          r={x: _this.x,y: _this.y,width: r.width*params.scale,height: r.height*params.scale};
          
        }
        //$LASTPOS=68000810;//kernel.InputMod:810
        res = Tonyu.globals.$touches.findTouch((function anonymous_837(t) {
          var tt;
          
          //$LASTPOS=68000853;//kernel.InputMod:853
          if (params.pickup||t.touched==1) {
            //$LASTPOS=68000903;//kernel.InputMod:903
            tt = Tonyu.globals.$Screen.convert(t,_this.layer);
            
            //$LASTPOS=68000949;//kernel.InputMod:949
            if (Math.abs(r.x-tt.x)<r.width/2&&Math.abs(r.y-tt.y)<r.height/2) {
              return true;
              
            }
            
          }
        }));
        
        //$LASTPOS=68001104;//kernel.InputMod:1104
        if (res) {
          //$LASTPOS=68001124;//kernel.InputMod:1124
          res.layer=_this.layer;
          return res;
          
        }
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"getkey":{"nowait":true},"waitInputDevice":{"nowait":false},"findTouch":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.BaseActor',
  shortName: 'BaseActor',
  namespace: 'kernel',
  includes: [Tonyu.classes.kernel.MathMod,Tonyu.classes.kernel.EventMod,Tonyu.classes.kernel.ThreadGroupMod,Tonyu.classes.kernel.EventHandlerCaller,Tonyu.classes.kernel.DialogMod,Tonyu.classes.kernel.FileMod,Tonyu.classes.kernel.AnimMod,Tonyu.classes.kernel.SchedulerMod,Tonyu.classes.kernel.QueryMod,Tonyu.classes.kernel.InputMod,Tonyu.classes.kernel.LifeCycleMod,Tonyu.classes.kernel.SpriteMod,Tonyu.classes.kernel.ParallelMod,Tonyu.classes.kernel.PlayMod,Tonyu.classes.kernel.ParallelMod],
  methods: function (__superClass) {
    return {
      main :function _trc_BaseActor_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=69000198;//kernel.BaseActor:198
        "field strict";
      },
      fiber$main :function _trc_BaseActor_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=69000198;//kernel.BaseActor:198
        "field strict";
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_BaseActor_initialize(x,y,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=69000270;//kernel.BaseActor:270
        if (typeof  x=="object") {
          //$LASTPOS=69000294;//kernel.BaseActor:294
          Tonyu.extend(_this,x);
        } else {
          //$LASTPOS=69000326;//kernel.BaseActor:326
          if (typeof  x=="number") {
            //$LASTPOS=69000361;//kernel.BaseActor:361
            _this.x=x;
            //$LASTPOS=69000380;//kernel.BaseActor:380
            _this.y=y;
            //$LASTPOS=69000399;//kernel.BaseActor:399
            _this.p=p;
            
          }
        }
        //$LASTPOS=69000421;//kernel.BaseActor:421
        _this.initSchedulerMod();
        //$LASTPOS=69000446;//kernel.BaseActor:446
        _this.layer=_this.layer||_this.defaultLayer;
        //$LASTPOS=69000478;//kernel.BaseActor:478
        if (_this.layer.group instanceof Tonyu.classes.kernel.SpriteGroup) {
          //$LASTPOS=69000518;//kernel.BaseActor:518
          _this.layer=_this.layer.group;
        }
        //$LASTPOS=69000542;//kernel.BaseActor:542
        _this.crashScale=1;
        //$LASTPOS=69000561;//kernel.BaseActor:561
        _this.initSpriteMod();
        //$LASTPOS=69000583;//kernel.BaseActor:583
        if (Tonyu.runMode) {
          //$LASTPOS=69000602;//kernel.BaseActor:602
          _this.addToLayer();
        }
        //$LASTPOS=69000621;//kernel.BaseActor:621
        _this.initAnimMod();
      },
      extend :function _trc_BaseActor_extend(obj) {
        "use strict";
        var _this=this;
        
        return Tonyu.extend(_this,obj);
      },
      print :function _trc_BaseActor_print() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=69000727;//kernel.BaseActor:727
        Tonyu.globals.$_printCount++;
        //$LASTPOS=69000743;//kernel.BaseActor:743
        if (Tonyu.globals.$_printCount>Tonyu.globals.$printLimit) {
          throw new Error("printをしすぎています.\n"+"       $printLimitの値を変更すると、1フレーム間にできるprint回数を変更できます\n"+"       $printLimit="+Tonyu.globals.$printLimit+"; // 現在のprint回数の限度\n"+"       [参考] https://edit.tonyu.jp/doc/limitations.html\n");
          
        }
        //$LASTPOS=69001017;//kernel.BaseActor:1017
        console.log.apply(console,arguments);
        //$LASTPOS=69001060;//kernel.BaseActor:1060
        if (Tonyu.globals.$consolePanel) {
          //$LASTPOS=69001088;//kernel.BaseActor:1088
          Tonyu.globals.$consolePanel.print.apply(Tonyu.globals.$consolePanel,arguments);
          
        }
      },
      loadPage :function _trc_BaseActor_loadPage() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=69001190;//kernel.BaseActor:1190
        Tonyu.globals.$Boot.loadPage.apply(Tonyu.globals.$Boot,arguments);
        //$LASTPOS=69001234;//kernel.BaseActor:1234
        _this.update();
      },
      fiber$loadPage :function _trc_BaseActor_f_loadPage(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=69001190;//kernel.BaseActor:1190
        Tonyu.globals.$Boot.loadPage.apply(Tonyu.globals.$Boot,_arguments);
        
        _thread.enter(function _trc_BaseActor_ent_loadPage(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=69001234;//kernel.BaseActor:1234
              _this.fiber$update(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __getter__defaultLayer :function _trc_BaseActor___getter__defaultLayer() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$mainLayer;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"extend":{"nowait":true},"print":{"nowait":true},"loadPage":{"nowait":false},"__getter__defaultLayer":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.NoviceActor',
  shortName: 'NoviceActor',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.BaseActor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_NoviceActor_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_NoviceActor_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      sleep :function _trc_NoviceActor_sleep(n) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000054;//kernel.NoviceActor:54
        if (! n) {
          //$LASTPOS=70000061;//kernel.NoviceActor:61
          n=1;
        }
        //$LASTPOS=70000071;//kernel.NoviceActor:71
        //$LASTPOS=70000075;//kernel.NoviceActor:75
        n;for (; n>0 ; n--) {
          //$LASTPOS=70000086;//kernel.NoviceActor:86
          _this.update();
        }
      },
      fiber$sleep :function _trc_NoviceActor_f_sleep(_thread,n) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=70000054;//kernel.NoviceActor:54
        if (! n) {
          //$LASTPOS=70000061;//kernel.NoviceActor:61
          n=1;
        }
        
        _thread.enter(function _trc_NoviceActor_ent_sleep(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=70000071;//kernel.NoviceActor:71
              //$LASTPOS=70000075;//kernel.NoviceActor:75
              n;
            case 1:
              if (!(n>0)) { __pc=4     ; break; }
              //$LASTPOS=70000086;//kernel.NoviceActor:86
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
            case 3     :
              n--;
              __pc=1;break;
            case 4     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initSprite :function _trc_NoviceActor_initSprite() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000121;//kernel.NoviceActor:121
        if (! _this._sprite) {
          //$LASTPOS=70000146;//kernel.NoviceActor:146
          _this._sprite=new Tonyu.classes.kernel.BaseActor({owner: _this});
          //$LASTPOS=70000217;//kernel.NoviceActor:217
          Tonyu.globals.$Sprites.add(_this);
          
        }
      },
      fiber$initSprite :function _trc_NoviceActor_f_initSprite(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=70000121;//kernel.NoviceActor:121
        if (! _this._sprite) {
          //$LASTPOS=70000146;//kernel.NoviceActor:146
          _this._sprite=new Tonyu.classes.kernel.BaseActor({owner: _this});
          //$LASTPOS=70000217;//kernel.NoviceActor:217
          Tonyu.globals.$Sprites.add(_this);
          
        }
        
        _thread.retVal=_this;return;
      },
      say :function _trc_NoviceActor_say(text,size) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000271;//kernel.NoviceActor:271
        if (! size) {
          //$LASTPOS=70000282;//kernel.NoviceActor:282
          size=15;
        }
        //$LASTPOS=70000296;//kernel.NoviceActor:296
        _this.initSprite();
        //$LASTPOS=70000315;//kernel.NoviceActor:315
        _this._sprite._fukidashi={text: text,size: size,c: 30};
      },
      fiber$say :function _trc_NoviceActor_f_say(_thread,text,size) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=70000271;//kernel.NoviceActor:271
        if (! size) {
          //$LASTPOS=70000282;//kernel.NoviceActor:282
          size=15;
        }
        
        _thread.enter(function _trc_NoviceActor_ent_say(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=70000296;//kernel.NoviceActor:296
              _this.fiber$initSprite(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=70000315;//kernel.NoviceActor:315
              _this._sprite._fukidashi={text: text,size: size,c: 30};
              _thread.exit(_this);return;
            }
          }
        });
      },
      sprite :function _trc_NoviceActor_sprite(x,y,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000390;//kernel.NoviceActor:390
        _this.go(x,y,p);
      },
      fiber$sprite :function _trc_NoviceActor_f_sprite(_thread,x,y,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_NoviceActor_ent_sprite(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=70000390;//kernel.NoviceActor:390
              _this.fiber$go(_thread, x, y, p);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      show :function _trc_NoviceActor_show(x,y,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000425;//kernel.NoviceActor:425
        _this.go(x,y,p);
      },
      draw :function _trc_NoviceActor_draw(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000465;//kernel.NoviceActor:465
        _this._sprite.draw(ctx);
      },
      getCrashRect :function _trc_NoviceActor_getCrashRect() {
        "use strict";
        var _this=this;
        
        return _this._sprite.getCrashRect();
      },
      fiber$getCrashRect :function _trc_NoviceActor_f_getCrashRect(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this._sprite.getCrashRect();return;
        
        
        _thread.retVal=_this;return;
      },
      go :function _trc_NoviceActor_go(x,y,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000564;//kernel.NoviceActor:564
        _this.initSprite();
        //$LASTPOS=70000583;//kernel.NoviceActor:583
        _this._sprite.x=x;
        //$LASTPOS=70000601;//kernel.NoviceActor:601
        _this._sprite.y=y;
        //$LASTPOS=70000619;//kernel.NoviceActor:619
        if (p!=null) {
          //$LASTPOS=70000632;//kernel.NoviceActor:632
          _this._sprite.p=p;
        }
      },
      fiber$go :function _trc_NoviceActor_f_go(_thread,x,y,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_NoviceActor_ent_go(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=70000564;//kernel.NoviceActor:564
              _this.fiber$initSprite(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=70000583;//kernel.NoviceActor:583
              _this._sprite.x=x;
              //$LASTPOS=70000601;//kernel.NoviceActor:601
              _this._sprite.y=y;
              //$LASTPOS=70000619;//kernel.NoviceActor:619
              if (p!=null) {
                //$LASTPOS=70000632;//kernel.NoviceActor:632
                _this._sprite.p=p;
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      change :function _trc_NoviceActor_change(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=70000684;//kernel.NoviceActor:684
        _this.initSprite();
        //$LASTPOS=70000703;//kernel.NoviceActor:703
        _this._sprite.p=p;
      },
      fiber$change :function _trc_NoviceActor_f_change(_thread,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_NoviceActor_ent_change(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=70000684;//kernel.NoviceActor:684
              _this.fiber$initSprite(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=70000703;//kernel.NoviceActor:703
              _this._sprite.p=p;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"sleep":{"nowait":false},"initSprite":{"nowait":false},"say":{"nowait":false},"sprite":{"nowait":false},"show":{"nowait":true},"draw":{"nowait":true},"getCrashRect":{"nowait":false},"go":{"nowait":false},"change":{"nowait":false}},"fields":{"_sprite":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Actor',
  shortName: 'Actor',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.BaseActor,
  includes: [Tonyu.classes.kernel.SpriteMod2D,Tonyu.classes.kernel.QueryMod2D,Tonyu.classes.kernel.OneframeSpriteMod],
  methods: function (__superClass) {
    return {
      main :function _trc_Actor_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=71000072;//kernel.Actor:72
        "field strict";
      },
      fiber$main :function _trc_Actor_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=71000072;//kernel.Actor:72
        "field strict";
        
        _thread.retVal=_this;return;
      },
      addSubsprite :function _trc_Actor_addSubsprite(s) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=71000115;//kernel.Actor:115
        _this.subsprites=_this.subsprites||new Tonyu.classes.kernel.Sprites({layer: _this});
        //$LASTPOS=71000187;//kernel.Actor:187
        _this.subsprites.add(s);
        //$LASTPOS=71000211;//kernel.Actor:211
        if (! s.lifeKeeper) {
          //$LASTPOS=71000230;//kernel.Actor:230
          s.lifeKeeper=_this;
        }
      },
      fiber$addSubsprite :function _trc_Actor_f_addSubsprite(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=71000115;//kernel.Actor:115
        _this.subsprites=_this.subsprites||new Tonyu.classes.kernel.Sprites({layer: _this});
        //$LASTPOS=71000187;//kernel.Actor:187
        _this.subsprites.add(s);
        //$LASTPOS=71000211;//kernel.Actor:211
        if (! s.lifeKeeper) {
          //$LASTPOS=71000230;//kernel.Actor:230
          s.lifeKeeper=_this;
        }
        
        _thread.retVal=_this;return;
      },
      findEventHandlerClass :function _trc_Actor_findEventHandlerClass(type) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=71000289;//kernel.Actor:289
        if (type==="touchstart") {
          return Tonyu.classes.kernel.ActorTouchStart;
        }
        return __superClass.prototype.findEventHandlerClass.apply( _this, [type]);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"addSubsprite":{"nowait":false},"findEventHandlerClass":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.Actor3D',
  shortName: 'Actor3D',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.BaseActor,
  includes: [Tonyu.classes.kernel.SpriteMod3D,Tonyu.classes.kernel.QueryMod3D],
  methods: function (__superClass) {
    return {
      main :function _trc_Actor3D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=72000054;//kernel.Actor3D:54
        "field strict";
        
      },
      fiber$main :function _trc_Actor3D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=72000054;//kernel.Actor3D:54
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Actor3D_initialize(params) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=72000124;//kernel.Actor3D:124
        Tonyu.extend(_this,params);
        //$LASTPOS=72000156;//kernel.Actor3D:156
        _this.initSchedulerMod();
        //$LASTPOS=72000181;//kernel.Actor3D:181
        _this.layer=_this.layer||_this.defaultLayer;
        //$LASTPOS=72000348;//kernel.Actor3D:348
        _this.crashScale=1;
        //$LASTPOS=72000367;//kernel.Actor3D:367
        _this.initSpriteMod();
        //$LASTPOS=72000654;//kernel.Actor3D:654
        if (Tonyu.runMode) {
          //$LASTPOS=72000673;//kernel.Actor3D:673
          _this.addToLayer();
        }
        //$LASTPOS=72000692;//kernel.Actor3D:692
        _this.initAnimMod();
      },
      rotate :function _trc_Actor3D_rotate(axis,angle) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=72001923;//kernel.Actor3D:1923
        _this.direction.rotate(axis,angle);
        return _this;
      },
      fiber$rotate :function _trc_Actor3D_f_rotate(_thread,axis,angle) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=72001923;//kernel.Actor3D:1923
        _this.direction.rotate(axis,angle);
        _thread.retVal=_this;return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__defaultLayer :function _trc_Actor3D___getter__defaultLayer() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$mainLayer3D;
      },
      dist :function _trc_Actor3D_dist(dx,dy,dz) {
        "use strict";
        var _this=this;
        var t;
        
        //$LASTPOS=72000877;//kernel.Actor3D:877
        if (typeof  dx=="object") {
          //$LASTPOS=72000913;//kernel.Actor3D:913
          t = dx;
          
          //$LASTPOS=72000932;//kernel.Actor3D:932
          dx=t.x-_this.x;
          //$LASTPOS=72000941;//kernel.Actor3D:941
          dy=t.y-_this.y;
          //$LASTPOS=72000950;//kernel.Actor3D:950
          dz=t.z-_this.z;
          
        }
        //$LASTPOS=72000972;//kernel.Actor3D:972
        dz=dz||0;
        return _this.sqrt(dx*dx+dy*dy+dz*dz);
      },
      addSubsprite :function _trc_Actor3D_addSubsprite(s) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=72001049;//kernel.Actor3D:1049
        _this.subsprites=_this.subsprites||new Tonyu.classes.kernel.Sprites3D({layer: _this,transform: _this.transform});
        //$LASTPOS=72001114;//kernel.Actor3D:1114
        _this.subsprites.add(s);
        //$LASTPOS=72001138;//kernel.Actor3D:1138
        if (! s.lifeKeeper) {
          //$LASTPOS=72001157;//kernel.Actor3D:1157
          s.lifeKeeper=_this;
        }
      },
      fiber$addSubsprite :function _trc_Actor3D_f_addSubsprite(_thread,s) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=72001049;//kernel.Actor3D:1049
        _this.subsprites=_this.subsprites||new Tonyu.classes.kernel.Sprites3D({layer: _this,transform: _this.transform});
        //$LASTPOS=72001114;//kernel.Actor3D:1114
        _this.subsprites.add(s);
        //$LASTPOS=72001138;//kernel.Actor3D:1138
        if (! s.lifeKeeper) {
          //$LASTPOS=72001157;//kernel.Actor3D:1157
          s.lifeKeeper=_this;
        }
        
        _thread.retVal=_this;return;
      },
      localToWorld :function _trc_Actor3D_localToWorld(fru) {
        "use strict";
        var _this=this;
        var res;
        var name;
        var k;
        var _it_613;
        var vec;
        
        //$LASTPOS=72001593;//kernel.Actor3D:1593
        res = _this.position.clone();
        
        //$LASTPOS=72001624;//kernel.Actor3D:1624
        _it_613=Tonyu.iterator(fru,2);
        while(_it_613.next()) {
          name=_it_613[0];
          k=_it_613[1];
          
          //$LASTPOS=72001659;//kernel.Actor3D:1659
          vec = _this.direction[name];
          
          //$LASTPOS=72001693;//kernel.Actor3D:1693
          if (vec&&vec.mul) {
            //$LASTPOS=72001713;//kernel.Actor3D:1713
            res.addX_v(vec.mul(k));
          }
          
        }
        return res;
      },
      fiber$localToWorld :function _trc_Actor3D_f_localToWorld(_thread,fru) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var name;
        var k;
        var _it_613;
        var vec;
        
        //$LASTPOS=72001593;//kernel.Actor3D:1593
        res = _this.position.clone();
        
        //$LASTPOS=72001624;//kernel.Actor3D:1624
        _it_613=Tonyu.iterator(fru,2);
        while(_it_613.next()) {
          name=_it_613[0];
          k=_it_613[1];
          
          //$LASTPOS=72001659;//kernel.Actor3D:1659
          vec = _this.direction[name];
          
          //$LASTPOS=72001693;//kernel.Actor3D:1693
          if (vec&&vec.mul) {
            //$LASTPOS=72001713;//kernel.Actor3D:1713
            res.addX_v(vec.mul(k));
          }
          
        }
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      moveBy :function _trc_Actor3D_moveBy(by) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=72001784;//kernel.Actor3D:1784
        if (typeof  by==="number") {
          return _this.moveBy({forward: by});
        }
        //$LASTPOS=72001842;//kernel.Actor3D:1842
        _this.position.set(_this.localToWorld(by));
        return _this;
      },
      fiber$moveBy :function _trc_Actor3D_f_moveBy(_thread,by) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Actor3D_ent_moveBy(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=72001784;//kernel.Actor3D:1784
              if (!(typeof  by==="number")) { __pc=2     ; break; }
              _this.fiber$moveBy(_thread, {forward: by});
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
            case 2     :
              
              //$LASTPOS=72001842;//kernel.Actor3D:1842
              _this.position.set(_this.localToWorld(by));
              _thread.exit(_this);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"rotate":{"nowait":false},"__getter__defaultLayer":{"nowait":true},"dist":{"nowait":true},"addSubsprite":{"nowait":false},"localToWorld":{"nowait":false},"moveBy":{"nowait":false}},"fields":{"z":{},"direction":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Camera3D',
  shortName: 'Camera3D',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor3D,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Camera3D_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=73000035;//kernel.Camera3D:35
        "field strict";
        
      },
      fiber$main :function _trc_Camera3D_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=73000035;//kernel.Camera3D:35
        "field strict";
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Camera3D_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=73000223;//kernel.Camera3D:223
        __superClass.apply( _this, [p]);
        //$LASTPOS=73000303;//kernel.Camera3D:303
        _this.z1=_this.z1||Tonyu.globals.$screenWidth/2;
        //$LASTPOS=73000331;//kernel.Camera3D:331
        _this.z=- _this.z1;
      },
      to2D :function _trc_Camera3D_to2D(pos) {
        "use strict";
        var _this=this;
        var c;
        var x;
        var y;
        var z;
        
        //$LASTPOS=73000365;//kernel.Camera3D:365
        c = pos;
        
        //$LASTPOS=73000381;//kernel.Camera3D:381
        x = c.x;
        
        //$LASTPOS=73000397;//kernel.Camera3D:397
        y = c.y;
        
        //$LASTPOS=73000413;//kernel.Camera3D:413
        z = c.z;
        
        //$LASTPOS=73000429;//kernel.Camera3D:429
        if (z<=0) {
          return null;
        }
        //$LASTPOS=73000457;//kernel.Camera3D:457
        x=x*_this.z1/z;
        //$LASTPOS=73000479;//kernel.Camera3D:479
        y=y*_this.z1/z;
        return {x: x,y: y,z: z,scale: _this.z1/z};
      },
      fiber$to2D :function _trc_Camera3D_f_to2D(_thread,pos) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var c;
        var x;
        var y;
        var z;
        
        //$LASTPOS=73000365;//kernel.Camera3D:365
        c = pos;
        
        //$LASTPOS=73000381;//kernel.Camera3D:381
        x = c.x;
        
        //$LASTPOS=73000397;//kernel.Camera3D:397
        y = c.y;
        
        //$LASTPOS=73000413;//kernel.Camera3D:413
        z = c.z;
        
        //$LASTPOS=73000429;//kernel.Camera3D:429
        if (z<=0) {
          _thread.retVal=null;return;
          
        }
        //$LASTPOS=73000457;//kernel.Camera3D:457
        x=x*_this.z1/z;
        //$LASTPOS=73000479;//kernel.Camera3D:479
        y=y*_this.z1/z;
        _thread.retVal={x: x,y: y,z: z,scale: _this.z1/z};return;
        
        
        _thread.retVal=_this;return;
      },
      draw3D :function _trc_Camera3D_draw3D(ctx3d) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=73000554;//kernel.Camera3D:554
        if (ctx3d.camera===_this) {
          return _this;
        }
        //$LASTPOS=73000642;//kernel.Camera3D:642
        __superClass.prototype.draw3D.apply( _this, [ctx3d]);
      },
      fiber$draw3D :function _trc_Camera3D_f_draw3D(_thread,ctx3d) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=73000554;//kernel.Camera3D:554
        if (ctx3d.camera===_this) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_Camera3D_ent_draw3D(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=73000642;//kernel.Camera3D:642
              __superClass.prototype.fiber$draw3D.apply( _this, [_thread, ctx3d]);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      goBehind :function _trc_Camera3D_goBehind(target,dist) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=73000698;//kernel.Camera3D:698
        if (! dist) {
          //$LASTPOS=73000709;//kernel.Camera3D:709
          dist=_this.z1;
        }
        //$LASTPOS=73000723;//kernel.Camera3D:723
        _this.position.set(target.position.sub(target.direction.forward.mul(dist)));
        //$LASTPOS=73000799;//kernel.Camera3D:799
        _this.direction.set(target.direction);
      },
      fiber$goBehind :function _trc_Camera3D_f_goBehind(_thread,target,dist) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=73000698;//kernel.Camera3D:698
        if (! dist) {
          //$LASTPOS=73000709;//kernel.Camera3D:709
          dist=_this.z1;
        }
        //$LASTPOS=73000723;//kernel.Camera3D:723
        _this.position.set(target.position.sub(target.direction.forward.mul(dist)));
        //$LASTPOS=73000799;//kernel.Camera3D:799
        _this.direction.set(target.direction);
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"to2D":{"nowait":false},"draw3D":{"nowait":false},"goBehind":{"nowait":false}},"fields":{"z1":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.GameScreen',
  shortName: 'GameScreen',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_GameScreen_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_GameScreen_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_GameScreen_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=74000113;//kernel.GameScreen:113
        _this.extend(opt);
        //$LASTPOS=74000131;//kernel.GameScreen:131
        _this.resize(_this.width,_this.height);
        //$LASTPOS=74000159;//kernel.GameScreen:159
        _this.bgColor="rgb(20,80,180)";
        //$LASTPOS=74000195;//kernel.GameScreen:195
        _this.isDrawGrid=Tonyu.globals.$Sprites.isDrawGrid;
      },
      resize :function _trc_GameScreen_resize(width,height) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=74000260;//kernel.GameScreen:260
        _this.width=width;
        //$LASTPOS=74000283;//kernel.GameScreen:283
        _this.height=height;
        //$LASTPOS=74000308;//kernel.GameScreen:308
        _this.buf=$("<canvas>").attr({width: width,height: height});
        //$LASTPOS=74000351;//kernel.GameScreen:351
        _this.ctx=_this.buf[0].getContext("2d");
        //$LASTPOS=74000385;//kernel.GameScreen:385
        _this.fireEvent("resize",width,height);
      },
      fiber$resize :function _trc_GameScreen_f_resize(_thread,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=74000260;//kernel.GameScreen:260
        _this.width=width;
        //$LASTPOS=74000283;//kernel.GameScreen:283
        _this.height=height;
        //$LASTPOS=74000308;//kernel.GameScreen:308
        _this.buf=$("<canvas>").attr({width: width,height: height});
        //$LASTPOS=74000351;//kernel.GameScreen:351
        _this.ctx=_this.buf[0].getContext("2d");
        //$LASTPOS=74000385;//kernel.GameScreen:385
        _this.fireEvent("resize",width,height);
        
        _thread.retVal=_this;return;
      },
      setBounds :function _trc_GameScreen_setBounds(b) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=74000620;//kernel.GameScreen:620
        _this.bounds=b;
      },
      fiber$setBounds :function _trc_GameScreen_f_setBounds(_thread,b) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=74000620;//kernel.GameScreen:620
        _this.bounds=b;
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_GameScreen_draw(cctx) {
        "use strict";
        var _this=this;
        var b;
        
        //$LASTPOS=74000653;//kernel.GameScreen:653
        b = _this.bounds;
        
        //$LASTPOS=74000672;//kernel.GameScreen:672
        _this.fillCanvas();
        //$LASTPOS=74000691;//kernel.GameScreen:691
        _this.sprites.draw(_this.buf[0]);
        //$LASTPOS=74000718;//kernel.GameScreen:718
        cctx.drawImage(_this.buf[0],0,0,_this.width,_this.height,b.left,b.top,b.width,b.height);
      },
      canvas2buf :function _trc_GameScreen_canvas2buf(point) {
        "use strict";
        var _this=this;
        var b;
        
        //$LASTPOS=74000856;//kernel.GameScreen:856
        b = _this.bounds;
        
        //$LASTPOS=74000875;//kernel.GameScreen:875
        if (! b) {
          return point;
        }
        return {x: (point.x-b.left)/b.width*_this.width,y: (point.y-b.top)/b.height*_this.height};
      },
      fiber$canvas2buf :function _trc_GameScreen_f_canvas2buf(_thread,point) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var b;
        
        //$LASTPOS=74000856;//kernel.GameScreen:856
        b = _this.bounds;
        
        //$LASTPOS=74000875;//kernel.GameScreen:875
        if (! b) {
          _thread.retVal=point;return;
          
        }
        _thread.retVal={x: (point.x-b.left)/b.width*_this.width,y: (point.y-b.top)/b.height*_this.height};return;
        
        
        _thread.retVal=_this;return;
      },
      setBGColor :function _trc_GameScreen_setBGColor(c) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=74001012;//kernel.GameScreen:1012
        _this.bgColor=c;
      },
      fiber$setBGColor :function _trc_GameScreen_f_setBGColor(_thread,c) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=74001012;//kernel.GameScreen:1012
        _this.bgColor=c;
        
        _thread.retVal=_this;return;
      },
      fillCanvas :function _trc_GameScreen_fillCanvas() {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=74001052;//kernel.GameScreen:1052
        ctx = _this.buf[0].getContext("2d");
        
        //$LASTPOS=74001090;//kernel.GameScreen:1090
        ctx.save();
        //$LASTPOS=74001107;//kernel.GameScreen:1107
        ctx.fillStyle=_this.bgColor+"";
        //$LASTPOS=74001138;//kernel.GameScreen:1138
        ctx.fillRect(0,0,_this.width,_this.height);
        //$LASTPOS=74001212;//kernel.GameScreen:1212
        ctx.restore();
      },
      fiber$fillCanvas :function _trc_GameScreen_f_fillCanvas(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        //$LASTPOS=74001052;//kernel.GameScreen:1052
        ctx = _this.buf[0].getContext("2d");
        
        //$LASTPOS=74001090;//kernel.GameScreen:1090
        ctx.save();
        //$LASTPOS=74001107;//kernel.GameScreen:1107
        ctx.fillStyle=_this.bgColor+"";
        //$LASTPOS=74001138;//kernel.GameScreen:1138
        ctx.fillRect(0,0,_this.width,_this.height);
        //$LASTPOS=74001212;//kernel.GameScreen:1212
        ctx.restore();
        
        _thread.retVal=_this;return;
      },
      scrollTo :function _trc_GameScreen_scrollTo(scrollX,scrollY) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=74001264;//kernel.GameScreen:1264
        _this.sprites.scrollTo(scrollX,scrollY);
      },
      fiber$scrollTo :function _trc_GameScreen_f_scrollTo(_thread,scrollX,scrollY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=74001264;//kernel.GameScreen:1264
        _this.sprites.scrollTo(scrollX,scrollY);
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"resize":{"nowait":false},"setBounds":{"nowait":false},"draw":{"nowait":true},"canvas2buf":{"nowait":false},"setBGColor":{"nowait":false},"fillCanvas":{"nowait":false},"scrollTo":{"nowait":false}},"fields":{"isDrawGrid":{},"buf":{},"ctx":{},"bounds":{},"sprites":{},"bgColor":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Map',
  shortName: 'Map',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Map_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Map_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Map_initialize(param) {
        "use strict";
        var _this=this;
        var j;
        var i;
        
        //$LASTPOS=75000077;//kernel.Map:77
        _this.sx=0;
        //$LASTPOS=75000088;//kernel.Map:88
        _this.sy=0;
        //$LASTPOS=75000099;//kernel.Map:99
        _this.alpha=255;
        //$LASTPOS=75000115;//kernel.Map:115
        __superClass.apply( _this, [param]);
        //$LASTPOS=75000134;//kernel.Map:134
        _this.chipWidth=_this.chipWidth||32;
        //$LASTPOS=75000164;//kernel.Map:164
        _this.chipHeight=_this.chipHeight||_this.chipWidth||32;
        //$LASTPOS=75000207;//kernel.Map:207
        if (typeof  _this.col!=="number") {
          //$LASTPOS=75000234;//kernel.Map:234
          _this.col=Tonyu.globals.$screenWidth/_this.chipWidth;
        }
        //$LASTPOS=75000267;//kernel.Map:267
        if (typeof  _this.row!=="number") {
          //$LASTPOS=75000294;//kernel.Map:294
          _this.row=Tonyu.globals.$screenHeight/_this.chipHeight;
        }
        //$LASTPOS=75000329;//kernel.Map:329
        _this.col=_this.floor(_this.col);
        //$LASTPOS=75000344;//kernel.Map:344
        _this.row=_this.floor(_this.row);
        //$LASTPOS=75000365;//kernel.Map:365
        _this.buf=$("<canvas>").attr({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
        //$LASTPOS=75000437;//kernel.Map:437
        _this.mapObj=true;
        //$LASTPOS=75000455;//kernel.Map:455
        _this.mapTable=[];
        //$LASTPOS=75000475;//kernel.Map:475
        _this.mapOnTable=[];
        //$LASTPOS=75000497;//kernel.Map:497
        //$LASTPOS=75000501;//kernel.Map:501
        j = 0;
        for (; j<_this.row ; j++) {
          {
            //$LASTPOS=75000530;//kernel.Map:530
            _this.rows=[];
            //$LASTPOS=75000550;//kernel.Map:550
            //$LASTPOS=75000554;//kernel.Map:554
            i = 0;
            for (; i<_this.col ; i++) {
              {
                //$LASTPOS=75000587;//kernel.Map:587
                _this.rows.push(- 1);
              }
            }
            //$LASTPOS=75000622;//kernel.Map:622
            _this.mapTable.push(_this.rows);
          }
        }
        //$LASTPOS=75000655;//kernel.Map:655
        //$LASTPOS=75000659;//kernel.Map:659
        j = 0;
        for (; j<_this.row ; j++) {
          {
            //$LASTPOS=75000688;//kernel.Map:688
            _this.rows=[];
            //$LASTPOS=75000708;//kernel.Map:708
            //$LASTPOS=75000712;//kernel.Map:712
            i = 0;
            for (; i<_this.col ; i++) {
              {
                //$LASTPOS=75000745;//kernel.Map:745
                _this.rows.push(- 1);
              }
            }
            //$LASTPOS=75000780;//kernel.Map:780
            _this.mapOnTable.push(_this.rows);
          }
        }
        //$LASTPOS=75000880;//kernel.Map:880
        _this.initMap();
      },
      initMap :function _trc_Map_initMap() {
        "use strict";
        var _this=this;
        var i;
        var j;
        
        //$LASTPOS=75000912;//kernel.Map:912
        if (! _this.mapData) {
          return _this;
        }
        //$LASTPOS=75000938;//kernel.Map:938
        //$LASTPOS=75000942;//kernel.Map:942
        i = 0;
        for (; i<_this.row ; i++) {
          {
            //$LASTPOS=75000971;//kernel.Map:971
            //$LASTPOS=75000975;//kernel.Map:975
            j = 0;
            for (; j<_this.col ; j++) {
              {
                //$LASTPOS=75001008;//kernel.Map:1008
                _this.set(j,i,_this.mapData[i][j]);
              }
            }
          }
        }
        //$LASTPOS=75001055;//kernel.Map:1055
        if (! _this.mapOnData) {
          return _this;
        }
        //$LASTPOS=75001083;//kernel.Map:1083
        //$LASTPOS=75001087;//kernel.Map:1087
        i = 0;
        for (; i<_this.row ; i++) {
          {
            //$LASTPOS=75001116;//kernel.Map:1116
            //$LASTPOS=75001120;//kernel.Map:1120
            j = 0;
            for (; j<_this.col ; j++) {
              {
                //$LASTPOS=75001153;//kernel.Map:1153
                _this.setOn(j,i,_this.mapOnData[i][j]);
              }
            }
          }
        }
      },
      fiber$initMap :function _trc_Map_f_initMap(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        var j;
        
        //$LASTPOS=75000912;//kernel.Map:912
        if (! _this.mapData) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_Map_ent_initMap(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=75000938;//kernel.Map:938
              //$LASTPOS=75000942;//kernel.Map:942
              i = 0;
              
            case 1:
              if (!(i<_this.row)) { __pc=7     ; break; }
              //$LASTPOS=75000971;//kernel.Map:971
              //$LASTPOS=75000975;//kernel.Map:975
              j = 0;
              
            case 2:
              if (!(j<_this.col)) { __pc=5     ; break; }
              //$LASTPOS=75001008;//kernel.Map:1008
              _this.fiber$set(_thread, j, i, _this.mapData[i][j]);
              __pc=3;return;
            case 3:
              
            case 4     :
              j++;
              __pc=2;break;
            case 5     :
              
            case 6     :
              i++;
              __pc=1;break;
            case 7     :
              
              //$LASTPOS=75001055;//kernel.Map:1055
              if (!(! _this.mapOnData)) { __pc=8     ; break; }
              _thread.exit(_this);return;
            case 8     :
              
              //$LASTPOS=75001083;//kernel.Map:1083
              //$LASTPOS=75001087;//kernel.Map:1087
              i = 0;
              
            case 9:
              if (!(i<_this.row)) { __pc=15    ; break; }
              //$LASTPOS=75001116;//kernel.Map:1116
              //$LASTPOS=75001120;//kernel.Map:1120
              j = 0;
              
            case 10:
              if (!(j<_this.col)) { __pc=13    ; break; }
              //$LASTPOS=75001153;//kernel.Map:1153
              _this.fiber$setOn(_thread, j, i, _this.mapOnData[i][j]);
              __pc=11;return;
            case 11:
              
            case 12    :
              j++;
              __pc=10;break;
            case 13    :
              
            case 14    :
              i++;
              __pc=9;break;
            case 15    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      redrawMap :function _trc_Map_redrawMap() {
        "use strict";
        var _this=this;
        
        return _this.redraw();
      },
      fiber$redrawMap :function _trc_Map_f_redrawMap(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Map_ent_redrawMap(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$redraw(_thread);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      redraw :function _trc_Map_redraw() {
        "use strict";
        var _this=this;
        var i;
        var j;
        
        //$LASTPOS=75001260;//kernel.Map:1260
        if (! _this.mapTable) {
          return _this;
        }
        //$LASTPOS=75001287;//kernel.Map:1287
        _this.buf=$("<canvas>").attr({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
        //$LASTPOS=75001359;//kernel.Map:1359
        //$LASTPOS=75001363;//kernel.Map:1363
        i = 0;
        for (; i<_this.row ; i++) {
          {
            //$LASTPOS=75001392;//kernel.Map:1392
            //$LASTPOS=75001396;//kernel.Map:1396
            j = 0;
            for (; j<_this.col ; j++) {
              {
                //$LASTPOS=75001429;//kernel.Map:1429
                _this.set(j,i,_this.mapTable[i][j]);
              }
            }
          }
        }
        //$LASTPOS=75001477;//kernel.Map:1477
        if (! _this.mapOnTable) {
          return _this;
        }
        //$LASTPOS=75001506;//kernel.Map:1506
        //$LASTPOS=75001510;//kernel.Map:1510
        i = 0;
        for (; i<_this.row ; i++) {
          {
            //$LASTPOS=75001539;//kernel.Map:1539
            //$LASTPOS=75001543;//kernel.Map:1543
            j = 0;
            for (; j<_this.col ; j++) {
              {
                //$LASTPOS=75001576;//kernel.Map:1576
                _this.setOn(j,i,_this.mapOnTable[i][j]);
              }
            }
          }
        }
      },
      fiber$redraw :function _trc_Map_f_redraw(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        var j;
        
        //$LASTPOS=75001260;//kernel.Map:1260
        if (! _this.mapTable) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=75001287;//kernel.Map:1287
        _this.buf=$("<canvas>").attr({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
        
        _thread.enter(function _trc_Map_ent_redraw(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=75001359;//kernel.Map:1359
              //$LASTPOS=75001363;//kernel.Map:1363
              i = 0;
              
            case 1:
              if (!(i<_this.row)) { __pc=7     ; break; }
              //$LASTPOS=75001392;//kernel.Map:1392
              //$LASTPOS=75001396;//kernel.Map:1396
              j = 0;
              
            case 2:
              if (!(j<_this.col)) { __pc=5     ; break; }
              //$LASTPOS=75001429;//kernel.Map:1429
              _this.fiber$set(_thread, j, i, _this.mapTable[i][j]);
              __pc=3;return;
            case 3:
              
            case 4     :
              j++;
              __pc=2;break;
            case 5     :
              
            case 6     :
              i++;
              __pc=1;break;
            case 7     :
              
              //$LASTPOS=75001477;//kernel.Map:1477
              if (!(! _this.mapOnTable)) { __pc=8     ; break; }
              _thread.exit(_this);return;
            case 8     :
              
              //$LASTPOS=75001506;//kernel.Map:1506
              //$LASTPOS=75001510;//kernel.Map:1510
              i = 0;
              
            case 9:
              if (!(i<_this.row)) { __pc=15    ; break; }
              //$LASTPOS=75001539;//kernel.Map:1539
              //$LASTPOS=75001543;//kernel.Map:1543
              j = 0;
              
            case 10:
              if (!(j<_this.col)) { __pc=13    ; break; }
              //$LASTPOS=75001576;//kernel.Map:1576
              _this.fiber$setOn(_thread, j, i, _this.mapOnTable[i][j]);
              __pc=11;return;
            case 11:
              
            case 12    :
              j++;
              __pc=10;break;
            case 13    :
              
            case 14    :
              i++;
              __pc=9;break;
            case 15    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      load :function _trc_Map_load(dataFile) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75001651;//kernel.Map:1651
        _this.baseData=_this.file("../maps/").rel(dataFile).obj();
        //$LASTPOS=75001703;//kernel.Map:1703
        if (! _this.baseData) {
          //$LASTPOS=75001717;//kernel.Map:1717
          _this.baseData=_this.file(dataFile).obj();
        }
        //$LASTPOS=75001753;//kernel.Map:1753
        _this.mapTable=_this.baseData[0];
        //$LASTPOS=75001780;//kernel.Map:1780
        _this.mapData=_this.mapTable;
        //$LASTPOS=75001803;//kernel.Map:1803
        _this.row=_this.mapTable.length;
        //$LASTPOS=75001829;//kernel.Map:1829
        _this.col=_this.mapTable[0].length;
        //$LASTPOS=75001858;//kernel.Map:1858
        _this.mapOnTable=_this.baseData[1];
        //$LASTPOS=75001887;//kernel.Map:1887
        _this.mapOnData=_this.mapOnTable;
        //$LASTPOS=75001914;//kernel.Map:1914
        if (typeof  _this.baseData[2]=="number") {
          //$LASTPOS=75001948;//kernel.Map:1948
          _this.chipWidth=_this.baseData[2];
        }
        //$LASTPOS=75001976;//kernel.Map:1976
        if (typeof  _this.baseData[3]=="number") {
          //$LASTPOS=75002010;//kernel.Map:2010
          _this.chipHeight=_this.baseData[3];
        }
        //$LASTPOS=75002039;//kernel.Map:2039
        _this.buf=$("<canvas>").attr({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
        //$LASTPOS=75002111;//kernel.Map:2111
        _this.initMap();
      },
      fiber$load :function _trc_Map_f_load(_thread,dataFile) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=75001651;//kernel.Map:1651
        _this.baseData=_this.file("../maps/").rel(dataFile).obj();
        //$LASTPOS=75001703;//kernel.Map:1703
        if (! _this.baseData) {
          //$LASTPOS=75001717;//kernel.Map:1717
          _this.baseData=_this.file(dataFile).obj();
        }
        //$LASTPOS=75001753;//kernel.Map:1753
        _this.mapTable=_this.baseData[0];
        //$LASTPOS=75001780;//kernel.Map:1780
        _this.mapData=_this.mapTable;
        //$LASTPOS=75001803;//kernel.Map:1803
        _this.row=_this.mapTable.length;
        //$LASTPOS=75001829;//kernel.Map:1829
        _this.col=_this.mapTable[0].length;
        //$LASTPOS=75001858;//kernel.Map:1858
        _this.mapOnTable=_this.baseData[1];
        //$LASTPOS=75001887;//kernel.Map:1887
        _this.mapOnData=_this.mapOnTable;
        //$LASTPOS=75001914;//kernel.Map:1914
        if (typeof  _this.baseData[2]=="number") {
          //$LASTPOS=75001948;//kernel.Map:1948
          _this.chipWidth=_this.baseData[2];
        }
        //$LASTPOS=75001976;//kernel.Map:1976
        if (typeof  _this.baseData[3]=="number") {
          //$LASTPOS=75002010;//kernel.Map:2010
          _this.chipHeight=_this.baseData[3];
        }
        //$LASTPOS=75002039;//kernel.Map:2039
        _this.buf=$("<canvas>").attr({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
        
        _thread.enter(function _trc_Map_ent_load(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=75002111;//kernel.Map:2111
              _this.fiber$initMap(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      save :function _trc_Map_save(saveFileName) {
        "use strict";
        var _this=this;
        var saveDataFile;
        var data;
        
        //$LASTPOS=75002153;//kernel.Map:2153
        saveDataFile = _this.file("../maps/").rel(saveFileName);
        
        //$LASTPOS=75002211;//kernel.Map:2211
        data = [_this.mapTable,_this.mapOnTable,_this.chipWidth,_this.chipHeight];
        
        //$LASTPOS=75002269;//kernel.Map:2269
        saveDataFile.obj(data);
      },
      fiber$save :function _trc_Map_f_save(_thread,saveFileName) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var saveDataFile;
        var data;
        
        //$LASTPOS=75002153;//kernel.Map:2153
        saveDataFile = _this.file("../maps/").rel(saveFileName);
        
        //$LASTPOS=75002211;//kernel.Map:2211
        data = [_this.mapTable,_this.mapOnTable,_this.chipWidth,_this.chipHeight];
        
        //$LASTPOS=75002269;//kernel.Map:2269
        saveDataFile.obj(data);
        
        _thread.retVal=_this;return;
      },
      set :function _trc_Map_set(setCol,setRow,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75002325;//kernel.Map:2325
        if (setCol>=_this.col||setRow>=_this.row||setCol<0||setRow<0) {
          return _this;
        }
        //$LASTPOS=75002393;//kernel.Map:2393
        _this.mapTable[setRow][setCol]=p;
        //$LASTPOS=75002464;//kernel.Map:2464
        _this.ctx=_this.buf[0].getContext("2d");
        //$LASTPOS=75002498;//kernel.Map:2498
        p=Math.floor(p);
        //$LASTPOS=75002520;//kernel.Map:2520
        _this.pImg=Tonyu.globals.$imageList[p];
        //$LASTPOS=75002545;//kernel.Map:2545
        if (! _this.pImg) {
          //$LASTPOS=75002567;//kernel.Map:2567
          _this.ctx.clearRect(setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
          return _this;
          
        }
        //$LASTPOS=75002668;//kernel.Map:2668
        _this.ctx.clearRect(setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
        //$LASTPOS=75002745;//kernel.Map:2745
        _this.ctx.save();
        //$LASTPOS=75002916;//kernel.Map:2916
        _this.ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
        //$LASTPOS=75003060;//kernel.Map:3060
        _this.ctx.restore();
      },
      fiber$set :function _trc_Map_f_set(_thread,setCol,setRow,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=75002325;//kernel.Map:2325
        if (setCol>=_this.col||setRow>=_this.row||setCol<0||setRow<0) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=75002393;//kernel.Map:2393
        _this.mapTable[setRow][setCol]=p;
        //$LASTPOS=75002464;//kernel.Map:2464
        _this.ctx=_this.buf[0].getContext("2d");
        //$LASTPOS=75002498;//kernel.Map:2498
        p=Math.floor(p);
        //$LASTPOS=75002520;//kernel.Map:2520
        _this.pImg=Tonyu.globals.$imageList[p];
        //$LASTPOS=75002545;//kernel.Map:2545
        if (! _this.pImg) {
          //$LASTPOS=75002567;//kernel.Map:2567
          _this.ctx.clearRect(setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
          _thread.retVal=_this;return;
          
          
        }
        //$LASTPOS=75002668;//kernel.Map:2668
        _this.ctx.clearRect(setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
        //$LASTPOS=75002745;//kernel.Map:2745
        _this.ctx.save();
        //$LASTPOS=75002916;//kernel.Map:2916
        _this.ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
        //$LASTPOS=75003060;//kernel.Map:3060
        _this.ctx.restore();
        
        _thread.retVal=_this;return;
      },
      setOn :function _trc_Map_setOn(setCol,setRow,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75003109;//kernel.Map:3109
        if (setCol>=_this.col||setRow>=_this.row||setCol<0||setRow<0) {
          return _this;
        }
        //$LASTPOS=75003177;//kernel.Map:3177
        _this.set(setCol,setRow,_this.mapTable[setRow][setCol]);
        //$LASTPOS=75003227;//kernel.Map:3227
        _this.mapOnTable[setRow][setCol]=p;
        //$LASTPOS=75003262;//kernel.Map:3262
        _this.ctx=_this.buf[0].getContext("2d");
        //$LASTPOS=75003296;//kernel.Map:3296
        p=Math.floor(p);
        //$LASTPOS=75003318;//kernel.Map:3318
        _this.pImg=Tonyu.globals.$imageList[p];
        //$LASTPOS=75003343;//kernel.Map:3343
        if (! _this.pImg) {
          return _this;
        }
        //$LASTPOS=75003367;//kernel.Map:3367
        _this.ctx.save();
        //$LASTPOS=75003384;//kernel.Map:3384
        _this.ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
        //$LASTPOS=75003528;//kernel.Map:3528
        _this.ctx.restore();
      },
      fiber$setOn :function _trc_Map_f_setOn(_thread,setCol,setRow,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=75003109;//kernel.Map:3109
        if (setCol>=_this.col||setRow>=_this.row||setCol<0||setRow<0) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_Map_ent_setOn(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=75003177;//kernel.Map:3177
              _this.fiber$set(_thread, setCol, setRow, _this.mapTable[setRow][setCol]);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=75003227;//kernel.Map:3227
              _this.mapOnTable[setRow][setCol]=p;
              //$LASTPOS=75003262;//kernel.Map:3262
              _this.ctx=_this.buf[0].getContext("2d");
              //$LASTPOS=75003296;//kernel.Map:3296
              p=Math.floor(p);
              //$LASTPOS=75003318;//kernel.Map:3318
              _this.pImg=Tonyu.globals.$imageList[p];
              //$LASTPOS=75003343;//kernel.Map:3343
              if (!(! _this.pImg)) { __pc=2     ; break; }
              _thread.exit(_this);return;
            case 2     :
              
              //$LASTPOS=75003367;//kernel.Map:3367
              _this.ctx.save();
              //$LASTPOS=75003384;//kernel.Map:3384
              _this.ctx.drawImage(_this.pImg.image,_this.pImg.x,_this.pImg.y,_this.pImg.width,_this.pImg.height,setCol*_this.chipWidth,setRow*_this.chipHeight,_this.chipWidth,_this.chipHeight);
              //$LASTPOS=75003528;//kernel.Map:3528
              _this.ctx.restore();
              _thread.exit(_this);return;
            }
          }
        });
      },
      setOnAt :function _trc_Map_setOnAt(setX,setY,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75003575;//kernel.Map:3575
        _this.setOn(Math.floor((setX-_this.sx)/_this.chipWidth),Math.floor((setY-_this.sy)/_this.chipHeight),p);
      },
      fiber$setOnAt :function _trc_Map_f_setOnAt(_thread,setX,setY,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Map_ent_setOnAt(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=75003575;//kernel.Map:3575
              _this.fiber$setOn(_thread, Math.floor((setX-_this.sx)/_this.chipWidth), Math.floor((setY-_this.sy)/_this.chipHeight), p);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      setAt :function _trc_Map_setAt(setX,setY,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75003680;//kernel.Map:3680
        _this.set(Math.floor((setX-_this.sx)/_this.chipWidth),Math.floor((setY-_this.sy)/_this.chipHeight),p);
      },
      fiber$setAt :function _trc_Map_f_setAt(_thread,setX,setY,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Map_ent_setAt(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=75003680;//kernel.Map:3680
              _this.fiber$set(_thread, Math.floor((setX-_this.sx)/_this.chipWidth), Math.floor((setY-_this.sy)/_this.chipHeight), p);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      get :function _trc_Map_get(getCol,getRow) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75003783;//kernel.Map:3783
        if (getCol<_this.col&&getRow<_this.row&&getCol>=0&&getRow>=0) {
          return _this.mapTable[getRow][getCol];
        }
        return - 1;
      },
      fiber$get :function _trc_Map_f_get(_thread,getCol,getRow) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=75003783;//kernel.Map:3783
        if (getCol<_this.col&&getRow<_this.row&&getCol>=0&&getRow>=0) {
          _thread.retVal=_this.mapTable[getRow][getCol];return;
          
        }
        _thread.retVal=- 1;return;
        
        
        _thread.retVal=_this;return;
      },
      getAt :function _trc_Map_getAt(getX,getY) {
        "use strict";
        var _this=this;
        
        return _this.get(Math.floor((getX-_this.sx)/_this.chipWidth),Math.floor((getY-_this.sy)/_this.chipHeight));
      },
      fiber$getAt :function _trc_Map_f_getAt(_thread,getX,getY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Map_ent_getAt(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$get(_thread, Math.floor((getX-_this.sx)/_this.chipWidth), Math.floor((getY-_this.sy)/_this.chipHeight));
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getOn :function _trc_Map_getOn(getCol,getRow) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75004025;//kernel.Map:4025
        if (getCol<_this.col&&getRow<_this.row&&getCol>=0&&getRow>=0) {
          return _this.mapOnTable[getRow][getCol];
        }
        return - 1;
      },
      fiber$getOn :function _trc_Map_f_getOn(_thread,getCol,getRow) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=75004025;//kernel.Map:4025
        if (getCol<_this.col&&getRow<_this.row&&getCol>=0&&getRow>=0) {
          _thread.retVal=_this.mapOnTable[getRow][getCol];return;
          
        }
        _thread.retVal=- 1;return;
        
        
        _thread.retVal=_this;return;
      },
      getOnAt :function _trc_Map_getOnAt(getX,getY) {
        "use strict";
        var _this=this;
        
        return _this.getOn(Math.floor((getX-_this.sx)/_this.chipWidth),Math.floor((getY-_this.sy)/_this.chipHeight));
      },
      fiber$getOnAt :function _trc_Map_f_getOnAt(_thread,getX,getY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Map_ent_getOnAt(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$getOn(_thread, Math.floor((getX-_this.sx)/_this.chipWidth), Math.floor((getY-_this.sy)/_this.chipHeight));
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      scrollTo :function _trc_Map_scrollTo(scrollX,scrollY) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75004278;//kernel.Map:4278
        _this.sx=- scrollX;
        //$LASTPOS=75004296;//kernel.Map:4296
        _this.sy=- scrollY;
      },
      fiber$scrollTo :function _trc_Map_f_scrollTo(_thread,scrollX,scrollY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=75004278;//kernel.Map:4278
        _this.sx=- scrollX;
        //$LASTPOS=75004296;//kernel.Map:4296
        _this.sy=- scrollY;
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_Map_draw(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=75004331;//kernel.Map:4331
        _this.pImg=_this.buf[0];
        //$LASTPOS=75004349;//kernel.Map:4349
        ctx.save();
        //$LASTPOS=75004366;//kernel.Map:4366
        ctx.globalAlpha=_this.alpha/255;
        //$LASTPOS=75004398;//kernel.Map:4398
        ctx.drawImage(_this.pImg,0,0,_this.col*_this.chipWidth,_this.row*_this.chipHeight,_this.sx,_this.sy,_this.col*_this.chipWidth,_this.row*_this.chipHeight);
        //$LASTPOS=75004510;//kernel.Map:4510
        ctx.restore();
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"initMap":{"nowait":false},"redrawMap":{"nowait":false},"redraw":{"nowait":false},"load":{"nowait":false},"save":{"nowait":false},"set":{"nowait":false},"setOn":{"nowait":false},"setOnAt":{"nowait":false},"setAt":{"nowait":false},"get":{"nowait":false},"getAt":{"nowait":false},"getOn":{"nowait":false},"getOnAt":{"nowait":false},"scrollTo":{"nowait":false},"draw":{"nowait":true}},"fields":{"sx":{},"sy":{},"chipWidth":{},"chipHeight":{},"col":{},"row":{},"buf":{},"mapObj":{},"mapTable":{},"mapOnTable":{},"rows":{},"mapData":{},"mapOnData":{},"baseData":{},"ctx":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Panel',
  shortName: 'Panel',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Panel_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Panel_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Panel_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76000427;//kernel.Panel:427
        __superClass.apply( _this, [opt]);
        //$LASTPOS=76000496;//kernel.Panel:496
        if (_this.canvas) {
          //$LASTPOS=76000519;//kernel.Panel:519
          _this.width=_this.canvas.width;
          //$LASTPOS=76000548;//kernel.Panel:548
          _this.height=_this.canvas.height;
          //$LASTPOS=76000579;//kernel.Panel:579
          _this.parallel("watchResize");
          
        } else {
          //$LASTPOS=76000627;//kernel.Panel:627
          _this.setPanel(_this.width||Tonyu.globals.$screenWidth||465,_this.height||Tonyu.globals.$screenHeight||465);
          
        }
        //$LASTPOS=76000751;//kernel.Panel:751
        if (_this._fillStyle&&_this.canvas) {
          //$LASTPOS=76000777;//kernel.Panel:777
          _this.canvas.getContext("2d").fillStyle=_this._fillStyle+"";
        }
        //$LASTPOS=76000831;//kernel.Panel:831
        _this.x=typeof  _this.x==="number"?_this.x:_this.width/2;
        //$LASTPOS=76000872;//kernel.Panel:872
        _this.y=typeof  _this.y==="number"?_this.y:_this.height/2;
        //$LASTPOS=76000914;//kernel.Panel:914
        if (_this.align==null) {
          //$LASTPOS=76000930;//kernel.Panel:930
          _this.align="center";
        }
        //$LASTPOS=76000951;//kernel.Panel:951
        if (_this.alpha==null) {
          //$LASTPOS=76000967;//kernel.Panel:967
          _this.alpha=255;
        }
        //$LASTPOS=76000983;//kernel.Panel:983
        if (_this._drawn==null) {
          //$LASTPOS=76001000;//kernel.Panel:1000
          _this._drawn=false;
        }
        //$LASTPOS=76001021;//kernel.Panel:1021
        _this.registerEventHandler("touchstart",new Tonyu.classes.kernel.PanelTouchStart({target: _this}));
      },
      watchResize :function _trc_Panel_watchResize() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76001117;//kernel.Panel:1117
        while (true) {
          //$LASTPOS=76001140;//kernel.Panel:1140
          if (_this.width!=_this.canvas.width||_this.height!=_this.canvas.height) {
            //$LASTPOS=76001205;//kernel.Panel:1205
            _this.width=_this.canvas.width;
            //$LASTPOS=76001224;//kernel.Panel:1224
            _this.height=_this.canvas.height;
            //$LASTPOS=76001259;//kernel.Panel:1259
            _this.fireEvent("resize",{width: _this.width,height: _this.height});
            
          }
          //$LASTPOS=76001315;//kernel.Panel:1315
          _this.runPromise(requestAnimationFrame);
          
        }
      },
      fiber$watchResize :function _trc_Panel_f_watchResize(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Panel_ent_watchResize(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76001117;//kernel.Panel:1117
            case 1:
              //$LASTPOS=76001140;//kernel.Panel:1140
              if (_this.width!=_this.canvas.width||_this.height!=_this.canvas.height) {
                //$LASTPOS=76001205;//kernel.Panel:1205
                _this.width=_this.canvas.width;
                //$LASTPOS=76001224;//kernel.Panel:1224
                _this.height=_this.canvas.height;
                //$LASTPOS=76001259;//kernel.Panel:1259
                _this.fireEvent("resize",{width: _this.width,height: _this.height});
                
              }
              //$LASTPOS=76001315;//kernel.Panel:1315
              _this.fiber$runPromise(_thread, requestAnimationFrame);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      setPanel :function _trc_Panel_setPanel(width,height) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76001441;//kernel.Panel:1441
        if (! (width*height>0)) {
          throw new Error("Invalid Panel size: "+width+"x"+height);
          
          
        }
        //$LASTPOS=76001545;//kernel.Panel:1545
        _this.width=_this.trunc(width);
        //$LASTPOS=76001575;//kernel.Panel:1575
        _this.height=_this.trunc(height);
        //$LASTPOS=76001607;//kernel.Panel:1607
        _this.buf=$("<canvas>").attr({width: width,height: height});
        //$LASTPOS=76001650;//kernel.Panel:1650
        _this.canvas=_this.buf[0];
        //$LASTPOS=76001670;//kernel.Panel:1670
        _this.imageSmoothingEnabled=! Tonyu.globals.$imageSmoothingDisabled;
        //$LASTPOS=76001723;//kernel.Panel:1723
        _this._drawn=false;
        //$LASTPOS=76001742;//kernel.Panel:1742
        _this.fireEvent("resize",{width: width,height: height,force: true});
      },
      fiber$setPanel :function _trc_Panel_f_setPanel(_thread,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=76001441;//kernel.Panel:1441
        if (! (width*height>0)) {
          throw new Error("Invalid Panel size: "+width+"x"+height);
          
          
        }
        //$LASTPOS=76001545;//kernel.Panel:1545
        _this.width=_this.trunc(width);
        //$LASTPOS=76001575;//kernel.Panel:1575
        _this.height=_this.trunc(height);
        //$LASTPOS=76001607;//kernel.Panel:1607
        _this.buf=$("<canvas>").attr({width: width,height: height});
        //$LASTPOS=76001650;//kernel.Panel:1650
        _this.canvas=_this.buf[0];
        //$LASTPOS=76001670;//kernel.Panel:1670
        _this.imageSmoothingEnabled=! Tonyu.globals.$imageSmoothingDisabled;
        //$LASTPOS=76001723;//kernel.Panel:1723
        _this._drawn=false;
        //$LASTPOS=76001742;//kernel.Panel:1742
        _this.fireEvent("resize",{width: width,height: height,force: true});
        
        _thread.retVal=_this;return;
      },
      resize :function _trc_Panel_resize(width,height) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76001821;//kernel.Panel:1821
        if (_this.width==width&&_this.height==height) {
          return _this;
        }
        //$LASTPOS=76001880;//kernel.Panel:1880
        _this.setPanel(width,height);
      },
      fiber$resize :function _trc_Panel_f_resize(_thread,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=76001821;//kernel.Panel:1821
        if (_this.width==width&&_this.height==height) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_Panel_ent_resize(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76001880;//kernel.Panel:1880
              _this.fiber$setPanel(_thread, width, height);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getContext :function _trc_Panel_getContext() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76001928;//kernel.Panel:1928
        _this._drawn=true;
        return _this.canvas.getContext("2d");
      },
      fiber$getContext :function _trc_Panel_f_getContext(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=76001928;//kernel.Panel:1928
        _this._drawn=true;
        _thread.retVal=_this.canvas.getContext("2d");return;
        
        
        _thread.retVal=_this;return;
      },
      __getter__context :function _trc_Panel___getter__context() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76001998;//kernel.Panel:1998
        _this._drawn=true;
        return _this.canvas.getContext("2d");
      },
      __getter__image :function _trc_Panel___getter__image() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76002066;//kernel.Panel:2066
        _this._drawn=true;
        return _this.canvas;
      },
      setFillStyle :function _trc_Panel_setFillStyle(color) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76002130;//kernel.Panel:2130
        _this.fillStyle=color;
      },
      fiber$setFillStyle :function _trc_Panel_f_setFillStyle(_thread,color) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=76002130;//kernel.Panel:2130
        _this.fillStyle=color;
        
        _thread.retVal=_this;return;
      },
      __getter__fillStyle :function _trc_Panel___getter__fillStyle() {
        "use strict";
        var _this=this;
        
        return _this._fillStyle;
      },
      __setter__fillStyle :function _trc_Panel___setter__fillStyle(val) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76002214;//kernel.Panel:2214
        _this._fillStyle=val;
        //$LASTPOS=76002235;//kernel.Panel:2235
        if (! _this.canvas) {
          return _this;
        }
        //$LASTPOS=76002261;//kernel.Panel:2261
        _this.context.fillStyle=val+"";
      },
      __setter__strokeStyle :function _trc_Panel___setter__strokeStyle(val) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76002315;//kernel.Panel:2315
        _this.context.strokeStyle=val+"";
      },
      __setter__lineWidth :function _trc_Panel___setter__lineWidth(val) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76002369;//kernel.Panel:2369
        _this.context.lineWidth=val;
      },
      fillCircle :function _trc_Panel_fillCircle(x,y,r) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=76002422;//kernel.Panel:2422
        ctx = _this.context;
        
        //$LASTPOS=76002444;//kernel.Panel:2444
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=76002477;//kernel.Panel:2477
        ctx.beginPath();
        //$LASTPOS=76002499;//kernel.Panel:2499
        ctx.arc(x,y,r,0,2*Tonyu.globals.$Math.PI);
        //$LASTPOS=76002533;//kernel.Panel:2533
        ctx.closePath();
        //$LASTPOS=76002555;//kernel.Panel:2555
        ctx.fill();
      },
      fiber$fillCircle :function _trc_Panel_f_fillCircle(_thread,x,y,r) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        //$LASTPOS=76002422;//kernel.Panel:2422
        ctx = _this.context;
        
        //$LASTPOS=76002444;//kernel.Panel:2444
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=76002477;//kernel.Panel:2477
        ctx.beginPath();
        //$LASTPOS=76002499;//kernel.Panel:2499
        ctx.arc(x,y,r,0,2*Tonyu.globals.$Math.PI);
        //$LASTPOS=76002533;//kernel.Panel:2533
        ctx.closePath();
        //$LASTPOS=76002555;//kernel.Panel:2555
        ctx.fill();
        
        _thread.retVal=_this;return;
      },
      fillRect :function _trc_Panel_fillRect(x,y,w,h) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=76002596;//kernel.Panel:2596
        ctx = _this.getContext();
        
        //$LASTPOS=76002677;//kernel.Panel:2677
        ctx.fillRect(x,y,w,h);
      },
      fillText :function _trc_Panel_fillText(text,x,y,size,align,baseline) {
        "use strict";
        var _this=this;
        var ctx;
        var splits;
        var f;
        var colCount;
        
        //$LASTPOS=76002772;//kernel.Panel:2772
        ctx = _this.getContext();
        
        //$LASTPOS=76002799;//kernel.Panel:2799
        ctx.save();
        //$LASTPOS=76002816;//kernel.Panel:2816
        text=text+"";
        //$LASTPOS=76002835;//kernel.Panel:2835
        splits = text.split("\n");
        
        //$LASTPOS=76002921;//kernel.Panel:2921
        ctx.textAlign=align||"center";
        //$LASTPOS=76002960;//kernel.Panel:2960
        ctx.textBaseline=baseline||"alphabetic";
        //$LASTPOS=76003009;//kernel.Panel:3009
        size=size||15;
        //$LASTPOS=76003029;//kernel.Panel:3029
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=76003062;//kernel.Panel:3062
        f = ctx.font.replace(/^[0-9\.]+/,"");
        
        //$LASTPOS=76003107;//kernel.Panel:3107
        ctx.font=size+f;
        //$LASTPOS=76003129;//kernel.Panel:3129
        //$LASTPOS=76003133;//kernel.Panel:3133
        colCount = 0;
        for (; colCount<splits.length ; colCount++) {
          {
            //$LASTPOS=76003193;//kernel.Panel:3193
            ctx.fillText(splits[colCount],x,y);
            //$LASTPOS=76003238;//kernel.Panel:3238
            y+=size;
          }
        }
        //$LASTPOS=76003259;//kernel.Panel:3259
        ctx.restore();
      },
      fiber$fillText :function _trc_Panel_f_fillText(_thread,text,x,y,size,align,baseline) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        var splits;
        var f;
        var colCount;
        
        
        _thread.enter(function _trc_Panel_ent_fillText(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76002772;//kernel.Panel:2772
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=76002799;//kernel.Panel:2799
              ctx.save();
              //$LASTPOS=76002816;//kernel.Panel:2816
              text=text+"";
              //$LASTPOS=76002835;//kernel.Panel:2835
              splits = text.split("\n");
              
              //$LASTPOS=76002921;//kernel.Panel:2921
              ctx.textAlign=align||"center";
              //$LASTPOS=76002960;//kernel.Panel:2960
              ctx.textBaseline=baseline||"alphabetic";
              //$LASTPOS=76003009;//kernel.Panel:3009
              size=size||15;
              //$LASTPOS=76003029;//kernel.Panel:3029
              ctx.fillStyle=_this.fillStyle+"";
              //$LASTPOS=76003062;//kernel.Panel:3062
              f = ctx.font.replace(/^[0-9\.]+/,"");
              
              //$LASTPOS=76003107;//kernel.Panel:3107
              ctx.font=size+f;
              //$LASTPOS=76003129;//kernel.Panel:3129
              //$LASTPOS=76003133;//kernel.Panel:3133
              colCount = 0;
              for (; colCount<splits.length ; colCount++) {
                {
                  //$LASTPOS=76003193;//kernel.Panel:3193
                  ctx.fillText(splits[colCount],x,y);
                  //$LASTPOS=76003238;//kernel.Panel:3238
                  y+=size;
                }
              }
              //$LASTPOS=76003259;//kernel.Panel:3259
              ctx.restore();
              _thread.exit(_this);return;
            }
          }
        });
      },
      clearRect :function _trc_Panel_clearRect(clearX,clearY,clearW,clearH) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=76003324;//kernel.Panel:3324
        ctx = _this.getContext();
        
        //$LASTPOS=76003351;//kernel.Panel:3351
        ctx.save();
        //$LASTPOS=76003368;//kernel.Panel:3368
        ctx.clearRect(clearX||0,clearY||0,clearW||_this.width,clearH||_this.height);
        //$LASTPOS=76003438;//kernel.Panel:3438
        ctx.restore();
        //$LASTPOS=76003458;//kernel.Panel:3458
        if (arguments.length==0) {
          //$LASTPOS=76003483;//kernel.Panel:3483
          _this._drawn=false;
        }
      },
      fiber$clearRect :function _trc_Panel_f_clearRect(_thread,clearX,clearY,clearW,clearH) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        
        _thread.enter(function _trc_Panel_ent_clearRect(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76003324;//kernel.Panel:3324
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=76003351;//kernel.Panel:3351
              ctx.save();
              //$LASTPOS=76003368;//kernel.Panel:3368
              ctx.clearRect(clearX||0,clearY||0,clearW||_this.width,clearH||_this.height);
              //$LASTPOS=76003438;//kernel.Panel:3438
              ctx.restore();
              //$LASTPOS=76003458;//kernel.Panel:3458
              if (_arguments.length==0) {
                //$LASTPOS=76003483;//kernel.Panel:3483
                _this._drawn=false;
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      getPixel :function _trc_Panel_getPixel(getX,getY) {
        "use strict";
        var _this=this;
        var ctx;
        
        
        //$LASTPOS=76003542;//kernel.Panel:3542
        if (typeof  getX=="number"&&! isNaN(getX)&&typeof  getY=="number"&&! isNaN(getY)) {
          //$LASTPOS=76003640;//kernel.Panel:3640
          ctx=_this.getContext();
          //$LASTPOS=76003667;//kernel.Panel:3667
          _this.imagedata=ctx.getImageData(getX,getY,1,1);
          //$LASTPOS=76003719;//kernel.Panel:3719
          _this.colordata=[_this.imagedata.data[0],_this.imagedata.data[1],_this.imagedata.data[2],_this.imagedata.data[3]];
          
        } else {
          //$LASTPOS=76003859;//kernel.Panel:3859
          _this.colordata=[0,0,0,0];
          
        }
        return (_this.colordata);
      },
      fiber$getPixel :function _trc_Panel_f_getPixel(_thread,getX,getY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        
        
        _thread.enter(function _trc_Panel_ent_getPixel(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76003542;//kernel.Panel:3542
              if (!(typeof  getX=="number"&&! isNaN(getX)&&typeof  getY=="number"&&! isNaN(getY))) { __pc=2     ; break; }
              //$LASTPOS=76003640;//kernel.Panel:3640
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=76003667;//kernel.Panel:3667
              _this.imagedata=ctx.getImageData(getX,getY,1,1);
              //$LASTPOS=76003719;//kernel.Panel:3719
              _this.colordata=[_this.imagedata.data[0],_this.imagedata.data[1],_this.imagedata.data[2],_this.imagedata.data[3]];
              __pc=3     ;break;
            case 2     :
              {
                //$LASTPOS=76003859;//kernel.Panel:3859
                _this.colordata=[0,0,0,0];
              }
            case 3     :
              
              _thread.exit((_this.colordata));return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      scroll :function _trc_Panel_scroll(scrollX,scrollY) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=76003946;//kernel.Panel:3946
        ctx = _this.getContext();
        
        //$LASTPOS=76003973;//kernel.Panel:3973
        ctx.save();
        //$LASTPOS=76003990;//kernel.Panel:3990
        _this.imagedata=ctx.getImageData(0,0,_this.width,_this.height);
        //$LASTPOS=76004051;//kernel.Panel:4051
        _this.clearRect(0,0,_this.width,_this.height);
        //$LASTPOS=76004085;//kernel.Panel:4085
        ctx.putImageData(_this.imagedata,- scrollX,- scrollY);
        //$LASTPOS=76004137;//kernel.Panel:4137
        ctx.restore();
      },
      fiber$scroll :function _trc_Panel_f_scroll(_thread,scrollX,scrollY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        
        _thread.enter(function _trc_Panel_ent_scroll(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76003946;//kernel.Panel:3946
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              ctx=_thread.retVal;
              
              //$LASTPOS=76003973;//kernel.Panel:3973
              ctx.save();
              //$LASTPOS=76003990;//kernel.Panel:3990
              _this.imagedata=ctx.getImageData(0,0,_this.width,_this.height);
              //$LASTPOS=76004051;//kernel.Panel:4051
              _this.fiber$clearRect(_thread, 0, 0, _this.width, _this.height);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=76004085;//kernel.Panel:4085
              ctx.putImageData(_this.imagedata,- scrollX,- scrollY);
              //$LASTPOS=76004137;//kernel.Panel:4137
              ctx.restore();
              _thread.exit(_this);return;
            }
          }
        });
      },
      draw :function _trc_Panel_draw(ctx) {
        "use strict";
        var _this=this;
        var pImg;
        
        //$LASTPOS=76004173;//kernel.Panel:4173
        if (_this._drawn) {
          //$LASTPOS=76004194;//kernel.Panel:4194
          pImg = _this.canvas;
          
          //$LASTPOS=76004220;//kernel.Panel:4220
          ctx.save();
          //$LASTPOS=76004241;//kernel.Panel:4241
          if (_this.align=="left") {
            //$LASTPOS=76004273;//kernel.Panel:4273
            ctx.translate(_this.x+_this.width/2,_this.y+_this.height/2);
            
          } else {
            //$LASTPOS=76004325;//kernel.Panel:4325
            if (_this.align=="center") {
              //$LASTPOS=76004359;//kernel.Panel:4359
              ctx.translate(_this.x,_this.y);
              
            } else {
              //$LASTPOS=76004394;//kernel.Panel:4394
              if (_this.align=="right") {
                //$LASTPOS=76004427;//kernel.Panel:4427
                ctx.translate(_this.x-_this.width/2,_this.y-_this.height/2);
                
              }
            }
          }
          //$LASTPOS=76004484;//kernel.Panel:4484
          if (_this.rotation!=0) {
            //$LASTPOS=76004519;//kernel.Panel:4519
            ctx.rotate(_this.rotation/180*Math.PI);
            
          } else {
            //$LASTPOS=76004587;//kernel.Panel:4587
            ctx.rotate(_this.rotate/180*Math.PI);
            
          }
          //$LASTPOS=76004644;//kernel.Panel:4644
          if (typeof  _this.scaleY==="undefined") {
            //$LASTPOS=76004696;//kernel.Panel:4696
            ctx.scale(_this.scaleX,_this.scaleX);
            
          } else {
            //$LASTPOS=76004761;//kernel.Panel:4761
            ctx.scale(_this.scaleX,_this.scaleY);
            
          }
          //$LASTPOS=76004817;//kernel.Panel:4817
          ctx.globalAlpha=_this.alpha/255;
          //$LASTPOS=76004858;//kernel.Panel:4858
          ctx.drawImage(pImg,0,0,_this.width,_this.height,- _this.width/2,- _this.height/2,_this.width,_this.height);
          //$LASTPOS=76004962;//kernel.Panel:4962
          ctx.restore();
          
        }
      },
      drawSprite :function _trc_Panel_drawSprite(x,y,p,options) {
        "use strict";
        var _this=this;
        var pImg;
        var scaleX;
        var scaleY;
        var rotation;
        var ctx;
        
        //$LASTPOS=76005029;//kernel.Panel:5029
        pImg = Tonyu.globals.$imageList[p];
        
        //$LASTPOS=76005058;//kernel.Panel:5058
        if (! pImg) {
          return _this;
        }
        //$LASTPOS=76005082;//kernel.Panel:5082
        if (options===true) {
          //$LASTPOS=76005102;//kernel.Panel:5102
          options={f: true};
        }
        //$LASTPOS=76005125;//kernel.Panel:5125
        options=options||{};
        //$LASTPOS=76005151;//kernel.Panel:5151
        scaleX = typeof  (options.scaleX)==="number"?options.scaleX:1;
        
        //$LASTPOS=76005220;//kernel.Panel:5220
        scaleY = typeof  (options.scaleY)==="number"?options.scaleY:scaleX;
        
        //$LASTPOS=76005294;//kernel.Panel:5294
        rotation = options.rotation||options.angle||0;
        
        //$LASTPOS=76005348;//kernel.Panel:5348
        ctx = _this.context;
        
        //$LASTPOS=76005370;//kernel.Panel:5370
        if (options.f) {
          //$LASTPOS=76005385;//kernel.Panel:5385
          scaleX*=- 1;
        }
        //$LASTPOS=76005404;//kernel.Panel:5404
        ctx.save();
        //$LASTPOS=76005421;//kernel.Panel:5421
        ctx.translate(x,y);
        //$LASTPOS=76005446;//kernel.Panel:5446
        ctx.rotate(rotation/180*Math.PI);
        //$LASTPOS=76005485;//kernel.Panel:5485
        ctx.scale(scaleX,scaleY);
        //$LASTPOS=76005516;//kernel.Panel:5516
        ctx.drawImage(pImg.image,pImg.x,pImg.y,pImg.width,pImg.height,- pImg.width/2,- pImg.height/2,pImg.width,pImg.height);
        //$LASTPOS=76005656;//kernel.Panel:5656
        ctx.restore();
      },
      copy :function _trc_Panel_copy() {
        "use strict";
        var _this=this;
        var sx;
        var sy;
        var sw;
        var sh;
        var dx;
        var dy;
        var dw;
        var dh;
        var a;
        var srcPanel;
        var params;
        
        
        //$LASTPOS=76005894;//kernel.Panel:5894
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=76005931;//kernel.Panel:5931
        srcPanel = a.shift(Tonyu.classes.kernel.Panel)||_this;
        
        //$LASTPOS=76005973;//kernel.Panel:5973
        if (a.length<=4) {
          //$LASTPOS=76006001;//kernel.Panel:6001
          dx=a.shift();
          //$LASTPOS=76006024;//kernel.Panel:6024
          dy=a.shift();
          //$LASTPOS=76006047;//kernel.Panel:6047
          if (a.length==0) {
            //$LASTPOS=76006079;//kernel.Panel:6079
            _this.context.drawImage(srcPanel.image,dx,dy);
            
          } else {
            //$LASTPOS=76006152;//kernel.Panel:6152
            dw=a.shift();
            //$LASTPOS=76006179;//kernel.Panel:6179
            dh=a.shift();
            //$LASTPOS=76006206;//kernel.Panel:6206
            if (dw*dh!=0) {
              //$LASTPOS=76006239;//kernel.Panel:6239
              _this.context.drawImage(srcPanel.image,dx,dy,dw,dh);
              
            }
            
          }
          
        } else {
          //$LASTPOS=76006335;//kernel.Panel:6335
          sx=a.shift();
          //$LASTPOS=76006358;//kernel.Panel:6358
          sy=a.shift();
          //$LASTPOS=76006381;//kernel.Panel:6381
          sw=a.shift();
          //$LASTPOS=76006404;//kernel.Panel:6404
          sh=a.shift();
          //$LASTPOS=76006427;//kernel.Panel:6427
          dx=a.shift();
          //$LASTPOS=76006450;//kernel.Panel:6450
          if (typeof  dx==="object") {
            //$LASTPOS=76006491;//kernel.Panel:6491
            params = dx;
            
            
          }
          //$LASTPOS=76006577;//kernel.Panel:6577
          dy=a.shift();
          //$LASTPOS=76006600;//kernel.Panel:6600
          dw=a.shift()||sw;
          //$LASTPOS=76006629;//kernel.Panel:6629
          dh=a.shift()||sh;
          //$LASTPOS=76006708;//kernel.Panel:6708
          if (sw*sh*dw*dh!=0) {
            //$LASTPOS=76006743;//kernel.Panel:6743
            _this.context.drawImage(srcPanel.image,sx,sy,sw,sh,dx,dy,dw,dh);
            
          }
          
        }
      },
      convert :function _trc_Panel_convert(obj,toLayer) {
        "use strict";
        var _this=this;
        var fromLayer;
        var scaleY;
        var dx;
        var dy;
        var rt;
        var x;
        var y;
        
        //$LASTPOS=76007261;//kernel.Panel:7261
        fromLayer = obj.layer;
        
        //$LASTPOS=76007291;//kernel.Panel:7291
        if (fromLayer==null&&toLayer==null) {
          //$LASTPOS=76007340;//kernel.Panel:7340
          fromLayer=_this;
          //$LASTPOS=76007355;//kernel.Panel:7355
          toLayer=_this.layer;
          
        } else {
          //$LASTPOS=76007382;//kernel.Panel:7382
          if (fromLayer==null&&toLayer===_this.layer) {
            //$LASTPOS=76007433;//kernel.Panel:7433
            fromLayer=_this;
            
          } else {
            //$LASTPOS=76007461;//kernel.Panel:7461
            if (fromLayer===_this&&toLayer==null) {
              //$LASTPOS=76007511;//kernel.Panel:7511
              toLayer=_this.layer;
              
            } else {
              //$LASTPOS=76007538;//kernel.Panel:7538
              if (fromLayer==null&&toLayer===_this) {
                //$LASTPOS=76007588;//kernel.Panel:7588
                fromLayer=_this.layer;
                
              } else {
                //$LASTPOS=76007617;//kernel.Panel:7617
                if (fromLayer===_this.layer&&toLayer==null) {
                  //$LASTPOS=76007668;//kernel.Panel:7668
                  toLayer=_this;
                  
                }
              }
            }
          }
        }
        //$LASTPOS=76007694;//kernel.Panel:7694
        if (fromLayer===toLayer) {
          return obj;
        }
        //$LASTPOS=76007736;//kernel.Panel:7736
        scaleY = _this.scaleY||_this.scaleX;
        
        //$LASTPOS=76007773;//kernel.Panel:7773
        if (fromLayer==null||toLayer==null) {
          throw new Error("layer not set");
          
        }
        //$LASTPOS=76007850;//kernel.Panel:7850
        if (fromLayer===_this&&toLayer===_this.layer) {
          //$LASTPOS=76007931;//kernel.Panel:7931
          dx = obj.x-_this.width/2;
          
          //$LASTPOS=76007962;//kernel.Panel:7962
          dy = obj.y-_this.height/2;
          
          //$LASTPOS=76007994;//kernel.Panel:7994
          rt = _this.rotation;
          
          //$LASTPOS=76008192;//kernel.Panel:8192
          x = _this.x+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)*_this.scaleX;
          
          //$LASTPOS=76008249;//kernel.Panel:8249
          y = _this.y+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)*scaleY;
          
          return {x: x,y: y,rotation: obj.rotation,scale: obj.scale,layer: toLayer};
          
        } else {
          //$LASTPOS=76008436;//kernel.Panel:8436
          if (fromLayer===_this.layer&&toLayer===_this) {
            //$LASTPOS=76008517;//kernel.Panel:8517
            rt = - _this.rotation;
            
            //$LASTPOS=76008544;//kernel.Panel:8544
            dx = obj.x-(_this.x);
            
            //$LASTPOS=76008576;//kernel.Panel:8576
            dy = obj.y-(_this.y);
            
            //$LASTPOS=76008832;//kernel.Panel:8832
            x = _this.width/2+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)/_this.scaleX;
            
            //$LASTPOS=76008892;//kernel.Panel:8892
            y = _this.height/2+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)/scaleY;
            
            return {x: x,y: y,rotation: rt,scale: 1/_this.scaleX,layer: toLayer};
            
          } else {
            //$LASTPOS=76009083;//kernel.Panel:9083
            _this.print("no support",obj.layer,toLayer);
            throw new Error("not support");
            
            
          }
        }
      },
      fiber$convert :function _trc_Panel_f_convert(_thread,obj,toLayer) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var fromLayer;
        var scaleY;
        var dx;
        var dy;
        var rt;
        var x;
        var y;
        
        //$LASTPOS=76007261;//kernel.Panel:7261
        fromLayer = obj.layer;
        
        //$LASTPOS=76007291;//kernel.Panel:7291
        if (fromLayer==null&&toLayer==null) {
          //$LASTPOS=76007340;//kernel.Panel:7340
          fromLayer=_this;
          //$LASTPOS=76007355;//kernel.Panel:7355
          toLayer=_this.layer;
          
        } else {
          //$LASTPOS=76007382;//kernel.Panel:7382
          if (fromLayer==null&&toLayer===_this.layer) {
            //$LASTPOS=76007433;//kernel.Panel:7433
            fromLayer=_this;
            
          } else {
            //$LASTPOS=76007461;//kernel.Panel:7461
            if (fromLayer===_this&&toLayer==null) {
              //$LASTPOS=76007511;//kernel.Panel:7511
              toLayer=_this.layer;
              
            } else {
              //$LASTPOS=76007538;//kernel.Panel:7538
              if (fromLayer==null&&toLayer===_this) {
                //$LASTPOS=76007588;//kernel.Panel:7588
                fromLayer=_this.layer;
                
              } else {
                //$LASTPOS=76007617;//kernel.Panel:7617
                if (fromLayer===_this.layer&&toLayer==null) {
                  //$LASTPOS=76007668;//kernel.Panel:7668
                  toLayer=_this;
                  
                }
              }
            }
          }
        }
        //$LASTPOS=76007694;//kernel.Panel:7694
        if (fromLayer===toLayer) {
          _thread.retVal=obj;return;
          
        }
        //$LASTPOS=76007736;//kernel.Panel:7736
        scaleY = _this.scaleY||_this.scaleX;
        
        //$LASTPOS=76007773;//kernel.Panel:7773
        if (fromLayer==null||toLayer==null) {
          throw new Error("layer not set");
          
        }
        //$LASTPOS=76007850;//kernel.Panel:7850
        if (fromLayer===_this&&toLayer===_this.layer) {
          //$LASTPOS=76007931;//kernel.Panel:7931
          dx = obj.x-_this.width/2;
          
          //$LASTPOS=76007962;//kernel.Panel:7962
          dy = obj.y-_this.height/2;
          
          //$LASTPOS=76007994;//kernel.Panel:7994
          rt = _this.rotation;
          
          //$LASTPOS=76008192;//kernel.Panel:8192
          x = _this.x+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)*_this.scaleX;
          
          //$LASTPOS=76008249;//kernel.Panel:8249
          y = _this.y+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)*scaleY;
          
          _thread.retVal={x: x,y: y,rotation: obj.rotation,scale: obj.scale,layer: toLayer};return;
          
          
        } else {
          //$LASTPOS=76008436;//kernel.Panel:8436
          if (fromLayer===_this.layer&&toLayer===_this) {
            //$LASTPOS=76008517;//kernel.Panel:8517
            rt = - _this.rotation;
            
            //$LASTPOS=76008544;//kernel.Panel:8544
            dx = obj.x-(_this.x);
            
            //$LASTPOS=76008576;//kernel.Panel:8576
            dy = obj.y-(_this.y);
            
            //$LASTPOS=76008832;//kernel.Panel:8832
            x = _this.width/2+(_this.cos(rt)*dx+_this.cos(rt+90)*dy)/_this.scaleX;
            
            //$LASTPOS=76008892;//kernel.Panel:8892
            y = _this.height/2+(_this.sin(rt)*dx+_this.sin(rt+90)*dy)/scaleY;
            
            _thread.retVal={x: x,y: y,rotation: rt,scale: 1/_this.scaleX,layer: toLayer};return;
            
            
          } else {
            //$LASTPOS=76009083;//kernel.Panel:9083
            _this.print("no support",obj.layer,toLayer);
            throw new Error("not support");
            
            
          }
        }
        
        _thread.retVal=_this;return;
      },
      drawLine :function _trc_Panel_drawLine(x,y,dx,dy) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76009203;//kernel.Panel:9203
        if (dx==null&&dy==null) {
          //$LASTPOS=76009240;//kernel.Panel:9240
          if (x==null&&y==null) {
            //$LASTPOS=76009279;//kernel.Panel:9279
            _this.px=null;
            //$LASTPOS=76009287;//kernel.Panel:9287
            _this.py=null;
            return _this;
            
          }
          //$LASTPOS=76009323;//kernel.Panel:9323
          if (_this.px==null&&_this.py==null) {
            //$LASTPOS=76009364;//kernel.Panel:9364
            _this.px=x;
            //$LASTPOS=76009369;//kernel.Panel:9369
            _this.py=y;
            return _this;
            
          }
          //$LASTPOS=76009402;//kernel.Panel:9402
          dx=x;
          //$LASTPOS=76009407;//kernel.Panel:9407
          dy=y;
          //$LASTPOS=76009412;//kernel.Panel:9412
          x=_this.px;
          //$LASTPOS=76009417;//kernel.Panel:9417
          y=_this.py;
          //$LASTPOS=76009422;//kernel.Panel:9422
          _this.px=dx;
          //$LASTPOS=76009428;//kernel.Panel:9428
          _this.py=dy;
          
        }
        //$LASTPOS=76009447;//kernel.Panel:9447
        _this.context.beginPath();
        //$LASTPOS=76009473;//kernel.Panel:9473
        _this.context.moveTo(x,y);
        //$LASTPOS=76009499;//kernel.Panel:9499
        _this.context.lineTo(dx,dy);
        //$LASTPOS=76009527;//kernel.Panel:9527
        _this.context.stroke();
      },
      slicePattern :function _trc_Panel_slicePattern(x,y,width,height) {
        "use strict";
        var _this=this;
        
        return {image: _this.canvas,x: x,y: y,width: width,height: height};
      },
      fiber$slicePattern :function _trc_Panel_f_slicePattern(_thread,x,y,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal={image: _this.canvas,x: x,y: y,width: width,height: height};return;
        
        
        _thread.retVal=_this;return;
      },
      addPattern :function _trc_Panel_addPattern(x,y,width,height) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76009669;//kernel.Panel:9669
        Tonyu.globals.$imageList.push(_this.slicePattern(x,y,width,height));
        return Tonyu.globals.$imageList.length-1;
      },
      fiber$addPattern :function _trc_Panel_f_addPattern(_thread,x,y,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=76009669;//kernel.Panel:9669
        Tonyu.globals.$imageList.push(_this.slicePattern(x,y,width,height));
        _thread.retVal=Tonyu.globals.$imageList.length-1;return;
        
        
        _thread.retVal=_this;return;
      },
      getImageData :function _trc_Panel_getImageData(x,y,width,height) {
        "use strict";
        var _this=this;
        
        return _this.context.getImageData(x,y,width,height);
      },
      fiber$getImageData :function _trc_Panel_f_getImageData(_thread,x,y,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.context.getImageData(x,y,width,height);return;
        
        
        _thread.retVal=_this;return;
      },
      putImageData :function _trc_Panel_putImageData(data,x,y) {
        "use strict";
        var _this=this;
        
        return _this.context.putImageData(data,x,y);
      },
      fiber$putImageData :function _trc_Panel_f_putImageData(_thread,data,x,y) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.context.putImageData(data,x,y);return;
        
        
        _thread.retVal=_this;return;
      },
      replace :function _trc_Panel_replace(x,y,width,height,replacement) {
        "use strict";
        var _this=this;
        
      },
      fiber$replace :function _trc_Panel_f_replace(_thread,x,y,width,height,replacement) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      save :function _trc_Panel_save(fn) {
        "use strict";
        var _this=this;
        var url;
        
        //$LASTPOS=76009985;//kernel.Panel:9985
        url = _this.buf[0].toDataURL();
        
        //$LASTPOS=76010018;//kernel.Panel:10018
        if (typeof  fn==="string") {
          //$LASTPOS=76010044;//kernel.Panel:10044
          fn=_this.file(fn);
        }
        return fn.text(url);
      },
      fiber$save :function _trc_Panel_f_save(_thread,fn) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var url;
        
        //$LASTPOS=76009985;//kernel.Panel:9985
        url = _this.buf[0].toDataURL();
        
        
        _thread.enter(function _trc_Panel_ent_save(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76010018;//kernel.Panel:10018
              if (!(typeof  fn==="string")) { __pc=2     ; break; }
              //$LASTPOS=76010044;//kernel.Panel:10044
              _this.fiber$file(_thread, fn);
              __pc=1;return;
            case 1:
              fn=_thread.retVal;
              
            case 2     :
              
              _thread.exit(fn.text(url));return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      load :function _trc_Panel_load(fn) {
        "use strict";
        var _this=this;
        var d;
        var url;
        var element;
        
        //$LASTPOS=76010106;//kernel.Panel:10106
        if (typeof  fn==="string") {
          //$LASTPOS=76010132;//kernel.Panel:10132
          fn=_this.file(fn);
        }
        //$LASTPOS=76010150;//kernel.Panel:10150
        d = new $.Deferred();
        
        //$LASTPOS=76010179;//kernel.Panel:10179
        url = fn.text();
        
        //$LASTPOS=76010203;//kernel.Panel:10203
        element = $("<img>").css({display: "none"}).appendTo("body");
        
        //$LASTPOS=76010269;//kernel.Panel:10269
        element.on("load",(function anonymous_10288() {
          var img;
          var width;
          var height;
          
          //$LASTPOS=76010300;//kernel.Panel:10300
          img = new Image();
          
          //$LASTPOS=76010332;//kernel.Panel:10332
          img.src=element.attr('src');
          //$LASTPOS=76010372;//kernel.Panel:10372
          width = img.width;
          
          //$LASTPOS=76010404;//kernel.Panel:10404
          height = img.height;
          
          //$LASTPOS=76010470;//kernel.Panel:10470
          _this.resize(width,height);
          //$LASTPOS=76010501;//kernel.Panel:10501
          _this.context.drawImage(img,0,0);
          //$LASTPOS=76010539;//kernel.Panel:10539
          d.resolve(_this);
        }));
        //$LASTPOS=76010569;//kernel.Panel:10569
        element.attr({src: url});
        return d.promise();
      },
      fiber$load :function _trc_Panel_f_load(_thread,fn) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var d;
        var url;
        var element;
        
        
        _thread.enter(function _trc_Panel_ent_load(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76010106;//kernel.Panel:10106
              if (!(typeof  fn==="string")) { __pc=2     ; break; }
              //$LASTPOS=76010132;//kernel.Panel:10132
              _this.fiber$file(_thread, fn);
              __pc=1;return;
            case 1:
              fn=_thread.retVal;
              
            case 2     :
              
              //$LASTPOS=76010150;//kernel.Panel:10150
              d = new $.Deferred();
              
              //$LASTPOS=76010179;//kernel.Panel:10179
              url = fn.text();
              
              //$LASTPOS=76010203;//kernel.Panel:10203
              element = $("<img>").css({display: "none"}).appendTo("body");
              
              //$LASTPOS=76010269;//kernel.Panel:10269
              element.on("load",(function anonymous_10288() {
                var img;
                var width;
                var height;
                
                //$LASTPOS=76010300;//kernel.Panel:10300
                img = new Image();
                
                //$LASTPOS=76010332;//kernel.Panel:10332
                img.src=element.attr('src');
                //$LASTPOS=76010372;//kernel.Panel:10372
                width = img.width;
                
                //$LASTPOS=76010404;//kernel.Panel:10404
                height = img.height;
                
                //$LASTPOS=76010470;//kernel.Panel:10470
                _this.resize(width,height);
                //$LASTPOS=76010501;//kernel.Panel:10501
                _this.context.drawImage(img,0,0);
                //$LASTPOS=76010539;//kernel.Panel:10539
                d.resolve(_this);
              }));
              //$LASTPOS=76010569;//kernel.Panel:10569
              element.attr({src: url});
              _thread.exit(d.promise());return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __setter__imageSmoothingEnabled :function _trc_Panel___setter__imageSmoothingEnabled(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76010653;//kernel.Panel:10653
        if (typeof  _this.context.msImageSmoothingEnabled==="boolean") {
          //$LASTPOS=76010720;//kernel.Panel:10720
          _this.context.msImageSmoothingEnabled=v;
          
        } else {
          //$LASTPOS=76010778;//kernel.Panel:10778
          _this.context.imageSmoothingEnabled=v;
          
        }
      },
      __getter__imageSmoothingEnabled :function _trc_Panel___getter__imageSmoothingEnabled() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=76010852;//kernel.Panel:10852
        if (typeof  _this.context.msImageSmoothingEnabled==="boolean") {
          return _this.context.msImageSmoothingEnabled;
          
        } else {
          return _this.context.imageSmoothingEnabled;
          
        }
      },
      replaceColor :function _trc_Panel_replaceColor() {
        "use strict";
        var _this=this;
        var a;
        var top;
        var left;
        var w;
        var h;
        var func;
        var ctx;
        var data;
        var i;
        var j;
        
        //$LASTPOS=76011054;//kernel.Panel:11054
        a = new Tonyu.classes.kernel.ArgParser(arguments);
        
        //$LASTPOS=76011091;//kernel.Panel:11091
        top = 0;
        left = 0;
        
        //$LASTPOS=76011114;//kernel.Panel:11114
        w = _this.width;
        h = _this.height;
        
        //$LASTPOS=76011142;//kernel.Panel:11142
        if (a.length>=4) {
          //$LASTPOS=76011170;//kernel.Panel:11170
          left=a.shift();
          //$LASTPOS=76011195;//kernel.Panel:11195
          top=a.shift();
          //$LASTPOS=76011219;//kernel.Panel:11219
          w=a.shift();
          //$LASTPOS=76011241;//kernel.Panel:11241
          h=a.shift();
          
        }
        //$LASTPOS=76011266;//kernel.Panel:11266
        func = a.shift();
        
        //$LASTPOS=76011291;//kernel.Panel:11291
        if (typeof  func!=="function") {
          //$LASTPOS=76011332;//kernel.Panel:11332
          ctx = _this.context;
          
          //$LASTPOS=76011358;//kernel.Panel:11358
          ctx.save();
          //$LASTPOS=76011379;//kernel.Panel:11379
          ctx.beginPath();
          //$LASTPOS=76011405;//kernel.Panel:11405
          ctx.moveTo(left,top);
          //$LASTPOS=76011436;//kernel.Panel:11436
          ctx.lineTo(left+w,top);
          //$LASTPOS=76011469;//kernel.Panel:11469
          ctx.lineTo(left+w,top+h);
          //$LASTPOS=76011504;//kernel.Panel:11504
          ctx.lineTo(left,top+h);
          //$LASTPOS=76011537;//kernel.Panel:11537
          ctx.closePath();
          //$LASTPOS=76011563;//kernel.Panel:11563
          ctx.clip();
          //$LASTPOS=76011584;//kernel.Panel:11584
          ctx.globalCompositeOperation="source-in";
          //$LASTPOS=76011635;//kernel.Panel:11635
          if (func) {
            //$LASTPOS=76011645;//kernel.Panel:11645
            _this.fillStyle=func;
          }
          //$LASTPOS=76011670;//kernel.Panel:11670
          ctx.fillRect(left,top,w,h);
          //$LASTPOS=76011707;//kernel.Panel:11707
          ctx.restore();
          return _this;
          
        }
        //$LASTPOS=76011751;//kernel.Panel:11751
        data = _this.getImageData(left,top,w,h);
        
        //$LASTPOS=76011793;//kernel.Panel:11793
        //$LASTPOS=76011798;//kernel.Panel:11798
        i = 0;
        for (; i<h ; i++) {
          {
            //$LASTPOS=76011826;//kernel.Panel:11826
            //$LASTPOS=76011831;//kernel.Panel:11831
            j = 0;
            for (; j<w ; j++) {
              {
                //$LASTPOS=76011863;//kernel.Panel:11863
                func(new Tonyu.classes.kernel.Color(data,j,i),left+j,top+i);
              }
            }
          }
        }
        //$LASTPOS=76011926;//kernel.Panel:11926
        _this.putImageData(data,left,top);
      },
      fiber$replaceColor :function _trc_Panel_f_replaceColor(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        var top;
        var left;
        var w;
        var h;
        var func;
        var ctx;
        var data;
        var i;
        var j;
        
        //$LASTPOS=76011054;//kernel.Panel:11054
        a = new Tonyu.classes.kernel.ArgParser(_arguments);
        
        //$LASTPOS=76011091;//kernel.Panel:11091
        top = 0;
        left = 0;
        
        //$LASTPOS=76011114;//kernel.Panel:11114
        w = _this.width;
        h = _this.height;
        
        //$LASTPOS=76011142;//kernel.Panel:11142
        if (a.length>=4) {
          //$LASTPOS=76011170;//kernel.Panel:11170
          left=a.shift();
          //$LASTPOS=76011195;//kernel.Panel:11195
          top=a.shift();
          //$LASTPOS=76011219;//kernel.Panel:11219
          w=a.shift();
          //$LASTPOS=76011241;//kernel.Panel:11241
          h=a.shift();
          
        }
        //$LASTPOS=76011266;//kernel.Panel:11266
        func = a.shift();
        
        //$LASTPOS=76011291;//kernel.Panel:11291
        if (typeof  func!=="function") {
          //$LASTPOS=76011332;//kernel.Panel:11332
          ctx = _this.context;
          
          //$LASTPOS=76011358;//kernel.Panel:11358
          ctx.save();
          //$LASTPOS=76011379;//kernel.Panel:11379
          ctx.beginPath();
          //$LASTPOS=76011405;//kernel.Panel:11405
          ctx.moveTo(left,top);
          //$LASTPOS=76011436;//kernel.Panel:11436
          ctx.lineTo(left+w,top);
          //$LASTPOS=76011469;//kernel.Panel:11469
          ctx.lineTo(left+w,top+h);
          //$LASTPOS=76011504;//kernel.Panel:11504
          ctx.lineTo(left,top+h);
          //$LASTPOS=76011537;//kernel.Panel:11537
          ctx.closePath();
          //$LASTPOS=76011563;//kernel.Panel:11563
          ctx.clip();
          //$LASTPOS=76011584;//kernel.Panel:11584
          ctx.globalCompositeOperation="source-in";
          //$LASTPOS=76011635;//kernel.Panel:11635
          if (func) {
            //$LASTPOS=76011645;//kernel.Panel:11645
            _this.fillStyle=func;
          }
          //$LASTPOS=76011670;//kernel.Panel:11670
          ctx.fillRect(left,top,w,h);
          //$LASTPOS=76011707;//kernel.Panel:11707
          ctx.restore();
          _thread.retVal=_this;return;
          
          
        }
        
        _thread.enter(function _trc_Panel_ent_replaceColor(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=76011751;//kernel.Panel:11751
              _this.fiber$getImageData(_thread, left, top, w, h);
              __pc=1;return;
            case 1:
              data=_thread.retVal;
              
              //$LASTPOS=76011793;//kernel.Panel:11793
              //$LASTPOS=76011798;//kernel.Panel:11798
              i = 0;
              for (; i<h ; i++) {
                {
                  //$LASTPOS=76011826;//kernel.Panel:11826
                  //$LASTPOS=76011831;//kernel.Panel:11831
                  j = 0;
                  for (; j<w ; j++) {
                    {
                      //$LASTPOS=76011863;//kernel.Panel:11863
                      func(new Tonyu.classes.kernel.Color(data,j,i),left+j,top+i);
                    }
                  }
                }
              }
              //$LASTPOS=76011926;//kernel.Panel:11926
              _this.fiber$putImageData(_thread, data, left, top);
              __pc=2;return;
            case 2:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"watchResize":{"nowait":false},"setPanel":{"nowait":false},"resize":{"nowait":false},"getContext":{"nowait":false},"__getter__context":{"nowait":true},"__getter__image":{"nowait":true},"setFillStyle":{"nowait":false},"__getter__fillStyle":{"nowait":true},"__setter__fillStyle":{"nowait":true},"__setter__strokeStyle":{"nowait":true},"__setter__lineWidth":{"nowait":true},"fillCircle":{"nowait":false},"fillRect":{"nowait":true},"fillText":{"nowait":false},"clearRect":{"nowait":false},"getPixel":{"nowait":false},"scroll":{"nowait":false},"draw":{"nowait":true},"drawSprite":{"nowait":true},"copy":{"nowait":true},"convert":{"nowait":false},"drawLine":{"nowait":true},"slicePattern":{"nowait":false},"addPattern":{"nowait":false},"getImageData":{"nowait":false},"putImageData":{"nowait":false},"replace":{"nowait":false},"save":{"nowait":false},"load":{"nowait":false},"__setter__imageSmoothingEnabled":{"nowait":true},"__getter__imageSmoothingEnabled":{"nowait":true},"replaceColor":{"nowait":false}},"fields":{"canvas":{},"_fillStyle":{},"_drawn":{},"buf":{},"imagedata":{},"colordata":{},"px":{},"py":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ScaledCanvas',
  shortName: 'ScaledCanvas',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ScaledCanvas_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ScaledCanvas_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_ScaledCanvas_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=77000095;//kernel.ScaledCanvas:95
        _this.extend(opt);
        //$LASTPOS=77000142;//kernel.ScaledCanvas:142
        _this.resize(_this.width,_this.height);
        //$LASTPOS=77000170;//kernel.ScaledCanvas:170
        _this.cw=_this.canvas.width();
        //$LASTPOS=77000194;//kernel.ScaledCanvas:194
        _this.ch=_this.canvas.height();
        //$LASTPOS=77000219;//kernel.ScaledCanvas:219
        _this.cctx=_this.canvas[0].getContext("2d");
        //$LASTPOS=77000257;//kernel.ScaledCanvas:257
        _this._color="rgb(20,80,180)";
        //$LASTPOS=77000292;//kernel.ScaledCanvas:292
        _this.sx=0;
        //$LASTPOS=77000303;//kernel.ScaledCanvas:303
        _this.sy=0;
        //$LASTPOS=77000314;//kernel.ScaledCanvas:314
        _this.isDrawGrid=Tonyu.globals.$Sprites.isDrawGrid;
      },
      resize :function _trc_ScaledCanvas_resize(width,height) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=77000379;//kernel.ScaledCanvas:379
        _this.width=width;
        //$LASTPOS=77000402;//kernel.ScaledCanvas:402
        _this.height=height;
        //$LASTPOS=77000427;//kernel.ScaledCanvas:427
        _this.buf=$("<canvas>").attr({width: width,height: height});
        //$LASTPOS=77000470;//kernel.ScaledCanvas:470
        _this.ctx=_this.buf[0].getContext("2d");
        //$LASTPOS=77000504;//kernel.ScaledCanvas:504
        Tonyu.globals.$screenWidth=width;
        //$LASTPOS=77000529;//kernel.ScaledCanvas:529
        Tonyu.globals.$screenHeight=height;
        //$LASTPOS=77000556;//kernel.ScaledCanvas:556
        if (Tonyu.globals.$panel) {
          //$LASTPOS=77000577;//kernel.ScaledCanvas:577
          Tonyu.globals.$panel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
          //$LASTPOS=77000631;//kernel.ScaledCanvas:631
          Tonyu.globals.$panel.x=Tonyu.globals.$screenWidth/2;
          //$LASTPOS=77000665;//kernel.ScaledCanvas:665
          Tonyu.globals.$panel.y=Tonyu.globals.$screenHeight/2;
          
        }
        //$LASTPOS=77000703;//kernel.ScaledCanvas:703
        if (Tonyu.globals.$consolePanel) {
          //$LASTPOS=77000731;//kernel.ScaledCanvas:731
          Tonyu.globals.$consolePanel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
          //$LASTPOS=77000792;//kernel.ScaledCanvas:792
          Tonyu.globals.$consolePanel.x=Tonyu.globals.$screenWidth/2;
          //$LASTPOS=77000833;//kernel.ScaledCanvas:833
          Tonyu.globals.$consolePanel.y=Tonyu.globals.$screenHeight/2;
          //$LASTPOS=77000875;//kernel.ScaledCanvas:875
          Tonyu.globals.$consolePrintY=Tonyu.globals.$screenHeight;
          
        }
      },
      fiber$resize :function _trc_ScaledCanvas_f_resize(_thread,width,height) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=77000379;//kernel.ScaledCanvas:379
        _this.width=width;
        //$LASTPOS=77000402;//kernel.ScaledCanvas:402
        _this.height=height;
        //$LASTPOS=77000427;//kernel.ScaledCanvas:427
        _this.buf=$("<canvas>").attr({width: width,height: height});
        //$LASTPOS=77000470;//kernel.ScaledCanvas:470
        _this.ctx=_this.buf[0].getContext("2d");
        //$LASTPOS=77000504;//kernel.ScaledCanvas:504
        Tonyu.globals.$screenWidth=width;
        //$LASTPOS=77000529;//kernel.ScaledCanvas:529
        Tonyu.globals.$screenHeight=height;
        //$LASTPOS=77000556;//kernel.ScaledCanvas:556
        if (Tonyu.globals.$panel) {
          //$LASTPOS=77000577;//kernel.ScaledCanvas:577
          Tonyu.globals.$panel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
          //$LASTPOS=77000631;//kernel.ScaledCanvas:631
          Tonyu.globals.$panel.x=Tonyu.globals.$screenWidth/2;
          //$LASTPOS=77000665;//kernel.ScaledCanvas:665
          Tonyu.globals.$panel.y=Tonyu.globals.$screenHeight/2;
          
        }
        //$LASTPOS=77000703;//kernel.ScaledCanvas:703
        if (Tonyu.globals.$consolePanel) {
          //$LASTPOS=77000731;//kernel.ScaledCanvas:731
          Tonyu.globals.$consolePanel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
          //$LASTPOS=77000792;//kernel.ScaledCanvas:792
          Tonyu.globals.$consolePanel.x=Tonyu.globals.$screenWidth/2;
          //$LASTPOS=77000833;//kernel.ScaledCanvas:833
          Tonyu.globals.$consolePanel.y=Tonyu.globals.$screenHeight/2;
          //$LASTPOS=77000875;//kernel.ScaledCanvas:875
          Tonyu.globals.$consolePrintY=Tonyu.globals.$screenHeight;
          
        }
        
        _thread.retVal=_this;return;
      },
      shouldDraw1x1 :function _trc_ScaledCanvas_shouldDraw1x1(srcw,srch,dstw,dsth) {
        "use strict";
        var _this=this;
        var larger;
        var smaller;
        
        //$LASTPOS=77000994;//kernel.ScaledCanvas:994
        larger = 200;
        
        //$LASTPOS=77001015;//kernel.ScaledCanvas:1015
        smaller = 5;
        
        return srcw-smaller<=dstw&&dstw<=srcw+larger&&srch-smaller<=dsth&&dsth<=srch+larger;
      },
      fiber$shouldDraw1x1 :function _trc_ScaledCanvas_f_shouldDraw1x1(_thread,srcw,srch,dstw,dsth) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var larger;
        var smaller;
        
        //$LASTPOS=77000994;//kernel.ScaledCanvas:994
        larger = 200;
        
        //$LASTPOS=77001015;//kernel.ScaledCanvas:1015
        smaller = 5;
        
        _thread.retVal=srcw-smaller<=dstw&&dstw<=srcw+larger&&srch-smaller<=dsth&&dsth<=srch+larger;return;
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_ScaledCanvas_draw() {
        "use strict";
        var _this=this;
        var calcw;
        var calch;
        var marginw;
        var marginh;
        
        //$LASTPOS=77001150;//kernel.ScaledCanvas:1150
        _this.cw=_this.canvas.width();
        //$LASTPOS=77001174;//kernel.ScaledCanvas:1174
        _this.ch=_this.canvas.height();
        //$LASTPOS=77001199;//kernel.ScaledCanvas:1199
        calcw = _this.ch/_this.height*_this.width;
        
        //$LASTPOS=77001243;//kernel.ScaledCanvas:1243
        calch = _this.cw/_this.width*_this.height;
        
        //$LASTPOS=77001287;//kernel.ScaledCanvas:1287
        if (calch>_this.ch) {
          //$LASTPOS=77001301;//kernel.ScaledCanvas:1301
          calch=_this.ch;
        }
        //$LASTPOS=77001316;//kernel.ScaledCanvas:1316
        if (calcw>_this.cw) {
          //$LASTPOS=77001330;//kernel.ScaledCanvas:1330
          calcw=_this.cw;
        }
        //$LASTPOS=77001345;//kernel.ScaledCanvas:1345
        _this.cctx.clearRect(0,0,_this.cw,_this.ch);
        //$LASTPOS=77001377;//kernel.ScaledCanvas:1377
        if (_this.shouldDraw1x1(_this.width,_this.height,calcw,calch)) {
          //$LASTPOS=77001433;//kernel.ScaledCanvas:1433
          calcw=_this.width;
          //$LASTPOS=77001445;//kernel.ScaledCanvas:1445
          calch=_this.height;
          
        }
        //$LASTPOS=77001471;//kernel.ScaledCanvas:1471
        marginw = Math.floor((_this.cw-calcw)/2);
        
        //$LASTPOS=77001514;//kernel.ScaledCanvas:1514
        marginh = Math.floor((_this.ch-calch)/2);
        
        //$LASTPOS=77001557;//kernel.ScaledCanvas:1557
        _this.cctx.drawImage(_this.buf[0],0,0,_this.width,_this.height,marginw,marginh,calcw,calch);
      },
      canvas2buf :function _trc_ScaledCanvas_canvas2buf(point) {
        "use strict";
        var _this=this;
        var calcw;
        var calch;
        var marginw;
        var marginh;
        
        //$LASTPOS=77001671;//kernel.ScaledCanvas:1671
        calcw = _this.ch/_this.height*_this.width;
        
        //$LASTPOS=77001715;//kernel.ScaledCanvas:1715
        calch = _this.cw/_this.width*_this.height;
        
        //$LASTPOS=77001759;//kernel.ScaledCanvas:1759
        if (calch>_this.ch) {
          //$LASTPOS=77001773;//kernel.ScaledCanvas:1773
          calch=_this.ch;
        }
        //$LASTPOS=77001788;//kernel.ScaledCanvas:1788
        if (calcw>_this.cw) {
          //$LASTPOS=77001802;//kernel.ScaledCanvas:1802
          calcw=_this.cw;
        }
        //$LASTPOS=77001817;//kernel.ScaledCanvas:1817
        if (_this.shouldDraw1x1(_this.width,_this.height,calcw,calch)) {
          //$LASTPOS=77001873;//kernel.ScaledCanvas:1873
          calcw=_this.width;
          //$LASTPOS=77001885;//kernel.ScaledCanvas:1885
          calch=_this.height;
          
        }
        //$LASTPOS=77001911;//kernel.ScaledCanvas:1911
        marginw = Math.floor((_this.cw-calcw)/2);
        
        //$LASTPOS=77001954;//kernel.ScaledCanvas:1954
        marginh = Math.floor((_this.ch-calch)/2);
        
        //$LASTPOS=77002050;//kernel.ScaledCanvas:2050
        _this._ret="("+point.x+"-"+marginw+")/"+calcw+"*"+_this.width+",";
        return {x: (point.x-marginw)/calcw*_this.width,y: (point.y-marginh)/calch*_this.height};
      },
      fiber$canvas2buf :function _trc_ScaledCanvas_f_canvas2buf(_thread,point) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var calcw;
        var calch;
        var marginw;
        var marginh;
        
        //$LASTPOS=77001671;//kernel.ScaledCanvas:1671
        calcw = _this.ch/_this.height*_this.width;
        
        //$LASTPOS=77001715;//kernel.ScaledCanvas:1715
        calch = _this.cw/_this.width*_this.height;
        
        //$LASTPOS=77001759;//kernel.ScaledCanvas:1759
        if (calch>_this.ch) {
          //$LASTPOS=77001773;//kernel.ScaledCanvas:1773
          calch=_this.ch;
        }
        //$LASTPOS=77001788;//kernel.ScaledCanvas:1788
        if (calcw>_this.cw) {
          //$LASTPOS=77001802;//kernel.ScaledCanvas:1802
          calcw=_this.cw;
        }
        //$LASTPOS=77001817;//kernel.ScaledCanvas:1817
        if (_this.shouldDraw1x1(_this.width,_this.height,calcw,calch)) {
          //$LASTPOS=77001873;//kernel.ScaledCanvas:1873
          calcw=_this.width;
          //$LASTPOS=77001885;//kernel.ScaledCanvas:1885
          calch=_this.height;
          
        }
        //$LASTPOS=77001911;//kernel.ScaledCanvas:1911
        marginw = Math.floor((_this.cw-calcw)/2);
        
        //$LASTPOS=77001954;//kernel.ScaledCanvas:1954
        marginh = Math.floor((_this.ch-calch)/2);
        
        //$LASTPOS=77002050;//kernel.ScaledCanvas:2050
        _this._ret="("+point.x+"-"+marginw+")/"+calcw+"*"+_this.width+",";
        _thread.retVal={x: (point.x-marginw)/calcw*_this.width,y: (point.y-marginh)/calch*_this.height};return;
        
        
        _thread.retVal=_this;return;
      },
      setBGColor :function _trc_ScaledCanvas_setBGColor(color) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=77002222;//kernel.ScaledCanvas:2222
        _this._color=color;
      },
      fiber$setBGColor :function _trc_ScaledCanvas_f_setBGColor(_thread,color) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=77002222;//kernel.ScaledCanvas:2222
        _this._color=color;
        
        _thread.retVal=_this;return;
      },
      fillCanvas :function _trc_ScaledCanvas_fillCanvas(cv) {
        "use strict";
        var _this=this;
        var ctx;
        
        //$LASTPOS=77002267;//kernel.ScaledCanvas:2267
        ctx = cv.getContext("2d");
        
        //$LASTPOS=77002301;//kernel.ScaledCanvas:2301
        ctx.save();
        //$LASTPOS=77002318;//kernel.ScaledCanvas:2318
        ctx.fillStyle=_this._color+"";
        //$LASTPOS=77002348;//kernel.ScaledCanvas:2348
        ctx.fillRect(0,0,cv.width,cv.height);
        //$LASTPOS=77002391;//kernel.ScaledCanvas:2391
        if (_this.isDrawGrid) {
          //$LASTPOS=77002407;//kernel.ScaledCanvas:2407
          _this.drawGrid(cv);
        }
        //$LASTPOS=77002426;//kernel.ScaledCanvas:2426
        ctx.restore();
      },
      fiber$fillCanvas :function _trc_ScaledCanvas_f_fillCanvas(_thread,cv) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var ctx;
        
        //$LASTPOS=77002267;//kernel.ScaledCanvas:2267
        ctx = cv.getContext("2d");
        
        //$LASTPOS=77002301;//kernel.ScaledCanvas:2301
        ctx.save();
        //$LASTPOS=77002318;//kernel.ScaledCanvas:2318
        ctx.fillStyle=_this._color+"";
        //$LASTPOS=77002348;//kernel.ScaledCanvas:2348
        ctx.fillRect(0,0,cv.width,cv.height);
        //$LASTPOS=77002391;//kernel.ScaledCanvas:2391
        if (_this.isDrawGrid) {
          //$LASTPOS=77002407;//kernel.ScaledCanvas:2407
          _this.drawGrid(cv);
        }
        //$LASTPOS=77002426;//kernel.ScaledCanvas:2426
        ctx.restore();
        
        _thread.retVal=_this;return;
      },
      scrollTo :function _trc_ScaledCanvas_scrollTo(scrollX,scrollY) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=77002770;//kernel.ScaledCanvas:2770
        Tonyu.globals.$Sprites.scrollTo(scrollX,scrollY);
      },
      fiber$scrollTo :function _trc_ScaledCanvas_f_scrollTo(_thread,scrollX,scrollY) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=77002770;//kernel.ScaledCanvas:2770
        Tonyu.globals.$Sprites.scrollTo(scrollX,scrollY);
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"resize":{"nowait":false},"shouldDraw1x1":{"nowait":false},"draw":{"nowait":true},"canvas2buf":{"nowait":false},"setBGColor":{"nowait":false},"fillCanvas":{"nowait":false},"scrollTo":{"nowait":false}},"fields":{"cw":{},"canvas":{},"ch":{},"cctx":{},"sx":{},"sy":{},"isDrawGrid":{},"buf":{},"ctx":{},"_ret":{},"_color":{},"drawGrid":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Screen',
  shortName: 'Screen',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Panel,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Screen_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Screen_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Screen_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=78000031;//kernel.Screen:31
        _this.layers=[];
        //$LASTPOS=78000046;//kernel.Screen:46
        _this._color="black";
        //$LASTPOS=78000066;//kernel.Screen:66
        _this.camera={screen: _this};
        //$LASTPOS=78000092;//kernel.Screen:92
        __superClass.apply( _this, [opt]);
      },
      drawLayers :function _trc_Screen_drawLayers() {
        "use strict";
        var _this=this;
        var c;
        var i;
        var l;
        
        //$LASTPOS=78000127;//kernel.Screen:127
        if (! _this._drawing) {
          //$LASTPOS=78000152;//kernel.Screen:152
          if (! _this.canvas) {
            throw new Error("canvas is null");
            
            
          }
          //$LASTPOS=78000232;//kernel.Screen:232
          _this._drawing=true;
          //$LASTPOS=78000255;//kernel.Screen:255
          if (_this.clearBG) {
            //$LASTPOS=78000282;//kernel.Screen:282
            _this.clearRect(0,0,_this.width,_this.height);
            
          }
          //$LASTPOS=78000329;//kernel.Screen:329
          _this.fillStyle=_this._color+"";
          //$LASTPOS=78000358;//kernel.Screen:358
          _this.fillRect(0,0,_this.width,_this.height);
          //$LASTPOS=78000394;//kernel.Screen:394
          c = _this.getContext();
          
          //$LASTPOS=78000422;//kernel.Screen:422
          //$LASTPOS=78000427;//kernel.Screen:427
          i = _this.layers.length-1;
          for (; i>=0 ; i--) {
            {
              //$LASTPOS=78000473;//kernel.Screen:473
              l = _this.layers[i];
              
              //$LASTPOS=78000502;//kernel.Screen:502
              l.draw(c);
            }
          }
          //$LASTPOS=78000531;//kernel.Screen:531
          _this._drawing=false;
          
        }
      },
      fiber$drawLayers :function _trc_Screen_f_drawLayers(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var c;
        var i;
        var l;
        
        
        _thread.enter(function _trc_Screen_ent_drawLayers(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=78000127;//kernel.Screen:127
              if (!(! _this._drawing)) { __pc=4     ; break; }
              //$LASTPOS=78000152;//kernel.Screen:152
              if (! _this.canvas) {
                throw new Error("canvas is null");
                
                
              }
              //$LASTPOS=78000232;//kernel.Screen:232
              _this._drawing=true;
              //$LASTPOS=78000255;//kernel.Screen:255
              if (!(_this.clearBG)) { __pc=2     ; break; }
              //$LASTPOS=78000282;//kernel.Screen:282
              _this.fiber$clearRect(_thread, 0, 0, _this.width, _this.height);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              //$LASTPOS=78000329;//kernel.Screen:329
              _this.fillStyle=_this._color+"";
              //$LASTPOS=78000358;//kernel.Screen:358
              _this.fillRect(0,0,_this.width,_this.height);
              //$LASTPOS=78000394;//kernel.Screen:394
              _this.fiber$getContext(_thread);
              __pc=3;return;
            case 3:
              c=_thread.retVal;
              
              //$LASTPOS=78000422;//kernel.Screen:422
              //$LASTPOS=78000427;//kernel.Screen:427
              i = _this.layers.length-1;
              for (; i>=0 ; i--) {
                {
                  //$LASTPOS=78000473;//kernel.Screen:473
                  l = _this.layers[i];
                  
                  //$LASTPOS=78000502;//kernel.Screen:502
                  l.draw(c);
                }
              }
              //$LASTPOS=78000531;//kernel.Screen:531
              _this._drawing=false;
            case 4     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      draw :function _trc_Screen_draw(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=78000572;//kernel.Screen:572
        _this.drawLayers();
        //$LASTPOS=78000590;//kernel.Screen:590
        __superClass.prototype.draw.apply( _this, [ctx]);
      },
      addLayer :function _trc_Screen_addLayer(group,at) {
        "use strict";
        var _this=this;
        var layer;
        
        
        //$LASTPOS=78000650;//kernel.Screen:650
        if (Tonyu.is(group,Tonyu.classes.kernel.ScreenLayer)) {
          //$LASTPOS=78000686;//kernel.Screen:686
          layer=group;
          
        } else {
          //$LASTPOS=78000720;//kernel.Screen:720
          group=group||new Tonyu.classes.kernel.Sprites;
          //$LASTPOS=78000827;//kernel.Screen:827
          layer=new Tonyu.classes.kernel.Layer2D({spx: 0,spy: 0,wpx: 0,wpy: 0,rotation: 0,scale: 1,group: group,screen: _this,index: _this.layers.length});
          
        }
        //$LASTPOS=78000986;//kernel.Screen:986
        if (at==null) {
          //$LASTPOS=78001000;//kernel.Screen:1000
          _this.layers.push(layer);
        } else {
          //$LASTPOS=78001039;//kernel.Screen:1039
          if (at<0) {
            //$LASTPOS=78001049;//kernel.Screen:1049
            at=_this.layers.length-at;
          }
          //$LASTPOS=78001078;//kernel.Screen:1078
          _this.layers.splice(at,0,layer);
          
        }
        //$LASTPOS=78001115;//kernel.Screen:1115
        if (_this.layers.length==1&&_this.index==null) {
          //$LASTPOS=78001162;//kernel.Screen:1162
          _this.selectLayer(layer);
          
        }
        return layer;
      },
      fiber$addLayer :function _trc_Screen_f_addLayer(_thread,group,at) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var layer;
        
        
        //$LASTPOS=78000650;//kernel.Screen:650
        if (Tonyu.is(group,Tonyu.classes.kernel.ScreenLayer)) {
          //$LASTPOS=78000686;//kernel.Screen:686
          layer=group;
          
        } else {
          //$LASTPOS=78000720;//kernel.Screen:720
          group=group||new Tonyu.classes.kernel.Sprites;
          //$LASTPOS=78000827;//kernel.Screen:827
          layer=new Tonyu.classes.kernel.Layer2D({spx: 0,spy: 0,wpx: 0,wpy: 0,rotation: 0,scale: 1,group: group,screen: _this,index: _this.layers.length});
          
        }
        //$LASTPOS=78000986;//kernel.Screen:986
        if (at==null) {
          //$LASTPOS=78001000;//kernel.Screen:1000
          _this.layers.push(layer);
        } else {
          //$LASTPOS=78001039;//kernel.Screen:1039
          if (at<0) {
            //$LASTPOS=78001049;//kernel.Screen:1049
            at=_this.layers.length-at;
          }
          //$LASTPOS=78001078;//kernel.Screen:1078
          _this.layers.splice(at,0,layer);
          
        }
        
        _thread.enter(function _trc_Screen_ent_addLayer(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=78001115;//kernel.Screen:1115
              if (!(_this.layers.length==1&&_this.index==null)) { __pc=2     ; break; }
              //$LASTPOS=78001162;//kernel.Screen:1162
              _this.fiber$selectLayer(_thread, layer);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              _thread.exit(layer);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      selectLayer :function _trc_Screen_selectLayer(i) {
        "use strict";
        var _this=this;
        var r;
        
        //$LASTPOS=78001230;//kernel.Screen:1230
        r = _this.findLayerIndex(i);
        
        //$LASTPOS=78001259;//kernel.Screen:1259
        if (r!=null) {
          //$LASTPOS=78001272;//kernel.Screen:1272
          _this.index=r;
        }
      },
      fiber$selectLayer :function _trc_Screen_f_selectLayer(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        
        
        _thread.enter(function _trc_Screen_ent_selectLayer(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=78001230;//kernel.Screen:1230
              _this.fiber$findLayerIndex(_thread, i);
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              //$LASTPOS=78001259;//kernel.Screen:1259
              if (r!=null) {
                //$LASTPOS=78001272;//kernel.Screen:1272
                _this.index=r;
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      findLayerIndex :function _trc_Screen_findLayerIndex(i) {
        "use strict";
        var _this=this;
        var j;
        
        //$LASTPOS=78001308;//kernel.Screen:1308
        if (typeof  i=="number") {
          //$LASTPOS=78001342;//kernel.Screen:1342
          if (_this.layers[i]) {
            return i;
          }
          
        } else {
          //$LASTPOS=78001388;//kernel.Screen:1388
          //$LASTPOS=78001393;//kernel.Screen:1393
          j = 0;
          for (; j<_this.layers.length ; j++) {
            {
              //$LASTPOS=78001437;//kernel.Screen:1437
              if (_this.layers[j]==i||_this.layers[j].group==i) {
                return j;
                
              }
            }
          }
          
        }
        return - 1;
      },
      fiber$findLayerIndex :function _trc_Screen_f_findLayerIndex(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var j;
        
        //$LASTPOS=78001308;//kernel.Screen:1308
        if (typeof  i=="number") {
          //$LASTPOS=78001342;//kernel.Screen:1342
          if (_this.layers[i]) {
            _thread.retVal=i;return;
            
          }
          
        } else {
          //$LASTPOS=78001388;//kernel.Screen:1388
          //$LASTPOS=78001393;//kernel.Screen:1393
          j = 0;
          for (; j<_this.layers.length ; j++) {
            {
              //$LASTPOS=78001437;//kernel.Screen:1437
              if (_this.layers[j]==i||_this.layers[j].group==i) {
                _thread.retVal=j;return;
                
                
              }
            }
          }
          
        }
        _thread.retVal=- 1;return;
        
        
        _thread.retVal=_this;return;
      },
      findLayer :function _trc_Screen_findLayer(key) {
        "use strict";
        var _this=this;
        var idx;
        
        //$LASTPOS=78001574;//kernel.Screen:1574
        idx = _this.findLayerIndex(key);
        
        //$LASTPOS=78001607;//kernel.Screen:1607
        if (idx>=0) {
          return _this.layers[idx];
        }
        return null;
      },
      fiber$findLayer :function _trc_Screen_f_findLayer(_thread,key) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var idx;
        
        
        _thread.enter(function _trc_Screen_ent_findLayer(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=78001574;//kernel.Screen:1574
              _this.fiber$findLayerIndex(_thread, key);
              __pc=1;return;
            case 1:
              idx=_thread.retVal;
              
              //$LASTPOS=78001607;//kernel.Screen:1607
              if (!(idx>=0)) { __pc=2     ; break; }
              _thread.exit(_this.layers[idx]);return;
            case 2     :
              
              _thread.exit(null);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      setPivot :function _trc_Screen_setPivot(x,y) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=78001679;//kernel.Screen:1679
        _this.layers[_this.index].spx=x;
        //$LASTPOS=78001704;//kernel.Screen:1704
        _this.layers[_this.index].spy=y;
      },
      fiber$setPivot :function _trc_Screen_f_setPivot(_thread,x,y) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=78001679;//kernel.Screen:1679
        _this.layers[_this.index].spx=x;
        //$LASTPOS=78001704;//kernel.Screen:1704
        _this.layers[_this.index].spy=y;
        
        _thread.retVal=_this;return;
      },
      scrollTo :function _trc_Screen_scrollTo(x,y,scl,rot) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=78001756;//kernel.Screen:1756
        _this.layers[_this.index].wpx=x;
        //$LASTPOS=78001781;//kernel.Screen:1781
        _this.layers[_this.index].wpy=y;
        //$LASTPOS=78001806;//kernel.Screen:1806
        if (typeof  scl=="number") {
          //$LASTPOS=78001832;//kernel.Screen:1832
          _this.layers[_this.index].scale=scl;
        }
        //$LASTPOS=78001861;//kernel.Screen:1861
        if (typeof  rot=="number") {
          //$LASTPOS=78001887;//kernel.Screen:1887
          _this.layers[_this.index].rotation=rot;
        }
      },
      fiber$scrollTo :function _trc_Screen_f_scrollTo(_thread,x,y,scl,rot) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=78001756;//kernel.Screen:1756
        _this.layers[_this.index].wpx=x;
        //$LASTPOS=78001781;//kernel.Screen:1781
        _this.layers[_this.index].wpy=y;
        //$LASTPOS=78001806;//kernel.Screen:1806
        if (typeof  scl=="number") {
          //$LASTPOS=78001832;//kernel.Screen:1832
          _this.layers[_this.index].scale=scl;
        }
        //$LASTPOS=78001861;//kernel.Screen:1861
        if (typeof  rot=="number") {
          //$LASTPOS=78001887;//kernel.Screen:1887
          _this.layers[_this.index].rotation=rot;
        }
        
        _thread.retVal=_this;return;
      },
      canvas2buf :function _trc_Screen_canvas2buf(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=78001938;//kernel.Screen:1938
        p.layer=_this.layer;
        return _this.convert(p,_this);
      },
      fiber$canvas2buf :function _trc_Screen_f_canvas2buf(_thread,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=78001938;//kernel.Screen:1938
        p.layer=_this.layer;
        
        _thread.enter(function _trc_Screen_ent_canvas2buf(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$convert(_thread, p, _this);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      convert :function _trc_Screen_convert(obj,toLayer) {
        "use strict";
        var _this=this;
        var p;
        var l;
        
        //$LASTPOS=78002169;//kernel.Screen:2169
        if (toLayer==null) {
          //$LASTPOS=78002188;//kernel.Screen:2188
          toLayer=_this;
        }
        //$LASTPOS=78002206;//kernel.Screen:2206
        if (! obj.layer) {
          //$LASTPOS=78002222;//kernel.Screen:2222
          obj.layer=_this;
        }
        //$LASTPOS=78002278;//kernel.Screen:2278
        if (obj.layer===toLayer) {
          return obj;
        }
        //$LASTPOS=78002319;//kernel.Screen:2319
        if (obj.layer!==_this&&toLayer!==_this) {
          //$LASTPOS=78002369;//kernel.Screen:2369
          p = _this.convert(obj,_this);
          
          return _this.convert(p,toLayer);
          
        } else {
          //$LASTPOS=78002440;//kernel.Screen:2440
          if (obj.layer!==_this&&toLayer===_this) {
            //$LASTPOS=78002490;//kernel.Screen:2490
            l = _this.findLayer(obj.layer);
            
            //$LASTPOS=78002526;//kernel.Screen:2526
            if (l!=null) {
              return l.world2screen(obj);
              
            } else {
              return __superClass.prototype.convert.apply( _this, [obj,_this]);
              
            }
            
          } else {
            //$LASTPOS=78002724;//kernel.Screen:2724
            if (obj.layer===_this&&toLayer!==_this) {
              //$LASTPOS=78002774;//kernel.Screen:2774
              l = _this.findLayer(toLayer);
              
              //$LASTPOS=78002808;//kernel.Screen:2808
              if (l!=null) {
                return l.screen2world(obj);
                
              } else {
                return __superClass.prototype.convert.apply( _this, [obj,toLayer]);
                
              }
              
            } else {
              return obj;
            }
          }
        }
      },
      fiber$convert :function _trc_Screen_f_convert(_thread,obj,toLayer) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var p;
        var l;
        
        //$LASTPOS=78002169;//kernel.Screen:2169
        if (toLayer==null) {
          //$LASTPOS=78002188;//kernel.Screen:2188
          toLayer=_this;
        }
        //$LASTPOS=78002206;//kernel.Screen:2206
        if (! obj.layer) {
          //$LASTPOS=78002222;//kernel.Screen:2222
          obj.layer=_this;
        }
        //$LASTPOS=78002278;//kernel.Screen:2278
        if (obj.layer===toLayer) {
          _thread.retVal=obj;return;
          
        }
        
        _thread.enter(function _trc_Screen_ent_convert(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=78002319;//kernel.Screen:2319
              if (!(obj.layer!==_this&&toLayer!==_this)) { __pc=3     ; break; }
              //$LASTPOS=78002369;//kernel.Screen:2369
              _this.fiber$convert(_thread, obj, _this);
              __pc=1;return;
            case 1:
              p=_thread.retVal;
              
              _this.fiber$convert(_thread, p, toLayer);
              __pc=2;return;
            case 2:
              _thread.exit(_thread.retVal);return;
              
              __pc=14    ;break;
            case 3     :
              //$LASTPOS=78002440;//kernel.Screen:2440
              if (!(obj.layer!==_this&&toLayer===_this)) { __pc=7     ; break; }
              //$LASTPOS=78002490;//kernel.Screen:2490
              _this.fiber$findLayer(_thread, obj.layer);
              __pc=4;return;
            case 4:
              l=_thread.retVal;
              
              //$LASTPOS=78002526;//kernel.Screen:2526
              if (!(l!=null)) { __pc=5     ; break; }
              _thread.exit(l.world2screen(obj));return;
              __pc=6     ;break;
            case 5     :
              _thread.exit(__superClass.prototype.convert.apply( _this, [obj,_this]));return;
            case 6     :
              
              __pc=13    ;break;
            case 7     :
              //$LASTPOS=78002724;//kernel.Screen:2724
              if (!(obj.layer===_this&&toLayer!==_this)) { __pc=11    ; break; }
              //$LASTPOS=78002774;//kernel.Screen:2774
              _this.fiber$findLayer(_thread, toLayer);
              __pc=8;return;
            case 8:
              l=_thread.retVal;
              
              //$LASTPOS=78002808;//kernel.Screen:2808
              if (!(l!=null)) { __pc=9     ; break; }
              _thread.exit(l.screen2world(obj));return;
              __pc=10    ;break;
            case 9     :
              _thread.exit(__superClass.prototype.convert.apply( _this, [obj,toLayer]));return;
            case 10    :
              
              __pc=12    ;break;
            case 11    :
              _thread.exit(obj);return;
            case 12    :
              
            case 13    :
              
            case 14    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      setBGColor :function _trc_Screen_setBGColor(color) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=78003045;//kernel.Screen:3045
        _this._color=color;
      },
      fiber$setBGColor :function _trc_Screen_f_setBGColor(_thread,color) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=78003045;//kernel.Screen:3045
        _this._color=color;
        
        _thread.retVal=_this;return;
      },
      all :function _trc_Screen_all() {
        "use strict";
        var _this=this;
        var res;
        var l;
        var _it_704;
        var q;
        
        //$LASTPOS=78003079;//kernel.Screen:3079
        res = new Tonyu.classes.kernel.TQuery({screen: _this});
        
        //$LASTPOS=78003116;//kernel.Screen:3116
        _it_704=Tonyu.iterator(_this.layers,1);
        while(_it_704.next()) {
          l=_it_704[0];
          
          //$LASTPOS=78003148;//kernel.Screen:3148
          q = l.group.all.apply(l.group,arguments);
          
          //$LASTPOS=78003200;//kernel.Screen:3200
          res.push(q);
          
        }
        return res;
      },
      touchedFingers :function _trc_Screen_touchedFingers(q,options) {
        "use strict";
        var _this=this;
        var res;
        var e;
        var _it_709;
        var r;
        var i;
        var t;
        var p;
        
        //$LASTPOS=78003306;//kernel.Screen:3306
        res = [];
        
        //$LASTPOS=78003322;//kernel.Screen:3322
        options=options||{};
        //$LASTPOS=78003347;//kernel.Screen:3347
        _it_709=Tonyu.iterator(q,1);
        while(_it_709.next()) {
          e=_it_709[0];
          
          //$LASTPOS=78003374;//kernel.Screen:3374
          r = e.getCrashRect();
          
          //$LASTPOS=78003406;//kernel.Screen:3406
          //$LASTPOS=78003411;//kernel.Screen:3411
          i = 0;
          for (; i<Tonyu.globals.$touches.length ; i++) {
            {
              //$LASTPOS=78003456;//kernel.Screen:3456
              t = Tonyu.globals.$touches[i];
              
              //$LASTPOS=78003487;//kernel.Screen:3487
              if (t.touched==1) {
                //$LASTPOS=78003523;//kernel.Screen:3523
                p = _this.convert(t,e.layer);
                
                //$LASTPOS=78003565;//kernel.Screen:3565
                if (p.x>=r.x-r.width/2&&p.x<=r.x+r.width/2&&p.y>=r.y-r.height/2&&p.y<=r.y+r.height/2) {
                  //$LASTPOS=78003695;//kernel.Screen:3695
                  t.captured=e;
                  //$LASTPOS=78003729;//kernel.Screen:3729
                  res.push(t);
                  
                }
                
              }
            }
          }
          
        }
        return res;
      },
      fiber$touchedFingers :function _trc_Screen_f_touchedFingers(_thread,q,options) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var e;
        var _it_709;
        var r;
        var i;
        var t;
        var p;
        
        //$LASTPOS=78003306;//kernel.Screen:3306
        res = [];
        
        //$LASTPOS=78003322;//kernel.Screen:3322
        options=options||{};
        
        _thread.enter(function _trc_Screen_ent_touchedFingers(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=78003347;//kernel.Screen:3347
              _it_709=Tonyu.iterator(q,1);
            case 1:
              if (!(_it_709.next())) { __pc=7     ; break; }
              e=_it_709[0];
              
              //$LASTPOS=78003374;//kernel.Screen:3374
              r = e.getCrashRect();
              
              //$LASTPOS=78003406;//kernel.Screen:3406
              //$LASTPOS=78003411;//kernel.Screen:3411
              i = 0;
              
            case 2:
              if (!(i<Tonyu.globals.$touches.length)) { __pc=6     ; break; }
              //$LASTPOS=78003456;//kernel.Screen:3456
              t = Tonyu.globals.$touches[i];
              
              //$LASTPOS=78003487;//kernel.Screen:3487
              if (!(t.touched==1)) { __pc=4     ; break; }
              //$LASTPOS=78003523;//kernel.Screen:3523
              _this.fiber$convert(_thread, t, e.layer);
              __pc=3;return;
            case 3:
              p=_thread.retVal;
              
              //$LASTPOS=78003565;//kernel.Screen:3565
              if (p.x>=r.x-r.width/2&&p.x<=r.x+r.width/2&&p.y>=r.y-r.height/2&&p.y<=r.y+r.height/2) {
                //$LASTPOS=78003695;//kernel.Screen:3695
                t.captured=e;
                //$LASTPOS=78003729;//kernel.Screen:3729
                res.push(t);
                
              }
            case 4     :
              
            case 5     :
              i++;
              __pc=2;break;
            case 6     :
              
              __pc=1;break;
            case 7     :
              
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"drawLayers":{"nowait":false},"draw":{"nowait":true},"addLayer":{"nowait":false},"selectLayer":{"nowait":false},"findLayerIndex":{"nowait":false},"findLayer":{"nowait":false},"setPivot":{"nowait":false},"scrollTo":{"nowait":false},"canvas2buf":{"nowait":false},"convert":{"nowait":false},"setBGColor":{"nowait":false},"all":{"nowait":true},"touchedFingers":{"nowait":false}},"fields":{"layers":{},"_color":{},"camera":{},"_drawing":{},"clearBG":{},"index":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.BodyActor',
  shortName: 'BodyActor',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [Tonyu.classes.kernel.T2Mod],
  methods: function (__superClass) {
    return {
      main :function _trc_BodyActor_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_BodyActor_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_BodyActor_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79000082;//kernel.BodyActor:82
        __superClass.apply( _this, [p]);
        //$LASTPOS=79000097;//kernel.BodyActor:97
        _this._th.on("end",Tonyu.bindFunc(_this,_this.initBody));
      },
      getWorld :function _trc_BodyActor_getWorld() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79000145;//kernel.BodyActor:145
        if (Tonyu.globals.$t2World) {
          return Tonyu.globals.$t2World;
        }
        //$LASTPOS=79000181;//kernel.BodyActor:181
        Tonyu.globals.$t2World=new Tonyu.classes.kernel.T2World;
        return Tonyu.globals.$t2World;
      },
      fiber$getWorld :function _trc_BodyActor_f_getWorld(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=79000145;//kernel.BodyActor:145
        if (Tonyu.globals.$t2World) {
          _thread.retVal=Tonyu.globals.$t2World;return;
          
        }
        //$LASTPOS=79000181;//kernel.BodyActor:181
        Tonyu.globals.$t2World=new Tonyu.classes.kernel.T2World;
        _thread.retVal=Tonyu.globals.$t2World;return;
        
        
        _thread.retVal=_this;return;
      },
      update :function _trc_BodyActor_update() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79000246;//kernel.BodyActor:246
        _this.initBody();
        //$LASTPOS=79000263;//kernel.BodyActor:263
        __superClass.prototype.update.apply( _this, []);
      },
      fiber$update :function _trc_BodyActor_f_update(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_BodyActor_ent_update(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79000246;//kernel.BodyActor:246
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79000263;//kernel.BodyActor:263
              __superClass.prototype.fiber$update.apply( _this, [_thread]);
              __pc=2;return;
            case 2:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initBody :function _trc_BodyActor_initBody() {
        "use strict";
        var _this=this;
        var wworld;
        var b2Vec2;
        var b2BodyDef;
        var b2Body;
        var b2FixtureDef;
        var b2Fixture;
        var b2PolygonShape;
        var b2CircleShape;
        var fixDef;
        var bodyDef;
        var w;
        var h;
        var t;
        var fps;
        var r;
        var ve;
        var vr;
        
        //$LASTPOS=79000302;//kernel.BodyActor:302
        if (_this.body) {
          return _this;
        }
        //$LASTPOS=79000325;//kernel.BodyActor:325
        wworld = _this.getWorld();
        
        //$LASTPOS=79000353;//kernel.BodyActor:353
        _this.world=wworld.world;
        //$LASTPOS=79000378;//kernel.BodyActor:378
        _this.scale=wworld.scale;
        //$LASTPOS=79000403;//kernel.BodyActor:403
        b2Vec2 = Box2D.Common.Math.b2Vec2;
        
        //$LASTPOS=79000447;//kernel.BodyActor:447
        b2BodyDef = Box2D.Dynamics.b2BodyDef;
        
        //$LASTPOS=79000494;//kernel.BodyActor:494
        b2Body = Box2D.Dynamics.b2Body;
        
        //$LASTPOS=79000535;//kernel.BodyActor:535
        b2FixtureDef = Box2D.Dynamics.b2FixtureDef;
        
        //$LASTPOS=79000588;//kernel.BodyActor:588
        b2Fixture = Box2D.Dynamics.b2Fixture;
        
        //$LASTPOS=79000635;//kernel.BodyActor:635
        b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape;
        
        //$LASTPOS=79000700;//kernel.BodyActor:700
        b2CircleShape = Box2D.Collision.Shapes.b2CircleShape;
        
        //$LASTPOS=79000765;//kernel.BodyActor:765
        fixDef = new b2FixtureDef;
        
        //$LASTPOS=79000801;//kernel.BodyActor:801
        fixDef.density=_this.defv(_this.density,1);
        //$LASTPOS=79000843;//kernel.BodyActor:843
        fixDef.friction=_this.defv(_this.friction,0.5);
        //$LASTPOS=79000887;//kernel.BodyActor:887
        fixDef.restitution=_this.defv(_this.restitution,0.2);
        //$LASTPOS=79000939;//kernel.BodyActor:939
        bodyDef = new b2BodyDef;
        
        //$LASTPOS=79000973;//kernel.BodyActor:973
        bodyDef.type=_this.isStatic?b2Body.b2_staticBody:b2Body.b2_dynamicBody;
        //$LASTPOS=79001057;//kernel.BodyActor:1057
        bodyDef.position.x=_this.x/_this.scale;
        //$LASTPOS=79001093;//kernel.BodyActor:1093
        bodyDef.position.y=_this.y/_this.scale;
        //$LASTPOS=79001129;//kernel.BodyActor:1129
        _this.shape=_this.shape||(_this.radius?"circle":"box");
        //$LASTPOS=79001178;//kernel.BodyActor:1178
        w = _this.width;
        h = _this.height;
        
        //$LASTPOS=79001205;//kernel.BodyActor:1205
        if (! w) {
          //$LASTPOS=79001224;//kernel.BodyActor:1224
          t = _this.detectSpriteType();
          
          //$LASTPOS=79001259;//kernel.BodyActor:1259
          if (t==="Image") {
            //$LASTPOS=79001276;//kernel.BodyActor:1276
            _this.prepareImage();
          } else {
            //$LASTPOS=79001306;//kernel.BodyActor:1306
            if (t==="Custom") {
              //$LASTPOS=79001339;//kernel.BodyActor:1339
              if (_this.p.width*_this.p.height>0) {
                //$LASTPOS=79001423;//kernel.BodyActor:1423
                _this.width=_this.p.width;
                //$LASTPOS=79001455;//kernel.BodyActor:1455
                _this.height=_this.p.height;
                
              }
              
            }
          }
          //$LASTPOS=79001507;//kernel.BodyActor:1507
          w=_this.width*(_this.scaleX||1);
          //$LASTPOS=79001537;//kernel.BodyActor:1537
          h=_this.height*(_this.scaleY||_this.scaleX||1);
          
        }
        //$LASTPOS=79001579;//kernel.BodyActor:1579
        if (_this.shape=="box") {
          //$LASTPOS=79001608;//kernel.BodyActor:1608
          if (! w) {
            //$LASTPOS=79001631;//kernel.BodyActor:1631
            console.log(_this);
            throw new Error("BodyActor::width is not set");
            
            
          }
          //$LASTPOS=79001731;//kernel.BodyActor:1731
          if (! h) {
            //$LASTPOS=79001739;//kernel.BodyActor:1739
            h=w;
          }
          //$LASTPOS=79001753;//kernel.BodyActor:1753
          fixDef.shape=new b2PolygonShape;
          //$LASTPOS=79001797;//kernel.BodyActor:1797
          fixDef.shape.SetAsOrientedBox(w/2/_this.scale,h/2/_this.scale,new b2Vec2(0,0),0);
          
        } else {
          //$LASTPOS=79001901;//kernel.BodyActor:1901
          _this.radius=_this.radius||w/2||16;
          //$LASTPOS=79001938;//kernel.BodyActor:1938
          fixDef.shape=new b2CircleShape(_this.radius/_this.scale);
          //$LASTPOS=79002015;//kernel.BodyActor:2015
          _this.width=_this.height=_this.radius*2;
          
        }
        //$LASTPOS=79002050;//kernel.BodyActor:2050
        fps = wworld.fps;
        
        //$LASTPOS=79002075;//kernel.BodyActor:2075
        r = _this.rotation;
        ve = _this.bvec(_this.defv(_this.vx*fps,0),_this.defv(_this.vy*fps,0));
        vr = _this.defv(_this.vrotation,0);
        
        //$LASTPOS=79002157;//kernel.BodyActor:2157
        _this.body=_this.world.CreateBody(bodyDef);
        //$LASTPOS=79002194;//kernel.BodyActor:2194
        _this.body.CreateFixture(fixDef);
        //$LASTPOS=79002227;//kernel.BodyActor:2227
        _this.body.SetUserData(_this);
        //$LASTPOS=79002256;//kernel.BodyActor:2256
        _this.body.SetLinearVelocity(ve);
        //$LASTPOS=79002289;//kernel.BodyActor:2289
        _this.rotation=r;
        //$LASTPOS=79002306;//kernel.BodyActor:2306
        _this.vrotation=vr;
        //$LASTPOS=79002325;//kernel.BodyActor:2325
        _this.fireEvent("createBody");
      },
      fiber$initBody :function _trc_BodyActor_f_initBody(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var wworld;
        var b2Vec2;
        var b2BodyDef;
        var b2Body;
        var b2FixtureDef;
        var b2Fixture;
        var b2PolygonShape;
        var b2CircleShape;
        var fixDef;
        var bodyDef;
        var w;
        var h;
        var t;
        var fps;
        var r;
        var ve;
        var vr;
        
        //$LASTPOS=79000302;//kernel.BodyActor:302
        if (_this.body) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_BodyActor_ent_initBody(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79000325;//kernel.BodyActor:325
              _this.fiber$getWorld(_thread);
              __pc=1;return;
            case 1:
              wworld=_thread.retVal;
              
              //$LASTPOS=79000353;//kernel.BodyActor:353
              _this.world=wworld.world;
              //$LASTPOS=79000378;//kernel.BodyActor:378
              _this.scale=wworld.scale;
              //$LASTPOS=79000403;//kernel.BodyActor:403
              b2Vec2 = Box2D.Common.Math.b2Vec2;
              
              //$LASTPOS=79000447;//kernel.BodyActor:447
              b2BodyDef = Box2D.Dynamics.b2BodyDef;
              
              //$LASTPOS=79000494;//kernel.BodyActor:494
              b2Body = Box2D.Dynamics.b2Body;
              
              //$LASTPOS=79000535;//kernel.BodyActor:535
              b2FixtureDef = Box2D.Dynamics.b2FixtureDef;
              
              //$LASTPOS=79000588;//kernel.BodyActor:588
              b2Fixture = Box2D.Dynamics.b2Fixture;
              
              //$LASTPOS=79000635;//kernel.BodyActor:635
              b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape;
              
              //$LASTPOS=79000700;//kernel.BodyActor:700
              b2CircleShape = Box2D.Collision.Shapes.b2CircleShape;
              
              //$LASTPOS=79000765;//kernel.BodyActor:765
              fixDef = new b2FixtureDef;
              
              //$LASTPOS=79000801;//kernel.BodyActor:801
              _this.fiber$defv(_thread, _this.density, 1);
              __pc=2;return;
            case 2:
              fixDef.density=_thread.retVal;
              
              //$LASTPOS=79000843;//kernel.BodyActor:843
              _this.fiber$defv(_thread, _this.friction, 0.5);
              __pc=3;return;
            case 3:
              fixDef.friction=_thread.retVal;
              
              //$LASTPOS=79000887;//kernel.BodyActor:887
              _this.fiber$defv(_thread, _this.restitution, 0.2);
              __pc=4;return;
            case 4:
              fixDef.restitution=_thread.retVal;
              
              //$LASTPOS=79000939;//kernel.BodyActor:939
              bodyDef = new b2BodyDef;
              
              //$LASTPOS=79000973;//kernel.BodyActor:973
              bodyDef.type=_this.isStatic?b2Body.b2_staticBody:b2Body.b2_dynamicBody;
              //$LASTPOS=79001057;//kernel.BodyActor:1057
              bodyDef.position.x=_this.x/_this.scale;
              //$LASTPOS=79001093;//kernel.BodyActor:1093
              bodyDef.position.y=_this.y/_this.scale;
              //$LASTPOS=79001129;//kernel.BodyActor:1129
              _this.shape=_this.shape||(_this.radius?"circle":"box");
              //$LASTPOS=79001178;//kernel.BodyActor:1178
              w = _this.width;
              h = _this.height;
              
              //$LASTPOS=79001205;//kernel.BodyActor:1205
              if (!(! w)) { __pc=6     ; break; }
              //$LASTPOS=79001224;//kernel.BodyActor:1224
              _this.fiber$detectSpriteType(_thread);
              __pc=5;return;
            case 5:
              t=_thread.retVal;
              
              //$LASTPOS=79001259;//kernel.BodyActor:1259
              if (t==="Image") {
                //$LASTPOS=79001276;//kernel.BodyActor:1276
                _this.prepareImage();
              } else {
                //$LASTPOS=79001306;//kernel.BodyActor:1306
                if (t==="Custom") {
                  //$LASTPOS=79001339;//kernel.BodyActor:1339
                  if (_this.p.width*_this.p.height>0) {
                    //$LASTPOS=79001423;//kernel.BodyActor:1423
                    _this.width=_this.p.width;
                    //$LASTPOS=79001455;//kernel.BodyActor:1455
                    _this.height=_this.p.height;
                    
                  }
                  
                }
              }
              //$LASTPOS=79001507;//kernel.BodyActor:1507
              w=_this.width*(_this.scaleX||1);
              //$LASTPOS=79001537;//kernel.BodyActor:1537
              h=_this.height*(_this.scaleY||_this.scaleX||1);
            case 6     :
              
              //$LASTPOS=79001579;//kernel.BodyActor:1579
              if (_this.shape=="box") {
                //$LASTPOS=79001608;//kernel.BodyActor:1608
                if (! w) {
                  //$LASTPOS=79001631;//kernel.BodyActor:1631
                  console.log(_this);
                  throw new Error("BodyActor::width is not set");
                  
                  
                }
                //$LASTPOS=79001731;//kernel.BodyActor:1731
                if (! h) {
                  //$LASTPOS=79001739;//kernel.BodyActor:1739
                  h=w;
                }
                //$LASTPOS=79001753;//kernel.BodyActor:1753
                fixDef.shape=new b2PolygonShape;
                //$LASTPOS=79001797;//kernel.BodyActor:1797
                fixDef.shape.SetAsOrientedBox(w/2/_this.scale,h/2/_this.scale,new b2Vec2(0,0),0);
                
              } else {
                //$LASTPOS=79001901;//kernel.BodyActor:1901
                _this.radius=_this.radius||w/2||16;
                //$LASTPOS=79001938;//kernel.BodyActor:1938
                fixDef.shape=new b2CircleShape(_this.radius/_this.scale);
                //$LASTPOS=79002015;//kernel.BodyActor:2015
                _this.width=_this.height=_this.radius*2;
                
              }
              //$LASTPOS=79002050;//kernel.BodyActor:2050
              fps = wworld.fps;
              
              //$LASTPOS=79002075;//kernel.BodyActor:2075
              r = _this.rotation;
              _this.fiber$bvec(_thread, _this.defv(_this.vx*fps,0), _this.defv(_this.vy*fps,0));
              __pc=7;return;
            case 7:
              ve=_thread.retVal;
              _this.fiber$defv(_thread, _this.vrotation, 0);
              __pc=8;return;
            case 8:
              vr=_thread.retVal;
              
              //$LASTPOS=79002157;//kernel.BodyActor:2157
              _this.body=_this.world.CreateBody(bodyDef);
              //$LASTPOS=79002194;//kernel.BodyActor:2194
              _this.body.CreateFixture(fixDef);
              //$LASTPOS=79002227;//kernel.BodyActor:2227
              _this.body.SetUserData(_this);
              //$LASTPOS=79002256;//kernel.BodyActor:2256
              _this.body.SetLinearVelocity(ve);
              //$LASTPOS=79002289;//kernel.BodyActor:2289
              _this.rotation=r;
              //$LASTPOS=79002306;//kernel.BodyActor:2306
              _this.vrotation=vr;
              //$LASTPOS=79002325;//kernel.BodyActor:2325
              _this.fireEvent("createBody");
              _thread.exit(_this);return;
            }
          }
        });
      },
      allContactPoints :function _trc_BodyActor_allContactPoints(klass) {
        "use strict";
        var _this=this;
        var res;
        var m;
        var point;
        var w;
        var c;
        var a;
        var b;
        
        //$LASTPOS=79002386;//kernel.BodyActor:2386
        _this.initBody();
        //$LASTPOS=79002403;//kernel.BodyActor:2403
        res = [];
        
        //$LASTPOS=79002428;//kernel.BodyActor:2428
        w = _this.getWorld();
        
        //$LASTPOS=79002451;//kernel.BodyActor:2451
        //$LASTPOS=79002456;//kernel.BodyActor:2456
        c = _this.world.GetContactList();
        for (; c ; c=c.GetNext()) {
          {
            //$LASTPOS=79002513;//kernel.BodyActor:2513
            if (c.IsTouching()) {
              //$LASTPOS=79002545;//kernel.BodyActor:2545
              c.GetWorldManifold(m=new Box2D.Collision.b2WorldManifold);
              //$LASTPOS=79002617;//kernel.BodyActor:2617
              if (m.m_points[0]) {
                //$LASTPOS=79002655;//kernel.BodyActor:2655
                if (m.m_points[1]&&m.m_points[1].x&&m.m_points[1].y) {
                  //$LASTPOS=79002729;//kernel.BodyActor:2729
                  point={x: (m.m_points[0].x+m.m_points[1].x)/2*w.scale,y: (m.m_points[0].y+m.m_points[1].y)/2*w.scale};
                  
                } else {
                  //$LASTPOS=79002903;//kernel.BodyActor:2903
                  point={x: m.m_points[0].x*w.scale,y: m.m_points[0].y*w.scale};
                  
                }
                
              } else {
                //$LASTPOS=79003004;//kernel.BodyActor:3004
                point={x: _this.x,y: _this.y};
              }
              //$LASTPOS=79003030;//kernel.BodyActor:3030
              a = c.GetFixtureA().GetBody().GetUserData();
              
              //$LASTPOS=79003090;//kernel.BodyActor:3090
              b = c.GetFixtureB().GetBody().GetUserData();
              
              //$LASTPOS=79003150;//kernel.BodyActor:3150
              if (a===_this) {
                //$LASTPOS=79003183;//kernel.BodyActor:3183
                if (! klass||b===klass||b instanceof klass) {
                  //$LASTPOS=79003253;//kernel.BodyActor:3253
                  res.push({target: b,manifold: m,x: point.x,y: point.y});
                  
                }
                
              } else {
                //$LASTPOS=79003346;//kernel.BodyActor:3346
                if (b===_this) {
                  //$LASTPOS=79003379;//kernel.BodyActor:3379
                  if (! klass||a===klass||a instanceof klass) {
                    //$LASTPOS=79003449;//kernel.BodyActor:3449
                    res.push({target: a,manifold: m,x: point.x,y: point.y});
                    
                  }
                  
                }
              }
              
            }
          }
        }
        return res;
      },
      fiber$allContactPoints :function _trc_BodyActor_f_allContactPoints(_thread,klass) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var m;
        var point;
        var w;
        var c;
        var a;
        var b;
        
        
        _thread.enter(function _trc_BodyActor_ent_allContactPoints(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79002386;//kernel.BodyActor:2386
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79002403;//kernel.BodyActor:2403
              res = [];
              
              //$LASTPOS=79002428;//kernel.BodyActor:2428
              _this.fiber$getWorld(_thread);
              __pc=2;return;
            case 2:
              w=_thread.retVal;
              
              //$LASTPOS=79002451;//kernel.BodyActor:2451
              //$LASTPOS=79002456;//kernel.BodyActor:2456
              c = _this.world.GetContactList();
              for (; c ; c=c.GetNext()) {
                {
                  //$LASTPOS=79002513;//kernel.BodyActor:2513
                  if (c.IsTouching()) {
                    //$LASTPOS=79002545;//kernel.BodyActor:2545
                    c.GetWorldManifold(m=new Box2D.Collision.b2WorldManifold);
                    //$LASTPOS=79002617;//kernel.BodyActor:2617
                    if (m.m_points[0]) {
                      //$LASTPOS=79002655;//kernel.BodyActor:2655
                      if (m.m_points[1]&&m.m_points[1].x&&m.m_points[1].y) {
                        //$LASTPOS=79002729;//kernel.BodyActor:2729
                        point={x: (m.m_points[0].x+m.m_points[1].x)/2*w.scale,y: (m.m_points[0].y+m.m_points[1].y)/2*w.scale};
                        
                      } else {
                        //$LASTPOS=79002903;//kernel.BodyActor:2903
                        point={x: m.m_points[0].x*w.scale,y: m.m_points[0].y*w.scale};
                        
                      }
                      
                    } else {
                      //$LASTPOS=79003004;//kernel.BodyActor:3004
                      point={x: _this.x,y: _this.y};
                    }
                    //$LASTPOS=79003030;//kernel.BodyActor:3030
                    a = c.GetFixtureA().GetBody().GetUserData();
                    
                    //$LASTPOS=79003090;//kernel.BodyActor:3090
                    b = c.GetFixtureB().GetBody().GetUserData();
                    
                    //$LASTPOS=79003150;//kernel.BodyActor:3150
                    if (a===_this) {
                      //$LASTPOS=79003183;//kernel.BodyActor:3183
                      if (! klass||b===klass||b instanceof klass) {
                        //$LASTPOS=79003253;//kernel.BodyActor:3253
                        res.push({target: b,manifold: m,x: point.x,y: point.y});
                        
                      }
                      
                    } else {
                      //$LASTPOS=79003346;//kernel.BodyActor:3346
                      if (b===_this) {
                        //$LASTPOS=79003379;//kernel.BodyActor:3379
                        if (! klass||a===klass||a instanceof klass) {
                          //$LASTPOS=79003449;//kernel.BodyActor:3449
                          res.push({target: a,manifold: m,x: point.x,y: point.y});
                          
                        }
                        
                      }
                    }
                    
                  }
                }
              }
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      contactPoint :function _trc_BodyActor_contactPoint(klass) {
        "use strict";
        var _this=this;
        
        return _this.allContactPoints(klass)[0];
      },
      fiber$contactPoint :function _trc_BodyActor_f_contactPoint(_thread,klass) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.allContactPoints(klass)[0];return;
        
        
        _thread.retVal=_this;return;
      },
      allContact :function _trc_BodyActor_allContact(klass) {
        "use strict";
        var _this=this;
        
        return _this.allContacts(klass);
      },
      fiber$allContact :function _trc_BodyActor_f_allContact(_thread,klass) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_BodyActor_ent_allContact(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$allContacts(_thread, klass);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      allContacts :function _trc_BodyActor_allContacts(klass) {
        "use strict";
        var _this=this;
        var res;
        var c;
        var a;
        var b;
        
        //$LASTPOS=79003725;//kernel.BodyActor:3725
        _this.initBody();
        //$LASTPOS=79003742;//kernel.BodyActor:3742
        res = [];
        
        //$LASTPOS=79003759;//kernel.BodyActor:3759
        //$LASTPOS=79003764;//kernel.BodyActor:3764
        c = _this.world.GetContactList();
        for (; c ; c=c.GetNext()) {
          {
            //$LASTPOS=79003821;//kernel.BodyActor:3821
            if (c.IsTouching()) {
              //$LASTPOS=79003856;//kernel.BodyActor:3856
              a = c.GetFixtureA().GetBody().GetUserData();
              
              //$LASTPOS=79003916;//kernel.BodyActor:3916
              b = c.GetFixtureB().GetBody().GetUserData();
              
              //$LASTPOS=79003976;//kernel.BodyActor:3976
              if (a===_this) {
                //$LASTPOS=79004009;//kernel.BodyActor:4009
                if (! klass||b===klass||b instanceof klass) {
                  //$LASTPOS=79004079;//kernel.BodyActor:4079
                  res.push(b);
                  
                }
                
              } else {
                //$LASTPOS=79004131;//kernel.BodyActor:4131
                if (b===_this) {
                  //$LASTPOS=79004164;//kernel.BodyActor:4164
                  if (! klass||a===klass||a instanceof klass) {
                    //$LASTPOS=79004234;//kernel.BodyActor:4234
                    res.push(a);
                    
                  }
                  
                }
              }
              
            }
          }
        }
        return res;
      },
      fiber$allContacts :function _trc_BodyActor_f_allContacts(_thread,klass) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var c;
        var a;
        var b;
        
        
        _thread.enter(function _trc_BodyActor_ent_allContacts(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79003725;//kernel.BodyActor:3725
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79003742;//kernel.BodyActor:3742
              res = [];
              
              //$LASTPOS=79003759;//kernel.BodyActor:3759
              //$LASTPOS=79003764;//kernel.BodyActor:3764
              c = _this.world.GetContactList();
              for (; c ; c=c.GetNext()) {
                {
                  //$LASTPOS=79003821;//kernel.BodyActor:3821
                  if (c.IsTouching()) {
                    //$LASTPOS=79003856;//kernel.BodyActor:3856
                    a = c.GetFixtureA().GetBody().GetUserData();
                    
                    //$LASTPOS=79003916;//kernel.BodyActor:3916
                    b = c.GetFixtureB().GetBody().GetUserData();
                    
                    //$LASTPOS=79003976;//kernel.BodyActor:3976
                    if (a===_this) {
                      //$LASTPOS=79004009;//kernel.BodyActor:4009
                      if (! klass||b===klass||b instanceof klass) {
                        //$LASTPOS=79004079;//kernel.BodyActor:4079
                        res.push(b);
                        
                      }
                      
                    } else {
                      //$LASTPOS=79004131;//kernel.BodyActor:4131
                      if (b===_this) {
                        //$LASTPOS=79004164;//kernel.BodyActor:4164
                        if (! klass||a===klass||a instanceof klass) {
                          //$LASTPOS=79004234;//kernel.BodyActor:4234
                          res.push(a);
                          
                        }
                        
                      }
                    }
                    
                  }
                }
              }
              _thread.exit(res);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      applyForce :function _trc_BodyActor_applyForce(fx,fy,px,py) {
        "use strict";
        var _this=this;
        var b2Vec2;
        var scale;
        var fps;
        
        //$LASTPOS=79004352;//kernel.BodyActor:4352
        _this.initBody();
        //$LASTPOS=79004369;//kernel.BodyActor:4369
        b2Vec2 = Box2D.Common.Math.b2Vec2;
        
        //$LASTPOS=79004413;//kernel.BodyActor:4413
        scale = _this.getWorld().scale;
        
        //$LASTPOS=79004446;//kernel.BodyActor:4446
        fps = 60;
        
        //$LASTPOS=79004463;//kernel.BodyActor:4463
        _this.body.ApplyForce(new b2Vec2(fx,fy),_this.body.GetPosition());
      },
      fiber$applyForce :function _trc_BodyActor_f_applyForce(_thread,fx,fy,px,py) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var b2Vec2;
        var scale;
        var fps;
        
        
        _thread.enter(function _trc_BodyActor_ent_applyForce(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79004352;//kernel.BodyActor:4352
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79004369;//kernel.BodyActor:4369
              b2Vec2 = Box2D.Common.Math.b2Vec2;
              
              //$LASTPOS=79004413;//kernel.BodyActor:4413
              scale = _this.getWorld().scale;
              
              //$LASTPOS=79004446;//kernel.BodyActor:4446
              fps = 60;
              
              //$LASTPOS=79004463;//kernel.BodyActor:4463
              _this.body.ApplyForce(new b2Vec2(fx,fy),_this.body.GetPosition());
              _thread.exit(_this);return;
            }
          }
        });
      },
      applyImpulse :function _trc_BodyActor_applyImpulse(fx,fy,px,py) {
        "use strict";
        var _this=this;
        var b2Vec2;
        var scale;
        var fps;
        
        //$LASTPOS=79004557;//kernel.BodyActor:4557
        _this.initBody();
        //$LASTPOS=79004574;//kernel.BodyActor:4574
        b2Vec2 = Box2D.Common.Math.b2Vec2;
        
        //$LASTPOS=79004618;//kernel.BodyActor:4618
        scale = _this.getWorld().scale;
        
        //$LASTPOS=79004651;//kernel.BodyActor:4651
        fps = 60;
        
        //$LASTPOS=79004668;//kernel.BodyActor:4668
        _this.body.ApplyImpulse(new b2Vec2(fx,fy),_this.body.GetPosition());
      },
      fiber$applyImpulse :function _trc_BodyActor_f_applyImpulse(_thread,fx,fy,px,py) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var b2Vec2;
        var scale;
        var fps;
        
        
        _thread.enter(function _trc_BodyActor_ent_applyImpulse(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79004557;//kernel.BodyActor:4557
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79004574;//kernel.BodyActor:4574
              b2Vec2 = Box2D.Common.Math.b2Vec2;
              
              //$LASTPOS=79004618;//kernel.BodyActor:4618
              scale = _this.getWorld().scale;
              
              //$LASTPOS=79004651;//kernel.BodyActor:4651
              fps = 60;
              
              //$LASTPOS=79004668;//kernel.BodyActor:4668
              _this.body.ApplyImpulse(new b2Vec2(fx,fy),_this.body.GetPosition());
              _thread.exit(_this);return;
            }
          }
        });
      },
      applyTorque :function _trc_BodyActor_applyTorque(a) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79004755;//kernel.BodyActor:4755
        _this.initBody();
        //$LASTPOS=79004772;//kernel.BodyActor:4772
        _this.body.ApplyTorque(a);
      },
      fiber$applyTorque :function _trc_BodyActor_f_applyTorque(_thread,a) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_BodyActor_ent_applyTorque(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79004755;//kernel.BodyActor:4755
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79004772;//kernel.BodyActor:4772
              _this.body.ApplyTorque(a);
              _thread.exit(_this);return;
            }
          }
        });
      },
      moveBy :function _trc_BodyActor_moveBy(dx,dy) {
        "use strict";
        var _this=this;
        var pos;
        
        //$LASTPOS=79004819;//kernel.BodyActor:4819
        _this.initBody();
        //$LASTPOS=79004836;//kernel.BodyActor:4836
        pos = _this.body.GetPosition();
        
        //$LASTPOS=79004869;//kernel.BodyActor:4869
        pos.x+=dx/_this.scale;
        //$LASTPOS=79004891;//kernel.BodyActor:4891
        pos.y+=dy/_this.scale;
        //$LASTPOS=79004913;//kernel.BodyActor:4913
        _this.body.SetPosition(pos);
      },
      fiber$moveBy :function _trc_BodyActor_f_moveBy(_thread,dx,dy) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var pos;
        
        
        _thread.enter(function _trc_BodyActor_ent_moveBy(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79004819;//kernel.BodyActor:4819
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79004836;//kernel.BodyActor:4836
              pos = _this.body.GetPosition();
              
              //$LASTPOS=79004869;//kernel.BodyActor:4869
              pos.x+=dx/_this.scale;
              //$LASTPOS=79004891;//kernel.BodyActor:4891
              pos.y+=dy/_this.scale;
              //$LASTPOS=79004913;//kernel.BodyActor:4913
              _this.body.SetPosition(pos);
              _thread.exit(_this);return;
            }
          }
        });
      },
      contactTo :function _trc_BodyActor_contactTo(t) {
        "use strict";
        var _this=this;
        
        return _this.allContact(t)[0];
      },
      fiber$contactTo :function _trc_BodyActor_f_contactTo(_thread,t) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.allContact(t)[0];return;
        
        
        _thread.retVal=_this;return;
      },
      die :function _trc_BodyActor_die() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79005004;//kernel.BodyActor:5004
        __superClass.prototype.die.apply( _this, []);
        //$LASTPOS=79005022;//kernel.BodyActor:5022
        if (_this.world) {
          //$LASTPOS=79005033;//kernel.BodyActor:5033
          _this.world.DestroyBody(_this.body);
        }
      },
      addRevoluteJoint :function _trc_BodyActor_addRevoluteJoint(params) {
        "use strict";
        var _this=this;
        var px;
        var py;
        var wworld;
        var scale;
        var world;
        var b2BodyDef;
        var b2Body;
        var JDC;
        var jd;
        var bodyB;
        var bodyDef;
        var b2Vec2;
        
        //$LASTPOS=79005095;//kernel.BodyActor:5095
        _this.initBody();
        //$LASTPOS=79005142;//kernel.BodyActor:5142
        params=params||{};
        //$LASTPOS=79005166;//kernel.BodyActor:5166
        px = params.x||_this.x;
        
        //$LASTPOS=79005191;//kernel.BodyActor:5191
        py = params.y||_this.y;
        
        //$LASTPOS=79005216;//kernel.BodyActor:5216
        wworld = _this.getWorld();
        
        //$LASTPOS=79005258;//kernel.BodyActor:5258
        scale = wworld.scale;
        
        //$LASTPOS=79005287;//kernel.BodyActor:5287
        world = wworld.world;
        
        //$LASTPOS=79005316;//kernel.BodyActor:5316
        b2BodyDef = Box2D.Dynamics.b2BodyDef;
        
        //$LASTPOS=79005363;//kernel.BodyActor:5363
        b2Body = Box2D.Dynamics.b2Body;
        
        //$LASTPOS=79005404;//kernel.BodyActor:5404
        JDC = Box2D.Dynamics.Joints.b2RevoluteJointDef;
        
        //$LASTPOS=79005459;//kernel.BodyActor:5459
        jd = new JDC;
        
        
        //$LASTPOS=79005496;//kernel.BodyActor:5496
        if (params.other&&Tonyu.is(params.other,Tonyu.classes.kernel.BodyActor)) {
          //$LASTPOS=79005554;//kernel.BodyActor:5554
          params.other.initBody();
          //$LASTPOS=79005588;//kernel.BodyActor:5588
          bodyB=params.other.body;
          
        } else {
          //$LASTPOS=79005636;//kernel.BodyActor:5636
          bodyDef = new b2BodyDef;
          
          //$LASTPOS=79005674;//kernel.BodyActor:5674
          bodyDef.type=b2Body.b2_staticBody;
          //$LASTPOS=79005720;//kernel.BodyActor:5720
          bodyDef.position.x=px/scale;
          //$LASTPOS=79005761;//kernel.BodyActor:5761
          bodyDef.position.y=py/scale;
          //$LASTPOS=79005802;//kernel.BodyActor:5802
          bodyB=world.CreateBody(bodyDef);
          
        }
        //$LASTPOS=79005847;//kernel.BodyActor:5847
        b2Vec2 = Box2D.Common.Math.b2Vec2;
        
        //$LASTPOS=79005891;//kernel.BodyActor:5891
        jd.Initialize(_this.body,bodyB,new b2Vec2(px/scale,py/scale));
        //$LASTPOS=79005954;//kernel.BodyActor:5954
        if (params.lowerAngle&&params.upperAngle) {
          //$LASTPOS=79006008;//kernel.BodyActor:6008
          jd.lowerAngle=_this.rad(params.lowerAngle);
          //$LASTPOS=79006056;//kernel.BodyActor:6056
          jd.upperAngle=_this.rad(params.upperAngle);
          //$LASTPOS=79006104;//kernel.BodyActor:6104
          jd.enableLimit=true;
          
        }
        //$LASTPOS=79006139;//kernel.BodyActor:6139
        world.CreateJoint(jd);
      },
      fiber$addRevoluteJoint :function _trc_BodyActor_f_addRevoluteJoint(_thread,params) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var px;
        var py;
        var wworld;
        var scale;
        var world;
        var b2BodyDef;
        var b2Body;
        var JDC;
        var jd;
        var bodyB;
        var bodyDef;
        var b2Vec2;
        
        
        _thread.enter(function _trc_BodyActor_ent_addRevoluteJoint(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=79005095;//kernel.BodyActor:5095
              _this.fiber$initBody(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=79005142;//kernel.BodyActor:5142
              params=params||{};
              //$LASTPOS=79005166;//kernel.BodyActor:5166
              px = params.x||_this.x;
              
              //$LASTPOS=79005191;//kernel.BodyActor:5191
              py = params.y||_this.y;
              
              //$LASTPOS=79005216;//kernel.BodyActor:5216
              _this.fiber$getWorld(_thread);
              __pc=2;return;
            case 2:
              wworld=_thread.retVal;
              
              //$LASTPOS=79005258;//kernel.BodyActor:5258
              scale = wworld.scale;
              
              //$LASTPOS=79005287;//kernel.BodyActor:5287
              world = wworld.world;
              
              //$LASTPOS=79005316;//kernel.BodyActor:5316
              b2BodyDef = Box2D.Dynamics.b2BodyDef;
              
              //$LASTPOS=79005363;//kernel.BodyActor:5363
              b2Body = Box2D.Dynamics.b2Body;
              
              //$LASTPOS=79005404;//kernel.BodyActor:5404
              JDC = Box2D.Dynamics.Joints.b2RevoluteJointDef;
              
              //$LASTPOS=79005459;//kernel.BodyActor:5459
              jd = new JDC;
              
              
              //$LASTPOS=79005496;//kernel.BodyActor:5496
              if (params.other&&Tonyu.is(params.other,Tonyu.classes.kernel.BodyActor)) {
                //$LASTPOS=79005554;//kernel.BodyActor:5554
                params.other.initBody();
                //$LASTPOS=79005588;//kernel.BodyActor:5588
                bodyB=params.other.body;
                
              } else {
                //$LASTPOS=79005636;//kernel.BodyActor:5636
                bodyDef = new b2BodyDef;
                
                //$LASTPOS=79005674;//kernel.BodyActor:5674
                bodyDef.type=b2Body.b2_staticBody;
                //$LASTPOS=79005720;//kernel.BodyActor:5720
                bodyDef.position.x=px/scale;
                //$LASTPOS=79005761;//kernel.BodyActor:5761
                bodyDef.position.y=py/scale;
                //$LASTPOS=79005802;//kernel.BodyActor:5802
                bodyB=world.CreateBody(bodyDef);
                
              }
              //$LASTPOS=79005847;//kernel.BodyActor:5847
              b2Vec2 = Box2D.Common.Math.b2Vec2;
              
              //$LASTPOS=79005891;//kernel.BodyActor:5891
              jd.Initialize(_this.body,bodyB,new b2Vec2(px/scale,py/scale));
              //$LASTPOS=79005954;//kernel.BodyActor:5954
              if (params.lowerAngle&&params.upperAngle) {
                //$LASTPOS=79006008;//kernel.BodyActor:6008
                jd.lowerAngle=_this.rad(params.lowerAngle);
                //$LASTPOS=79006056;//kernel.BodyActor:6056
                jd.upperAngle=_this.rad(params.upperAngle);
                //$LASTPOS=79006104;//kernel.BodyActor:6104
                jd.enableLimit=true;
                
              }
              //$LASTPOS=79006139;//kernel.BodyActor:6139
              world.CreateJoint(jd);
              _thread.exit(_this);return;
            }
          }
        });
      },
      __getter__rotation :function _trc_BodyActor___getter__rotation() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79006183;//kernel.BodyActor:6183
        if (! _this.body||_this.manualRotation) {
          return _this._rotation;
        }
        return _this.deg(_this.body.GetAngle());
      },
      __setter__rotation :function _trc_BodyActor___setter__rotation(r) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79006287;//kernel.BodyActor:6287
        r=r||0;
        //$LASTPOS=79006300;//kernel.BodyActor:6300
        if (! _this.body||_this.manualRotation) {
          return _this._rotation=r;
        }
        //$LASTPOS=79006354;//kernel.BodyActor:6354
        _this.body.SetAngle(_this.rad(r));
      },
      __getter__x :function _trc_BodyActor___getter__x() {
        "use strict";
        var _this=this;
        var pos;
        
        //$LASTPOS=79006393;//kernel.BodyActor:6393
        if (! _this.body) {
          return _this._x;
        }
        //$LASTPOS=79006420;//kernel.BodyActor:6420
        pos = _this.body.GetPosition();
        
        return pos.x*_this.scale;
      },
      __setter__x :function _trc_BodyActor___setter__x(v) {
        "use strict";
        var _this=this;
        var pos;
        
        //$LASTPOS=79006489;//kernel.BodyActor:6489
        if (! _this.body) {
          return _this._x=v;
        }
        //$LASTPOS=79006518;//kernel.BodyActor:6518
        v=v||0;
        //$LASTPOS=79006531;//kernel.BodyActor:6531
        pos = _this.body.GetPosition();
        
        //$LASTPOS=79006564;//kernel.BodyActor:6564
        pos.x=v/_this.scale;
        //$LASTPOS=79006584;//kernel.BodyActor:6584
        _this.body.SetPosition(pos);
      },
      __getter__y :function _trc_BodyActor___getter__y() {
        "use strict";
        var _this=this;
        var pos;
        
        //$LASTPOS=79006621;//kernel.BodyActor:6621
        if (! _this.body) {
          return _this._y;
        }
        //$LASTPOS=79006648;//kernel.BodyActor:6648
        pos = _this.body.GetPosition();
        
        return pos.y*_this.scale;
      },
      __setter__y :function _trc_BodyActor___setter__y(v) {
        "use strict";
        var _this=this;
        var pos;
        
        //$LASTPOS=79006717;//kernel.BodyActor:6717
        if (! _this.body) {
          return _this._y=v;
        }
        //$LASTPOS=79006746;//kernel.BodyActor:6746
        v=v||0;
        //$LASTPOS=79006759;//kernel.BodyActor:6759
        pos = _this.body.GetPosition();
        
        //$LASTPOS=79006792;//kernel.BodyActor:6792
        pos.y=v/_this.scale;
        //$LASTPOS=79006812;//kernel.BodyActor:6812
        _this.body.SetPosition(pos);
      },
      __getter__vx :function _trc_BodyActor___getter__vx() {
        "use strict";
        var _this=this;
        var v;
        
        //$LASTPOS=79006852;//kernel.BodyActor:6852
        if (! _this.body) {
          return _this._vx;
        }
        //$LASTPOS=79006880;//kernel.BodyActor:6880
        v = _this.body.GetLinearVelocity();
        
        return v.x*_this.scale/_this.getWorld().fps;
      },
      __setter__vx :function _trc_BodyActor___setter__vx(v) {
        "use strict";
        var _this=this;
        var ve;
        
        //$LASTPOS=79006967;//kernel.BodyActor:6967
        if (! _this.body) {
          return _this._vx=v;
        }
        //$LASTPOS=79006997;//kernel.BodyActor:6997
        v=v||0;
        //$LASTPOS=79007010;//kernel.BodyActor:7010
        ve = _this.body.GetLinearVelocity();
        
        //$LASTPOS=79007048;//kernel.BodyActor:7048
        ve.x=v/_this.scale*_this.getWorld().fps;
        //$LASTPOS=79007082;//kernel.BodyActor:7082
        if (v) {
          //$LASTPOS=79007089;//kernel.BodyActor:7089
          _this.body.SetAwake(true);
        }
        //$LASTPOS=79007115;//kernel.BodyActor:7115
        _this.body.SetLinearVelocity(ve);
      },
      __getter__vy :function _trc_BodyActor___getter__vy() {
        "use strict";
        var _this=this;
        var v;
        
        //$LASTPOS=79007160;//kernel.BodyActor:7160
        if (! _this.body) {
          return _this._vy;
        }
        //$LASTPOS=79007188;//kernel.BodyActor:7188
        v = _this.body.GetLinearVelocity();
        
        return v.y*_this.scale/_this.getWorld().fps;
      },
      __setter__vy :function _trc_BodyActor___setter__vy(v) {
        "use strict";
        var _this=this;
        var ve;
        
        //$LASTPOS=79007275;//kernel.BodyActor:7275
        if (! _this.body) {
          return _this._vy=v;
        }
        //$LASTPOS=79007305;//kernel.BodyActor:7305
        ve = _this.body.GetLinearVelocity();
        
        //$LASTPOS=79007343;//kernel.BodyActor:7343
        ve.y=v/_this.scale*_this.getWorld().fps;
        //$LASTPOS=79007377;//kernel.BodyActor:7377
        if (v) {
          //$LASTPOS=79007384;//kernel.BodyActor:7384
          _this.body.SetAwake(true);
        }
        //$LASTPOS=79007410;//kernel.BodyActor:7410
        _this.body.SetLinearVelocity(ve);
      },
      __getter__vrotation :function _trc_BodyActor___getter__vrotation() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79007460;//kernel.BodyActor:7460
        if (! _this.body) {
          return _this._vr;
        }
        return _this.deg(_this.body.GetAngularVelocity()/_this.getWorld().fps);
      },
      __setter__vrotation :function _trc_BodyActor___setter__vrotation(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=79007566;//kernel.BodyActor:7566
        if (! _this.body) {
          return _this._vr=v;
        }
        //$LASTPOS=79007596;//kernel.BodyActor:7596
        v=v||0;
        //$LASTPOS=79007609;//kernel.BodyActor:7609
        if (v) {
          //$LASTPOS=79007616;//kernel.BodyActor:7616
          _this.body.SetAwake(true);
        }
        //$LASTPOS=79007642;//kernel.BodyActor:7642
        _this.body.SetAngularVelocity(_this.rad(v*_this.getWorld().fps));
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"getWorld":{"nowait":false},"update":{"nowait":false},"initBody":{"nowait":false},"allContactPoints":{"nowait":false},"contactPoint":{"nowait":false},"allContact":{"nowait":false},"allContacts":{"nowait":false},"applyForce":{"nowait":false},"applyImpulse":{"nowait":false},"applyTorque":{"nowait":false},"moveBy":{"nowait":false},"contactTo":{"nowait":false},"die":{"nowait":true},"addRevoluteJoint":{"nowait":false},"__getter__rotation":{"nowait":true},"__setter__rotation":{"nowait":true},"__getter__x":{"nowait":true},"__setter__x":{"nowait":true},"__getter__y":{"nowait":true},"__setter__y":{"nowait":true},"__getter__vx":{"nowait":true},"__setter__vx":{"nowait":true},"__getter__vy":{"nowait":true},"__setter__vy":{"nowait":true},"__getter__vrotation":{"nowait":true},"__setter__vrotation":{"nowait":true}},"fields":{"body":{},"world":{},"density":{},"friction":{},"restitution":{},"isStatic":{},"shape":{},"manualRotation":{},"_rotation":{},"_x":{},"_y":{},"_vx":{},"_vy":{},"_vr":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.T2Body',
  shortName: 'T2Body',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.BodyActor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T2Body_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T2Body_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.T2World',
  shortName: 'T2World',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [Tonyu.classes.kernel.T2Mod],
  methods: function (__superClass) {
    return {
      main :function _trc_T2World_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=80000150;//kernel.T2World:150
        _this.loop();
      },
      fiber$main :function _trc_T2World_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_T2World_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=80000150;//kernel.T2World:150
              _this.fiber$loop(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      onAppear :function _trc_T2World_onAppear() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=80000086;//kernel.T2World:86
        Tonyu.globals.$currentProject.requestPlugin("box2d");
        //$LASTPOS=80000133;//kernel.T2World:133
        _this.initWorld();
      },
      fiber$onAppear :function _trc_T2World_f_onAppear(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=80000086;//kernel.T2World:86
        Tonyu.globals.$currentProject.requestPlugin("box2d");
        
        _thread.enter(function _trc_T2World_ent_onAppear(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=80000133;//kernel.T2World:133
              _this.fiber$initWorld(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initWorld :function _trc_T2World_initWorld() {
        "use strict";
        var _this=this;
        var b2World;
        var b2Vec2;
        
        //$LASTPOS=80000183;//kernel.T2World:183
        _this.gravity=_this.defv(_this.gravity,9.8);
        //$LASTPOS=80000216;//kernel.T2World:216
        _this.gravityX=_this.defv(_this.gravityX,0);
        //$LASTPOS=80000249;//kernel.T2World:249
        _this.fps=Tonyu.globals.$Boot.getFrameRate();
        //$LASTPOS=80000280;//kernel.T2World:280
        b2World = Box2D.Dynamics.b2World;
        
        //$LASTPOS=80000323;//kernel.T2World:323
        b2Vec2 = Box2D.Common.Math.b2Vec2;
        
        //$LASTPOS=80000367;//kernel.T2World:367
        _this.scale=_this.scale||32;
        //$LASTPOS=80000391;//kernel.T2World:391
        _this.world=new b2World(new b2Vec2(_this.gravityX,_this.gravity),true);
        //$LASTPOS=80000516;//kernel.T2World:516
        Tonyu.globals.$t2World=_this;
        //$LASTPOS=80000536;//kernel.T2World:536
        Tonyu.globals.$Boot.on("stop",Tonyu.bindFunc(_this,_this.releaseWorld));
        //$LASTPOS=80000572;//kernel.T2World:572
        _this.on("die",Tonyu.bindFunc(_this,_this.releaseWorld));
      },
      fiber$initWorld :function _trc_T2World_f_initWorld(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var b2World;
        var b2Vec2;
        
        
        _thread.enter(function _trc_T2World_ent_initWorld(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=80000183;//kernel.T2World:183
              _this.fiber$defv(_thread, _this.gravity, 9.8);
              __pc=1;return;
            case 1:
              _this.gravity=_thread.retVal;
              
              //$LASTPOS=80000216;//kernel.T2World:216
              _this.fiber$defv(_thread, _this.gravityX, 0);
              __pc=2;return;
            case 2:
              _this.gravityX=_thread.retVal;
              
              //$LASTPOS=80000249;//kernel.T2World:249
              _this.fps=Tonyu.globals.$Boot.getFrameRate();
              //$LASTPOS=80000280;//kernel.T2World:280
              b2World = Box2D.Dynamics.b2World;
              
              //$LASTPOS=80000323;//kernel.T2World:323
              b2Vec2 = Box2D.Common.Math.b2Vec2;
              
              //$LASTPOS=80000367;//kernel.T2World:367
              _this.scale=_this.scale||32;
              //$LASTPOS=80000391;//kernel.T2World:391
              _this.world=new b2World(new b2Vec2(_this.gravityX,_this.gravity),true);
              //$LASTPOS=80000516;//kernel.T2World:516
              Tonyu.globals.$t2World=_this;
              //$LASTPOS=80000536;//kernel.T2World:536
              Tonyu.globals.$Boot.on("stop",Tonyu.bindFunc(_this,_this.releaseWorld));
              //$LASTPOS=80000572;//kernel.T2World:572
              _this.on("die",Tonyu.bindFunc(_this,_this.releaseWorld));
              _thread.exit(_this);return;
            }
          }
        });
      },
      releaseWorld :function _trc_T2World_releaseWorld() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=80000623;//kernel.T2World:623
        if (Tonyu.globals.$t2World===_this) {
          //$LASTPOS=80000644;//kernel.T2World:644
          Tonyu.globals.$t2World=null;
        }
      },
      fiber$releaseWorld :function _trc_T2World_f_releaseWorld(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=80000623;//kernel.T2World:623
        if (Tonyu.globals.$t2World===_this) {
          //$LASTPOS=80000644;//kernel.T2World:644
          Tonyu.globals.$t2World=null;
        }
        
        _thread.retVal=_this;return;
      },
      loop :function _trc_T2World_loop() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=80000680;//kernel.T2World:680
        while (true) {
          //$LASTPOS=80000703;//kernel.T2World:703
          _this.fps=Tonyu.globals.$Boot.getFrameRate();
          //$LASTPOS=80000738;//kernel.T2World:738
          _this.world.Step(1/_this.fps,10,10);
          //$LASTPOS=80000922;//kernel.T2World:922
          _this.world.ClearForces();
          //$LASTPOS=80000976;//kernel.T2World:976
          _this.update();
          
        }
      },
      fiber$loop :function _trc_T2World_f_loop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_T2World_ent_loop(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=80000680;//kernel.T2World:680
            case 1:
              //$LASTPOS=80000703;//kernel.T2World:703
              _this.fps=Tonyu.globals.$Boot.getFrameRate();
              //$LASTPOS=80000738;//kernel.T2World:738
              _this.world.Step(1/_this.fps,10,10);
              //$LASTPOS=80000922;//kernel.T2World:922
              _this.world.ClearForces();
              //$LASTPOS=80000976;//kernel.T2World:976
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      updatePos :function _trc_T2World_updatePos() {
        "use strict";
        var _this=this;
        var b;
        var d;
        
        //$LASTPOS=80001017;//kernel.T2World:1017
        //$LASTPOS=80001022;//kernel.T2World:1022
        b = _this.world.GetBodyList();
        for (; b ; b=b.GetNext()) {
          {
            //$LASTPOS=80001076;//kernel.T2World:1076
            d = b.GetUserData();
            
            //$LASTPOS=80001108;//kernel.T2World:1108
            if (d) {
              //$LASTPOS=80001114;//kernel.T2World:1114
              d.updatePos();
            }
          }
        }
      },
      fiber$updatePos :function _trc_T2World_f_updatePos(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var b;
        var d;
        
        //$LASTPOS=80001017;//kernel.T2World:1017
        //$LASTPOS=80001022;//kernel.T2World:1022
        b = _this.world.GetBodyList();
        for (; b ; b=b.GetNext()) {
          {
            //$LASTPOS=80001076;//kernel.T2World:1076
            d = b.GetUserData();
            
            //$LASTPOS=80001108;//kernel.T2World:1108
            if (d) {
              //$LASTPOS=80001114;//kernel.T2World:1114
              d.updatePos();
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"onAppear":{"nowait":false},"initWorld":{"nowait":false},"releaseWorld":{"nowait":false},"loop":{"nowait":false},"updatePos":{"nowait":false}},"fields":{"gravity":{},"gravityX":{},"fps":{},"world":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.T2MediaPlayer',
  shortName: 'T2MediaPlayer',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T2MediaPlayer_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T2MediaPlayer_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_T2MediaPlayer_initialize() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000086;//kernel.T2MediaPlayer:86
        _this.initT2MediaPlayer();
      },
      initT2MediaPlayer :function _trc_T2MediaPlayer_initT2MediaPlayer() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000141;//kernel.T2MediaPlayer:141
        if (! Tonyu.globals.$t2MediaLib) {
          //$LASTPOS=81000170;//kernel.T2MediaPlayer:170
          Tonyu.globals.$t2MediaLib=new T2MediaLib();
          
        }
        //$LASTPOS=81000214;//kernel.T2MediaPlayer:214
        _this.bgmPlayerMax=Tonyu.globals.$t2MediaLib.bgmPlayerMax;
      },
      fiber$initT2MediaPlayer :function _trc_T2MediaPlayer_f_initT2MediaPlayer(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81000141;//kernel.T2MediaPlayer:141
        if (! Tonyu.globals.$t2MediaLib) {
          //$LASTPOS=81000170;//kernel.T2MediaPlayer:170
          Tonyu.globals.$t2MediaLib=new T2MediaLib();
          
        }
        //$LASTPOS=81000214;//kernel.T2MediaPlayer:214
        _this.bgmPlayerMax=Tonyu.globals.$t2MediaLib.bgmPlayerMax;
        
        _thread.retVal=_this;return;
      },
      allClearSoundData :function _trc_T2MediaPlayer_allClearSoundData() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000289;//kernel.T2MediaPlayer:289
        Tonyu.globals.$t2MediaLib.allResetBGM();
        //$LASTPOS=81000321;//kernel.T2MediaPlayer:321
        Tonyu.globals.$t2MediaLib.allClearSoundData();
      },
      fiber$allClearSoundData :function _trc_T2MediaPlayer_f_allClearSoundData(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81000289;//kernel.T2MediaPlayer:289
        Tonyu.globals.$t2MediaLib.allResetBGM();
        //$LASTPOS=81000321;//kernel.T2MediaPlayer:321
        Tonyu.globals.$t2MediaLib.allClearSoundData();
        
        _thread.retVal=_this;return;
      },
      clearSoundData :function _trc_T2MediaPlayer_clearSoundData(idx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000388;//kernel.T2MediaPlayer:388
        Tonyu.globals.$t2MediaLib.clearSoundData(idx);
      },
      fiber$clearSoundData :function _trc_T2MediaPlayer_f_clearSoundData(_thread,idx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81000388;//kernel.T2MediaPlayer:388
        Tonyu.globals.$t2MediaLib.clearSoundData(idx);
        
        _thread.retVal=_this;return;
      },
      allRemoveDecodedSoundData :function _trc_T2MediaPlayer_allRemoveDecodedSoundData() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000463;//kernel.T2MediaPlayer:463
        Tonyu.globals.$t2MediaLib.allRemoveDecodedSoundData();
      },
      fiber$allRemoveDecodedSoundData :function _trc_T2MediaPlayer_f_allRemoveDecodedSoundData(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81000463;//kernel.T2MediaPlayer:463
        Tonyu.globals.$t2MediaLib.allRemoveDecodedSoundData();
        
        _thread.retVal=_this;return;
      },
      removeDecodedSoundData :function _trc_T2MediaPlayer_removeDecodedSoundData(idx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000546;//kernel.T2MediaPlayer:546
        Tonyu.globals.$t2MediaLib.removeDecodedSoundData(idx);
      },
      fiber$removeDecodedSoundData :function _trc_T2MediaPlayer_f_removeDecodedSoundData(_thread,idx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81000546;//kernel.T2MediaPlayer:546
        Tonyu.globals.$t2MediaLib.removeDecodedSoundData(idx);
        
        _thread.retVal=_this;return;
      },
      getMasterVolume :function _trc_T2MediaPlayer_getMasterVolume() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getMasterVolume()*128;
      },
      fiber$getMasterVolume :function _trc_T2MediaPlayer_f_getMasterVolume(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getMasterVolume()*128;return;
        
        
        _thread.retVal=_this;return;
      },
      setMasterVolume :function _trc_T2MediaPlayer_setMasterVolume(vol) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000698;//kernel.T2MediaPlayer:698
        if (typeof  vol==="number") {
          //$LASTPOS=81000738;//kernel.T2MediaPlayer:738
          vol/=128;
          //$LASTPOS=81000759;//kernel.T2MediaPlayer:759
          if (vol<0) {
            //$LASTPOS=81000774;//kernel.T2MediaPlayer:774
            vol=0;
          }
          
        } else {
          return Tonyu.globals.$t2MediaLib.setMasterVolume(Tonyu.globals.$t2MediaLib.getMasterVolume());
          
        }
        return Tonyu.globals.$t2MediaLib.setMasterVolume(vol);
      },
      fiber$setMasterVolume :function _trc_T2MediaPlayer_f_setMasterVolume(_thread,vol) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81000698;//kernel.T2MediaPlayer:698
        if (typeof  vol==="number") {
          //$LASTPOS=81000738;//kernel.T2MediaPlayer:738
          vol/=128;
          //$LASTPOS=81000759;//kernel.T2MediaPlayer:759
          if (vol<0) {
            //$LASTPOS=81000774;//kernel.T2MediaPlayer:774
            vol=0;
          }
          
        } else {
          _thread.retVal=Tonyu.globals.$t2MediaLib.setMasterVolume(Tonyu.globals.$t2MediaLib.getMasterVolume());return;
          
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setMasterVolume(vol);return;
        
        
        _thread.retVal=_this;return;
      },
      loadSound :function _trc_T2MediaPlayer_loadSound(idx,src,callbacks) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81000983;//kernel.T2MediaPlayer:983
        Tonyu.globals.$t2MediaLib.loadSound(idx,src,callbacks);
      },
      fiber$loadSound :function _trc_T2MediaPlayer_f_loadSound(_thread,idx,src,callbacks) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81000983;//kernel.T2MediaPlayer:983
        Tonyu.globals.$t2MediaLib.loadSound(idx,src,callbacks);
        
        _thread.retVal=_this;return;
      },
      __getter__available :function _trc_T2MediaPlayer___getter__available() {
        "use strict";
        var _this=this;
        
        return ! ! Tonyu.globals.$t2MediaLib.context;
      },
      loadFromProject :function _trc_T2MediaPlayer_loadFromProject(prj) {
        "use strict";
        var _this=this;
        var r;
        var jobs;
        var cnt;
        var callbacks;
        var s;
        var name;
        var url;
        var func;
        var i;
        
        //$LASTPOS=81001126;//kernel.T2MediaPlayer:1126
        if (! _this.available) {
          return _this;
        }
        //$LASTPOS=81001155;//kernel.T2MediaPlayer:1155
        r = prj.getResource();
        
        //$LASTPOS=81001185;//kernel.T2MediaPlayer:1185
        if (! r||! r.sounds) {
          return _this;
        }
        //$LASTPOS=81001219;//kernel.T2MediaPlayer:1219
        if (r.sounds<=0) {
          return _this;
        }
        //$LASTPOS=81001253;//kernel.T2MediaPlayer:1253
        _this.progressNoLog("Loading sounds...[0/"+r.sounds.length+"]");
        //$LASTPOS=81001334;//kernel.T2MediaPlayer:1334
        jobs = 6;
        
        //$LASTPOS=81001351;//kernel.T2MediaPlayer:1351
        cnt = 0;
        
        //$LASTPOS=81001367;//kernel.T2MediaPlayer:1367
        callbacks = {};
        
        
        //$LASTPOS=81001413;//kernel.T2MediaPlayer:1413
        func = (function anonymous_1424(idx,errorID) {
          var s;
          var name;
          var url;
          
          //$LASTPOS=81001457;//kernel.T2MediaPlayer:1457
          if (errorID) {
            //$LASTPOS=81001485;//kernel.T2MediaPlayer:1485
            console.log(errorID);
            //$LASTPOS=81001564;//kernel.T2MediaPlayer:1564
            Tonyu.setGlobal(idx,"ERROR");
            
          } else {
            //$LASTPOS=81001672;//kernel.T2MediaPlayer:1672
            Tonyu.setGlobal(idx,idx);
            
          }
          //$LASTPOS=81001721;//kernel.T2MediaPlayer:1721
          cnt++;
          //$LASTPOS=81001738;//kernel.T2MediaPlayer:1738
          if (cnt>=r.sounds.length) {
            return _this;
          }
          //$LASTPOS=81001783;//kernel.T2MediaPlayer:1783
          _this.progressNoLog("Loading sounds...["+(cnt+1)+"/"+r.sounds.length+"]");
          //$LASTPOS=81001861;//kernel.T2MediaPlayer:1861
          s = r.sounds[cnt];
          
          //$LASTPOS=81001893;//kernel.T2MediaPlayer:1893
          name = s.name;
          
          //$LASTPOS=81001919;//kernel.T2MediaPlayer:1919
          url = Tonyu.Assets.resolve(s.url,prj);
          
          //$LASTPOS=81001970;//kernel.T2MediaPlayer:1970
          _this.loadSound(name,url,callbacks);
        });
        
        //$LASTPOS=81002016;//kernel.T2MediaPlayer:2016
        callbacks.succ=func;
        //$LASTPOS=81002042;//kernel.T2MediaPlayer:2042
        callbacks.err=func;
        //$LASTPOS=81002067;//kernel.T2MediaPlayer:2067
        //$LASTPOS=81002072;//kernel.T2MediaPlayer:2072
        i = 0;
        for (; i<jobs ; i++) {
          {
            //$LASTPOS=81002105;//kernel.T2MediaPlayer:2105
            if (i>=r.sounds.length) {
              break;
              
            }
            //$LASTPOS=81002147;//kernel.T2MediaPlayer:2147
            s=r.sounds[i];
            //$LASTPOS=81002173;//kernel.T2MediaPlayer:2173
            name=s.name;
            //$LASTPOS=81002195;//kernel.T2MediaPlayer:2195
            url=Tonyu.Assets.resolve(s.url,prj);
            //$LASTPOS=81002242;//kernel.T2MediaPlayer:2242
            _this.loadSound(name,url,callbacks);
          }
        }
        //$LASTPOS=81002287;//kernel.T2MediaPlayer:2287
        while (cnt<r.sounds.length) {
          //$LASTPOS=81002328;//kernel.T2MediaPlayer:2328
          _this.update();
          
        }
      },
      fiber$loadFromProject :function _trc_T2MediaPlayer_f_loadFromProject(_thread,prj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var r;
        var jobs;
        var cnt;
        var callbacks;
        var s;
        var name;
        var url;
        var func;
        var i;
        
        //$LASTPOS=81001126;//kernel.T2MediaPlayer:1126
        if (! _this.available) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=81001155;//kernel.T2MediaPlayer:1155
        r = prj.getResource();
        
        //$LASTPOS=81001185;//kernel.T2MediaPlayer:1185
        if (! r||! r.sounds) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=81001219;//kernel.T2MediaPlayer:1219
        if (r.sounds<=0) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=81001253;//kernel.T2MediaPlayer:1253
        _this.progressNoLog("Loading sounds...[0/"+r.sounds.length+"]");
        //$LASTPOS=81001334;//kernel.T2MediaPlayer:1334
        jobs = 6;
        
        //$LASTPOS=81001351;//kernel.T2MediaPlayer:1351
        cnt = 0;
        
        //$LASTPOS=81001367;//kernel.T2MediaPlayer:1367
        callbacks = {};
        
        
        
        _thread.enter(function _trc_T2MediaPlayer_ent_loadFromProject(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=81001413;//kernel.T2MediaPlayer:1413
              func = (function anonymous_1424(idx,errorID) {
                var s;
                var name;
                var url;
                
                //$LASTPOS=81001457;//kernel.T2MediaPlayer:1457
                if (errorID) {
                  //$LASTPOS=81001485;//kernel.T2MediaPlayer:1485
                  console.log(errorID);
                  //$LASTPOS=81001564;//kernel.T2MediaPlayer:1564
                  Tonyu.setGlobal(idx,"ERROR");
                  
                } else {
                  //$LASTPOS=81001672;//kernel.T2MediaPlayer:1672
                  Tonyu.setGlobal(idx,idx);
                  
                }
                //$LASTPOS=81001721;//kernel.T2MediaPlayer:1721
                cnt++;
                //$LASTPOS=81001738;//kernel.T2MediaPlayer:1738
                if (cnt>=r.sounds.length) {
                  return _this;
                }
                //$LASTPOS=81001783;//kernel.T2MediaPlayer:1783
                _this.progressNoLog("Loading sounds...["+(cnt+1)+"/"+r.sounds.length+"]");
                //$LASTPOS=81001861;//kernel.T2MediaPlayer:1861
                s = r.sounds[cnt];
                
                //$LASTPOS=81001893;//kernel.T2MediaPlayer:1893
                name = s.name;
                
                //$LASTPOS=81001919;//kernel.T2MediaPlayer:1919
                url = Tonyu.Assets.resolve(s.url,prj);
                
                //$LASTPOS=81001970;//kernel.T2MediaPlayer:1970
                _this.loadSound(name,url,callbacks);
              });
              
              //$LASTPOS=81002016;//kernel.T2MediaPlayer:2016
              callbacks.succ=func;
              //$LASTPOS=81002042;//kernel.T2MediaPlayer:2042
              callbacks.err=func;
              //$LASTPOS=81002067;//kernel.T2MediaPlayer:2067
              //$LASTPOS=81002072;//kernel.T2MediaPlayer:2072
              i = 0;
              
            case 1:
              if (!(i<jobs)) { __pc=5     ; break; }
              //$LASTPOS=81002105;//kernel.T2MediaPlayer:2105
              if (!(i>=r.sounds.length)) { __pc=2     ; break; }
              __pc=5     ; break;
              
            case 2     :
              
              //$LASTPOS=81002147;//kernel.T2MediaPlayer:2147
              s=r.sounds[i];
              //$LASTPOS=81002173;//kernel.T2MediaPlayer:2173
              name=s.name;
              //$LASTPOS=81002195;//kernel.T2MediaPlayer:2195
              url=Tonyu.Assets.resolve(s.url,prj);
              //$LASTPOS=81002242;//kernel.T2MediaPlayer:2242
              _this.fiber$loadSound(_thread, name, url, callbacks);
              __pc=3;return;
            case 3:
              
            case 4     :
              i++;
              __pc=1;break;
            case 5     :
              
              //$LASTPOS=81002287;//kernel.T2MediaPlayer:2287
            case 6:
              if (!(cnt<r.sounds.length)) { __pc=8     ; break; }
              //$LASTPOS=81002328;//kernel.T2MediaPlayer:2328
              _this.fiber$update(_thread);
              __pc=7;return;
            case 7:
              
              __pc=6;break;
            case 8     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      decodeSound :function _trc_T2MediaPlayer_decodeSound(idx,callbacks) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81002412;//kernel.T2MediaPlayer:2412
        Tonyu.globals.$t2MediaLib.decodeSound(idx,callbacks);
      },
      fiber$decodeSound :function _trc_T2MediaPlayer_f_decodeSound(_thread,idx,callbacks) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81002412;//kernel.T2MediaPlayer:2412
        Tonyu.globals.$t2MediaLib.decodeSound(idx,callbacks);
        
        _thread.retVal=_this;return;
      },
      getSoundFileData :function _trc_T2MediaPlayer_getSoundFileData(idx) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getSoundFileData(idx);
      },
      fiber$getSoundFileData :function _trc_T2MediaPlayer_f_getSoundFileData(_thread,idx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getSoundFileData(idx);return;
        
        
        _thread.retVal=_this;return;
      },
      getSoundDecodedData :function _trc_T2MediaPlayer_getSoundDecodedData(idx) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getSoundDecodedData(idx);
      },
      fiber$getSoundDecodedData :function _trc_T2MediaPlayer_f_getSoundDecodedData(_thread,idx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getSoundDecodedData(idx);return;
        
        
        _thread.retVal=_this;return;
      },
      getCurrentTime :function _trc_T2MediaPlayer_getCurrentTime() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getCurrentTime();
      },
      fiber$getCurrentTime :function _trc_T2MediaPlayer_f_getCurrentTime(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getCurrentTime();return;
        
        
        _thread.retVal=_this;return;
      },
      getContext :function _trc_T2MediaPlayer_getContext() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.context;
      },
      fiber$getContext :function _trc_T2MediaPlayer_f_getContext(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.context;return;
        
        
        _thread.retVal=_this;return;
      },
      playSE :function _trc_T2MediaPlayer_playSE(idx,vol,pan,rate,offset,loop,loopStart,loopEnd,start,duration) {
        "use strict";
        var _this=this;
        var o;
        
        //$LASTPOS=81002908;//kernel.T2MediaPlayer:2908
        if (_this.mute) {
          return _this;
        }
        //$LASTPOS=81002931;//kernel.T2MediaPlayer:2931
        if (vol&&typeof  vol==="object") {
          //$LASTPOS=81002986;//kernel.T2MediaPlayer:2986
          o = vol;
          
          //$LASTPOS=81003006;//kernel.T2MediaPlayer:3006
          vol=o.vol;
          //$LASTPOS=81003026;//kernel.T2MediaPlayer:3026
          pan=o.pan;
          //$LASTPOS=81003046;//kernel.T2MediaPlayer:3046
          rate=o.rate;
          //$LASTPOS=81003068;//kernel.T2MediaPlayer:3068
          offset=o.offset;
          //$LASTPOS=81003094;//kernel.T2MediaPlayer:3094
          loop=o.loop;
          //$LASTPOS=81003116;//kernel.T2MediaPlayer:3116
          loopStart=o.loopStart;
          //$LASTPOS=81003148;//kernel.T2MediaPlayer:3148
          loopEnd=o.loopEnd;
          //$LASTPOS=81003176;//kernel.T2MediaPlayer:3176
          start=o.start;
          //$LASTPOS=81003200;//kernel.T2MediaPlayer:3200
          duration=o.duration;
          
        }
        //$LASTPOS=81003368;//kernel.T2MediaPlayer:3368
        if (vol==null) {
          //$LASTPOS=81003385;//kernel.T2MediaPlayer:3385
          vol=128;
        }
        //$LASTPOS=81003401;//kernel.T2MediaPlayer:3401
        if (typeof  vol==="number") {
          //$LASTPOS=81003441;//kernel.T2MediaPlayer:3441
          vol/=128;
          //$LASTPOS=81003462;//kernel.T2MediaPlayer:3462
          if (vol<0) {
            //$LASTPOS=81003477;//kernel.T2MediaPlayer:3477
            vol=0;
          }
          
        } else {
          //$LASTPOS=81003511;//kernel.T2MediaPlayer:3511
          vol=1;
          
        }
        return Tonyu.globals.$t2MediaLib.playSE(idx,vol,pan,rate,offset,loop,loopStart,loopEnd,start,duration);
      },
      stopSE :function _trc_T2MediaPlayer_stopSE(sourceObj) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.stopSE(sourceObj);
      },
      fiber$stopSE :function _trc_T2MediaPlayer_f_stopSE(_thread,sourceObj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.stopSE(sourceObj);return;
        
        
        _thread.retVal=_this;return;
      },
      stopAllSE :function _trc_T2MediaPlayer_stopAllSE() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.stopAllSE();
      },
      fiber$stopAllSE :function _trc_T2MediaPlayer_f_stopAllSE(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.stopAllSE();return;
        
        
        _thread.retVal=_this;return;
      },
      getSEMasterVolume :function _trc_T2MediaPlayer_getSEMasterVolume() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getSEMasterVolume()*128;
      },
      fiber$getSEMasterVolume :function _trc_T2MediaPlayer_f_getSEMasterVolume(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getSEMasterVolume()*128;return;
        
        
        _thread.retVal=_this;return;
      },
      setSEMasterVolume :function _trc_T2MediaPlayer_setSEMasterVolume(vol) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81003884;//kernel.T2MediaPlayer:3884
        if (typeof  vol==="number") {
          //$LASTPOS=81003924;//kernel.T2MediaPlayer:3924
          vol/=128;
          //$LASTPOS=81003945;//kernel.T2MediaPlayer:3945
          if (vol<0) {
            //$LASTPOS=81003960;//kernel.T2MediaPlayer:3960
            vol=0;
          }
          
        } else {
          return Tonyu.globals.$t2MediaLib.setSEMasterVolume(Tonyu.globals.$t2MediaLib.getSEMasterVolume());
          
        }
        return Tonyu.globals.$t2MediaLib.setSEMasterVolume(vol);
      },
      fiber$setSEMasterVolume :function _trc_T2MediaPlayer_f_setSEMasterVolume(_thread,vol) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81003884;//kernel.T2MediaPlayer:3884
        if (typeof  vol==="number") {
          //$LASTPOS=81003924;//kernel.T2MediaPlayer:3924
          vol/=128;
          //$LASTPOS=81003945;//kernel.T2MediaPlayer:3945
          if (vol<0) {
            //$LASTPOS=81003960;//kernel.T2MediaPlayer:3960
            vol=0;
          }
          
        } else {
          _thread.retVal=Tonyu.globals.$t2MediaLib.setSEMasterVolume(Tonyu.globals.$t2MediaLib.getSEMasterVolume());return;
          
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setSEMasterVolume(vol);return;
        
        
        _thread.retVal=_this;return;
      },
      getSEVolume :function _trc_T2MediaPlayer_getSEVolume(sourceObj) {
        "use strict";
        var _this=this;
        var vol;
        
        //$LASTPOS=81004194;//kernel.T2MediaPlayer:4194
        vol = Tonyu.globals.$t2MediaLib.getSEVolume(sourceObj);
        
        return typeof  vol==="number"?vol*128:vol;
      },
      fiber$getSEVolume :function _trc_T2MediaPlayer_f_getSEVolume(_thread,sourceObj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var vol;
        
        //$LASTPOS=81004194;//kernel.T2MediaPlayer:4194
        vol = Tonyu.globals.$t2MediaLib.getSEVolume(sourceObj);
        
        _thread.retVal=typeof  vol==="number"?vol*128:vol;return;
        
        
        _thread.retVal=_this;return;
      },
      setSEVolume :function _trc_T2MediaPlayer_setSEVolume(sourceObj,vol) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81004337;//kernel.T2MediaPlayer:4337
        if (typeof  vol==="number") {
          //$LASTPOS=81004377;//kernel.T2MediaPlayer:4377
          vol/=128;
          //$LASTPOS=81004398;//kernel.T2MediaPlayer:4398
          if (vol<0) {
            //$LASTPOS=81004413;//kernel.T2MediaPlayer:4413
            vol=0;
          }
          
        } else {
          return Tonyu.globals.$t2MediaLib.setSEVolume(sourceObj,Tonyu.globals.$t2MediaLib.getSEVolume(sourceObj));
          
        }
        return Tonyu.globals.$t2MediaLib.setSEVolume(sourceObj,vol);
      },
      fiber$setSEVolume :function _trc_T2MediaPlayer_f_setSEVolume(_thread,sourceObj,vol) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81004337;//kernel.T2MediaPlayer:4337
        if (typeof  vol==="number") {
          //$LASTPOS=81004377;//kernel.T2MediaPlayer:4377
          vol/=128;
          //$LASTPOS=81004398;//kernel.T2MediaPlayer:4398
          if (vol<0) {
            //$LASTPOS=81004413;//kernel.T2MediaPlayer:4413
            vol=0;
          }
          
        } else {
          _thread.retVal=Tonyu.globals.$t2MediaLib.setSEVolume(sourceObj,Tonyu.globals.$t2MediaLib.getSEVolume(sourceObj));return;
          
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setSEVolume(sourceObj,vol);return;
        
        
        _thread.retVal=_this;return;
      },
      getSERate :function _trc_T2MediaPlayer_getSERate(sourceObj) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getSERate(sourceObj);
      },
      fiber$getSERate :function _trc_T2MediaPlayer_f_getSERate(_thread,sourceObj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getSERate(sourceObj);return;
        
        
        _thread.retVal=_this;return;
      },
      setSERate :function _trc_T2MediaPlayer_setSERate(sourceObj,rate) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setSERate(sourceObj,rate);
      },
      fiber$setSERate :function _trc_T2MediaPlayer_f_setSERate(_thread,sourceObj,rate) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setSERate(sourceObj,rate);return;
        
        
        _thread.retVal=_this;return;
      },
      getSEPan :function _trc_T2MediaPlayer_getSEPan(sourceObj) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getSEPan(sourceObj);
      },
      fiber$getSEPan :function _trc_T2MediaPlayer_f_getSEPan(_thread,sourceObj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getSEPan(sourceObj);return;
        
        
        _thread.retVal=_this;return;
      },
      setSEPan :function _trc_T2MediaPlayer_setSEPan(sourceObj,pan) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setSEPan(sourceObj,pan);
      },
      fiber$setSEPan :function _trc_T2MediaPlayer_f_setSEPan(_thread,sourceObj,pan) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setSEPan(sourceObj,pan);return;
        
        
        _thread.retVal=_this;return;
      },
      isSELoop :function _trc_T2MediaPlayer_isSELoop(sourceObj) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.isSELoop(sourceObj);
      },
      fiber$isSELoop :function _trc_T2MediaPlayer_f_isSELoop(_thread,sourceObj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.isSELoop(sourceObj);return;
        
        
        _thread.retVal=_this;return;
      },
      setSELoop :function _trc_T2MediaPlayer_setSELoop(sourceObj,loop) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setSELoop(sourceObj,loop);
      },
      fiber$setSELoop :function _trc_T2MediaPlayer_f_setSELoop(_thread,sourceObj,loop) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setSELoop(sourceObj,loop);return;
        
        
        _thread.retVal=_this;return;
      },
      getSELoopStartTime :function _trc_T2MediaPlayer_getSELoopStartTime(sourceObj) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getSELoopStartTime(sourceObj);
      },
      fiber$getSELoopStartTime :function _trc_T2MediaPlayer_f_getSELoopStartTime(_thread,sourceObj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getSELoopStartTime(sourceObj);return;
        
        
        _thread.retVal=_this;return;
      },
      setSELoopStartTime :function _trc_T2MediaPlayer_setSELoopStartTime(sourceObj,loopStart) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setSELoopStartTime(Tonyu.bindFunc(_this,_this.setSELoopStartTime),loopStart);
      },
      fiber$setSELoopStartTime :function _trc_T2MediaPlayer_f_setSELoopStartTime(_thread,sourceObj,loopStart) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setSELoopStartTime(Tonyu.bindFunc(_this,_this.setSELoopStartTime),loopStart);return;
        
        
        _thread.retVal=_this;return;
      },
      getSELoopEndTime :function _trc_T2MediaPlayer_getSELoopEndTime(sourceObj) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getSELoopEndTime(sourceObj);
      },
      fiber$getSELoopEndTime :function _trc_T2MediaPlayer_f_getSELoopEndTime(_thread,sourceObj) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getSELoopEndTime(sourceObj);return;
        
        
        _thread.retVal=_this;return;
      },
      setSELoopEndTime :function _trc_T2MediaPlayer_setSELoopEndTime(sourceObj,loopEnd) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setSELoopEndTime(Tonyu.bindFunc(_this,_this.setSELoopStartTime),loopEnd);
      },
      fiber$setSELoopEndTime :function _trc_T2MediaPlayer_f_setSELoopEndTime(_thread,sourceObj,loopEnd) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setSELoopEndTime(Tonyu.bindFunc(_this,_this.setSELoopStartTime),loopEnd);return;
        
        
        _thread.retVal=_this;return;
      },
      playBGM :function _trc_T2MediaPlayer_playBGM(idx,loop,offset,loopStart,loopEnd) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81005609;//kernel.T2MediaPlayer:5609
        if (_this.mute) {
          return _this;
        }
        //$LASTPOS=81005632;//kernel.T2MediaPlayer:5632
        if (loop==null) {
          //$LASTPOS=81005650;//kernel.T2MediaPlayer:5650
          loop=false;
        }
        //$LASTPOS=81005669;//kernel.T2MediaPlayer:5669
        if (offset==null) {
          //$LASTPOS=81005689;//kernel.T2MediaPlayer:5689
          offset=0;
        }
        return Tonyu.globals.$t2MediaLib.playBGM(0,idx,loop,offset,loopStart,loopEnd);
      },
      fiber$playBGM :function _trc_T2MediaPlayer_f_playBGM(_thread,idx,loop,offset,loopStart,loopEnd) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81005609;//kernel.T2MediaPlayer:5609
        if (_this.mute) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=81005632;//kernel.T2MediaPlayer:5632
        if (loop==null) {
          //$LASTPOS=81005650;//kernel.T2MediaPlayer:5650
          loop=false;
        }
        //$LASTPOS=81005669;//kernel.T2MediaPlayer:5669
        if (offset==null) {
          //$LASTPOS=81005689;//kernel.T2MediaPlayer:5689
          offset=0;
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.playBGM(0,idx,loop,offset,loopStart,loopEnd);return;
        
        
        _thread.retVal=_this;return;
      },
      stopBGM :function _trc_T2MediaPlayer_stopBGM() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.stopBGM(0);
      },
      fiber$stopBGM :function _trc_T2MediaPlayer_f_stopBGM(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.stopBGM(0);return;
        
        
        _thread.retVal=_this;return;
      },
      pauseBGM :function _trc_T2MediaPlayer_pauseBGM() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.pauseBGM(0);
      },
      fiber$pauseBGM :function _trc_T2MediaPlayer_f_pauseBGM(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.pauseBGM(0);return;
        
        
        _thread.retVal=_this;return;
      },
      resumeBGM :function _trc_T2MediaPlayer_resumeBGM() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81005914;//kernel.T2MediaPlayer:5914
        if (_this.mute) {
          return _this;
        }
        return Tonyu.globals.$t2MediaLib.resumeBGM(0);
      },
      fiber$resumeBGM :function _trc_T2MediaPlayer_f_resumeBGM(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81005914;//kernel.T2MediaPlayer:5914
        if (_this.mute) {
          _thread.retVal=_this;return;
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.resumeBGM(0);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMMasterVolume :function _trc_T2MediaPlayer_getBGMMasterVolume() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMMasterVolume()*128;
      },
      fiber$getBGMMasterVolume :function _trc_T2MediaPlayer_f_getBGMMasterVolume(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMMasterVolume()*128;return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMMasterVolume :function _trc_T2MediaPlayer_setBGMMasterVolume(vol) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81006090;//kernel.T2MediaPlayer:6090
        if (typeof  vol==="number") {
          //$LASTPOS=81006130;//kernel.T2MediaPlayer:6130
          vol/=128;
          //$LASTPOS=81006151;//kernel.T2MediaPlayer:6151
          if (vol<0) {
            //$LASTPOS=81006166;//kernel.T2MediaPlayer:6166
            vol=0;
          }
          
        } else {
          return Tonyu.globals.$t2MediaLib.setBGMMasterVolume(Tonyu.globals.$t2MediaLib.getBGMMasterVolume());
          
        }
        return Tonyu.globals.$t2MediaLib.setBGMMasterVolume(vol);
      },
      fiber$setBGMMasterVolume :function _trc_T2MediaPlayer_f_setBGMMasterVolume(_thread,vol) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81006090;//kernel.T2MediaPlayer:6090
        if (typeof  vol==="number") {
          //$LASTPOS=81006130;//kernel.T2MediaPlayer:6130
          vol/=128;
          //$LASTPOS=81006151;//kernel.T2MediaPlayer:6151
          if (vol<0) {
            //$LASTPOS=81006166;//kernel.T2MediaPlayer:6166
            vol=0;
          }
          
        } else {
          _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMMasterVolume(Tonyu.globals.$t2MediaLib.getBGMMasterVolume());return;
          
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMMasterVolume(vol);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMVolume :function _trc_T2MediaPlayer_getBGMVolume() {
        "use strict";
        var _this=this;
        var vol;
        
        //$LASTPOS=81006395;//kernel.T2MediaPlayer:6395
        vol = Tonyu.globals.$t2MediaLib.getBGMVolume(0);
        
        return typeof  vol==="number"?vol*128:vol;
      },
      fiber$getBGMVolume :function _trc_T2MediaPlayer_f_getBGMVolume(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var vol;
        
        //$LASTPOS=81006395;//kernel.T2MediaPlayer:6395
        vol = Tonyu.globals.$t2MediaLib.getBGMVolume(0);
        
        _thread.retVal=typeof  vol==="number"?vol*128:vol;return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMVolume :function _trc_T2MediaPlayer_setBGMVolume(vol) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81006617;//kernel.T2MediaPlayer:6617
        if (typeof  vol==="number") {
          //$LASTPOS=81006657;//kernel.T2MediaPlayer:6657
          vol/=128;
          //$LASTPOS=81006678;//kernel.T2MediaPlayer:6678
          if (vol<0) {
            //$LASTPOS=81006693;//kernel.T2MediaPlayer:6693
            vol=0;
          }
          
        } else {
          return Tonyu.globals.$t2MediaLib.setBGMVolume(0,Tonyu.globals.$t2MediaLib.getBGMVolume(0));
          
        }
        return Tonyu.globals.$t2MediaLib.setBGMVolume(0,vol);
      },
      fiber$setBGMVolume :function _trc_T2MediaPlayer_f_setBGMVolume(_thread,vol) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81006617;//kernel.T2MediaPlayer:6617
        if (typeof  vol==="number") {
          //$LASTPOS=81006657;//kernel.T2MediaPlayer:6657
          vol/=128;
          //$LASTPOS=81006678;//kernel.T2MediaPlayer:6678
          if (vol<0) {
            //$LASTPOS=81006693;//kernel.T2MediaPlayer:6693
            vol=0;
          }
          
        } else {
          _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMVolume(0,Tonyu.globals.$t2MediaLib.getBGMVolume(0));return;
          
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMVolume(0,vol);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMTempo :function _trc_T2MediaPlayer_getBGMTempo() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMTempo(0);
      },
      fiber$getBGMTempo :function _trc_T2MediaPlayer_f_getBGMTempo(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMTempo(0);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMTempo :function _trc_T2MediaPlayer_setBGMTempo(tempo) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMTempo(0,tempo);
      },
      fiber$setBGMTempo :function _trc_T2MediaPlayer_f_setBGMTempo(_thread,tempo) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMTempo(0,tempo);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMPan :function _trc_T2MediaPlayer_getBGMPan() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMPan(0);
      },
      fiber$getBGMPan :function _trc_T2MediaPlayer_f_getBGMPan(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMPan(0);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMPan :function _trc_T2MediaPlayer_setBGMPan(pan) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMPan(0,pan);
      },
      fiber$setBGMPan :function _trc_T2MediaPlayer_f_setBGMPan(_thread,pan) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMPan(0,pan);return;
        
        
        _thread.retVal=_this;return;
      },
      isBGMLoop :function _trc_T2MediaPlayer_isBGMLoop() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.isBGMLoop(0);
      },
      fiber$isBGMLoop :function _trc_T2MediaPlayer_f_isBGMLoop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.isBGMLoop(0);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMLoop :function _trc_T2MediaPlayer_setBGMLoop(loop) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMLoop(0,loop);
      },
      fiber$setBGMLoop :function _trc_T2MediaPlayer_f_setBGMLoop(_thread,loop) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMLoop(0,loop);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMLoopStartTime :function _trc_T2MediaPlayer_getBGMLoopStartTime() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMLoopStartTime(0);
      },
      fiber$getBGMLoopStartTime :function _trc_T2MediaPlayer_f_getBGMLoopStartTime(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMLoopStartTime(0);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMLoopStartTime :function _trc_T2MediaPlayer_setBGMLoopStartTime(loopStart) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMLoopStartTime(0,loopStart);
      },
      fiber$setBGMLoopStartTime :function _trc_T2MediaPlayer_f_setBGMLoopStartTime(_thread,loopStart) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMLoopStartTime(0,loopStart);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMLoopEndTime :function _trc_T2MediaPlayer_getBGMLoopEndTime() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMLoopEndTime(0);
      },
      fiber$getBGMLoopEndTime :function _trc_T2MediaPlayer_f_getBGMLoopEndTime(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMLoopEndTime(0);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMLoopEndTime :function _trc_T2MediaPlayer_setBGMLoopEndTime(loopEnd) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMLoopEndTime(0,loopEnd);
      },
      fiber$setBGMLoopEndTime :function _trc_T2MediaPlayer_f_setBGMLoopEndTime(_thread,loopEnd) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMLoopEndTime(0,loopEnd);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMCurrentTime :function _trc_T2MediaPlayer_getBGMCurrentTime() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMCurrentTime(0);
      },
      fiber$getBGMCurrentTime :function _trc_T2MediaPlayer_f_getBGMCurrentTime(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMCurrentTime(0);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMLength :function _trc_T2MediaPlayer_getBGMLength() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMLength(0);
      },
      fiber$getBGMLength :function _trc_T2MediaPlayer_f_getBGMLength(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMLength(0);return;
        
        
        _thread.retVal=_this;return;
      },
      getPlayingBGMName :function _trc_T2MediaPlayer_getPlayingBGMName() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getPlayingBGMName(0);
      },
      fiber$getPlayingBGMName :function _trc_T2MediaPlayer_f_getPlayingBGMName(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getPlayingBGMName(0);return;
        
        
        _thread.retVal=_this;return;
      },
      setOnBGMEndListener :function _trc_T2MediaPlayer_setOnBGMEndListener() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setOnBGMEndListener(0);
      },
      fiber$setOnBGMEndListener :function _trc_T2MediaPlayer_f_setOnBGMEndListener(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setOnBGMEndListener(0);return;
        
        
        _thread.retVal=_this;return;
      },
      getPlayingBGMState :function _trc_T2MediaPlayer_getPlayingBGMState(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getPlayingBGMState(id);
      },
      fiber$getPlayingBGMState :function _trc_T2MediaPlayer_f_getPlayingBGMState(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getPlayingBGMState(id);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMPicoAudio :function _trc_T2MediaPlayer_getBGMPicoAudio(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMPicoAudio(id);
      },
      fiber$getBGMPicoAudio :function _trc_T2MediaPlayer_f_getBGMPicoAudio(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMPicoAudio(id);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMPlayerMax :function _trc_T2MediaPlayer_getBGMPlayerMax() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMPlayerMax();
      },
      fiber$getBGMPlayerMax :function _trc_T2MediaPlayer_f_getBGMPlayerMax(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMPlayerMax();return;
        
        
        _thread.retVal=_this;return;
      },
      allStopBGM :function _trc_T2MediaPlayer_allStopBGM() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81008159;//kernel.T2MediaPlayer:8159
        Tonyu.globals.$t2MediaLib.allStopBGM();
      },
      fiber$allStopBGM :function _trc_T2MediaPlayer_f_allStopBGM(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81008159;//kernel.T2MediaPlayer:8159
        Tonyu.globals.$t2MediaLib.allStopBGM();
        
        _thread.retVal=_this;return;
      },
      allResetBGM :function _trc_T2MediaPlayer_allResetBGM() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81008213;//kernel.T2MediaPlayer:8213
        Tonyu.globals.$t2MediaLib.allResetBGM();
      },
      fiber$allResetBGM :function _trc_T2MediaPlayer_f_allResetBGM(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81008213;//kernel.T2MediaPlayer:8213
        Tonyu.globals.$t2MediaLib.allResetBGM();
        
        _thread.retVal=_this;return;
      },
      playBGMID :function _trc_T2MediaPlayer_playBGMID(id,idx,loop,offset,loopStart,loopEnd) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81008323;//kernel.T2MediaPlayer:8323
        if (_this.mute) {
          return _this;
        }
        //$LASTPOS=81008346;//kernel.T2MediaPlayer:8346
        if (loop==null) {
          //$LASTPOS=81008364;//kernel.T2MediaPlayer:8364
          loop=false;
        }
        //$LASTPOS=81008383;//kernel.T2MediaPlayer:8383
        if (offset==null) {
          //$LASTPOS=81008403;//kernel.T2MediaPlayer:8403
          offset=0;
        }
        return Tonyu.globals.$t2MediaLib.playBGM(id,idx,loop,offset,loopStart,loopEnd);
      },
      fiber$playBGMID :function _trc_T2MediaPlayer_f_playBGMID(_thread,id,idx,loop,offset,loopStart,loopEnd) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81008323;//kernel.T2MediaPlayer:8323
        if (_this.mute) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=81008346;//kernel.T2MediaPlayer:8346
        if (loop==null) {
          //$LASTPOS=81008364;//kernel.T2MediaPlayer:8364
          loop=false;
        }
        //$LASTPOS=81008383;//kernel.T2MediaPlayer:8383
        if (offset==null) {
          //$LASTPOS=81008403;//kernel.T2MediaPlayer:8403
          offset=0;
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.playBGM(id,idx,loop,offset,loopStart,loopEnd);return;
        
        
        _thread.retVal=_this;return;
      },
      stopBGMID :function _trc_T2MediaPlayer_stopBGMID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.stopBGM(id);
      },
      fiber$stopBGMID :function _trc_T2MediaPlayer_f_stopBGMID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.stopBGM(id);return;
        
        
        _thread.retVal=_this;return;
      },
      pauseBGMID :function _trc_T2MediaPlayer_pauseBGMID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.pauseBGM(id);
      },
      fiber$pauseBGMID :function _trc_T2MediaPlayer_f_pauseBGMID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.pauseBGM(id);return;
        
        
        _thread.retVal=_this;return;
      },
      resumeBGMID :function _trc_T2MediaPlayer_resumeBGMID(id) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81008643;//kernel.T2MediaPlayer:8643
        if (_this.mute) {
          return _this;
        }
        return Tonyu.globals.$t2MediaLib.resumeBGM(id);
      },
      fiber$resumeBGMID :function _trc_T2MediaPlayer_f_resumeBGMID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81008643;//kernel.T2MediaPlayer:8643
        if (_this.mute) {
          _thread.retVal=_this;return;
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.resumeBGM(id);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMVolumeID :function _trc_T2MediaPlayer_getBGMVolumeID(id) {
        "use strict";
        var _this=this;
        var vol;
        
        //$LASTPOS=81008733;//kernel.T2MediaPlayer:8733
        vol = Tonyu.globals.$t2MediaLib.getBGMVolume(id);
        
        return typeof  vol==="number"?vol*128:vol;
      },
      fiber$getBGMVolumeID :function _trc_T2MediaPlayer_f_getBGMVolumeID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var vol;
        
        //$LASTPOS=81008733;//kernel.T2MediaPlayer:8733
        vol = Tonyu.globals.$t2MediaLib.getBGMVolume(id);
        
        _thread.retVal=typeof  vol==="number"?vol*128:vol;return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMVolumeID :function _trc_T2MediaPlayer_setBGMVolumeID(id,vol) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81008962;//kernel.T2MediaPlayer:8962
        if (typeof  vol==="number") {
          //$LASTPOS=81009002;//kernel.T2MediaPlayer:9002
          vol/=128;
          //$LASTPOS=81009023;//kernel.T2MediaPlayer:9023
          if (vol<0) {
            //$LASTPOS=81009038;//kernel.T2MediaPlayer:9038
            vol=0;
          }
          
        } else {
          return Tonyu.globals.$t2MediaLib.setBGMVolume(id,Tonyu.globals.$t2MediaLib.getBGMVolume(id));
          
        }
        return Tonyu.globals.$t2MediaLib.setBGMVolume(id,vol);
      },
      fiber$setBGMVolumeID :function _trc_T2MediaPlayer_f_setBGMVolumeID(_thread,id,vol) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81008962;//kernel.T2MediaPlayer:8962
        if (typeof  vol==="number") {
          //$LASTPOS=81009002;//kernel.T2MediaPlayer:9002
          vol/=128;
          //$LASTPOS=81009023;//kernel.T2MediaPlayer:9023
          if (vol<0) {
            //$LASTPOS=81009038;//kernel.T2MediaPlayer:9038
            vol=0;
          }
          
        } else {
          _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMVolume(id,Tonyu.globals.$t2MediaLib.getBGMVolume(id));return;
          
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMVolume(id,vol);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMTempoID :function _trc_T2MediaPlayer_getBGMTempoID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMTempo(id);
      },
      fiber$getBGMTempoID :function _trc_T2MediaPlayer_f_getBGMTempoID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMTempo(id);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMTempoID :function _trc_T2MediaPlayer_setBGMTempoID(id,tempo) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMTempo(id,tempo);
      },
      fiber$setBGMTempoID :function _trc_T2MediaPlayer_f_setBGMTempoID(_thread,id,tempo) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMTempo(id,tempo);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMPanID :function _trc_T2MediaPlayer_getBGMPanID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMPan(id);
      },
      fiber$getBGMPanID :function _trc_T2MediaPlayer_f_getBGMPanID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMPan(id);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMPanID :function _trc_T2MediaPlayer_setBGMPanID(id,pan) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMPan(id,pan);
      },
      fiber$setBGMPanID :function _trc_T2MediaPlayer_f_setBGMPanID(_thread,id,pan) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMPan(id,pan);return;
        
        
        _thread.retVal=_this;return;
      },
      isBGMLoopID :function _trc_T2MediaPlayer_isBGMLoopID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.isBGMLoop(id);
      },
      fiber$isBGMLoopID :function _trc_T2MediaPlayer_f_isBGMLoopID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.isBGMLoop(id);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMLoopID :function _trc_T2MediaPlayer_setBGMLoopID(id,loop) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMLoop(id,loop);
      },
      fiber$setBGMLoopID :function _trc_T2MediaPlayer_f_setBGMLoopID(_thread,id,loop) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMLoop(id,loop);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMLoopStartTimeID :function _trc_T2MediaPlayer_getBGMLoopStartTimeID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMLoopStartTime(id);
      },
      fiber$getBGMLoopStartTimeID :function _trc_T2MediaPlayer_f_getBGMLoopStartTimeID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMLoopStartTime(id);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMLoopStartTimeID :function _trc_T2MediaPlayer_setBGMLoopStartTimeID(id,loopStart) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMLoopStartTime(id,loopStart);
      },
      fiber$setBGMLoopStartTimeID :function _trc_T2MediaPlayer_f_setBGMLoopStartTimeID(_thread,id,loopStart) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMLoopStartTime(id,loopStart);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMLoopEndTimeID :function _trc_T2MediaPlayer_getBGMLoopEndTimeID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMLoopEndTime(id);
      },
      fiber$getBGMLoopEndTimeID :function _trc_T2MediaPlayer_f_getBGMLoopEndTimeID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMLoopEndTime(id);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMLoopEndTimeID :function _trc_T2MediaPlayer_setBGMLoopEndTimeID(id,loopEnd) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setBGMLoopEndTime(id,loopEnd);
      },
      fiber$setBGMLoopEndTimeID :function _trc_T2MediaPlayer_f_setBGMLoopEndTimeID(_thread,id,loopEnd) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setBGMLoopEndTime(id,loopEnd);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMCurrentTimeID :function _trc_T2MediaPlayer_getBGMCurrentTimeID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMCurrentTime(id);
      },
      fiber$getBGMCurrentTimeID :function _trc_T2MediaPlayer_f_getBGMCurrentTimeID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMCurrentTime(id);return;
        
        
        _thread.retVal=_this;return;
      },
      getBGMLengthID :function _trc_T2MediaPlayer_getBGMLengthID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getBGMLength(id);
      },
      fiber$getBGMLengthID :function _trc_T2MediaPlayer_f_getBGMLengthID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getBGMLength(id);return;
        
        
        _thread.retVal=_this;return;
      },
      getPlayingBGMNameID :function _trc_T2MediaPlayer_getPlayingBGMNameID(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getPlayingBGMName(id);
      },
      fiber$getPlayingBGMNameID :function _trc_T2MediaPlayer_f_getPlayingBGMNameID(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getPlayingBGMName(id);return;
        
        
        _thread.retVal=_this;return;
      },
      setBGMOnSongEndListener :function _trc_T2MediaPlayer_setBGMOnSongEndListener(id) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setOnBGMEndListener(id);
      },
      fiber$setBGMOnSongEndListener :function _trc_T2MediaPlayer_f_setBGMOnSongEndListener(_thread,id) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setOnBGMEndListener(id);return;
        
        
        _thread.retVal=_this;return;
      },
      loadAudio :function _trc_T2MediaPlayer_loadAudio(idx,src) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81010565;//kernel.T2MediaPlayer:10565
        Tonyu.globals.$t2MediaLib.loadAudio(idx,src);
        //$LASTPOS=81010628;//kernel.T2MediaPlayer:10628
        while (Tonyu.globals.$t2MediaLib.getAudioData(idx)==null) {
          //$LASTPOS=81010674;//kernel.T2MediaPlayer:10674
          _this.update();
        }
      },
      fiber$loadAudio :function _trc_T2MediaPlayer_f_loadAudio(_thread,idx,src) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81010565;//kernel.T2MediaPlayer:10565
        Tonyu.globals.$t2MediaLib.loadAudio(idx,src);
        
        _thread.enter(function _trc_T2MediaPlayer_ent_loadAudio(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=81010628;//kernel.T2MediaPlayer:10628
            case 1:
              if (!(Tonyu.globals.$t2MediaLib.getAudioData(idx)==null)) { __pc=3     ; break; }
              //$LASTPOS=81010674;//kernel.T2MediaPlayer:10674
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      playAudio :function _trc_T2MediaPlayer_playAudio(idx,loop,startTime) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81010730;//kernel.T2MediaPlayer:10730
        if (_this.mute) {
          return _this;
        }
        //$LASTPOS=81010753;//kernel.T2MediaPlayer:10753
        if (loop==null) {
          //$LASTPOS=81010771;//kernel.T2MediaPlayer:10771
          loop=false;
        }
        //$LASTPOS=81010790;//kernel.T2MediaPlayer:10790
        if (startTime==null) {
          //$LASTPOS=81010813;//kernel.T2MediaPlayer:10813
          startTime=0;
        }
        return Tonyu.globals.$t2MediaLib.playAudio(idx,loop,startTime);
      },
      fiber$playAudio :function _trc_T2MediaPlayer_f_playAudio(_thread,idx,loop,startTime) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81010730;//kernel.T2MediaPlayer:10730
        if (_this.mute) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=81010753;//kernel.T2MediaPlayer:10753
        if (loop==null) {
          //$LASTPOS=81010771;//kernel.T2MediaPlayer:10771
          loop=false;
        }
        //$LASTPOS=81010790;//kernel.T2MediaPlayer:10790
        if (startTime==null) {
          //$LASTPOS=81010813;//kernel.T2MediaPlayer:10813
          startTime=0;
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.playAudio(idx,loop,startTime);return;
        
        
        _thread.retVal=_this;return;
      },
      stopAudio :function _trc_T2MediaPlayer_stopAudio() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.stopAudio();
      },
      fiber$stopAudio :function _trc_T2MediaPlayer_f_stopAudio(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.stopAudio();return;
        
        
        _thread.retVal=_this;return;
      },
      pauseAudio :function _trc_T2MediaPlayer_pauseAudio() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.pauseAudio();
      },
      fiber$pauseAudio :function _trc_T2MediaPlayer_f_pauseAudio(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.pauseAudio();return;
        
        
        _thread.retVal=_this;return;
      },
      resumeAudio :function _trc_T2MediaPlayer_resumeAudio() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81011031;//kernel.T2MediaPlayer:11031
        if (_this.mute) {
          return _this;
        }
        return Tonyu.globals.$t2MediaLib.resumeAudio();
      },
      fiber$resumeAudio :function _trc_T2MediaPlayer_f_resumeAudio(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81011031;//kernel.T2MediaPlayer:11031
        if (_this.mute) {
          _thread.retVal=_this;return;
          
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.resumeAudio();return;
        
        
        _thread.retVal=_this;return;
      },
      setAudioVolume :function _trc_T2MediaPlayer_setAudioVolume(vol) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81011122;//kernel.T2MediaPlayer:11122
        vol=vol/128;
        //$LASTPOS=81011144;//kernel.T2MediaPlayer:11144
        if (vol>1) {
          //$LASTPOS=81011164;//kernel.T2MediaPlayer:11164
          vol=1;
        } else {
          //$LASTPOS=81011185;//kernel.T2MediaPlayer:11185
          if (vol<0) {
            //$LASTPOS=81011200;//kernel.T2MediaPlayer:11200
            vol=0;
          }
        }
        return Tonyu.globals.$t2MediaLib.setAudioVolume(vol);
      },
      fiber$setAudioVolume :function _trc_T2MediaPlayer_f_setAudioVolume(_thread,vol) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81011122;//kernel.T2MediaPlayer:11122
        vol=vol/128;
        //$LASTPOS=81011144;//kernel.T2MediaPlayer:11144
        if (vol>1) {
          //$LASTPOS=81011164;//kernel.T2MediaPlayer:11164
          vol=1;
        } else {
          //$LASTPOS=81011185;//kernel.T2MediaPlayer:11185
          if (vol<0) {
            //$LASTPOS=81011200;//kernel.T2MediaPlayer:11200
            vol=0;
          }
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setAudioVolume(vol);return;
        
        
        _thread.retVal=_this;return;
      },
      setAudioTempo :function _trc_T2MediaPlayer_setAudioTempo(tempo) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=81011291;//kernel.T2MediaPlayer:11291
        if (tempo>4) {
          //$LASTPOS=81011313;//kernel.T2MediaPlayer:11313
          tempo=4;
        } else {
          //$LASTPOS=81011336;//kernel.T2MediaPlayer:11336
          if (tempo<0.5) {
            //$LASTPOS=81011353;//kernel.T2MediaPlayer:11353
            tempo=0.5;
          }
        }
        return Tonyu.globals.$t2MediaLib.setAudioTempo(tempo);
      },
      fiber$setAudioTempo :function _trc_T2MediaPlayer_f_setAudioTempo(_thread,tempo) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=81011291;//kernel.T2MediaPlayer:11291
        if (tempo>4) {
          //$LASTPOS=81011313;//kernel.T2MediaPlayer:11313
          tempo=4;
        } else {
          //$LASTPOS=81011336;//kernel.T2MediaPlayer:11336
          if (tempo<0.5) {
            //$LASTPOS=81011353;//kernel.T2MediaPlayer:11353
            tempo=0.5;
          }
        }
        _thread.retVal=Tonyu.globals.$t2MediaLib.setAudioTempo(tempo);return;
        
        
        _thread.retVal=_this;return;
      },
      setAudioPosition :function _trc_T2MediaPlayer_setAudioPosition(time) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.setAudioPosition(time);
      },
      fiber$setAudioPosition :function _trc_T2MediaPlayer_f_setAudioPosition(_thread,time) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.setAudioPosition(time);return;
        
        
        _thread.retVal=_this;return;
      },
      getAudioCurrentTime :function _trc_T2MediaPlayer_getAudioCurrentTime() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getAudioCurrentTime();
      },
      fiber$getAudioCurrentTime :function _trc_T2MediaPlayer_f_getAudioCurrentTime(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getAudioCurrentTime();return;
        
        
        _thread.retVal=_this;return;
      },
      getAudioLength :function _trc_T2MediaPlayer_getAudioLength() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getAudioLength();
      },
      fiber$getAudioLength :function _trc_T2MediaPlayer_f_getAudioLength(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getAudioLength();return;
        
        
        _thread.retVal=_this;return;
      },
      getAudioData :function _trc_T2MediaPlayer_getAudioData(idx) {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$t2MediaLib.getAudioData(idx);
      },
      fiber$getAudioData :function _trc_T2MediaPlayer_f_getAudioData(_thread,idx) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$t2MediaLib.getAudioData(idx);return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"initT2MediaPlayer":{"nowait":false},"allClearSoundData":{"nowait":false},"clearSoundData":{"nowait":false},"allRemoveDecodedSoundData":{"nowait":false},"removeDecodedSoundData":{"nowait":false},"getMasterVolume":{"nowait":false},"setMasterVolume":{"nowait":false},"loadSound":{"nowait":false},"__getter__available":{"nowait":true},"loadFromProject":{"nowait":false},"decodeSound":{"nowait":false},"getSoundFileData":{"nowait":false},"getSoundDecodedData":{"nowait":false},"getCurrentTime":{"nowait":false},"getContext":{"nowait":false},"playSE":{"nowait":true},"stopSE":{"nowait":false},"stopAllSE":{"nowait":false},"getSEMasterVolume":{"nowait":false},"setSEMasterVolume":{"nowait":false},"getSEVolume":{"nowait":false},"setSEVolume":{"nowait":false},"getSERate":{"nowait":false},"setSERate":{"nowait":false},"getSEPan":{"nowait":false},"setSEPan":{"nowait":false},"isSELoop":{"nowait":false},"setSELoop":{"nowait":false},"getSELoopStartTime":{"nowait":false},"setSELoopStartTime":{"nowait":false},"getSELoopEndTime":{"nowait":false},"setSELoopEndTime":{"nowait":false},"playBGM":{"nowait":false},"stopBGM":{"nowait":false},"pauseBGM":{"nowait":false},"resumeBGM":{"nowait":false},"getBGMMasterVolume":{"nowait":false},"setBGMMasterVolume":{"nowait":false},"getBGMVolume":{"nowait":false},"setBGMVolume":{"nowait":false},"getBGMTempo":{"nowait":false},"setBGMTempo":{"nowait":false},"getBGMPan":{"nowait":false},"setBGMPan":{"nowait":false},"isBGMLoop":{"nowait":false},"setBGMLoop":{"nowait":false},"getBGMLoopStartTime":{"nowait":false},"setBGMLoopStartTime":{"nowait":false},"getBGMLoopEndTime":{"nowait":false},"setBGMLoopEndTime":{"nowait":false},"getBGMCurrentTime":{"nowait":false},"getBGMLength":{"nowait":false},"getPlayingBGMName":{"nowait":false},"setOnBGMEndListener":{"nowait":false},"getPlayingBGMState":{"nowait":false},"getBGMPicoAudio":{"nowait":false},"getBGMPlayerMax":{"nowait":false},"allStopBGM":{"nowait":false},"allResetBGM":{"nowait":false},"playBGMID":{"nowait":false},"stopBGMID":{"nowait":false},"pauseBGMID":{"nowait":false},"resumeBGMID":{"nowait":false},"getBGMVolumeID":{"nowait":false},"setBGMVolumeID":{"nowait":false},"getBGMTempoID":{"nowait":false},"setBGMTempoID":{"nowait":false},"getBGMPanID":{"nowait":false},"setBGMPanID":{"nowait":false},"isBGMLoopID":{"nowait":false},"setBGMLoopID":{"nowait":false},"getBGMLoopStartTimeID":{"nowait":false},"setBGMLoopStartTimeID":{"nowait":false},"getBGMLoopEndTimeID":{"nowait":false},"setBGMLoopEndTimeID":{"nowait":false},"getBGMCurrentTimeID":{"nowait":false},"getBGMLengthID":{"nowait":false},"getPlayingBGMNameID":{"nowait":false},"setBGMOnSongEndListener":{"nowait":false},"loadAudio":{"nowait":false},"playAudio":{"nowait":false},"stopAudio":{"nowait":false},"pauseAudio":{"nowait":false},"resumeAudio":{"nowait":false},"setAudioVolume":{"nowait":false},"setAudioTempo":{"nowait":false},"setAudioPosition":{"nowait":false},"getAudioCurrentTime":{"nowait":false},"getAudioLength":{"nowait":false},"getAudioData":{"nowait":false}},"fields":{"bgmPlayerMax":{},"progressNoLog":{},"mute":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.PlainChar',
  shortName: 'PlainChar',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_PlainChar_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_PlainChar_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_PlainChar_initialize(x,y,p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=82000066;//kernel.PlainChar:66
        _this.layer=_this.layer||Tonyu.globals.$mainLayer;
        //$LASTPOS=82000096;//kernel.PlainChar:96
        if (Tonyu.runMode) {
          //$LASTPOS=82000126;//kernel.PlainChar:126
          _this._th=Tonyu.globals.$Boot.schedule(_this,"tMain",[]);
          //$LASTPOS=82000172;//kernel.PlainChar:172
          _this.addToLayer();
          
        }
        //$LASTPOS=82000198;//kernel.PlainChar:198
        _this._scheduler=_this._scheduler||Tonyu.globals.$Scheduler;
        //$LASTPOS=82000238;//kernel.PlainChar:238
        _this.crashScale=1;
        //$LASTPOS=82000257;//kernel.PlainChar:257
        if (typeof  x=="object") {
          //$LASTPOS=82000281;//kernel.PlainChar:281
          Tonyu.extend(_this,x);
        } else {
          //$LASTPOS=82000313;//kernel.PlainChar:313
          if (typeof  x=="number") {
            //$LASTPOS=82000348;//kernel.PlainChar:348
            _this.x=x;
            //$LASTPOS=82000367;//kernel.PlainChar:367
            _this.y=y;
            //$LASTPOS=82000386;//kernel.PlainChar:386
            _this.p=p;
            
          }
        }
      },
      draw :function _trc_PlainChar_draw(c) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=82000423;//kernel.PlainChar:423
        _this.onDraw();
        //$LASTPOS=82000438;//kernel.PlainChar:438
        if (_this._isInvisible) {
          return _this;
        }
      },
      setVisible :function _trc_PlainChar_setVisible(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=82000512;//kernel.PlainChar:512
        _this._isInvisible=! v;
      },
      fiber$setVisible :function _trc_PlainChar_f_setVisible(_thread,v) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=82000512;//kernel.PlainChar:512
        _this._isInvisible=! v;
        
        _thread.retVal=_this;return;
      },
      onDraw :function _trc_PlainChar_onDraw() {
        "use strict";
        var _this=this;
        
      },
      fiber$onDraw :function _trc_PlainChar_f_onDraw(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      update :function _trc_PlainChar_update() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=82000568;//kernel.PlainChar:568
        _this.onUpdate();
        //$LASTPOS=82000585;//kernel.PlainChar:585
        __superClass.prototype.update.apply( _this, []);
      },
      fiber$update :function _trc_PlainChar_f_update(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=82000568;//kernel.PlainChar:568
        _this.onUpdate();
        
        _thread.enter(function _trc_PlainChar_ent_update(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=82000585;//kernel.PlainChar:585
              __superClass.prototype.fiber$update.apply( _this, [_thread]);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      onUpdate :function _trc_PlainChar_onUpdate() {
        "use strict";
        var _this=this;
        
      },
      tMain :function _trc_PlainChar_tMain() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=82000641;//kernel.PlainChar:641
        _this.main();
        //$LASTPOS=82000654;//kernel.PlainChar:654
        _this.die();
      },
      fiber$tMain :function _trc_PlainChar_f_tMain(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_PlainChar_ent_tMain(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=82000641;//kernel.PlainChar:641
              _this.fiber$main(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=82000654;//kernel.PlainChar:654
              _this.die();
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"draw":{"nowait":true},"setVisible":{"nowait":false},"onDraw":{"nowait":false},"update":{"nowait":false},"onUpdate":{"nowait":true},"tMain":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.SecretChar',
  shortName: 'SecretChar',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.PlainChar,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_SecretChar_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_SecretChar_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_SecretChar_draw(c) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=83000038;//kernel.SecretChar:38
        _this.onDraw();
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"draw":{"nowait":true}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.SpriteChar',
  shortName: 'SpriteChar',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.PlainChar,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_SpriteChar_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_SpriteChar_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_SpriteChar_initialize(x,y,p,f) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=84000043;//kernel.SpriteChar:43
        __superClass.apply( _this, [x,y,p]);
        //$LASTPOS=84000062;//kernel.SpriteChar:62
        _this.f=f;
        //$LASTPOS=84000077;//kernel.SpriteChar:77
        if (! _this.x) {
          //$LASTPOS=84000090;//kernel.SpriteChar:90
          _this.x=0;
        }
        //$LASTPOS=84000105;//kernel.SpriteChar:105
        if (! _this.y) {
          //$LASTPOS=84000118;//kernel.SpriteChar:118
          _this.y=0;
        }
        //$LASTPOS=84000133;//kernel.SpriteChar:133
        if (! _this.p) {
          //$LASTPOS=84000146;//kernel.SpriteChar:146
          _this.p=0;
        }
        //$LASTPOS=84000161;//kernel.SpriteChar:161
        if (typeof  _this.scaleX!="number") {
          //$LASTPOS=84000190;//kernel.SpriteChar:190
          _this.scaleX=1;
        }
      },
      draw :function _trc_SpriteChar_draw(c) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=84000220;//kernel.SpriteChar:220
        if (_this._isInvisible) {
          return _this;
        }
        //$LASTPOS=84000251;//kernel.SpriteChar:251
        _this.onDraw();
        //$LASTPOS=84000266;//kernel.SpriteChar:266
        _this.prepareImage();
        //$LASTPOS=84000287;//kernel.SpriteChar:287
        _this.drawSprite(_this.x,_this.y,_this.p,_this.f,_this.zOrder);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"draw":{"nowait":true}},"fields":{"f":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.T1Map',
  shortName: 'T1Map',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Map,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T1Map_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T1Map_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      setBGColor :function _trc_T1Map_setBGColor(c) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=85000064;//kernel.T1Map:64
        Tonyu.globals.$Screen.setBGColor(c);
      },
      fiber$setBGColor :function _trc_T1Map_f_setBGColor(_thread,c) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=85000064;//kernel.T1Map:64
        Tonyu.globals.$Screen.setBGColor(c);
        
        _thread.retVal=_this;return;
      },
      load :function _trc_T1Map_load(fileName) {
        "use strict";
        var _this=this;
        var f;
        var o;
        
        //$LASTPOS=85000469;//kernel.T1Map:469
        f = _this.file("../maps/").rel(fileName);
        
        //$LASTPOS=85000512;//kernel.T1Map:512
        o = f.obj();
        
        //$LASTPOS=85000532;//kernel.T1Map:532
        _this.chipWidth=o.chipWidth;
        //$LASTPOS=85000560;//kernel.T1Map:560
        _this.chipHeight=o.chipHeight;
        //$LASTPOS=85000590;//kernel.T1Map:590
        _this.baseData=o.baseData;
        //$LASTPOS=85000616;//kernel.T1Map:616
        _this.mapTable=_this.conv(_this.baseData[0],o.pTable);
        //$LASTPOS=85000658;//kernel.T1Map:658
        _this.mapData=_this.mapTable;
        //$LASTPOS=85000681;//kernel.T1Map:681
        _this.row=_this.mapTable.length;
        //$LASTPOS=85000707;//kernel.T1Map:707
        _this.col=_this.mapTable[0].length;
        //$LASTPOS=85000736;//kernel.T1Map:736
        _this.mapOnTable=_this.conv(_this.baseData[1],o.pTable);
        //$LASTPOS=85000780;//kernel.T1Map:780
        _this.mapOnData=_this.mapOnTable;
        //$LASTPOS=85000813;//kernel.T1Map:813
        _this.buf=$("<canvas>").attr({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
        //$LASTPOS=85000885;//kernel.T1Map:885
        _this.initMap();
      },
      fiber$load :function _trc_T1Map_f_load(_thread,fileName) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var f;
        var o;
        
        //$LASTPOS=85000469;//kernel.T1Map:469
        f = _this.file("../maps/").rel(fileName);
        
        //$LASTPOS=85000512;//kernel.T1Map:512
        o = f.obj();
        
        //$LASTPOS=85000532;//kernel.T1Map:532
        _this.chipWidth=o.chipWidth;
        //$LASTPOS=85000560;//kernel.T1Map:560
        _this.chipHeight=o.chipHeight;
        //$LASTPOS=85000590;//kernel.T1Map:590
        _this.baseData=o.baseData;
        
        _thread.enter(function _trc_T1Map_ent_load(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=85000616;//kernel.T1Map:616
              _this.fiber$conv(_thread, _this.baseData[0], o.pTable);
              __pc=1;return;
            case 1:
              _this.mapTable=_thread.retVal;
              
              //$LASTPOS=85000658;//kernel.T1Map:658
              _this.mapData=_this.mapTable;
              //$LASTPOS=85000681;//kernel.T1Map:681
              _this.row=_this.mapTable.length;
              //$LASTPOS=85000707;//kernel.T1Map:707
              _this.col=_this.mapTable[0].length;
              //$LASTPOS=85000736;//kernel.T1Map:736
              _this.fiber$conv(_thread, _this.baseData[1], o.pTable);
              __pc=2;return;
            case 2:
              _this.mapOnTable=_thread.retVal;
              
              //$LASTPOS=85000780;//kernel.T1Map:780
              _this.mapOnData=_this.mapOnTable;
              //$LASTPOS=85000813;//kernel.T1Map:813
              _this.buf=$("<canvas>").attr({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
              //$LASTPOS=85000885;//kernel.T1Map:885
              _this.fiber$initMap(_thread);
              __pc=3;return;
            case 3:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      conv :function _trc_T1Map_conv(mat,tbl) {
        "use strict";
        var _this=this;
        var res;
        
        //$LASTPOS=85000926;//kernel.T1Map:926
        res = [];
        
        //$LASTPOS=85000943;//kernel.T1Map:943
        mat.forEach((function anonymous_955(row) {
          var rrow;
          
          //$LASTPOS=85000973;//kernel.T1Map:973
          rrow = [];
          
          //$LASTPOS=85000995;//kernel.T1Map:995
          res.push(rrow);
          //$LASTPOS=85001020;//kernel.T1Map:1020
          row.forEach((function anonymous_1032(dat) {
            var t;
            
            //$LASTPOS=85001067;//kernel.T1Map:1067
            t = tbl[dat[0]];
            
            //$LASTPOS=85001099;//kernel.T1Map:1099
            if (t) {
              //$LASTPOS=85001106;//kernel.T1Map:1106
              rrow.push(Tonyu.globals[t.name]+dat[1]);
            } else {
              //$LASTPOS=85001165;//kernel.T1Map:1165
              rrow.push(dat[1]);
            }
          }));
        }));
        return res;
      },
      fiber$conv :function _trc_T1Map_f_conv(_thread,mat,tbl) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        
        //$LASTPOS=85000926;//kernel.T1Map:926
        res = [];
        
        //$LASTPOS=85000943;//kernel.T1Map:943
        mat.forEach((function anonymous_955(row) {
          var rrow;
          
          //$LASTPOS=85000973;//kernel.T1Map:973
          rrow = [];
          
          //$LASTPOS=85000995;//kernel.T1Map:995
          res.push(rrow);
          //$LASTPOS=85001020;//kernel.T1Map:1020
          row.forEach((function anonymous_1032(dat) {
            var t;
            
            //$LASTPOS=85001067;//kernel.T1Map:1067
            t = tbl[dat[0]];
            
            //$LASTPOS=85001099;//kernel.T1Map:1099
            if (t) {
              //$LASTPOS=85001106;//kernel.T1Map:1106
              rrow.push(Tonyu.globals[t.name]+dat[1]);
            } else {
              //$LASTPOS=85001165;//kernel.T1Map:1165
              rrow.push(dat[1]);
            }
          }));
        }));
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"setBGColor":{"nowait":false},"load":{"nowait":false},"conv":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.T1Page',
  shortName: 'T1Page',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.PlainChar,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_T1Page_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_T1Page_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initGlobals :function _trc_T1Page_initGlobals() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=86000044;//kernel.T1Page:44
        Tonyu.globals.$chars=Tonyu.globals.$Sprites.sprites;
        //$LASTPOS=86000074;//kernel.T1Page:74
        Tonyu.globals.$Boot.setFrameRate(60);
        //$LASTPOS=86000103;//kernel.T1Page:103
        Tonyu.globals.$clBlack=_this.color(0,0,0);
        //$LASTPOS=86000131;//kernel.T1Page:131
        Tonyu.globals.$clRed=_this.color(255,0,0);
        //$LASTPOS=86000159;//kernel.T1Page:159
        Tonyu.globals.$clGreen=_this.color(0,255,0);
        //$LASTPOS=86000189;//kernel.T1Page:189
        Tonyu.globals.$clYellow=_this.color(255,255,0);
        //$LASTPOS=86000222;//kernel.T1Page:222
        Tonyu.globals.$clBlue=_this.color(0,0,255);
        //$LASTPOS=86000251;//kernel.T1Page:251
        Tonyu.globals.$clPink=_this.color(255,0,255);
        //$LASTPOS=86000282;//kernel.T1Page:282
        Tonyu.globals.$clAqua=_this.color(0,255,255);
        //$LASTPOS=86000313;//kernel.T1Page:313
        Tonyu.globals.$clWhite=_this.color(255,255,255);
        //$LASTPOS=86000347;//kernel.T1Page:347
        Tonyu.globals.$mplayer=new Tonyu.classes.kernel.MediaPlayer;
      },
      fiber$initGlobals :function _trc_T1Page_f_initGlobals(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=86000044;//kernel.T1Page:44
        Tonyu.globals.$chars=Tonyu.globals.$Sprites.sprites;
        //$LASTPOS=86000074;//kernel.T1Page:74
        Tonyu.globals.$Boot.setFrameRate(60);
        //$LASTPOS=86000103;//kernel.T1Page:103
        Tonyu.globals.$clBlack=_this.color(0,0,0);
        //$LASTPOS=86000131;//kernel.T1Page:131
        Tonyu.globals.$clRed=_this.color(255,0,0);
        //$LASTPOS=86000159;//kernel.T1Page:159
        Tonyu.globals.$clGreen=_this.color(0,255,0);
        //$LASTPOS=86000189;//kernel.T1Page:189
        Tonyu.globals.$clYellow=_this.color(255,255,0);
        //$LASTPOS=86000222;//kernel.T1Page:222
        Tonyu.globals.$clBlue=_this.color(0,0,255);
        //$LASTPOS=86000251;//kernel.T1Page:251
        Tonyu.globals.$clPink=_this.color(255,0,255);
        //$LASTPOS=86000282;//kernel.T1Page:282
        Tonyu.globals.$clAqua=_this.color(0,255,255);
        //$LASTPOS=86000313;//kernel.T1Page:313
        Tonyu.globals.$clWhite=_this.color(255,255,255);
        //$LASTPOS=86000347;//kernel.T1Page:347
        Tonyu.globals.$mplayer=new Tonyu.classes.kernel.MediaPlayer;
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"initGlobals":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.TextChar',
  shortName: 'TextChar',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.PlainChar,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_TextChar_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_TextChar_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_TextChar_initialize(xx,yy,t,c,s) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=87000072;//kernel.TextChar:72
        __superClass.apply( _this, [xx,yy]);
        //$LASTPOS=87000091;//kernel.TextChar:91
        _this.text=_this.text||"";
        //$LASTPOS=87000111;//kernel.TextChar:111
        _this.col=Tonyu.globals.$clWhite;
        //$LASTPOS=87000130;//kernel.TextChar:130
        _this.size=20;
        //$LASTPOS=87000144;//kernel.TextChar:144
        if (! _this.x) {
          //$LASTPOS=87000157;//kernel.TextChar:157
          _this.x=0;
        }
        //$LASTPOS=87000172;//kernel.TextChar:172
        if (! _this.y) {
          //$LASTPOS=87000185;//kernel.TextChar:185
          _this.y=0;
        }
        //$LASTPOS=87000200;//kernel.TextChar:200
        if (t) {
          //$LASTPOS=87000207;//kernel.TextChar:207
          _this.text=t;
        }
        //$LASTPOS=87000220;//kernel.TextChar:220
        if (c) {
          //$LASTPOS=87000227;//kernel.TextChar:227
          _this.fillStyle=c;
        }
        //$LASTPOS=87000245;//kernel.TextChar:245
        if (s) {
          //$LASTPOS=87000252;//kernel.TextChar:252
          _this.size=s;
        }
      },
      draw :function _trc_TextChar_draw(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=87000282;//kernel.TextChar:282
        if (_this._isInvisible) {
          return _this;
        }
        //$LASTPOS=87000313;//kernel.TextChar:313
        _this.onDraw();
        //$LASTPOS=87000328;//kernel.TextChar:328
        _this.drawText(_this.x,_this.y,_this.text,_this.col,_this.size);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"draw":{"nowait":true}},"fields":{"col":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.APad',
  shortName: 'APad',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_APad_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=88000862;//kernel.APad:862
        if (! _this.auto) {
          //$LASTPOS=88000873;//kernel.APad:873
          _this.loop();
        }
      },
      fiber$main :function _trc_APad_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_APad_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=88000862;//kernel.APad:862
              if (!(! _this.auto)) { __pc=2     ; break; }
              //$LASTPOS=88000873;//kernel.APad:873
              _this.fiber$loop(_thread);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initialize :function _trc_APad_initialize(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=88000033;//kernel.APad:33
        p=p||{};
        //$LASTPOS=88000047;//kernel.APad:47
        if (! p.alpha) {
          //$LASTPOS=88000061;//kernel.APad:61
          p.alpha=128;
        }
        //$LASTPOS=88000079;//kernel.APad:79
        __superClass.apply( _this, [p]);
        //$LASTPOS=88000094;//kernel.APad:94
        _this.vx=0;
        //$LASTPOS=88000099;//kernel.APad:99
        _this.vy=0;
        //$LASTPOS=88000110;//kernel.APad:110
        _this.outerRadius=_this.outerRadius||50;
        //$LASTPOS=88000144;//kernel.APad:144
        _this.fillStyle=_this.fillStyle||"white";
        //$LASTPOS=88000179;//kernel.APad:179
        _this.strokeStyle=_this.strokeStyle||"white";
        //$LASTPOS=88000218;//kernel.APad:218
        _this.innerRadius=_this.innerRadius||10;
        //$LASTPOS=88000252;//kernel.APad:252
        if (typeof  _this.keys==="object") {
          //$LASTPOS=88000291;//kernel.APad:291
          _this.leftKey=_this.keys.left;
          //$LASTPOS=88000319;//kernel.APad:319
          _this.rightKey=_this.keys.right;
          //$LASTPOS=88000349;//kernel.APad:349
          _this.upKey=_this.keys.up;
          //$LASTPOS=88000373;//kernel.APad:373
          _this.downKey=_this.keys.down;
          
        }
        //$LASTPOS=88000404;//kernel.APad:404
        _this.keySpeed=_this.keySpeed||15/50;
        //$LASTPOS=88000435;//kernel.APad:435
        _this.leftKey=_this.leftKey||"left";
        //$LASTPOS=88000465;//kernel.APad:465
        _this.rightKey=_this.rightKey||"right";
        //$LASTPOS=88000498;//kernel.APad:498
        _this.upKey=_this.upKey||"up";
        //$LASTPOS=88000522;//kernel.APad:522
        _this.downKey=_this.downKey||"down";
        //$LASTPOS=88000552;//kernel.APad:552
        _this.decay=_this.decay||0.8;
        //$LASTPOS=88000575;//kernel.APad:575
        _this.velocity=new Tonyu.classes.kernel.Vec3View(_this,{x: "vx",y: "vy",z: "vz"});
        //$LASTPOS=88000632;//kernel.APad:632
        if ((typeof  _this.x!=="number")||_this.x!==_this.x) {
          //$LASTPOS=88000679;//kernel.APad:679
          _this.x=Tonyu.globals.$screenWidth/2;
          
        }
        //$LASTPOS=88000709;//kernel.APad:709
        if ((typeof  _this.y!=="number")||_this.y!==_this.y) {
          //$LASTPOS=88000756;//kernel.APad:756
          _this.y=Tonyu.globals.$screenHeight-_this.outerRadius-_this.innerRadius;
          
        }
        //$LASTPOS=88000847;//kernel.APad:847
        _this.ix=_this.x;
        //$LASTPOS=88000852;//kernel.APad:852
        _this.iy=_this.y;
      },
      __getter__defaultLayer :function _trc_APad___getter__defaultLayer() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$frontLayer;
      },
      draw :function _trc_APad_draw(ctx) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=88000968;//kernel.APad:968
        if (_this.auto) {
          //$LASTPOS=88000989;//kernel.APad:989
          _this.ix=_this.x+_this.vx*_this.outerRadius;
          //$LASTPOS=88001019;//kernel.APad:1019
          _this.iy=_this.y+_this.vy*_this.outerRadius;
          
        }
        //$LASTPOS=88001052;//kernel.APad:1052
        ctx.globalAlpha=_this.alpha/255;
        //$LASTPOS=88001084;//kernel.APad:1084
        ctx.fillStyle=_this.fillStyle+"";
        //$LASTPOS=88001117;//kernel.APad:1117
        ctx.beginPath();
        //$LASTPOS=88001139;//kernel.APad:1139
        ctx.arc(_this.ix,_this.iy,_this.innerRadius,0,Tonyu.globals.$Math.PI*2);
        //$LASTPOS=88001185;//kernel.APad:1185
        ctx.closePath();
        //$LASTPOS=88001207;//kernel.APad:1207
        ctx.fill();
        //$LASTPOS=88001224;//kernel.APad:1224
        ctx.strokeStyle=_this.strokeStyle;
        //$LASTPOS=88001258;//kernel.APad:1258
        ctx.beginPath();
        //$LASTPOS=88001280;//kernel.APad:1280
        ctx.arc(_this.x,_this.y,_this.outerRadius,0,Tonyu.globals.$Math.PI*2);
        //$LASTPOS=88001324;//kernel.APad:1324
        ctx.closePath();
        //$LASTPOS=88001346;//kernel.APad:1346
        ctx.stroke();
      },
      findTouch :function _trc_APad_findTouch() {
        "use strict";
        var _this=this;
        var t;
        var _it_801;
        
        //$LASTPOS=88001384;//kernel.APad:1384
        _it_801=Tonyu.iterator(Tonyu.globals.$touches,1);
        while(_it_801.next()) {
          t=_it_801[0];
          
          //$LASTPOS=88001419;//kernel.APad:1419
          if ((! _this.touchRadius||_this.dist(t)<_this.touchRadius)&&t.touched==1) {
            return t;
            
          }
          
        }
      },
      loop :function _trc_APad_loop() {
        "use strict";
        var _this=this;
        var vx;
        var vy;
        
        //$LASTPOS=88001544;//kernel.APad:1544
        vx = 0;
        vy = 0;
        
        //$LASTPOS=88001564;//kernel.APad:1564
        while (true) {
          //$LASTPOS=88001587;//kernel.APad:1587
          if (! _this.t||_this.t.ended) {
            //$LASTPOS=88001606;//kernel.APad:1606
            _this.t=_this.findTouch();
          }
          //$LASTPOS=88001630;//kernel.APad:1630
          if (_this.t) {
            //$LASTPOS=88001652;//kernel.APad:1652
            vx+=_this.t.vx;
            //$LASTPOS=88001675;//kernel.APad:1675
            vy+=_this.t.vy;
            
          } else {
            //$LASTPOS=88001716;//kernel.APad:1716
            vx*=_this.decay;
            //$LASTPOS=88001740;//kernel.APad:1740
            vy*=_this.decay;
            
          }
          //$LASTPOS=88001835;//kernel.APad:1835
          if (_this.getkey(_this.leftKey)) {
            //$LASTPOS=88001856;//kernel.APad:1856
            vx-=_this.keySpeed*_this.outerRadius;
          }
          //$LASTPOS=88001891;//kernel.APad:1891
          if (_this.getkey(_this.rightKey)) {
            //$LASTPOS=88001913;//kernel.APad:1913
            vx+=_this.keySpeed*_this.outerRadius;
          }
          //$LASTPOS=88001948;//kernel.APad:1948
          if (_this.getkey(_this.upKey)) {
            //$LASTPOS=88001967;//kernel.APad:1967
            vy-=_this.keySpeed*_this.outerRadius;
          }
          //$LASTPOS=88002002;//kernel.APad:2002
          if (_this.getkey(_this.downKey)) {
            //$LASTPOS=88002023;//kernel.APad:2023
            vy+=_this.keySpeed*_this.outerRadius;
          }
          //$LASTPOS=88002058;//kernel.APad:2058
          _this.d=_this.dist(vx,vy);
          //$LASTPOS=88002082;//kernel.APad:2082
          if (_this.d>_this.outerRadius) {
            //$LASTPOS=88002116;//kernel.APad:2116
            vx=vx/_this.d*_this.outerRadius;
            //$LASTPOS=88002150;//kernel.APad:2150
            vy=vy/_this.d*_this.outerRadius;
            
          }
          //$LASTPOS=88002191;//kernel.APad:2191
          _this.ix=_this.x+vx;
          //$LASTPOS=88002209;//kernel.APad:2209
          _this.iy=_this.y+vy;
          //$LASTPOS=88002227;//kernel.APad:2227
          _this.vx=_this.clamp(vx/_this.outerRadius,- 1,1);
          //$LASTPOS=88002272;//kernel.APad:2272
          _this.vy=_this.clamp(vy/_this.outerRadius,- 1,1);
          //$LASTPOS=88002317;//kernel.APad:2317
          _this.update();
          
        }
      },
      fiber$loop :function _trc_APad_f_loop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var vx;
        var vy;
        
        //$LASTPOS=88001544;//kernel.APad:1544
        vx = 0;
        vy = 0;
        
        
        _thread.enter(function _trc_APad_ent_loop(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=88001564;//kernel.APad:1564
            case 1:
              //$LASTPOS=88001587;//kernel.APad:1587
              if (! _this.t||_this.t.ended) {
                //$LASTPOS=88001606;//kernel.APad:1606
                _this.t=_this.findTouch();
              }
              //$LASTPOS=88001630;//kernel.APad:1630
              if (_this.t) {
                //$LASTPOS=88001652;//kernel.APad:1652
                vx+=_this.t.vx;
                //$LASTPOS=88001675;//kernel.APad:1675
                vy+=_this.t.vy;
                
              } else {
                //$LASTPOS=88001716;//kernel.APad:1716
                vx*=_this.decay;
                //$LASTPOS=88001740;//kernel.APad:1740
                vy*=_this.decay;
                
              }
              //$LASTPOS=88001835;//kernel.APad:1835
              if (_this.getkey(_this.leftKey)) {
                //$LASTPOS=88001856;//kernel.APad:1856
                vx-=_this.keySpeed*_this.outerRadius;
              }
              //$LASTPOS=88001891;//kernel.APad:1891
              if (_this.getkey(_this.rightKey)) {
                //$LASTPOS=88001913;//kernel.APad:1913
                vx+=_this.keySpeed*_this.outerRadius;
              }
              //$LASTPOS=88001948;//kernel.APad:1948
              if (_this.getkey(_this.upKey)) {
                //$LASTPOS=88001967;//kernel.APad:1967
                vy-=_this.keySpeed*_this.outerRadius;
              }
              //$LASTPOS=88002002;//kernel.APad:2002
              if (_this.getkey(_this.downKey)) {
                //$LASTPOS=88002023;//kernel.APad:2023
                vy+=_this.keySpeed*_this.outerRadius;
              }
              //$LASTPOS=88002058;//kernel.APad:2058
              _this.d=_this.dist(vx,vy);
              //$LASTPOS=88002082;//kernel.APad:2082
              if (_this.d>_this.outerRadius) {
                //$LASTPOS=88002116;//kernel.APad:2116
                vx=vx/_this.d*_this.outerRadius;
                //$LASTPOS=88002150;//kernel.APad:2150
                vy=vy/_this.d*_this.outerRadius;
                
              }
              //$LASTPOS=88002191;//kernel.APad:2191
              _this.ix=_this.x+vx;
              //$LASTPOS=88002209;//kernel.APad:2209
              _this.iy=_this.y+vy;
              //$LASTPOS=88002227;//kernel.APad:2227
              _this.vx=_this.clamp(vx/_this.outerRadius,- 1,1);
              //$LASTPOS=88002272;//kernel.APad:2272
              _this.vy=_this.clamp(vy/_this.outerRadius,- 1,1);
              //$LASTPOS=88002317;//kernel.APad:2317
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __getter__speed :function _trc_APad___getter__speed() {
        "use strict";
        var _this=this;
        
        return _this.sqrt(_this.vx*_this.vx+_this.vy*_this.vy);
      },
      __getter__direction :function _trc_APad___getter__direction() {
        "use strict";
        var _this=this;
        
        return _this.atanxy(_this.vx,_this.vy);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"__getter__defaultLayer":{"nowait":true},"draw":{"nowait":true},"findTouch":{"nowait":true},"loop":{"nowait":false},"__getter__speed":{"nowait":true},"__getter__direction":{"nowait":true}},"fields":{"auto":{},"vx":{},"vy":{},"outerRadius":{},"strokeStyle":{},"innerRadius":{},"keys":{},"leftKey":{},"rightKey":{},"upKey":{},"downKey":{},"keySpeed":{},"decay":{},"velocity":{},"ix":{},"iy":{},"touchRadius":{},"t":{},"d":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Button',
  shortName: 'Button',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Button_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=89000575;//kernel.Button:575
        while (true) {
          //$LASTPOS=89000594;//kernel.Button:594
          if (! _this.disabled) {
            //$LASTPOS=89000620;//kernel.Button:620
            _this.clicked=_this.checkTouch();
            //$LASTPOS=89000651;//kernel.Button:651
            if (_this.clicked==1) {
              //$LASTPOS=89000682;//kernel.Button:682
              Tonyu.classes.kernel.Button.last=_this;
              //$LASTPOS=89000713;//kernel.Button:713
              if (_this.onClick) {
                //$LASTPOS=89000726;//kernel.Button:726
                _this.onClick(_this);
              }
              
            }
            
          } else {
            //$LASTPOS=89000775;//kernel.Button:775
            _this.clicked=0;
            
          }
          //$LASTPOS=89000798;//kernel.Button:798
          _this.update();
          
        }
      },
      fiber$main :function _trc_Button_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Button_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=89000575;//kernel.Button:575
            case 1:
              //$LASTPOS=89000594;//kernel.Button:594
              if (!(! _this.disabled)) { __pc=3     ; break; }
              //$LASTPOS=89000620;//kernel.Button:620
              _this.fiber$checkTouch(_thread);
              __pc=2;return;
            case 2:
              _this.clicked=_thread.retVal;
              
              //$LASTPOS=89000651;//kernel.Button:651
              if (_this.clicked==1) {
                //$LASTPOS=89000682;//kernel.Button:682
                Tonyu.classes.kernel.Button.last=_this;
                //$LASTPOS=89000713;//kernel.Button:713
                if (_this.onClick) {
                  //$LASTPOS=89000726;//kernel.Button:726
                  _this.onClick(_this);
                }
                
              }
              __pc=4     ;break;
            case 3     :
              {
                //$LASTPOS=89000775;//kernel.Button:775
                _this.clicked=0;
              }
            case 4     :
              
              //$LASTPOS=89000798;//kernel.Button:798
              _this.fiber$update(_thread);
              __pc=5;return;
            case 5:
              
              __pc=1;break;
            case 6     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initialize :function _trc_Button_initialize(options) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=89000121;//kernel.Button:121
        options.layer=options.layer||Tonyu.globals.$frontLayer;
        //$LASTPOS=89000168;//kernel.Button:168
        __superClass.apply( _this, [options]);
        //$LASTPOS=89000189;//kernel.Button:189
        _this.fillStyle=_this.fillStyle||"rgb(179,255,142)";
        //$LASTPOS=89000235;//kernel.Button:235
        _this.strokeStyle=_this.strokeStyle||"black";
        //$LASTPOS=89000274;//kernel.Button:274
        _this.clickedStyle=_this.clickedStyle||"white";
        //$LASTPOS=89000315;//kernel.Button:315
        _this.disabledStrokeStyle=_this.disabledStrokeStyle||"#ddd";
        //$LASTPOS=89000369;//kernel.Button:369
        _this.alpha=typeof  (_this.alpha)=="number"?_this.alpha:255;
        //$LASTPOS=89000415;//kernel.Button:415
        _this.padding=typeof  (_this.padding)=="number"?_this.padding:5;
        //$LASTPOS=89000466;//kernel.Button:466
        _this.width=_this.width||Tonyu.globals.$screenWidth-100;
        //$LASTPOS=89000506;//kernel.Button:506
        _this.height=_this.height||50;
        //$LASTPOS=89000534;//kernel.Button:534
        _this.left=typeof  (_this.left)=="number"?_this.left:50;
      },
      checkTouch :function _trc_Button_checkTouch() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=89000833;//kernel.Button:833
        //$LASTPOS=89000838;//kernel.Button:838
        _this.i=0;for (; _this.i<2 ; _this.i++) {
          {
            //$LASTPOS=89000865;//kernel.Button:865
            if (Tonyu.globals.$touches[_this.i].touched>0&&_this.inRect(Tonyu.globals.$touches[_this.i])) {
              return Tonyu.globals.$touches[_this.i].touched;
              
            }
          }
        }
        //$LASTPOS=89000981;//kernel.Button:981
        if (_this.key) {
          return _this.getkey(_this.key);
        }
        return 0;
      },
      fiber$checkTouch :function _trc_Button_f_checkTouch(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=89000833;//kernel.Button:833
        //$LASTPOS=89000838;//kernel.Button:838
        _this.i=0;for (; _this.i<2 ; _this.i++) {
          {
            //$LASTPOS=89000865;//kernel.Button:865
            if (Tonyu.globals.$touches[_this.i].touched>0&&_this.inRect(Tonyu.globals.$touches[_this.i])) {
              _thread.retVal=Tonyu.globals.$touches[_this.i].touched;return;
              
              
            }
          }
        }
        //$LASTPOS=89000981;//kernel.Button:981
        if (_this.key) {
          _thread.retVal=_this.getkey(_this.key);return;
          
        }
        _thread.retVal=0;return;
        
        
        _thread.retVal=_this;return;
      },
      inRect :function _trc_Button_inRect(p) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=89001047;//kernel.Button:1047
        p=Tonyu.globals.$Screen.convert(p,_this.layer);
        return p.x>=_this.left&&p.x<=_this.left+_this.width&&p.y>=_this.top&&p.y<=_this.top+_this.height;
      },
      fiber$inRect :function _trc_Button_f_inRect(_thread,p) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=89001047;//kernel.Button:1047
        p=Tonyu.globals.$Screen.convert(p,_this.layer);
        _thread.retVal=p.x>=_this.left&&p.x<=_this.left+_this.width&&p.y>=_this.top&&p.y<=_this.top+_this.height;return;
        
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_Button_draw(c) {
        "use strict";
        var _this=this;
        var size;
        var f;
        var r;
        
        //$LASTPOS=89001168;//kernel.Button:1168
        c.globalAlpha=_this.alpha/255;
        //$LASTPOS=89001198;//kernel.Button:1198
        c.fillStyle=_this.fillStyle?_this.fillStyle+"":"gray";
        //$LASTPOS=89001250;//kernel.Button:1250
        c.strokeStyle=_this.strokeStyle?_this.strokeStyle+"":"black";
        //$LASTPOS=89001309;//kernel.Button:1309
        if (_this.disabled) {
          //$LASTPOS=89001323;//kernel.Button:1323
          c.strokeStyle=_this.disabledStrokeStyle+"";
        }
        //$LASTPOS=89001366;//kernel.Button:1366
        c.fillRect(_this.left,_this.top,_this.width,_this.height);
        //$LASTPOS=89001409;//kernel.Button:1409
        c.strokeRect(_this.left,_this.top,_this.width,_this.height);
        //$LASTPOS=89001454;//kernel.Button:1454
        size = _this.height-_this.padding*2;
        
        //$LASTPOS=89001486;//kernel.Button:1486
        f = c.font.replace(/^[0-9]+px /,"");
        
        //$LASTPOS=89001530;//kernel.Button:1530
        c.font=size+"px "+f;
        //$LASTPOS=89001569;//kernel.Button:1569
        c.textBaseline="top";
        //$LASTPOS=89001596;//kernel.Button:1596
        c.fillStyle=_this.clicked?_this.clickedStyle+"":_this.disabled?_this.disabledStrokeStyle+"":_this.strokeStyle+"";
        //$LASTPOS=89001691;//kernel.Button:1691
        r = c.measureText(_this.text);
        
        //$LASTPOS=89001723;//kernel.Button:1723
        c.fillText(_this.text,_this.left+_this.width/2-r.width/2,_this.top+_this.padding);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"checkTouch":{"nowait":false},"inRect":{"nowait":false},"draw":{"nowait":true}},"fields":{"disabled":{},"clicked":{},"onClick":{},"strokeStyle":{},"clickedStyle":{},"disabledStrokeStyle":{},"padding":{},"left":{},"i":{},"key":{},"top":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.GameConsole',
  shortName: 'GameConsole',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_GameConsole_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_GameConsole_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_GameConsole_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=90000084;//kernel.GameConsole:84
        _this.extend(opt);
        //$LASTPOS=90000102;//kernel.GameConsole:102
        _this.cw=_this.canvas.width();
        //$LASTPOS=90000126;//kernel.GameConsole:126
        _this.ch=_this.canvas.height();
        //$LASTPOS=90000151;//kernel.GameConsole:151
        Tonyu.globals.$Sprites=new Tonyu.classes.kernel.Sprites;
        //$LASTPOS=90000178;//kernel.GameConsole:178
        Tonyu.globals.$Screen=_this.gameScreen=new Tonyu.classes.kernel.GameScreen({width: 465,height: 465,sprites: Tonyu.globals.$Sprites});
        //$LASTPOS=90000259;//kernel.GameConsole:259
        Tonyu.globals.$FrontSprites=_this.sprites=new Tonyu.classes.kernel.Sprites;
        //$LASTPOS=90000299;//kernel.GameConsole:299
        _this.sprites.add(_this.gameScreen);
        //$LASTPOS=90000329;//kernel.GameConsole:329
        _this.cctx=_this.canvas[0].getContext("2d");
      },
      shouldDraw1x1 :function _trc_GameConsole_shouldDraw1x1(srcw,srch,dstw,dsth) {
        "use strict";
        var _this=this;
        var larger;
        var smaller;
        
        //$LASTPOS=90000448;//kernel.GameConsole:448
        larger = 200;
        
        //$LASTPOS=90000469;//kernel.GameConsole:469
        smaller = 5;
        
        return srcw-smaller<=dstw&&dstw<=srcw+larger&&srch-smaller<=dsth&&dsth<=srch+larger;
      },
      fiber$shouldDraw1x1 :function _trc_GameConsole_f_shouldDraw1x1(_thread,srcw,srch,dstw,dsth) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var larger;
        var smaller;
        
        //$LASTPOS=90000448;//kernel.GameConsole:448
        larger = 200;
        
        //$LASTPOS=90000469;//kernel.GameConsole:469
        smaller = 5;
        
        _thread.retVal=srcw-smaller<=dstw&&dstw<=srcw+larger&&srch-smaller<=dsth&&dsth<=srch+larger;return;
        
        
        _thread.retVal=_this;return;
      },
      layout :function _trc_GameConsole_layout() {
        "use strict";
        var _this=this;
        var width;
        var height;
        var calcw;
        var calch;
        var marginw;
        var marginh;
        
        //$LASTPOS=90000606;//kernel.GameConsole:606
        _this.cw=_this.canvas.width();
        //$LASTPOS=90000630;//kernel.GameConsole:630
        _this.ch=_this.canvas.height();
        //$LASTPOS=90000655;//kernel.GameConsole:655
        width = _this.gameScreen.width;
        
        //$LASTPOS=90000688;//kernel.GameConsole:688
        height = _this.gameScreen.height;
        
        //$LASTPOS=90000723;//kernel.GameConsole:723
        calcw = _this.ch/height*width;
        
        //$LASTPOS=90000767;//kernel.GameConsole:767
        calch = _this.cw/width*height;
        
        //$LASTPOS=90000811;//kernel.GameConsole:811
        if (calch>_this.ch) {
          //$LASTPOS=90000825;//kernel.GameConsole:825
          calch=_this.ch;
        }
        //$LASTPOS=90000840;//kernel.GameConsole:840
        if (calcw>_this.cw) {
          //$LASTPOS=90000854;//kernel.GameConsole:854
          calcw=_this.cw;
        }
        //$LASTPOS=90000869;//kernel.GameConsole:869
        if (_this.shouldDraw1x1(width,height,calcw,calch)) {
          //$LASTPOS=90000925;//kernel.GameConsole:925
          calcw=width;
          //$LASTPOS=90000937;//kernel.GameConsole:937
          calch=height;
          
        }
        //$LASTPOS=90000963;//kernel.GameConsole:963
        marginw = Math.floor((_this.cw-calcw)/2);
        
        //$LASTPOS=90001006;//kernel.GameConsole:1006
        marginh = Math.floor((_this.ch-calch)/2);
        
        //$LASTPOS=90001049;//kernel.GameConsole:1049
        _this.gameScreen.setBounds({left: marginw,top: marginh,width: calcw,height: calch});
      },
      fiber$layout :function _trc_GameConsole_f_layout(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var width;
        var height;
        var calcw;
        var calch;
        var marginw;
        var marginh;
        
        //$LASTPOS=90000606;//kernel.GameConsole:606
        _this.cw=_this.canvas.width();
        //$LASTPOS=90000630;//kernel.GameConsole:630
        _this.ch=_this.canvas.height();
        //$LASTPOS=90000655;//kernel.GameConsole:655
        width = _this.gameScreen.width;
        
        //$LASTPOS=90000688;//kernel.GameConsole:688
        height = _this.gameScreen.height;
        
        //$LASTPOS=90000723;//kernel.GameConsole:723
        calcw = _this.ch/height*width;
        
        //$LASTPOS=90000767;//kernel.GameConsole:767
        calch = _this.cw/width*height;
        
        //$LASTPOS=90000811;//kernel.GameConsole:811
        if (calch>_this.ch) {
          //$LASTPOS=90000825;//kernel.GameConsole:825
          calch=_this.ch;
        }
        //$LASTPOS=90000840;//kernel.GameConsole:840
        if (calcw>_this.cw) {
          //$LASTPOS=90000854;//kernel.GameConsole:854
          calcw=_this.cw;
        }
        //$LASTPOS=90000869;//kernel.GameConsole:869
        if (_this.shouldDraw1x1(width,height,calcw,calch)) {
          //$LASTPOS=90000925;//kernel.GameConsole:925
          calcw=width;
          //$LASTPOS=90000937;//kernel.GameConsole:937
          calch=height;
          
        }
        //$LASTPOS=90000963;//kernel.GameConsole:963
        marginw = Math.floor((_this.cw-calcw)/2);
        
        //$LASTPOS=90001006;//kernel.GameConsole:1006
        marginh = Math.floor((_this.ch-calch)/2);
        
        //$LASTPOS=90001049;//kernel.GameConsole:1049
        _this.gameScreen.setBounds({left: marginw,top: marginh,width: calcw,height: calch});
        
        _thread.retVal=_this;return;
      },
      draw :function _trc_GameConsole_draw() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=90001144;//kernel.GameConsole:1144
        _this.layout();
        //$LASTPOS=90001159;//kernel.GameConsole:1159
        _this.sprites.draw(_this.canvas[0]);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"shouldDraw1x1":{"nowait":false},"layout":{"nowait":false},"draw":{"nowait":true}},"fields":{"cw":{},"canvas":{},"ch":{},"gameScreen":{},"sprites":{},"cctx":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Label',
  shortName: 'Label',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Label_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_Label_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_Label_initialize(x,y,f) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=91000130;//kernel.Label:130
        __superClass.apply( _this, [x,y,- 1]);
        //$LASTPOS=91000150;//kernel.Label:150
        if (x==null) {
          //$LASTPOS=91000163;//kernel.Label:163
          x=50;
        }
        //$LASTPOS=91000174;//kernel.Label:174
        if (y==null) {
          //$LASTPOS=91000187;//kernel.Label:187
          y=50;
        }
        //$LASTPOS=91000198;//kernel.Label:198
        if (typeof  _this.template!=="string"&&_this._text==null) {
          //$LASTPOS=91000256;//kernel.Label:256
          _this.text="text";
          
        }
      },
      __getter__defaultLayer :function _trc_Label___getter__defaultLayer() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$frontLayer;
      },
      __getter__text :function _trc_Label___getter__text() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=91000337;//kernel.Label:337
        if (typeof  _this.template!=="string") {
          return _this._text;
        }
        return _this.template.replace(/[\$\@][A-Za-z0-9\.]* ?/g,(function anonymous_439(v) {
          
          //$LASTPOS=91000455;//kernel.Label:455
          v=v.replace(/ $/,"");
          //$LASTPOS=91000486;//kernel.Label:486
          if (v=="") {
            return "$";
          }
          //$LASTPOS=91000518;//kernel.Label:518
          if (v.match(/^@/)) {
            return _this.exapndVal(_this.target,v.substring(1).split("."));
            
          } else {
            return _this.expandVal(Tonyu.globals,v.split("."));
            
          }
        }));
      },
      expandVal :function _trc_Label_expandVal(obj,flds) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=91000733;//kernel.Label:733
        while (flds.length>0) {
          //$LASTPOS=91000766;//kernel.Label:766
          if (! obj) {
            return "";
          }
          //$LASTPOS=91000796;//kernel.Label:796
          obj=obj[flds.shift()];
          
        }
        return obj;
      },
      fiber$expandVal :function _trc_Label_f_expandVal(_thread,obj,flds) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Label_ent_expandVal(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=91000733;//kernel.Label:733
            case 1:
              if (!(flds.length>0)) { __pc=3     ; break; }
              //$LASTPOS=91000766;//kernel.Label:766
              if (!(! obj)) { __pc=2     ; break; }
              _thread.exit("");return;
            case 2     :
              
              //$LASTPOS=91000796;//kernel.Label:796
              obj=obj[flds.shift()];
              __pc=1;break;
            case 3     :
              
              _thread.exit(obj);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      __setter__text :function _trc_Label___setter__text(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=91000862;//kernel.Label:862
        delete _this.template;
        //$LASTPOS=91000884;//kernel.Label:884
        _this._text=v;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"__getter__defaultLayer":{"nowait":true},"__getter__text":{"nowait":true},"expandVal":{"nowait":false},"__setter__text":{"nowait":true}},"fields":{"template":{},"_text":{},"exapndVal":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.MapEditor',
  shortName: 'MapEditor',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_MapEditor_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=92000049;//kernel.MapEditor:49
        Tonyu.globals.$Screen.resize(480,640);
        //$LASTPOS=92000075;//kernel.MapEditor:75
        _this.loadMode=false;
        //$LASTPOS=92000092;//kernel.MapEditor:92
        _this.fileExist=false;
        //$LASTPOS=92000110;//kernel.MapEditor:110
        Tonyu.globals.$Boot.on("stop",(function anonymous_127(e) {
          
          //$LASTPOS=92000179;//kernel.MapEditor:179
          if (_this.modified) {
            //$LASTPOS=92000204;//kernel.MapEditor:204
            e.preventDefault();
            //$LASTPOS=92000233;//kernel.MapEditor:233
            _this.parallel(Tonyu.bindFunc(_this,_this.st),e);
            
          }
        }));
        //$LASTPOS=92000646;//kernel.MapEditor:646
        _this.print("map file(s)");
        //$LASTPOS=92000694;//kernel.MapEditor:694
        _this.fileList=_this.file("../maps/");
        //$LASTPOS=92000722;//kernel.MapEditor:722
        if (_this.fileList.exists()) {
          //$LASTPOS=92000750;//kernel.MapEditor:750
          _this.fileList.recursive((function a(f) {
            
            //$LASTPOS=92000844;//kernel.MapEditor:844
            _this.print(f.name());
            //$LASTPOS=92000900;//kernel.MapEditor:900
            _this.fileExist=true;
          }));
          
        }
        //$LASTPOS=92000943;//kernel.MapEditor:943
        if (_this.fileExist) {
          //$LASTPOS=92000963;//kernel.MapEditor:963
          _this.print("Load Data?: Y or N");
          //$LASTPOS=92000997;//kernel.MapEditor:997
          while (true) {
            //$LASTPOS=92001019;//kernel.MapEditor:1019
            if (_this.getkey("y")>0) {
              //$LASTPOS=92001051;//kernel.MapEditor:1051
              _this.loadMode=true;
              break;
              
              
            }
            //$LASTPOS=92001106;//kernel.MapEditor:1106
            if (_this.getkey("n")>0) {
              //$LASTPOS=92001138;//kernel.MapEditor:1138
              _this.loadMode=false;
              break;
              
              
            }
            //$LASTPOS=92001194;//kernel.MapEditor:1194
            _this.update();
            
          }
          //$LASTPOS=92001216;//kernel.MapEditor:1216
          if (_this.loadMode) {
            //$LASTPOS=92001239;//kernel.MapEditor:1239
            _this.fileName=_this.prompt("Input json file (*.json)","map.json");
            //$LASTPOS=92001304;//kernel.MapEditor:1304
            if (_this.fileName) {
              //$LASTPOS=92001331;//kernel.MapEditor:1331
              _this.mapDataFile=_this.file("../maps/").rel(_this.fileName);
              
            }
            //$LASTPOS=92001395;//kernel.MapEditor:1395
            if (_this.mapDataFile.obj()) {
              //$LASTPOS=92001431;//kernel.MapEditor:1431
              _this.baseData=_this.mapDataFile.obj();
              //$LASTPOS=92001472;//kernel.MapEditor:1472
              _this.loadedFile=_this.fileName;
              
            } else {
              //$LASTPOS=92001522;//kernel.MapEditor:1522
              _this.mapDataFile=_this.file(_this.fileName);
              //$LASTPOS=92001563;//kernel.MapEditor:1563
              if (_this.mapDataFile.obj()) {
                //$LASTPOS=92001603;//kernel.MapEditor:1603
                _this.baseData=_this.mapDataFile.obj();
                //$LASTPOS=92001648;//kernel.MapEditor:1648
                _this.loadedFile=_this.fileName;
                
              }
              
            }
            //$LASTPOS=92001704;//kernel.MapEditor:1704
            if (_this.baseData==undefined) {
              //$LASTPOS=92001742;//kernel.MapEditor:1742
              _this.print("Load failed");
              //$LASTPOS=92001777;//kernel.MapEditor:1777
              _this.loadMode=false;
              
            } else {
              //$LASTPOS=92001808;//kernel.MapEditor:1808
              if (_this.baseData[0]&&_this.baseData[1]) {
                //$LASTPOS=92001853;//kernel.MapEditor:1853
                _this.modified=false;
                //$LASTPOS=92001882;//kernel.MapEditor:1882
                _this.mapData=_this.baseData[0];
                //$LASTPOS=92001916;//kernel.MapEditor:1916
                _this.mapOnData=_this.baseData[1];
                //$LASTPOS=92001952;//kernel.MapEditor:1952
                if (_this.baseData.length>2) {
                  //$LASTPOS=92001992;//kernel.MapEditor:1992
                  _this.chipWidth=_this.baseData[_this.baseData.length-2];
                  //$LASTPOS=92002048;//kernel.MapEditor:2048
                  _this.chipHeight=_this.baseData[_this.baseData.length-1];
                  
                }
                
              }
            }
            
          }
          
        }
        //$LASTPOS=92002125;//kernel.MapEditor:2125
        _this.update();
        //$LASTPOS=92002170;//kernel.MapEditor:2170
        if (! _this.loadMode) {
          //$LASTPOS=92002190;//kernel.MapEditor:2190
          _this.row=_this.prompt("input row");
          //$LASTPOS=92002220;//kernel.MapEditor:2220
          _this.row=(_this.row-0)||50;
          //$LASTPOS=92002242;//kernel.MapEditor:2242
          _this.col=_this.prompt("input col");
          //$LASTPOS=92002272;//kernel.MapEditor:2272
          _this.col=(_this.col-0)||50;
          //$LASTPOS=92002294;//kernel.MapEditor:2294
          _this.chipWidth=_this.prompt("input chipWidth");
          //$LASTPOS=92002336;//kernel.MapEditor:2336
          _this.chipHeight=_this.prompt("input chipHeight");
          //$LASTPOS=92002380;//kernel.MapEditor:2380
          _this.panel=new Tonyu.classes.kernel.Panel({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
          //$LASTPOS=92002445;//kernel.MapEditor:2445
          _this.panel.x=_this.panel.width/2+40;
          //$LASTPOS=92002476;//kernel.MapEditor:2476
          _this.panel.y=_this.panel.height/2+40;
          //$LASTPOS=92002508;//kernel.MapEditor:2508
          _this.panel.setFillStyle("cyan");
          //$LASTPOS=92002541;//kernel.MapEditor:2541
          _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
          //$LASTPOS=92002592;//kernel.MapEditor:2592
          Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.row,col: _this.col,chipWidth: _this.chipWidth,chipHeight: _this.chipHeight});
          
        } else {
          //$LASTPOS=92002903;//kernel.MapEditor:2903
          Tonyu.globals.$map=new Tonyu.classes.kernel.Map({chipWidth: 32,chipHeight: 32});
          //$LASTPOS=92002950;//kernel.MapEditor:2950
          Tonyu.globals.$map.load(_this.fileName);
          //$LASTPOS=92002976;//kernel.MapEditor:2976
          _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
          //$LASTPOS=92003072;//kernel.MapEditor:3072
          _this.panel.x=_this.panel.width/2+40;
          //$LASTPOS=92003103;//kernel.MapEditor:3103
          _this.panel.y=_this.panel.height/2+40;
          //$LASTPOS=92003135;//kernel.MapEditor:3135
          _this.panel.setFillStyle("cyan");
          //$LASTPOS=92003168;//kernel.MapEditor:3168
          _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
          
        }
        //$LASTPOS=92003235;//kernel.MapEditor:3235
        _this.mIW=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip].image.width;
        //$LASTPOS=92003278;//kernel.MapEditor:3278
        _this.mIH=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip].image.height;
        //$LASTPOS=92003322;//kernel.MapEditor:3322
        _this.mCW=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip+0].width;
        //$LASTPOS=92003361;//kernel.MapEditor:3361
        _this.mCH=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip+0].height;
        //$LASTPOS=92003401;//kernel.MapEditor:3401
        Tonyu.globals.$mp=new Tonyu.classes.kernel.Map({row: _this.floor(_this.mIH/_this.mCH),col: _this.floor(_this.mIW/_this.mCW),chipWidth: _this.mCW,chipHeight: _this.mCH});
        //$LASTPOS=92003483;//kernel.MapEditor:3483
        _this.counter=0;
        //$LASTPOS=92003495;//kernel.MapEditor:3495
        //$LASTPOS=92003499;//kernel.MapEditor:3499
        _this.i = 0;
        for (; _this.i<Tonyu.globals.$mp.row ; _this.i++) {
          {
            //$LASTPOS=92003528;//kernel.MapEditor:3528
            //$LASTPOS=92003532;//kernel.MapEditor:3532
            _this.j = 0;
            for (; _this.j<Tonyu.globals.$mp.col ; _this.j++) {
              {
                //$LASTPOS=92003565;//kernel.MapEditor:3565
                Tonyu.globals.$mp.set(_this.j,_this.i,Tonyu.globals.$pat_mapchip+_this.counter);
                //$LASTPOS=92003609;//kernel.MapEditor:3609
                _this.counter++;
              }
            }
          }
        }
        //$LASTPOS=92003633;//kernel.MapEditor:3633
        Tonyu.globals.$consolePanel.clearRect(0,0,Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
        //$LASTPOS=92003713;//kernel.MapEditor:3713
        _this.mode="get";
        //$LASTPOS=92003726;//kernel.MapEditor:3726
        _this.prevMode="set";
        //$LASTPOS=92003743;//kernel.MapEditor:3743
        _this.mapp=0;
        //$LASTPOS=92003752;//kernel.MapEditor:3752
        _this.maponp=- 1;
        //$LASTPOS=92003764;//kernel.MapEditor:3764
        _this.mx=- 40;
        //$LASTPOS=92003773;//kernel.MapEditor:3773
        _this.my=- 40;
        //$LASTPOS=92003782;//kernel.MapEditor:3782
        _this.chipX=- 40;
        //$LASTPOS=92003794;//kernel.MapEditor:3794
        _this.chipY=- 40;
        //$LASTPOS=92003806;//kernel.MapEditor:3806
        _this.x=Tonyu.globals.$screenWidth-_this.chipWidth/2;
        //$LASTPOS=92003835;//kernel.MapEditor:3835
        _this.y=Tonyu.globals.$screenHeight-_this.chipHeight/2;
        //$LASTPOS=92003866;//kernel.MapEditor:3866
        Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
        //$LASTPOS=92003891;//kernel.MapEditor:3891
        _this.initialWidth=Tonyu.globals.$map.chipWidth;
        //$LASTPOS=92003921;//kernel.MapEditor:3921
        _this.initialHeight=Tonyu.globals.$map.chipHeight;
        //$LASTPOS=92003953;//kernel.MapEditor:3953
        _this.layers=["base","on","all"];
        //$LASTPOS=92003982;//kernel.MapEditor:3982
        _this.lc=0;
        //$LASTPOS=92003989;//kernel.MapEditor:3989
        _this.selectedLayer=_this.layers[_this.lc];
        //$LASTPOS=92004016;//kernel.MapEditor:4016
        _this.drawPanel();
        //$LASTPOS=92004030;//kernel.MapEditor:4030
        _this.drawLetter(_this.mode);
        //$LASTPOS=92004051;//kernel.MapEditor:4051
        while (true) {
          //$LASTPOS=92004069;//kernel.MapEditor:4069
          _this.p=_this.mapp;
          //$LASTPOS=92004082;//kernel.MapEditor:4082
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640) {
            //$LASTPOS=92004201;//kernel.MapEditor:4201
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=92004235;//kernel.MapEditor:4235
            _this.mode="erase";
            //$LASTPOS=92004290;//kernel.MapEditor:4290
            _this.drawLetter(_this.mode);
            
          }
          //$LASTPOS=92004320;//kernel.MapEditor:4320
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
            //$LASTPOS=92004439;//kernel.MapEditor:4439
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=92004473;//kernel.MapEditor:4473
            _this.mode="set";
            //$LASTPOS=92004494;//kernel.MapEditor:4494
            _this.drawLetter(_this.mode);
            
          }
          //$LASTPOS=92004524;//kernel.MapEditor:4524
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
            //$LASTPOS=92004645;//kernel.MapEditor:4645
            _this.lc++;
            //$LASTPOS=92004660;//kernel.MapEditor:4660
            _this.selectedLayer=_this.layers[_this.lc%3];
            //$LASTPOS=92004697;//kernel.MapEditor:4697
            _this.drawPanel();
            //$LASTPOS=92004751;//kernel.MapEditor:4751
            _this.drawLetter(_this.mode);
            
          }
          //$LASTPOS=92004874;//kernel.MapEditor:4874
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>240&&Tonyu.globals.$touches[0].x<360&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
            //$LASTPOS=92004995;//kernel.MapEditor:4995
            if (_this.mode!="get") {
              //$LASTPOS=92005025;//kernel.MapEditor:5025
              _this.prevMode=_this.mode;
              //$LASTPOS=92005053;//kernel.MapEditor:5053
              Tonyu.globals.$mp.scrollTo(- 40,- 40);
              //$LASTPOS=92005089;//kernel.MapEditor:5089
              _this.mode="get";
              //$LASTPOS=92005114;//kernel.MapEditor:5114
              _this.chipX=- 40;
              //$LASTPOS=92005138;//kernel.MapEditor:5138
              _this.chipY=- 40;
              
            } else {
              //$LASTPOS=92005178;//kernel.MapEditor:5178
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=92005216;//kernel.MapEditor:5216
              _this.mode=_this.prevMode;
              
            }
            //$LASTPOS=92005283;//kernel.MapEditor:5283
            _this.drawLetter(_this.mode);
            
          }
          //$LASTPOS=92005313;//kernel.MapEditor:5313
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>360&&Tonyu.globals.$touches[0].x<480&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
            //$LASTPOS=92005449;//kernel.MapEditor:5449
            if (_this.loadedFile) {
              //$LASTPOS=92005478;//kernel.MapEditor:5478
              _this.saveFileName=_this.prompt("input json file(*.json)",_this.loadedFile);
              
            } else {
              //$LASTPOS=92005566;//kernel.MapEditor:5566
              _this.saveFileName=_this.prompt("input json file(*.json)","map.json");
              
            }
            //$LASTPOS=92005660;//kernel.MapEditor:5660
            if (_this.saveFileName) {
              //$LASTPOS=92005691;//kernel.MapEditor:5691
              _this.save(_this.saveFileName);
              
            }
            
          }
          //$LASTPOS=92005991;//kernel.MapEditor:5991
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640) {
            //$LASTPOS=92006112;//kernel.MapEditor:6112
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=92006146;//kernel.MapEditor:6146
            _this.mode="copy";
            //$LASTPOS=92006200;//kernel.MapEditor:6200
            _this.drawLetter(_this.mode);
            
          }
          //$LASTPOS=92006230;//kernel.MapEditor:6230
          if (_this.mode!="get") {
            //$LASTPOS=92006256;//kernel.MapEditor:6256
            if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=92006362;//kernel.MapEditor:6362
              _this.mx=_this.mx-8;
            }
            //$LASTPOS=92006380;//kernel.MapEditor:6380
            if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=92006511;//kernel.MapEditor:6511
              _this.mx=_this.mx+8;
            }
            //$LASTPOS=92006529;//kernel.MapEditor:6529
            if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
              //$LASTPOS=92006642;//kernel.MapEditor:6642
              _this.my=_this.my-8;
            }
            //$LASTPOS=92006660;//kernel.MapEditor:6660
            if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
              //$LASTPOS=92006795;//kernel.MapEditor:6795
              _this.my=_this.my+8;
            }
            //$LASTPOS=92006813;//kernel.MapEditor:6813
            Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
            
          } else {
            //$LASTPOS=92006856;//kernel.MapEditor:6856
            if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=92006962;//kernel.MapEditor:6962
              _this.chipX=_this.chipX-8;
            }
            //$LASTPOS=92006986;//kernel.MapEditor:6986
            if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=92007117;//kernel.MapEditor:7117
              _this.chipX=_this.chipX+8;
            }
            //$LASTPOS=92007141;//kernel.MapEditor:7141
            if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
              //$LASTPOS=92007254;//kernel.MapEditor:7254
              _this.chipY=_this.chipY-8;
            }
            //$LASTPOS=92007278;//kernel.MapEditor:7278
            if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
              //$LASTPOS=92007413;//kernel.MapEditor:7413
              _this.chipY=_this.chipY+8;
            }
            //$LASTPOS=92007437;//kernel.MapEditor:7437
            Tonyu.globals.$mp.scrollTo(_this.chipX,_this.chipY);
            
          }
          //$LASTPOS=92007506;//kernel.MapEditor:7506
          if (_this.getkey("i")==1) {
            //$LASTPOS=92007535;//kernel.MapEditor:7535
            if (Tonyu.globals.$map.chipWidth<_this.initialWidth) {
              //$LASTPOS=92007567;//kernel.MapEditor:7567
              Tonyu.globals.$map.chipWidth+=4;
            }
            //$LASTPOS=92007595;//kernel.MapEditor:7595
            if (Tonyu.globals.$map.chipHeight<_this.initialHeight) {
              //$LASTPOS=92007629;//kernel.MapEditor:7629
              Tonyu.globals.$map.chipHeight+=4;
            }
            //$LASTPOS=92007658;//kernel.MapEditor:7658
            Tonyu.globals.$map.redrawMap();
            //$LASTPOS=92007685;//kernel.MapEditor:7685
            _this.panel.die();
            //$LASTPOS=92007707;//kernel.MapEditor:7707
            _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
            //$LASTPOS=92007807;//kernel.MapEditor:7807
            _this.panel.x=_this.panel.width/2+40;
            //$LASTPOS=92007842;//kernel.MapEditor:7842
            _this.panel.y=_this.panel.height/2+40;
            //$LASTPOS=92007878;//kernel.MapEditor:7878
            _this.panel.setFillStyle("cyan");
            //$LASTPOS=92007915;//kernel.MapEditor:7915
            _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
            
          }
          //$LASTPOS=92007973;//kernel.MapEditor:7973
          if (_this.getkey("o")==1) {
            //$LASTPOS=92008002;//kernel.MapEditor:8002
            if (Tonyu.globals.$map.chipWidth>4) {
              //$LASTPOS=92008023;//kernel.MapEditor:8023
              Tonyu.globals.$map.chipWidth-=4;
            }
            //$LASTPOS=92008051;//kernel.MapEditor:8051
            if (Tonyu.globals.$map.chipHeight>4) {
              //$LASTPOS=92008073;//kernel.MapEditor:8073
              Tonyu.globals.$map.chipHeight-=4;
            }
            //$LASTPOS=92008102;//kernel.MapEditor:8102
            Tonyu.globals.$map.redrawMap();
            //$LASTPOS=92008129;//kernel.MapEditor:8129
            _this.panel.die();
            //$LASTPOS=92008151;//kernel.MapEditor:8151
            _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
            //$LASTPOS=92008251;//kernel.MapEditor:8251
            _this.panel.x=_this.panel.width/2+40;
            //$LASTPOS=92008286;//kernel.MapEditor:8286
            _this.panel.y=_this.panel.height/2+40;
            //$LASTPOS=92008322;//kernel.MapEditor:8322
            _this.panel.setFillStyle("cyan");
            //$LASTPOS=92008359;//kernel.MapEditor:8359
            _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
            
          }
          //$LASTPOS=92008443;//kernel.MapEditor:8443
          _this.panel.x=_this.panel.width/2-_this.mx;
          //$LASTPOS=92008474;//kernel.MapEditor:8474
          _this.panel.y=_this.panel.height/2-_this.my;
          //$LASTPOS=92008506;//kernel.MapEditor:8506
          if (_this.mode=="set"&&_this.getkey(1)>0&&_this.inRect()) {
            //$LASTPOS=92008559;//kernel.MapEditor:8559
            if (_this.selectedLayer=="base") {
              //$LASTPOS=92008599;//kernel.MapEditor:8599
              _this.tmpon=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
              //$LASTPOS=92008649;//kernel.MapEditor:8649
              Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
              //$LASTPOS=92008696;//kernel.MapEditor:8696
              Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.tmpon);
              
            } else {
              //$LASTPOS=92008748;//kernel.MapEditor:8748
              if (_this.selectedLayer=="on") {
                //$LASTPOS=92008786;//kernel.MapEditor:8786
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
                
              } else {
                //$LASTPOS=92008851;//kernel.MapEditor:8851
                Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
                //$LASTPOS=92008898;//kernel.MapEditor:8898
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.maponp);
                
              }
            }
            //$LASTPOS=92008956;//kernel.MapEditor:8956
            _this.modified=true;
            
          } else {
            //$LASTPOS=92008982;//kernel.MapEditor:8982
            if (_this.mode=="erase"&&_this.getkey(1)>0&&_this.inRect()) {
              //$LASTPOS=92009037;//kernel.MapEditor:9037
              if (_this.selectedLayer=="base") {
                //$LASTPOS=92009077;//kernel.MapEditor:9077
                _this.tmpon=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                //$LASTPOS=92009127;//kernel.MapEditor:9127
                Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                //$LASTPOS=92009172;//kernel.MapEditor:9172
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.tmpon);
                
              } else {
                //$LASTPOS=92009224;//kernel.MapEditor:9224
                if (_this.selectedLayer=="on") {
                  //$LASTPOS=92009262;//kernel.MapEditor:9262
                  Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                  
                } else {
                  //$LASTPOS=92009325;//kernel.MapEditor:9325
                  Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                  //$LASTPOS=92009370;//kernel.MapEditor:9370
                  Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                  
                }
              }
              //$LASTPOS=92009424;//kernel.MapEditor:9424
              _this.modified=true;
              
            } else {
              //$LASTPOS=92009450;//kernel.MapEditor:9450
              if (_this.mode=="get"&&_this.getkey(1)>0&&_this.inRect()) {
                //$LASTPOS=92009503;//kernel.MapEditor:9503
                _this.mapp=Tonyu.globals.$mp.getAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                //$LASTPOS=92009571;//kernel.MapEditor:9571
                _this.mode="set";
                //$LASTPOS=92009592;//kernel.MapEditor:9592
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=92009658;//kernel.MapEditor:9658
                _this.drawLetter(_this.mode);
                //$LASTPOS=92009685;//kernel.MapEditor:9685
                _this.updateEx(10);
                
              } else {
                //$LASTPOS=92009710;//kernel.MapEditor:9710
                if (_this.mode=="setOn"&&_this.getkey(1)>0&&_this.inRect()) {
                  //$LASTPOS=92009765;//kernel.MapEditor:9765
                  Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
                  //$LASTPOS=92009810;//kernel.MapEditor:9810
                  _this.modified=true;
                  
                } else {
                  //$LASTPOS=92009836;//kernel.MapEditor:9836
                  if (_this.mode=="copy"&&_this.getkey(1)>0&&_this.inRect()) {
                    //$LASTPOS=92009890;//kernel.MapEditor:9890
                    if (_this.selectedLayer=="base") {
                      //$LASTPOS=92009930;//kernel.MapEditor:9930
                      _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                      //$LASTPOS=92009977;//kernel.MapEditor:9977
                      _this.maponp=- 1;
                      
                    } else {
                      //$LASTPOS=92010003;//kernel.MapEditor:10003
                      if (_this.selectedLayer=="on") {
                        //$LASTPOS=92010041;//kernel.MapEditor:10041
                        _this.mapp=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                        
                      } else {
                        //$LASTPOS=92010106;//kernel.MapEditor:10106
                        _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                        //$LASTPOS=92010153;//kernel.MapEditor:10153
                        _this.maponp=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                        
                      }
                    }
                    //$LASTPOS=92010258;//kernel.MapEditor:10258
                    _this.mode="set";
                    //$LASTPOS=92010311;//kernel.MapEditor:10311
                    _this.drawLetter(_this.mode);
                    //$LASTPOS=92010338;//kernel.MapEditor:10338
                    _this.updateEx(10);
                    
                  }
                }
              }
            }
          }
          //$LASTPOS=92010364;//kernel.MapEditor:10364
          _this.update();
          
        }
      },
      fiber$main :function _trc_MapEditor_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=92000049;//kernel.MapEditor:49
        Tonyu.globals.$Screen.resize(480,640);
        //$LASTPOS=92000075;//kernel.MapEditor:75
        _this.loadMode=false;
        //$LASTPOS=92000092;//kernel.MapEditor:92
        _this.fileExist=false;
        //$LASTPOS=92000110;//kernel.MapEditor:110
        Tonyu.globals.$Boot.on("stop",(function anonymous_127(e) {
          
          //$LASTPOS=92000179;//kernel.MapEditor:179
          if (_this.modified) {
            //$LASTPOS=92000204;//kernel.MapEditor:204
            e.preventDefault();
            //$LASTPOS=92000233;//kernel.MapEditor:233
            _this.parallel(Tonyu.bindFunc(_this,_this.st),e);
            
          }
        }));
        //$LASTPOS=92000646;//kernel.MapEditor:646
        _this.print("map file(s)");
        
        _thread.enter(function _trc_MapEditor_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=92000694;//kernel.MapEditor:694
              _this.fiber$file(_thread, "../maps/");
              __pc=1;return;
            case 1:
              _this.fileList=_thread.retVal;
              
              //$LASTPOS=92000722;//kernel.MapEditor:722
              if (_this.fileList.exists()) {
                //$LASTPOS=92000750;//kernel.MapEditor:750
                _this.fileList.recursive((function a(f) {
                  
                  //$LASTPOS=92000844;//kernel.MapEditor:844
                  _this.print(f.name());
                  //$LASTPOS=92000900;//kernel.MapEditor:900
                  _this.fileExist=true;
                }));
                
              }
              //$LASTPOS=92000943;//kernel.MapEditor:943
              if (!(_this.fileExist)) { __pc=12    ; break; }
              //$LASTPOS=92000963;//kernel.MapEditor:963
              _this.print("Load Data?: Y or N");
              //$LASTPOS=92000997;//kernel.MapEditor:997
            case 2:
              //$LASTPOS=92001019;//kernel.MapEditor:1019
              if (!(_this.getkey("y")>0)) { __pc=3     ; break; }
              //$LASTPOS=92001051;//kernel.MapEditor:1051
              _this.loadMode=true;
              __pc=6     ; break;
              
            case 3     :
              
              //$LASTPOS=92001106;//kernel.MapEditor:1106
              if (!(_this.getkey("n")>0)) { __pc=4     ; break; }
              //$LASTPOS=92001138;//kernel.MapEditor:1138
              _this.loadMode=false;
              __pc=6     ; break;
              
            case 4     :
              
              //$LASTPOS=92001194;//kernel.MapEditor:1194
              _this.fiber$update(_thread);
              __pc=5;return;
            case 5:
              
              __pc=2;break;
            case 6     :
              
              //$LASTPOS=92001216;//kernel.MapEditor:1216
              if (!(_this.loadMode)) { __pc=11    ; break; }
              //$LASTPOS=92001239;//kernel.MapEditor:1239
              _this.fiber$prompt(_thread, "Input json file (*.json)", "map.json");
              __pc=7;return;
            case 7:
              _this.fileName=_thread.retVal;
              
              //$LASTPOS=92001304;//kernel.MapEditor:1304
              if (_this.fileName) {
                //$LASTPOS=92001331;//kernel.MapEditor:1331
                _this.mapDataFile=_this.file("../maps/").rel(_this.fileName);
                
              }
              //$LASTPOS=92001395;//kernel.MapEditor:1395
              if (!(_this.mapDataFile.obj())) { __pc=8     ; break; }
              {
                //$LASTPOS=92001431;//kernel.MapEditor:1431
                _this.baseData=_this.mapDataFile.obj();
                //$LASTPOS=92001472;//kernel.MapEditor:1472
                _this.loadedFile=_this.fileName;
              }
              __pc=10    ;break;
            case 8     :
              //$LASTPOS=92001522;//kernel.MapEditor:1522
              _this.fiber$file(_thread, _this.fileName);
              __pc=9;return;
            case 9:
              _this.mapDataFile=_thread.retVal;
              
              //$LASTPOS=92001563;//kernel.MapEditor:1563
              if (_this.mapDataFile.obj()) {
                //$LASTPOS=92001603;//kernel.MapEditor:1603
                _this.baseData=_this.mapDataFile.obj();
                //$LASTPOS=92001648;//kernel.MapEditor:1648
                _this.loadedFile=_this.fileName;
                
              }
            case 10    :
              
              //$LASTPOS=92001704;//kernel.MapEditor:1704
              if (_this.baseData==undefined) {
                //$LASTPOS=92001742;//kernel.MapEditor:1742
                _this.print("Load failed");
                //$LASTPOS=92001777;//kernel.MapEditor:1777
                _this.loadMode=false;
                
              } else {
                //$LASTPOS=92001808;//kernel.MapEditor:1808
                if (_this.baseData[0]&&_this.baseData[1]) {
                  //$LASTPOS=92001853;//kernel.MapEditor:1853
                  _this.modified=false;
                  //$LASTPOS=92001882;//kernel.MapEditor:1882
                  _this.mapData=_this.baseData[0];
                  //$LASTPOS=92001916;//kernel.MapEditor:1916
                  _this.mapOnData=_this.baseData[1];
                  //$LASTPOS=92001952;//kernel.MapEditor:1952
                  if (_this.baseData.length>2) {
                    //$LASTPOS=92001992;//kernel.MapEditor:1992
                    _this.chipWidth=_this.baseData[_this.baseData.length-2];
                    //$LASTPOS=92002048;//kernel.MapEditor:2048
                    _this.chipHeight=_this.baseData[_this.baseData.length-1];
                    
                  }
                  
                }
              }
            case 11    :
              
            case 12    :
              
              //$LASTPOS=92002125;//kernel.MapEditor:2125
              _this.fiber$update(_thread);
              __pc=13;return;
            case 13:
              
              //$LASTPOS=92002170;//kernel.MapEditor:2170
              if (!(! _this.loadMode)) { __pc=18    ; break; }
              //$LASTPOS=92002190;//kernel.MapEditor:2190
              _this.fiber$prompt(_thread, "input row");
              __pc=14;return;
            case 14:
              _this.row=_thread.retVal;
              
              //$LASTPOS=92002220;//kernel.MapEditor:2220
              _this.row=(_this.row-0)||50;
              //$LASTPOS=92002242;//kernel.MapEditor:2242
              _this.fiber$prompt(_thread, "input col");
              __pc=15;return;
            case 15:
              _this.col=_thread.retVal;
              
              //$LASTPOS=92002272;//kernel.MapEditor:2272
              _this.col=(_this.col-0)||50;
              //$LASTPOS=92002294;//kernel.MapEditor:2294
              _this.fiber$prompt(_thread, "input chipWidth");
              __pc=16;return;
            case 16:
              _this.chipWidth=_thread.retVal;
              
              //$LASTPOS=92002336;//kernel.MapEditor:2336
              _this.fiber$prompt(_thread, "input chipHeight");
              __pc=17;return;
            case 17:
              _this.chipHeight=_thread.retVal;
              
              //$LASTPOS=92002380;//kernel.MapEditor:2380
              _this.panel=new Tonyu.classes.kernel.Panel({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
              //$LASTPOS=92002445;//kernel.MapEditor:2445
              _this.panel.x=_this.panel.width/2+40;
              //$LASTPOS=92002476;//kernel.MapEditor:2476
              _this.panel.y=_this.panel.height/2+40;
              //$LASTPOS=92002508;//kernel.MapEditor:2508
              _this.panel.setFillStyle("cyan");
              //$LASTPOS=92002541;//kernel.MapEditor:2541
              _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
              //$LASTPOS=92002592;//kernel.MapEditor:2592
              Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.row,col: _this.col,chipWidth: _this.chipWidth,chipHeight: _this.chipHeight});
              __pc=19    ;break;
            case 18    :
              {
                //$LASTPOS=92002903;//kernel.MapEditor:2903
                Tonyu.globals.$map=new Tonyu.classes.kernel.Map({chipWidth: 32,chipHeight: 32});
                //$LASTPOS=92002950;//kernel.MapEditor:2950
                Tonyu.globals.$map.load(_this.fileName);
                //$LASTPOS=92002976;//kernel.MapEditor:2976
                _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
                //$LASTPOS=92003072;//kernel.MapEditor:3072
                _this.panel.x=_this.panel.width/2+40;
                //$LASTPOS=92003103;//kernel.MapEditor:3103
                _this.panel.y=_this.panel.height/2+40;
                //$LASTPOS=92003135;//kernel.MapEditor:3135
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=92003168;//kernel.MapEditor:3168
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
              }
            case 19    :
              
              //$LASTPOS=92003235;//kernel.MapEditor:3235
              _this.mIW=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip].image.width;
              //$LASTPOS=92003278;//kernel.MapEditor:3278
              _this.mIH=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip].image.height;
              //$LASTPOS=92003322;//kernel.MapEditor:3322
              _this.mCW=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip+0].width;
              //$LASTPOS=92003361;//kernel.MapEditor:3361
              _this.mCH=Tonyu.globals.$imageList[Tonyu.globals.$pat_mapchip+0].height;
              //$LASTPOS=92003401;//kernel.MapEditor:3401
              Tonyu.globals.$mp=new Tonyu.classes.kernel.Map({row: _this.floor(_this.mIH/_this.mCH),col: _this.floor(_this.mIW/_this.mCW),chipWidth: _this.mCW,chipHeight: _this.mCH});
              //$LASTPOS=92003483;//kernel.MapEditor:3483
              _this.counter=0;
              //$LASTPOS=92003495;//kernel.MapEditor:3495
              //$LASTPOS=92003499;//kernel.MapEditor:3499
              _this.i = 0;
              for (; _this.i<Tonyu.globals.$mp.row ; _this.i++) {
                {
                  //$LASTPOS=92003528;//kernel.MapEditor:3528
                  //$LASTPOS=92003532;//kernel.MapEditor:3532
                  _this.j = 0;
                  for (; _this.j<Tonyu.globals.$mp.col ; _this.j++) {
                    {
                      //$LASTPOS=92003565;//kernel.MapEditor:3565
                      Tonyu.globals.$mp.set(_this.j,_this.i,Tonyu.globals.$pat_mapchip+_this.counter);
                      //$LASTPOS=92003609;//kernel.MapEditor:3609
                      _this.counter++;
                    }
                  }
                }
              }
              //$LASTPOS=92003633;//kernel.MapEditor:3633
              Tonyu.globals.$consolePanel.clearRect(0,0,Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
              //$LASTPOS=92003713;//kernel.MapEditor:3713
              _this.mode="get";
              //$LASTPOS=92003726;//kernel.MapEditor:3726
              _this.prevMode="set";
              //$LASTPOS=92003743;//kernel.MapEditor:3743
              _this.mapp=0;
              //$LASTPOS=92003752;//kernel.MapEditor:3752
              _this.maponp=- 1;
              //$LASTPOS=92003764;//kernel.MapEditor:3764
              _this.mx=- 40;
              //$LASTPOS=92003773;//kernel.MapEditor:3773
              _this.my=- 40;
              //$LASTPOS=92003782;//kernel.MapEditor:3782
              _this.chipX=- 40;
              //$LASTPOS=92003794;//kernel.MapEditor:3794
              _this.chipY=- 40;
              //$LASTPOS=92003806;//kernel.MapEditor:3806
              _this.x=Tonyu.globals.$screenWidth-_this.chipWidth/2;
              //$LASTPOS=92003835;//kernel.MapEditor:3835
              _this.y=Tonyu.globals.$screenHeight-_this.chipHeight/2;
              //$LASTPOS=92003866;//kernel.MapEditor:3866
              Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
              //$LASTPOS=92003891;//kernel.MapEditor:3891
              _this.initialWidth=Tonyu.globals.$map.chipWidth;
              //$LASTPOS=92003921;//kernel.MapEditor:3921
              _this.initialHeight=Tonyu.globals.$map.chipHeight;
              //$LASTPOS=92003953;//kernel.MapEditor:3953
              _this.layers=["base","on","all"];
              //$LASTPOS=92003982;//kernel.MapEditor:3982
              _this.lc=0;
              //$LASTPOS=92003989;//kernel.MapEditor:3989
              _this.selectedLayer=_this.layers[_this.lc];
              //$LASTPOS=92004016;//kernel.MapEditor:4016
              _this.fiber$drawPanel(_thread);
              __pc=20;return;
            case 20:
              
              //$LASTPOS=92004030;//kernel.MapEditor:4030
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=21;return;
            case 21:
              
              //$LASTPOS=92004051;//kernel.MapEditor:4051
            case 22:
              //$LASTPOS=92004069;//kernel.MapEditor:4069
              _this.p=_this.mapp;
              //$LASTPOS=92004082;//kernel.MapEditor:4082
              if (!(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640)) { __pc=24    ; break; }
              //$LASTPOS=92004201;//kernel.MapEditor:4201
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=92004235;//kernel.MapEditor:4235
              _this.mode="erase";
              //$LASTPOS=92004290;//kernel.MapEditor:4290
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=23;return;
            case 23:
              
            case 24    :
              
              //$LASTPOS=92004320;//kernel.MapEditor:4320
              if (!(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) { __pc=26    ; break; }
              //$LASTPOS=92004439;//kernel.MapEditor:4439
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=92004473;//kernel.MapEditor:4473
              _this.mode="set";
              //$LASTPOS=92004494;//kernel.MapEditor:4494
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=25;return;
            case 25:
              
            case 26    :
              
              //$LASTPOS=92004524;//kernel.MapEditor:4524
              if (!(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) { __pc=29    ; break; }
              //$LASTPOS=92004645;//kernel.MapEditor:4645
              _this.lc++;
              //$LASTPOS=92004660;//kernel.MapEditor:4660
              _this.selectedLayer=_this.layers[_this.lc%3];
              //$LASTPOS=92004697;//kernel.MapEditor:4697
              _this.fiber$drawPanel(_thread);
              __pc=27;return;
            case 27:
              
              //$LASTPOS=92004751;//kernel.MapEditor:4751
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=28;return;
            case 28:
              
            case 29    :
              
              //$LASTPOS=92004874;//kernel.MapEditor:4874
              if (!(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>240&&Tonyu.globals.$touches[0].x<360&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) { __pc=31    ; break; }
              //$LASTPOS=92004995;//kernel.MapEditor:4995
              if (_this.mode!="get") {
                //$LASTPOS=92005025;//kernel.MapEditor:5025
                _this.prevMode=_this.mode;
                //$LASTPOS=92005053;//kernel.MapEditor:5053
                Tonyu.globals.$mp.scrollTo(- 40,- 40);
                //$LASTPOS=92005089;//kernel.MapEditor:5089
                _this.mode="get";
                //$LASTPOS=92005114;//kernel.MapEditor:5114
                _this.chipX=- 40;
                //$LASTPOS=92005138;//kernel.MapEditor:5138
                _this.chipY=- 40;
                
              } else {
                //$LASTPOS=92005178;//kernel.MapEditor:5178
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=92005216;//kernel.MapEditor:5216
                _this.mode=_this.prevMode;
                
              }
              //$LASTPOS=92005283;//kernel.MapEditor:5283
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=30;return;
            case 30:
              
            case 31    :
              
              //$LASTPOS=92005313;//kernel.MapEditor:5313
              if (!(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>360&&Tonyu.globals.$touches[0].x<480&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) { __pc=38    ; break; }
              //$LASTPOS=92005449;//kernel.MapEditor:5449
              if (!(_this.loadedFile)) { __pc=33    ; break; }
              //$LASTPOS=92005478;//kernel.MapEditor:5478
              _this.fiber$prompt(_thread, "input json file(*.json)", _this.loadedFile);
              __pc=32;return;
            case 32:
              _this.saveFileName=_thread.retVal;
              
              __pc=35    ;break;
            case 33    :
              //$LASTPOS=92005566;//kernel.MapEditor:5566
              _this.fiber$prompt(_thread, "input json file(*.json)", "map.json");
              __pc=34;return;
            case 34:
              _this.saveFileName=_thread.retVal;
              
            case 35    :
              
              //$LASTPOS=92005660;//kernel.MapEditor:5660
              if (!(_this.saveFileName)) { __pc=37    ; break; }
              //$LASTPOS=92005691;//kernel.MapEditor:5691
              _this.fiber$save(_thread, _this.saveFileName);
              __pc=36;return;
            case 36:
              
            case 37    :
              
            case 38    :
              
              //$LASTPOS=92005991;//kernel.MapEditor:5991
              if (!(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640)) { __pc=40    ; break; }
              //$LASTPOS=92006112;//kernel.MapEditor:6112
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=92006146;//kernel.MapEditor:6146
              _this.mode="copy";
              //$LASTPOS=92006200;//kernel.MapEditor:6200
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=39;return;
            case 39:
              
            case 40    :
              
              //$LASTPOS=92006230;//kernel.MapEditor:6230
              if (_this.mode!="get") {
                //$LASTPOS=92006256;//kernel.MapEditor:6256
                if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=92006362;//kernel.MapEditor:6362
                  _this.mx=_this.mx-8;
                }
                //$LASTPOS=92006380;//kernel.MapEditor:6380
                if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=92006511;//kernel.MapEditor:6511
                  _this.mx=_this.mx+8;
                }
                //$LASTPOS=92006529;//kernel.MapEditor:6529
                if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
                  //$LASTPOS=92006642;//kernel.MapEditor:6642
                  _this.my=_this.my-8;
                }
                //$LASTPOS=92006660;//kernel.MapEditor:6660
                if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
                  //$LASTPOS=92006795;//kernel.MapEditor:6795
                  _this.my=_this.my+8;
                }
                //$LASTPOS=92006813;//kernel.MapEditor:6813
                Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
                
              } else {
                //$LASTPOS=92006856;//kernel.MapEditor:6856
                if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=92006962;//kernel.MapEditor:6962
                  _this.chipX=_this.chipX-8;
                }
                //$LASTPOS=92006986;//kernel.MapEditor:6986
                if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=92007117;//kernel.MapEditor:7117
                  _this.chipX=_this.chipX+8;
                }
                //$LASTPOS=92007141;//kernel.MapEditor:7141
                if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
                  //$LASTPOS=92007254;//kernel.MapEditor:7254
                  _this.chipY=_this.chipY-8;
                }
                //$LASTPOS=92007278;//kernel.MapEditor:7278
                if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
                  //$LASTPOS=92007413;//kernel.MapEditor:7413
                  _this.chipY=_this.chipY+8;
                }
                //$LASTPOS=92007437;//kernel.MapEditor:7437
                Tonyu.globals.$mp.scrollTo(_this.chipX,_this.chipY);
                
              }
              //$LASTPOS=92007506;//kernel.MapEditor:7506
              if (_this.getkey("i")==1) {
                //$LASTPOS=92007535;//kernel.MapEditor:7535
                if (Tonyu.globals.$map.chipWidth<_this.initialWidth) {
                  //$LASTPOS=92007567;//kernel.MapEditor:7567
                  Tonyu.globals.$map.chipWidth+=4;
                }
                //$LASTPOS=92007595;//kernel.MapEditor:7595
                if (Tonyu.globals.$map.chipHeight<_this.initialHeight) {
                  //$LASTPOS=92007629;//kernel.MapEditor:7629
                  Tonyu.globals.$map.chipHeight+=4;
                }
                //$LASTPOS=92007658;//kernel.MapEditor:7658
                Tonyu.globals.$map.redrawMap();
                //$LASTPOS=92007685;//kernel.MapEditor:7685
                _this.panel.die();
                //$LASTPOS=92007707;//kernel.MapEditor:7707
                _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
                //$LASTPOS=92007807;//kernel.MapEditor:7807
                _this.panel.x=_this.panel.width/2+40;
                //$LASTPOS=92007842;//kernel.MapEditor:7842
                _this.panel.y=_this.panel.height/2+40;
                //$LASTPOS=92007878;//kernel.MapEditor:7878
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=92007915;//kernel.MapEditor:7915
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
                
              }
              //$LASTPOS=92007973;//kernel.MapEditor:7973
              if (_this.getkey("o")==1) {
                //$LASTPOS=92008002;//kernel.MapEditor:8002
                if (Tonyu.globals.$map.chipWidth>4) {
                  //$LASTPOS=92008023;//kernel.MapEditor:8023
                  Tonyu.globals.$map.chipWidth-=4;
                }
                //$LASTPOS=92008051;//kernel.MapEditor:8051
                if (Tonyu.globals.$map.chipHeight>4) {
                  //$LASTPOS=92008073;//kernel.MapEditor:8073
                  Tonyu.globals.$map.chipHeight-=4;
                }
                //$LASTPOS=92008102;//kernel.MapEditor:8102
                Tonyu.globals.$map.redrawMap();
                //$LASTPOS=92008129;//kernel.MapEditor:8129
                _this.panel.die();
                //$LASTPOS=92008151;//kernel.MapEditor:8151
                _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
                //$LASTPOS=92008251;//kernel.MapEditor:8251
                _this.panel.x=_this.panel.width/2+40;
                //$LASTPOS=92008286;//kernel.MapEditor:8286
                _this.panel.y=_this.panel.height/2+40;
                //$LASTPOS=92008322;//kernel.MapEditor:8322
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=92008359;//kernel.MapEditor:8359
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
                
              }
              //$LASTPOS=92008443;//kernel.MapEditor:8443
              _this.panel.x=_this.panel.width/2-_this.mx;
              //$LASTPOS=92008474;//kernel.MapEditor:8474
              _this.panel.y=_this.panel.height/2-_this.my;
              //$LASTPOS=92008506;//kernel.MapEditor:8506
              if (!(_this.mode=="set"&&_this.getkey(1)>0&&_this.inRect())) { __pc=41    ; break; }
              {
                //$LASTPOS=92008559;//kernel.MapEditor:8559
                if (_this.selectedLayer=="base") {
                  //$LASTPOS=92008599;//kernel.MapEditor:8599
                  _this.tmpon=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                  //$LASTPOS=92008649;//kernel.MapEditor:8649
                  Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
                  //$LASTPOS=92008696;//kernel.MapEditor:8696
                  Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.tmpon);
                  
                } else {
                  //$LASTPOS=92008748;//kernel.MapEditor:8748
                  if (_this.selectedLayer=="on") {
                    //$LASTPOS=92008786;//kernel.MapEditor:8786
                    Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
                    
                  } else {
                    //$LASTPOS=92008851;//kernel.MapEditor:8851
                    Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
                    //$LASTPOS=92008898;//kernel.MapEditor:8898
                    Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.maponp);
                    
                  }
                }
                //$LASTPOS=92008956;//kernel.MapEditor:8956
                _this.modified=true;
              }
              __pc=53    ;break;
            case 41    :
              //$LASTPOS=92008982;//kernel.MapEditor:8982
              if (!(_this.mode=="erase"&&_this.getkey(1)>0&&_this.inRect())) { __pc=42    ; break; }
              {
                //$LASTPOS=92009037;//kernel.MapEditor:9037
                if (_this.selectedLayer=="base") {
                  //$LASTPOS=92009077;//kernel.MapEditor:9077
                  _this.tmpon=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                  //$LASTPOS=92009127;//kernel.MapEditor:9127
                  Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                  //$LASTPOS=92009172;//kernel.MapEditor:9172
                  Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.tmpon);
                  
                } else {
                  //$LASTPOS=92009224;//kernel.MapEditor:9224
                  if (_this.selectedLayer=="on") {
                    //$LASTPOS=92009262;//kernel.MapEditor:9262
                    Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                    
                  } else {
                    //$LASTPOS=92009325;//kernel.MapEditor:9325
                    Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                    //$LASTPOS=92009370;//kernel.MapEditor:9370
                    Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,- 1);
                    
                  }
                }
                //$LASTPOS=92009424;//kernel.MapEditor:9424
                _this.modified=true;
              }
              __pc=52    ;break;
            case 42    :
              //$LASTPOS=92009450;//kernel.MapEditor:9450
              if (!(_this.mode=="get"&&_this.getkey(1)>0&&_this.inRect())) { __pc=45    ; break; }
              //$LASTPOS=92009503;//kernel.MapEditor:9503
              _this.mapp=Tonyu.globals.$mp.getAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
              //$LASTPOS=92009571;//kernel.MapEditor:9571
              _this.mode="set";
              //$LASTPOS=92009592;//kernel.MapEditor:9592
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=92009658;//kernel.MapEditor:9658
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=43;return;
            case 43:
              
              //$LASTPOS=92009685;//kernel.MapEditor:9685
              _this.fiber$updateEx(_thread, 10);
              __pc=44;return;
            case 44:
              
              __pc=51    ;break;
            case 45    :
              //$LASTPOS=92009710;//kernel.MapEditor:9710
              if (!(_this.mode=="setOn"&&_this.getkey(1)>0&&_this.inRect())) { __pc=46    ; break; }
              {
                //$LASTPOS=92009765;//kernel.MapEditor:9765
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY,_this.mapp);
                //$LASTPOS=92009810;//kernel.MapEditor:9810
                _this.modified=true;
              }
              __pc=50    ;break;
            case 46    :
              //$LASTPOS=92009836;//kernel.MapEditor:9836
              if (!(_this.mode=="copy"&&_this.getkey(1)>0&&_this.inRect())) { __pc=49    ; break; }
              //$LASTPOS=92009890;//kernel.MapEditor:9890
              if (_this.selectedLayer=="base") {
                //$LASTPOS=92009930;//kernel.MapEditor:9930
                _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                //$LASTPOS=92009977;//kernel.MapEditor:9977
                _this.maponp=- 1;
                
              } else {
                //$LASTPOS=92010003;//kernel.MapEditor:10003
                if (_this.selectedLayer=="on") {
                  //$LASTPOS=92010041;//kernel.MapEditor:10041
                  _this.mapp=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                  
                } else {
                  //$LASTPOS=92010106;//kernel.MapEditor:10106
                  _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                  //$LASTPOS=92010153;//kernel.MapEditor:10153
                  _this.maponp=Tonyu.globals.$map.getOnAt(Tonyu.globals.$mouseX,Tonyu.globals.$mouseY);
                  
                }
              }
              //$LASTPOS=92010258;//kernel.MapEditor:10258
              _this.mode="set";
              //$LASTPOS=92010311;//kernel.MapEditor:10311
              _this.fiber$drawLetter(_thread, _this.mode);
              __pc=47;return;
            case 47:
              
              //$LASTPOS=92010338;//kernel.MapEditor:10338
              _this.fiber$updateEx(_thread, 10);
              __pc=48;return;
            case 48:
              
            case 49    :
              
            case 50    :
              
            case 51    :
              
            case 52    :
              
            case 53    :
              
              //$LASTPOS=92010364;//kernel.MapEditor:10364
              _this.fiber$update(_thread);
              __pc=54;return;
            case 54:
              
              __pc=22;break;
            case 55    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getCurFileName :function _trc_MapEditor_getCurFileName() {
        "use strict";
        var _this=this;
        
        return _this.saveFileName||_this.loadedFile;
      },
      fiber$getCurFileName :function _trc_MapEditor_f_getCurFileName(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=_this.saveFileName||_this.loadedFile;return;
        
        
        _thread.retVal=_this;return;
      },
      st :function _trc_MapEditor_st(e) {
        "use strict";
        var _this=this;
        var curFileName;
        var r;
        
        //$LASTPOS=92000337;//kernel.MapEditor:337
        curFileName = _this.getCurFileName()||"map.json";
        
        //$LASTPOS=92000388;//kernel.MapEditor:388
        r = _this.confirm("Save "+curFileName+"?");
        
        //$LASTPOS=92000433;//kernel.MapEditor:433
        if (r) {
          //$LASTPOS=92000451;//kernel.MapEditor:451
          _this.save(curFileName);
          //$LASTPOS=92000479;//kernel.MapEditor:479
          _this.update();
          //$LASTPOS=92000498;//kernel.MapEditor:498
          e.die();
          
        } else {
          //$LASTPOS=92000530;//kernel.MapEditor:530
          r=_this.confirm("Discard changes?");
          //$LASTPOS=92000570;//kernel.MapEditor:570
          if (r) {
            //$LASTPOS=92000592;//kernel.MapEditor:592
            _this.update();
            //$LASTPOS=92000615;//kernel.MapEditor:615
            e.die();
            
          }
          
        }
      },
      fiber$st :function _trc_MapEditor_f_st(_thread,e) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var curFileName;
        var r;
        
        //$LASTPOS=92000337;//kernel.MapEditor:337
        curFileName = _this.getCurFileName()||"map.json";
        
        
        _thread.enter(function _trc_MapEditor_ent_st(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=92000388;//kernel.MapEditor:388
              _this.fiber$confirm(_thread, "Save "+curFileName+"?");
              __pc=1;return;
            case 1:
              r=_thread.retVal;
              
              //$LASTPOS=92000433;//kernel.MapEditor:433
              if (!(r)) { __pc=4     ; break; }
              //$LASTPOS=92000451;//kernel.MapEditor:451
              _this.fiber$save(_thread, curFileName);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=92000479;//kernel.MapEditor:479
              _this.fiber$update(_thread);
              __pc=3;return;
            case 3:
              
              //$LASTPOS=92000498;//kernel.MapEditor:498
              e.die();
              __pc=8     ;break;
            case 4     :
              //$LASTPOS=92000530;//kernel.MapEditor:530
              _this.fiber$confirm(_thread, "Discard changes?");
              __pc=5;return;
            case 5:
              r=_thread.retVal;
              
              //$LASTPOS=92000570;//kernel.MapEditor:570
              if (!(r)) { __pc=7     ; break; }
              //$LASTPOS=92000592;//kernel.MapEditor:592
              _this.fiber$update(_thread);
              __pc=6;return;
            case 6:
              
              //$LASTPOS=92000615;//kernel.MapEditor:615
              e.die();
            case 7     :
              
            case 8     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      save :function _trc_MapEditor_save(fileName) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=92010401;//kernel.MapEditor:10401
        _this.saveDataFile=_this.file("../maps/").rel(fileName);
        //$LASTPOS=92010451;//kernel.MapEditor:10451
        _this.data=[Tonyu.globals.$map.mapTable,Tonyu.globals.$map.mapOnTable,Tonyu.globals.$map.chipWidth,Tonyu.globals.$map.chipHeight];
        //$LASTPOS=92010525;//kernel.MapEditor:10525
        _this.saveDataFile.obj(_this.data);
        //$LASTPOS=92010554;//kernel.MapEditor:10554
        _this.modified=false;
        //$LASTPOS=92010575;//kernel.MapEditor:10575
        _this.print(fileName+" Saved");
      },
      fiber$save :function _trc_MapEditor_f_save(_thread,fileName) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=92010401;//kernel.MapEditor:10401
        _this.saveDataFile=_this.file("../maps/").rel(fileName);
        //$LASTPOS=92010451;//kernel.MapEditor:10451
        _this.data=[Tonyu.globals.$map.mapTable,Tonyu.globals.$map.mapOnTable,Tonyu.globals.$map.chipWidth,Tonyu.globals.$map.chipHeight];
        //$LASTPOS=92010525;//kernel.MapEditor:10525
        _this.saveDataFile.obj(_this.data);
        //$LASTPOS=92010554;//kernel.MapEditor:10554
        _this.modified=false;
        //$LASTPOS=92010575;//kernel.MapEditor:10575
        _this.print(fileName+" Saved");
        
        _thread.retVal=_this;return;
      },
      inRect :function _trc_MapEditor_inRect() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$mouseX>40&&Tonyu.globals.$mouseX<Tonyu.globals.$screenWidth-40&&Tonyu.globals.$mouseY>40&&Tonyu.globals.$mouseY<Tonyu.globals.$screenHeight-200;
      },
      fiber$inRect :function _trc_MapEditor_f_inRect(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$mouseX>40&&Tonyu.globals.$mouseX<Tonyu.globals.$screenWidth-40&&Tonyu.globals.$mouseY>40&&Tonyu.globals.$mouseY<Tonyu.globals.$screenHeight-200;return;
        
        
        _thread.retVal=_this;return;
      },
      drawPanel :function _trc_MapEditor_drawPanel() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=92010762;//kernel.MapEditor:10762
        Tonyu.globals.$panel.setFillStyle("gray");
        //$LASTPOS=92010796;//kernel.MapEditor:10796
        Tonyu.globals.$panel.alpha=128;
        //$LASTPOS=92010819;//kernel.MapEditor:10819
        Tonyu.globals.$panel.fillRect(0,0,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=92010862;//kernel.MapEditor:10862
        Tonyu.globals.$panel.fillRect(0,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=92010910;//kernel.MapEditor:10910
        Tonyu.globals.$panel.fillRect(Tonyu.globals.$screenWidth-40,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=92010972;//kernel.MapEditor:10972
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-200,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=92011031;//kernel.MapEditor:11031
        Tonyu.globals.$panel.alpha=255;
        //$LASTPOS=92011054;//kernel.MapEditor:11054
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=92011108;//kernel.MapEditor:11108
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011158;//kernel.MapEditor:11158
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011210;//kernel.MapEditor:11210
        Tonyu.globals.$panel.fillRect(240,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011262;//kernel.MapEditor:11262
        Tonyu.globals.$panel.fillRect(360,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011314;//kernel.MapEditor:11314
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=92011363;//kernel.MapEditor:11363
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=92011414;//kernel.MapEditor:11414
        Tonyu.globals.$panel.setFillStyle("white");
        //$LASTPOS=92011449;//kernel.MapEditor:11449
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011500;//kernel.MapEditor:11500
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011552;//kernel.MapEditor:11552
        Tonyu.globals.$panel.fillRect(250,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011604;//kernel.MapEditor:11604
        Tonyu.globals.$panel.fillRect(370,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011656;//kernel.MapEditor:11656
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=92011706;//kernel.MapEditor:11706
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=92011757;//kernel.MapEditor:11757
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=92011803;//kernel.MapEditor:11803
        Tonyu.globals.$panel.fillText("↑",Tonyu.globals.$screenWidth/2,30,40,"center");
        //$LASTPOS=92011860;//kernel.MapEditor:11860
        Tonyu.globals.$panel.fillText("←",20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=92011924;//kernel.MapEditor:11924
        Tonyu.globals.$panel.fillText("↓",Tonyu.globals.$screenWidth/2,Tonyu.globals.$screenHeight-160-10,40,"center");
        //$LASTPOS=92011999;//kernel.MapEditor:11999
        Tonyu.globals.$panel.fillText("→",Tonyu.globals.$screenWidth-20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=92012104;//kernel.MapEditor:12104
        Tonyu.globals.$panel.fillText("set",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012181;//kernel.MapEditor:12181
        Tonyu.globals.$panel.fillText(_this.selectedLayer,Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-110,35,"center");
        //$LASTPOS=92012266;//kernel.MapEditor:12266
        Tonyu.globals.$panel.fillText("get",Tonyu.globals.$screenWidth/2+60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012343;//kernel.MapEditor:12343
        Tonyu.globals.$panel.fillText("save",Tonyu.globals.$screenWidth-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012419;//kernel.MapEditor:12419
        Tonyu.globals.$panel.fillText("erase",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=92012497;//kernel.MapEditor:12497
        Tonyu.globals.$panel.fillText("copy",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-30,35,"center");
      },
      fiber$drawPanel :function _trc_MapEditor_f_drawPanel(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=92010762;//kernel.MapEditor:10762
        Tonyu.globals.$panel.setFillStyle("gray");
        //$LASTPOS=92010796;//kernel.MapEditor:10796
        Tonyu.globals.$panel.alpha=128;
        //$LASTPOS=92010819;//kernel.MapEditor:10819
        Tonyu.globals.$panel.fillRect(0,0,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=92010862;//kernel.MapEditor:10862
        Tonyu.globals.$panel.fillRect(0,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=92010910;//kernel.MapEditor:10910
        Tonyu.globals.$panel.fillRect(Tonyu.globals.$screenWidth-40,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=92010972;//kernel.MapEditor:10972
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-200,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=92011031;//kernel.MapEditor:11031
        Tonyu.globals.$panel.alpha=255;
        //$LASTPOS=92011054;//kernel.MapEditor:11054
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=92011108;//kernel.MapEditor:11108
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011158;//kernel.MapEditor:11158
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011210;//kernel.MapEditor:11210
        Tonyu.globals.$panel.fillRect(240,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011262;//kernel.MapEditor:11262
        Tonyu.globals.$panel.fillRect(360,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=92011314;//kernel.MapEditor:11314
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=92011363;//kernel.MapEditor:11363
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=92011414;//kernel.MapEditor:11414
        Tonyu.globals.$panel.setFillStyle("white");
        //$LASTPOS=92011449;//kernel.MapEditor:11449
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011500;//kernel.MapEditor:11500
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011552;//kernel.MapEditor:11552
        Tonyu.globals.$panel.fillRect(250,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011604;//kernel.MapEditor:11604
        Tonyu.globals.$panel.fillRect(370,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=92011656;//kernel.MapEditor:11656
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=92011706;//kernel.MapEditor:11706
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=92011757;//kernel.MapEditor:11757
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=92011803;//kernel.MapEditor:11803
        Tonyu.globals.$panel.fillText("↑",Tonyu.globals.$screenWidth/2,30,40,"center");
        //$LASTPOS=92011860;//kernel.MapEditor:11860
        Tonyu.globals.$panel.fillText("←",20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=92011924;//kernel.MapEditor:11924
        Tonyu.globals.$panel.fillText("↓",Tonyu.globals.$screenWidth/2,Tonyu.globals.$screenHeight-160-10,40,"center");
        //$LASTPOS=92011999;//kernel.MapEditor:11999
        Tonyu.globals.$panel.fillText("→",Tonyu.globals.$screenWidth-20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=92012104;//kernel.MapEditor:12104
        Tonyu.globals.$panel.fillText("set",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012181;//kernel.MapEditor:12181
        Tonyu.globals.$panel.fillText(_this.selectedLayer,Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-110,35,"center");
        //$LASTPOS=92012266;//kernel.MapEditor:12266
        Tonyu.globals.$panel.fillText("get",Tonyu.globals.$screenWidth/2+60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012343;//kernel.MapEditor:12343
        Tonyu.globals.$panel.fillText("save",Tonyu.globals.$screenWidth-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012419;//kernel.MapEditor:12419
        Tonyu.globals.$panel.fillText("erase",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=92012497;//kernel.MapEditor:12497
        Tonyu.globals.$panel.fillText("copy",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-30,35,"center");
        
        _thread.retVal=_this;return;
      },
      drawLetter :function _trc_MapEditor_drawLetter(mode) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=92012605;//kernel.MapEditor:12605
        if (mode=="set") {
          //$LASTPOS=92012621;//kernel.MapEditor:12621
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92012659;//kernel.MapEditor:12659
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92012694;//kernel.MapEditor:12694
        Tonyu.globals.$panel.fillText("set",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012771;//kernel.MapEditor:12771
        if (mode=="get") {
          //$LASTPOS=92012787;//kernel.MapEditor:12787
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92012825;//kernel.MapEditor:12825
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92012860;//kernel.MapEditor:12860
        Tonyu.globals.$panel.fillText("get",Tonyu.globals.$screenWidth/2+60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012937;//kernel.MapEditor:12937
        if (mode=="erase") {
          //$LASTPOS=92012955;//kernel.MapEditor:12955
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92012993;//kernel.MapEditor:12993
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92013028;//kernel.MapEditor:13028
        Tonyu.globals.$panel.fillText("erase",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=92013106;//kernel.MapEditor:13106
        if (mode=="copy") {
          //$LASTPOS=92013123;//kernel.MapEditor:13123
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92013161;//kernel.MapEditor:13161
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92013196;//kernel.MapEditor:13196
        Tonyu.globals.$panel.fillText("copy",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=92013273;//kernel.MapEditor:13273
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=92013308;//kernel.MapEditor:13308
        Tonyu.globals.$panel.fillText(_this.selectedLayer,Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-110,35,"center");
        //$LASTPOS=92013393;//kernel.MapEditor:13393
        Tonyu.globals.$panel.fillText("save",Tonyu.globals.$screenWidth-60,Tonyu.globals.$screenHeight-110,40,"center");
      },
      fiber$drawLetter :function _trc_MapEditor_f_drawLetter(_thread,mode) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=92012605;//kernel.MapEditor:12605
        if (mode=="set") {
          //$LASTPOS=92012621;//kernel.MapEditor:12621
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92012659;//kernel.MapEditor:12659
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92012694;//kernel.MapEditor:12694
        Tonyu.globals.$panel.fillText("set",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012771;//kernel.MapEditor:12771
        if (mode=="get") {
          //$LASTPOS=92012787;//kernel.MapEditor:12787
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92012825;//kernel.MapEditor:12825
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92012860;//kernel.MapEditor:12860
        Tonyu.globals.$panel.fillText("get",Tonyu.globals.$screenWidth/2+60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=92012937;//kernel.MapEditor:12937
        if (mode=="erase") {
          //$LASTPOS=92012955;//kernel.MapEditor:12955
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92012993;//kernel.MapEditor:12993
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92013028;//kernel.MapEditor:13028
        Tonyu.globals.$panel.fillText("erase",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=92013106;//kernel.MapEditor:13106
        if (mode=="copy") {
          //$LASTPOS=92013123;//kernel.MapEditor:13123
          Tonyu.globals.$panel.setFillStyle("red");
        } else {
          //$LASTPOS=92013161;//kernel.MapEditor:13161
          Tonyu.globals.$panel.setFillStyle("black");
        }
        //$LASTPOS=92013196;//kernel.MapEditor:13196
        Tonyu.globals.$panel.fillText("copy",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=92013273;//kernel.MapEditor:13273
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=92013308;//kernel.MapEditor:13308
        Tonyu.globals.$panel.fillText(_this.selectedLayer,Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-110,35,"center");
        //$LASTPOS=92013393;//kernel.MapEditor:13393
        Tonyu.globals.$panel.fillText("save",Tonyu.globals.$screenWidth-60,Tonyu.globals.$screenHeight-110,40,"center");
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"getCurFileName":{"nowait":false},"st":{"nowait":false},"save":{"nowait":false},"inRect":{"nowait":false},"drawPanel":{"nowait":false},"drawLetter":{"nowait":false}},"fields":{"i":{},"j":{},"loadMode":{},"fileExist":{},"modified":{},"fileList":{},"fileName":{},"mapDataFile":{},"baseData":{},"loadedFile":{},"mapData":{},"mapOnData":{},"chipWidth":{},"chipHeight":{},"row":{},"col":{},"panel":{},"mIW":{},"mIH":{},"mCW":{},"mCH":{},"counter":{},"mode":{},"prevMode":{},"mapp":{},"maponp":{},"mx":{},"my":{},"chipX":{},"chipY":{},"initialWidth":{},"initialHeight":{},"layers":{},"lc":{},"selectedLayer":{},"saveFileName":{},"tmpon":{},"saveDataFile":{},"data":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.MapEditorOLD',
  shortName: 'MapEditorOLD',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_MapEditorOLD_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=93000032;//kernel.MapEditorOLD:32
        _this.loadMode=false;
        //$LASTPOS=93000049;//kernel.MapEditorOLD:49
        _this.print("Load Data?: Y or N");
        //$LASTPOS=93000079;//kernel.MapEditorOLD:79
        while (true) {
          //$LASTPOS=93000097;//kernel.MapEditorOLD:97
          if (_this.getkey("y")>0) {
            //$LASTPOS=93000125;//kernel.MapEditorOLD:125
            _this.loadMode=true;
            break;
            
            
          }
          //$LASTPOS=93000168;//kernel.MapEditorOLD:168
          if (_this.getkey("n")>0) {
            //$LASTPOS=93000196;//kernel.MapEditorOLD:196
            _this.loadMode=false;
            break;
            
            
          }
          //$LASTPOS=93000240;//kernel.MapEditorOLD:240
          _this.update();
          
        }
        //$LASTPOS=93000254;//kernel.MapEditorOLD:254
        if (_this.loadMode) {
          //$LASTPOS=93000273;//kernel.MapEditorOLD:273
          _this.fileName=prompt("Input json file (*.json)","map.json");
          //$LASTPOS=93000334;//kernel.MapEditorOLD:334
          if (_this.fileName) {
            //$LASTPOS=93000357;//kernel.MapEditorOLD:357
            _this.mapDataFile=_this.file("../maps/").rel(_this.fileName);
            
          }
          //$LASTPOS=93000413;//kernel.MapEditorOLD:413
          if (_this.mapDataFile.obj()) {
            //$LASTPOS=93000445;//kernel.MapEditorOLD:445
            _this.baseData=_this.mapDataFile.obj();
            
          } else {
            //$LASTPOS=93000494;//kernel.MapEditorOLD:494
            _this.mapDataFile=_this.file(_this.fileName);
            //$LASTPOS=93000531;//kernel.MapEditorOLD:531
            if (_this.mapDataFile.obj()) {
              //$LASTPOS=93000567;//kernel.MapEditorOLD:567
              _this.baseData=_this.mapDataFile.obj();
              
            }
            
          }
          //$LASTPOS=93000618;//kernel.MapEditorOLD:618
          if (_this.baseData==undefined) {
            //$LASTPOS=93000652;//kernel.MapEditorOLD:652
            _this.print("Load failed");
            //$LASTPOS=93000683;//kernel.MapEditorOLD:683
            _this.loadMode=false;
            
          } else {
            //$LASTPOS=93000710;//kernel.MapEditorOLD:710
            if (_this.baseData[0]&&_this.baseData[1]) {
              //$LASTPOS=93000751;//kernel.MapEditorOLD:751
              _this.mapData=_this.baseData[0];
              //$LASTPOS=93000781;//kernel.MapEditorOLD:781
              _this.mapOnData=_this.baseData[1];
              
            }
          }
          
        }
        //$LASTPOS=93000815;//kernel.MapEditorOLD:815
        _this.update();
        //$LASTPOS=93001093;//kernel.MapEditorOLD:1093
        if (! _this.loadMode) {
          //$LASTPOS=93001113;//kernel.MapEditorOLD:1113
          _this.row=prompt("input row");
          //$LASTPOS=93001143;//kernel.MapEditorOLD:1143
          _this.update();
          //$LASTPOS=93001158;//kernel.MapEditorOLD:1158
          _this.col=prompt("input col");
          //$LASTPOS=93001188;//kernel.MapEditorOLD:1188
          _this.panel=new Tonyu.classes.kernel.Panel({width: _this.col*32,height: _this.row*32});
          //$LASTPOS=93001238;//kernel.MapEditorOLD:1238
          _this.panel.x=_this.panel.width/2+10;
          //$LASTPOS=93001269;//kernel.MapEditorOLD:1269
          _this.panel.y=_this.panel.height/2;
          //$LASTPOS=93001298;//kernel.MapEditorOLD:1298
          _this.panel.setFillStyle("cyan");
          //$LASTPOS=93001331;//kernel.MapEditorOLD:1331
          _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
          //$LASTPOS=93001382;//kernel.MapEditorOLD:1382
          Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.row,col: _this.col,chipWidth: 32,chipHeight: 32});
          
        } else {
          //$LASTPOS=93001445;//kernel.MapEditorOLD:1445
          if (! _this.mapOnData) {
            //$LASTPOS=93001470;//kernel.MapEditorOLD:1470
            Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.mapData.length,col: _this.mapData[0].length,chipWidth: 32,chipHeight: 32,mapData: _this.mapData});
            
          } else {
            //$LASTPOS=93001582;//kernel.MapEditorOLD:1582
            Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.mapData.length,col: _this.mapData[0].length,chipWidth: 32,chipHeight: 32,mapData: _this.mapData,mapOnData: _this.mapOnData});
            
          }
          //$LASTPOS=93001695;//kernel.MapEditorOLD:1695
          _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*32,height: Tonyu.globals.$map.row*32,zOrder: 100});
          //$LASTPOS=93001766;//kernel.MapEditorOLD:1766
          _this.panel.x=_this.panel.width/2;
          //$LASTPOS=93001794;//kernel.MapEditorOLD:1794
          _this.panel.y=_this.panel.height/2;
          //$LASTPOS=93001823;//kernel.MapEditorOLD:1823
          _this.panel.setFillStyle("cyan");
          //$LASTPOS=93001856;//kernel.MapEditorOLD:1856
          _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
          
        }
        //$LASTPOS=93001906;//kernel.MapEditorOLD:1906
        Tonyu.globals.$mp=new Tonyu.classes.kernel.Map({row: 16,col: 8,chipWidth: 32,chipHeight: 32});
        //$LASTPOS=93001961;//kernel.MapEditorOLD:1961
        _this.counter=0;
        //$LASTPOS=93001973;//kernel.MapEditorOLD:1973
        //$LASTPOS=93001977;//kernel.MapEditorOLD:1977
        _this.i = 0;
        for (; _this.i<16 ; _this.i++) {
          {
            //$LASTPOS=93002001;//kernel.MapEditorOLD:2001
            //$LASTPOS=93002005;//kernel.MapEditorOLD:2005
            _this.j = 0;
            for (; _this.j<8 ; _this.j++) {
              {
                //$LASTPOS=93002032;//kernel.MapEditorOLD:2032
                Tonyu.globals.$mp.set(_this.j,_this.i,Tonyu.globals.$pat_mapchip+_this.counter);
                //$LASTPOS=93002076;//kernel.MapEditorOLD:2076
                _this.counter++;
              }
            }
          }
        }
        //$LASTPOS=93002098;//kernel.MapEditorOLD:2098
        _this.mode="get";
        //$LASTPOS=93002111;//kernel.MapEditorOLD:2111
        _this.prevMode="set";
        //$LASTPOS=93002128;//kernel.MapEditorOLD:2128
        _this.mapp=0;
        //$LASTPOS=93002137;//kernel.MapEditorOLD:2137
        _this.mx=0;
        //$LASTPOS=93002144;//kernel.MapEditorOLD:2144
        _this.my=0;
        //$LASTPOS=93002151;//kernel.MapEditorOLD:2151
        _this.chipX=0;
        //$LASTPOS=93002161;//kernel.MapEditorOLD:2161
        _this.chipY=0;
        //$LASTPOS=93002171;//kernel.MapEditorOLD:2171
        _this.x=Tonyu.globals.$screenWidth-16;
        //$LASTPOS=93002191;//kernel.MapEditorOLD:2191
        _this.y=Tonyu.globals.$screenHeight-16;
        //$LASTPOS=93002212;//kernel.MapEditorOLD:2212
        while (true) {
          //$LASTPOS=93002230;//kernel.MapEditorOLD:2230
          _this.p=_this.mapp;
          //$LASTPOS=93002243;//kernel.MapEditorOLD:2243
          if (_this.getkey("e")==1) {
            //$LASTPOS=93002272;//kernel.MapEditorOLD:2272
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=93002306;//kernel.MapEditorOLD:2306
            _this.mode="erase";
            //$LASTPOS=93002329;//kernel.MapEditorOLD:2329
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=93002362;//kernel.MapEditorOLD:2362
          if (_this.getkey("s")==1) {
            //$LASTPOS=93002391;//kernel.MapEditorOLD:2391
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=93002425;//kernel.MapEditorOLD:2425
            if (_this.mode=="set") {
              //$LASTPOS=93002455;//kernel.MapEditorOLD:2455
              _this.mode="setOn";
              
            } else {
              //$LASTPOS=93002498;//kernel.MapEditorOLD:2498
              _this.mode="set";
              
            }
            //$LASTPOS=93002530;//kernel.MapEditorOLD:2530
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=93002563;//kernel.MapEditorOLD:2563
          if (_this.getkey("o")==1) {
            //$LASTPOS=93002592;//kernel.MapEditorOLD:2592
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=93002626;//kernel.MapEditorOLD:2626
            _this.mode="setOn";
            
          }
          //$LASTPOS=93002652;//kernel.MapEditorOLD:2652
          if (_this.getkey("g")==1) {
            //$LASTPOS=93002681;//kernel.MapEditorOLD:2681
            if (_this.mode!="get") {
              //$LASTPOS=93002711;//kernel.MapEditorOLD:2711
              _this.prevMode=_this.mode;
              //$LASTPOS=93002739;//kernel.MapEditorOLD:2739
              Tonyu.globals.$mp.scrollTo(0,0);
              //$LASTPOS=93002771;//kernel.MapEditorOLD:2771
              _this.mode="get";
              //$LASTPOS=93002796;//kernel.MapEditorOLD:2796
              _this.chipX=0;
              //$LASTPOS=93002818;//kernel.MapEditorOLD:2818
              _this.chipY=0;
              
            } else {
              //$LASTPOS=93002856;//kernel.MapEditorOLD:2856
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=93002894;//kernel.MapEditorOLD:2894
              _this.mode=_this.prevMode;
              
            }
            //$LASTPOS=93002929;//kernel.MapEditorOLD:2929
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=93002962;//kernel.MapEditorOLD:2962
          if (_this.getkey("p")==1) {
            //$LASTPOS=93003006;//kernel.MapEditorOLD:3006
            _this.saveFileName=prompt("input json file(*.json)","map.json");
            //$LASTPOS=93003495;//kernel.MapEditorOLD:3495
            _this.saveDataFile=_this.file("../maps/").rel(_this.saveFileName);
            //$LASTPOS=93003553;//kernel.MapEditorOLD:3553
            _this.data=[Tonyu.globals.$map.mapTable,Tonyu.globals.$map.mapOnTable];
            //$LASTPOS=93003668;//kernel.MapEditorOLD:3668
            _this.saveDataFile.obj(_this.data);
            //$LASTPOS=93003701;//kernel.MapEditorOLD:3701
            _this.print(_this.saveFileName+" Saved");
            
          }
          //$LASTPOS=93003793;//kernel.MapEditorOLD:3793
          if (_this.getkey("c")==1) {
            //$LASTPOS=93003822;//kernel.MapEditorOLD:3822
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=93003856;//kernel.MapEditorOLD:3856
            _this.mode="spuit";
            //$LASTPOS=93003879;//kernel.MapEditorOLD:3879
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=93003912;//kernel.MapEditorOLD:3912
          if (_this.mode!="get") {
            //$LASTPOS=93003938;//kernel.MapEditorOLD:3938
            if (_this.getkey("left")>0) {
              //$LASTPOS=93003959;//kernel.MapEditorOLD:3959
              _this.mx=_this.mx+8;
            }
            //$LASTPOS=93003977;//kernel.MapEditorOLD:3977
            if (_this.getkey("right")>0) {
              //$LASTPOS=93003999;//kernel.MapEditorOLD:3999
              _this.mx=_this.mx-8;
            }
            //$LASTPOS=93004017;//kernel.MapEditorOLD:4017
            if (_this.getkey("up")>0) {
              //$LASTPOS=93004036;//kernel.MapEditorOLD:4036
              _this.my=_this.my+8;
            }
            //$LASTPOS=93004054;//kernel.MapEditorOLD:4054
            if (_this.getkey("down")>0) {
              //$LASTPOS=93004075;//kernel.MapEditorOLD:4075
              _this.my=_this.my-8;
            }
            //$LASTPOS=93004093;//kernel.MapEditorOLD:4093
            Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
            
          } else {
            //$LASTPOS=93004136;//kernel.MapEditorOLD:4136
            if (_this.getkey("left")>0) {
              //$LASTPOS=93004157;//kernel.MapEditorOLD:4157
              _this.chipX=_this.chipX+8;
            }
            //$LASTPOS=93004181;//kernel.MapEditorOLD:4181
            if (_this.getkey("right")>0) {
              //$LASTPOS=93004203;//kernel.MapEditorOLD:4203
              _this.chipX=_this.chipX-8;
            }
            //$LASTPOS=93004227;//kernel.MapEditorOLD:4227
            if (_this.getkey("up")>0) {
              //$LASTPOS=93004246;//kernel.MapEditorOLD:4246
              _this.chipY=_this.chipY+8;
            }
            //$LASTPOS=93004270;//kernel.MapEditorOLD:4270
            if (_this.getkey("down")>0) {
              //$LASTPOS=93004291;//kernel.MapEditorOLD:4291
              _this.chipY=_this.chipY-8;
            }
            //$LASTPOS=93004315;//kernel.MapEditorOLD:4315
            Tonyu.globals.$mp.scrollTo(_this.chipX,_this.chipY);
            
          }
          //$LASTPOS=93004354;//kernel.MapEditorOLD:4354
          _this.panel.x=_this.panel.width/2-_this.mx;
          //$LASTPOS=93004385;//kernel.MapEditorOLD:4385
          _this.panel.y=_this.panel.height/2-_this.my;
          //$LASTPOS=93004417;//kernel.MapEditorOLD:4417
          if (_this.mode=="set"&&_this.getkey(1)>0) {
            //$LASTPOS=93004458;//kernel.MapEditorOLD:4458
            Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
            //$LASTPOS=93004507;//kernel.MapEditorOLD:4507
            Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
            
          } else {
            //$LASTPOS=93004558;//kernel.MapEditorOLD:4558
            if (_this.mode=="erase"&&_this.getkey(1)>0) {
              //$LASTPOS=93004601;//kernel.MapEditorOLD:4601
              Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
              
            } else {
              //$LASTPOS=93004650;//kernel.MapEditorOLD:4650
              if (_this.mode=="get"&&_this.getkey(1)>0) {
                //$LASTPOS=93004691;//kernel.MapEditorOLD:4691
                _this.mapp=Tonyu.globals.$mp.getAt(Tonyu.globals.$mouseX+_this.chipX,Tonyu.globals.$mouseY+_this.chipY);
                //$LASTPOS=93004745;//kernel.MapEditorOLD:4745
                _this.mode=_this.prevMode;
                //$LASTPOS=93004769;//kernel.MapEditorOLD:4769
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=93004803;//kernel.MapEditorOLD:4803
                _this.print(_this.mode+" mode");
                //$LASTPOS=93004833;//kernel.MapEditorOLD:4833
                _this.updateEx(10);
                
              } else {
                //$LASTPOS=93004858;//kernel.MapEditorOLD:4858
                if (_this.mode=="setOn"&&_this.getkey(1)>0) {
                  //$LASTPOS=93004901;//kernel.MapEditorOLD:4901
                  Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
                  
                } else {
                  //$LASTPOS=93004954;//kernel.MapEditorOLD:4954
                  if (_this.mode=="spuit"&&_this.getkey(1)>0) {
                    //$LASTPOS=93004997;//kernel.MapEditorOLD:4997
                    _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my);
                    //$LASTPOS=93005046;//kernel.MapEditorOLD:5046
                    _this.mode="set";
                    //$LASTPOS=93005067;//kernel.MapEditorOLD:5067
                    _this.print(_this.mode+" mode");
                    //$LASTPOS=93005097;//kernel.MapEditorOLD:5097
                    _this.updateEx(10);
                    
                  }
                }
              }
            }
          }
          //$LASTPOS=93005123;//kernel.MapEditorOLD:5123
          _this.update();
          
        }
      },
      fiber$main :function _trc_MapEditorOLD_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=93000032;//kernel.MapEditorOLD:32
        _this.loadMode=false;
        //$LASTPOS=93000049;//kernel.MapEditorOLD:49
        _this.print("Load Data?: Y or N");
        
        _thread.enter(function _trc_MapEditorOLD_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=93000079;//kernel.MapEditorOLD:79
            case 1:
              //$LASTPOS=93000097;//kernel.MapEditorOLD:97
              if (!(_this.getkey("y")>0)) { __pc=2     ; break; }
              //$LASTPOS=93000125;//kernel.MapEditorOLD:125
              _this.loadMode=true;
              __pc=5     ; break;
              
            case 2     :
              
              //$LASTPOS=93000168;//kernel.MapEditorOLD:168
              if (!(_this.getkey("n")>0)) { __pc=3     ; break; }
              //$LASTPOS=93000196;//kernel.MapEditorOLD:196
              _this.loadMode=false;
              __pc=5     ; break;
              
            case 3     :
              
              //$LASTPOS=93000240;//kernel.MapEditorOLD:240
              _this.fiber$update(_thread);
              __pc=4;return;
            case 4:
              
              __pc=1;break;
            case 5     :
              
              //$LASTPOS=93000254;//kernel.MapEditorOLD:254
              if (!(_this.loadMode)) { __pc=9     ; break; }
              //$LASTPOS=93000273;//kernel.MapEditorOLD:273
              _this.fileName=prompt("Input json file (*.json)","map.json");
              //$LASTPOS=93000334;//kernel.MapEditorOLD:334
              if (_this.fileName) {
                //$LASTPOS=93000357;//kernel.MapEditorOLD:357
                _this.mapDataFile=_this.file("../maps/").rel(_this.fileName);
                
              }
              //$LASTPOS=93000413;//kernel.MapEditorOLD:413
              if (!(_this.mapDataFile.obj())) { __pc=6     ; break; }
              {
                //$LASTPOS=93000445;//kernel.MapEditorOLD:445
                _this.baseData=_this.mapDataFile.obj();
              }
              __pc=8     ;break;
            case 6     :
              //$LASTPOS=93000494;//kernel.MapEditorOLD:494
              _this.fiber$file(_thread, _this.fileName);
              __pc=7;return;
            case 7:
              _this.mapDataFile=_thread.retVal;
              
              //$LASTPOS=93000531;//kernel.MapEditorOLD:531
              if (_this.mapDataFile.obj()) {
                //$LASTPOS=93000567;//kernel.MapEditorOLD:567
                _this.baseData=_this.mapDataFile.obj();
                
              }
            case 8     :
              
              //$LASTPOS=93000618;//kernel.MapEditorOLD:618
              if (_this.baseData==undefined) {
                //$LASTPOS=93000652;//kernel.MapEditorOLD:652
                _this.print("Load failed");
                //$LASTPOS=93000683;//kernel.MapEditorOLD:683
                _this.loadMode=false;
                
              } else {
                //$LASTPOS=93000710;//kernel.MapEditorOLD:710
                if (_this.baseData[0]&&_this.baseData[1]) {
                  //$LASTPOS=93000751;//kernel.MapEditorOLD:751
                  _this.mapData=_this.baseData[0];
                  //$LASTPOS=93000781;//kernel.MapEditorOLD:781
                  _this.mapOnData=_this.baseData[1];
                  
                }
              }
            case 9     :
              
              //$LASTPOS=93000815;//kernel.MapEditorOLD:815
              _this.fiber$update(_thread);
              __pc=10;return;
            case 10:
              
              //$LASTPOS=93001093;//kernel.MapEditorOLD:1093
              if (!(! _this.loadMode)) { __pc=12    ; break; }
              //$LASTPOS=93001113;//kernel.MapEditorOLD:1113
              _this.row=prompt("input row");
              //$LASTPOS=93001143;//kernel.MapEditorOLD:1143
              _this.fiber$update(_thread);
              __pc=11;return;
            case 11:
              
              //$LASTPOS=93001158;//kernel.MapEditorOLD:1158
              _this.col=prompt("input col");
              //$LASTPOS=93001188;//kernel.MapEditorOLD:1188
              _this.panel=new Tonyu.classes.kernel.Panel({width: _this.col*32,height: _this.row*32});
              //$LASTPOS=93001238;//kernel.MapEditorOLD:1238
              _this.panel.x=_this.panel.width/2+10;
              //$LASTPOS=93001269;//kernel.MapEditorOLD:1269
              _this.panel.y=_this.panel.height/2;
              //$LASTPOS=93001298;//kernel.MapEditorOLD:1298
              _this.panel.setFillStyle("cyan");
              //$LASTPOS=93001331;//kernel.MapEditorOLD:1331
              _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
              //$LASTPOS=93001382;//kernel.MapEditorOLD:1382
              Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.row,col: _this.col,chipWidth: 32,chipHeight: 32});
              __pc=13    ;break;
            case 12    :
              {
                //$LASTPOS=93001445;//kernel.MapEditorOLD:1445
                if (! _this.mapOnData) {
                  //$LASTPOS=93001470;//kernel.MapEditorOLD:1470
                  Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.mapData.length,col: _this.mapData[0].length,chipWidth: 32,chipHeight: 32,mapData: _this.mapData});
                  
                } else {
                  //$LASTPOS=93001582;//kernel.MapEditorOLD:1582
                  Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.mapData.length,col: _this.mapData[0].length,chipWidth: 32,chipHeight: 32,mapData: _this.mapData,mapOnData: _this.mapOnData});
                  
                }
                //$LASTPOS=93001695;//kernel.MapEditorOLD:1695
                _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*32,height: Tonyu.globals.$map.row*32,zOrder: 100});
                //$LASTPOS=93001766;//kernel.MapEditorOLD:1766
                _this.panel.x=_this.panel.width/2;
                //$LASTPOS=93001794;//kernel.MapEditorOLD:1794
                _this.panel.y=_this.panel.height/2;
                //$LASTPOS=93001823;//kernel.MapEditorOLD:1823
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=93001856;//kernel.MapEditorOLD:1856
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
              }
            case 13    :
              
              //$LASTPOS=93001906;//kernel.MapEditorOLD:1906
              Tonyu.globals.$mp=new Tonyu.classes.kernel.Map({row: 16,col: 8,chipWidth: 32,chipHeight: 32});
              //$LASTPOS=93001961;//kernel.MapEditorOLD:1961
              _this.counter=0;
              //$LASTPOS=93001973;//kernel.MapEditorOLD:1973
              //$LASTPOS=93001977;//kernel.MapEditorOLD:1977
              _this.i = 0;
              for (; _this.i<16 ; _this.i++) {
                {
                  //$LASTPOS=93002001;//kernel.MapEditorOLD:2001
                  //$LASTPOS=93002005;//kernel.MapEditorOLD:2005
                  _this.j = 0;
                  for (; _this.j<8 ; _this.j++) {
                    {
                      //$LASTPOS=93002032;//kernel.MapEditorOLD:2032
                      Tonyu.globals.$mp.set(_this.j,_this.i,Tonyu.globals.$pat_mapchip+_this.counter);
                      //$LASTPOS=93002076;//kernel.MapEditorOLD:2076
                      _this.counter++;
                    }
                  }
                }
              }
              //$LASTPOS=93002098;//kernel.MapEditorOLD:2098
              _this.mode="get";
              //$LASTPOS=93002111;//kernel.MapEditorOLD:2111
              _this.prevMode="set";
              //$LASTPOS=93002128;//kernel.MapEditorOLD:2128
              _this.mapp=0;
              //$LASTPOS=93002137;//kernel.MapEditorOLD:2137
              _this.mx=0;
              //$LASTPOS=93002144;//kernel.MapEditorOLD:2144
              _this.my=0;
              //$LASTPOS=93002151;//kernel.MapEditorOLD:2151
              _this.chipX=0;
              //$LASTPOS=93002161;//kernel.MapEditorOLD:2161
              _this.chipY=0;
              //$LASTPOS=93002171;//kernel.MapEditorOLD:2171
              _this.x=Tonyu.globals.$screenWidth-16;
              //$LASTPOS=93002191;//kernel.MapEditorOLD:2191
              _this.y=Tonyu.globals.$screenHeight-16;
              //$LASTPOS=93002212;//kernel.MapEditorOLD:2212
            case 14:
              //$LASTPOS=93002230;//kernel.MapEditorOLD:2230
              _this.p=_this.mapp;
              //$LASTPOS=93002243;//kernel.MapEditorOLD:2243
              if (_this.getkey("e")==1) {
                //$LASTPOS=93002272;//kernel.MapEditorOLD:2272
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=93002306;//kernel.MapEditorOLD:2306
                _this.mode="erase";
                //$LASTPOS=93002329;//kernel.MapEditorOLD:2329
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=93002362;//kernel.MapEditorOLD:2362
              if (_this.getkey("s")==1) {
                //$LASTPOS=93002391;//kernel.MapEditorOLD:2391
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=93002425;//kernel.MapEditorOLD:2425
                if (_this.mode=="set") {
                  //$LASTPOS=93002455;//kernel.MapEditorOLD:2455
                  _this.mode="setOn";
                  
                } else {
                  //$LASTPOS=93002498;//kernel.MapEditorOLD:2498
                  _this.mode="set";
                  
                }
                //$LASTPOS=93002530;//kernel.MapEditorOLD:2530
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=93002563;//kernel.MapEditorOLD:2563
              if (_this.getkey("o")==1) {
                //$LASTPOS=93002592;//kernel.MapEditorOLD:2592
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=93002626;//kernel.MapEditorOLD:2626
                _this.mode="setOn";
                
              }
              //$LASTPOS=93002652;//kernel.MapEditorOLD:2652
              if (_this.getkey("g")==1) {
                //$LASTPOS=93002681;//kernel.MapEditorOLD:2681
                if (_this.mode!="get") {
                  //$LASTPOS=93002711;//kernel.MapEditorOLD:2711
                  _this.prevMode=_this.mode;
                  //$LASTPOS=93002739;//kernel.MapEditorOLD:2739
                  Tonyu.globals.$mp.scrollTo(0,0);
                  //$LASTPOS=93002771;//kernel.MapEditorOLD:2771
                  _this.mode="get";
                  //$LASTPOS=93002796;//kernel.MapEditorOLD:2796
                  _this.chipX=0;
                  //$LASTPOS=93002818;//kernel.MapEditorOLD:2818
                  _this.chipY=0;
                  
                } else {
                  //$LASTPOS=93002856;//kernel.MapEditorOLD:2856
                  Tonyu.globals.$mp.scrollTo(1000,1000);
                  //$LASTPOS=93002894;//kernel.MapEditorOLD:2894
                  _this.mode=_this.prevMode;
                  
                }
                //$LASTPOS=93002929;//kernel.MapEditorOLD:2929
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=93002962;//kernel.MapEditorOLD:2962
              if (_this.getkey("p")==1) {
                //$LASTPOS=93003006;//kernel.MapEditorOLD:3006
                _this.saveFileName=prompt("input json file(*.json)","map.json");
                //$LASTPOS=93003495;//kernel.MapEditorOLD:3495
                _this.saveDataFile=_this.file("../maps/").rel(_this.saveFileName);
                //$LASTPOS=93003553;//kernel.MapEditorOLD:3553
                _this.data=[Tonyu.globals.$map.mapTable,Tonyu.globals.$map.mapOnTable];
                //$LASTPOS=93003668;//kernel.MapEditorOLD:3668
                _this.saveDataFile.obj(_this.data);
                //$LASTPOS=93003701;//kernel.MapEditorOLD:3701
                _this.print(_this.saveFileName+" Saved");
                
              }
              //$LASTPOS=93003793;//kernel.MapEditorOLD:3793
              if (_this.getkey("c")==1) {
                //$LASTPOS=93003822;//kernel.MapEditorOLD:3822
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=93003856;//kernel.MapEditorOLD:3856
                _this.mode="spuit";
                //$LASTPOS=93003879;//kernel.MapEditorOLD:3879
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=93003912;//kernel.MapEditorOLD:3912
              if (_this.mode!="get") {
                //$LASTPOS=93003938;//kernel.MapEditorOLD:3938
                if (_this.getkey("left")>0) {
                  //$LASTPOS=93003959;//kernel.MapEditorOLD:3959
                  _this.mx=_this.mx+8;
                }
                //$LASTPOS=93003977;//kernel.MapEditorOLD:3977
                if (_this.getkey("right")>0) {
                  //$LASTPOS=93003999;//kernel.MapEditorOLD:3999
                  _this.mx=_this.mx-8;
                }
                //$LASTPOS=93004017;//kernel.MapEditorOLD:4017
                if (_this.getkey("up")>0) {
                  //$LASTPOS=93004036;//kernel.MapEditorOLD:4036
                  _this.my=_this.my+8;
                }
                //$LASTPOS=93004054;//kernel.MapEditorOLD:4054
                if (_this.getkey("down")>0) {
                  //$LASTPOS=93004075;//kernel.MapEditorOLD:4075
                  _this.my=_this.my-8;
                }
                //$LASTPOS=93004093;//kernel.MapEditorOLD:4093
                Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
                
              } else {
                //$LASTPOS=93004136;//kernel.MapEditorOLD:4136
                if (_this.getkey("left")>0) {
                  //$LASTPOS=93004157;//kernel.MapEditorOLD:4157
                  _this.chipX=_this.chipX+8;
                }
                //$LASTPOS=93004181;//kernel.MapEditorOLD:4181
                if (_this.getkey("right")>0) {
                  //$LASTPOS=93004203;//kernel.MapEditorOLD:4203
                  _this.chipX=_this.chipX-8;
                }
                //$LASTPOS=93004227;//kernel.MapEditorOLD:4227
                if (_this.getkey("up")>0) {
                  //$LASTPOS=93004246;//kernel.MapEditorOLD:4246
                  _this.chipY=_this.chipY+8;
                }
                //$LASTPOS=93004270;//kernel.MapEditorOLD:4270
                if (_this.getkey("down")>0) {
                  //$LASTPOS=93004291;//kernel.MapEditorOLD:4291
                  _this.chipY=_this.chipY-8;
                }
                //$LASTPOS=93004315;//kernel.MapEditorOLD:4315
                Tonyu.globals.$mp.scrollTo(_this.chipX,_this.chipY);
                
              }
              //$LASTPOS=93004354;//kernel.MapEditorOLD:4354
              _this.panel.x=_this.panel.width/2-_this.mx;
              //$LASTPOS=93004385;//kernel.MapEditorOLD:4385
              _this.panel.y=_this.panel.height/2-_this.my;
              //$LASTPOS=93004417;//kernel.MapEditorOLD:4417
              if (!(_this.mode=="set"&&_this.getkey(1)>0)) { __pc=15    ; break; }
              {
                //$LASTPOS=93004458;//kernel.MapEditorOLD:4458
                Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
                //$LASTPOS=93004507;//kernel.MapEditorOLD:4507
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
              }
              __pc=25    ;break;
            case 15    :
              //$LASTPOS=93004558;//kernel.MapEditorOLD:4558
              if (!(_this.mode=="erase"&&_this.getkey(1)>0)) { __pc=16    ; break; }
              {
                //$LASTPOS=93004601;//kernel.MapEditorOLD:4601
                Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
              }
              __pc=24    ;break;
            case 16    :
              //$LASTPOS=93004650;//kernel.MapEditorOLD:4650
              if (!(_this.mode=="get"&&_this.getkey(1)>0)) { __pc=18    ; break; }
              //$LASTPOS=93004691;//kernel.MapEditorOLD:4691
              _this.mapp=Tonyu.globals.$mp.getAt(Tonyu.globals.$mouseX+_this.chipX,Tonyu.globals.$mouseY+_this.chipY);
              //$LASTPOS=93004745;//kernel.MapEditorOLD:4745
              _this.mode=_this.prevMode;
              //$LASTPOS=93004769;//kernel.MapEditorOLD:4769
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=93004803;//kernel.MapEditorOLD:4803
              _this.print(_this.mode+" mode");
              //$LASTPOS=93004833;//kernel.MapEditorOLD:4833
              _this.fiber$updateEx(_thread, 10);
              __pc=17;return;
            case 17:
              
              __pc=23    ;break;
            case 18    :
              //$LASTPOS=93004858;//kernel.MapEditorOLD:4858
              if (!(_this.mode=="setOn"&&_this.getkey(1)>0)) { __pc=19    ; break; }
              {
                //$LASTPOS=93004901;//kernel.MapEditorOLD:4901
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
              }
              __pc=22    ;break;
            case 19    :
              //$LASTPOS=93004954;//kernel.MapEditorOLD:4954
              if (!(_this.mode=="spuit"&&_this.getkey(1)>0)) { __pc=21    ; break; }
              //$LASTPOS=93004997;//kernel.MapEditorOLD:4997
              _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my);
              //$LASTPOS=93005046;//kernel.MapEditorOLD:5046
              _this.mode="set";
              //$LASTPOS=93005067;//kernel.MapEditorOLD:5067
              _this.print(_this.mode+" mode");
              //$LASTPOS=93005097;//kernel.MapEditorOLD:5097
              _this.fiber$updateEx(_thread, 10);
              __pc=20;return;
            case 20:
              
            case 21    :
              
            case 22    :
              
            case 23    :
              
            case 24    :
              
            case 25    :
              
              //$LASTPOS=93005123;//kernel.MapEditorOLD:5123
              _this.fiber$update(_thread);
              __pc=26;return;
            case 26:
              
              __pc=14;break;
            case 27    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false}},"fields":{"i":{},"j":{},"loadMode":{},"fileName":{},"mapDataFile":{},"baseData":{},"mapData":{},"mapOnData":{},"row":{},"col":{},"panel":{},"counter":{},"mode":{},"prevMode":{},"mapp":{},"mx":{},"my":{},"chipX":{},"chipY":{},"saveFileName":{},"saveDataFile":{},"data":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.MapEditorOLD2',
  shortName: 'MapEditorOLD2',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_MapEditorOLD2_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=94000032;//kernel.MapEditorOLD2:32
        Tonyu.globals.$Screen.resize(480,640);
        //$LASTPOS=94000058;//kernel.MapEditorOLD2:58
        _this.loadMode=false;
        //$LASTPOS=94000075;//kernel.MapEditorOLD2:75
        _this.fileExist=false;
        //$LASTPOS=94000093;//kernel.MapEditorOLD2:93
        _this.print("map file(s)");
        //$LASTPOS=94000116;//kernel.MapEditorOLD2:116
        _this.fileList=_this.file("../maps/");
        //$LASTPOS=94000144;//kernel.MapEditorOLD2:144
        if (_this.fileList.exists()) {
          //$LASTPOS=94000168;//kernel.MapEditorOLD2:168
          _this.fileList.recursive((function a(f) {
            
            //$LASTPOS=94000207;//kernel.MapEditorOLD2:207
            f=f+"";
            //$LASTPOS=94000220;//kernel.MapEditorOLD2:220
            _this.fNames=f.split("/");
            //$LASTPOS=94000246;//kernel.MapEditorOLD2:246
            _this.print(_this.fNames[_this.fNames.length-1]);
            //$LASTPOS=94000283;//kernel.MapEditorOLD2:283
            _this.fileExist=true;
          }));
          
        }
        //$LASTPOS=94000308;//kernel.MapEditorOLD2:308
        if (_this.fileExist) {
          //$LASTPOS=94000328;//kernel.MapEditorOLD2:328
          _this.print("Load Data?: Y or N");
          //$LASTPOS=94000362;//kernel.MapEditorOLD2:362
          while (true) {
            //$LASTPOS=94000384;//kernel.MapEditorOLD2:384
            if (_this.getkey("y")>0) {
              //$LASTPOS=94000416;//kernel.MapEditorOLD2:416
              _this.loadMode=true;
              break;
              
              
            }
            //$LASTPOS=94000471;//kernel.MapEditorOLD2:471
            if (_this.getkey("n")>0) {
              //$LASTPOS=94000503;//kernel.MapEditorOLD2:503
              _this.loadMode=false;
              break;
              
              
            }
            //$LASTPOS=94000559;//kernel.MapEditorOLD2:559
            _this.update();
            
          }
          //$LASTPOS=94000581;//kernel.MapEditorOLD2:581
          if (_this.loadMode) {
            //$LASTPOS=94000604;//kernel.MapEditorOLD2:604
            _this.fileName=prompt("Input json file (*.json)","map.json");
            //$LASTPOS=94000669;//kernel.MapEditorOLD2:669
            if (_this.fileName) {
              //$LASTPOS=94000696;//kernel.MapEditorOLD2:696
              _this.mapDataFile=_this.file("../maps/").rel(_this.fileName);
              
            }
            //$LASTPOS=94000760;//kernel.MapEditorOLD2:760
            if (_this.mapDataFile.obj()) {
              //$LASTPOS=94000796;//kernel.MapEditorOLD2:796
              _this.baseData=_this.mapDataFile.obj();
              //$LASTPOS=94000837;//kernel.MapEditorOLD2:837
              _this.loadedFile=_this.fileName;
              
            } else {
              //$LASTPOS=94000887;//kernel.MapEditorOLD2:887
              _this.mapDataFile=_this.file(_this.fileName);
              //$LASTPOS=94000928;//kernel.MapEditorOLD2:928
              if (_this.mapDataFile.obj()) {
                //$LASTPOS=94000968;//kernel.MapEditorOLD2:968
                _this.baseData=_this.mapDataFile.obj();
                //$LASTPOS=94001013;//kernel.MapEditorOLD2:1013
                _this.loadedFile=_this.fileName;
                
              }
              
            }
            //$LASTPOS=94001069;//kernel.MapEditorOLD2:1069
            if (_this.baseData==undefined) {
              //$LASTPOS=94001107;//kernel.MapEditorOLD2:1107
              _this.print("Load failed");
              //$LASTPOS=94001142;//kernel.MapEditorOLD2:1142
              _this.loadMode=false;
              
            } else {
              //$LASTPOS=94001173;//kernel.MapEditorOLD2:1173
              if (_this.baseData[0]&&_this.baseData[1]) {
                //$LASTPOS=94001218;//kernel.MapEditorOLD2:1218
                _this.mapData=_this.baseData[0];
                //$LASTPOS=94001252;//kernel.MapEditorOLD2:1252
                _this.mapOnData=_this.baseData[1];
                //$LASTPOS=94001288;//kernel.MapEditorOLD2:1288
                if (_this.baseData.length>2) {
                  //$LASTPOS=94001328;//kernel.MapEditorOLD2:1328
                  _this.chipWidth=_this.baseData[_this.baseData.length-2];
                  //$LASTPOS=94001384;//kernel.MapEditorOLD2:1384
                  _this.chipHeight=_this.baseData[_this.baseData.length-1];
                  
                }
                
              }
            }
            
          }
          
        }
        //$LASTPOS=94001461;//kernel.MapEditorOLD2:1461
        _this.update();
        //$LASTPOS=94001739;//kernel.MapEditorOLD2:1739
        if (! _this.loadMode) {
          //$LASTPOS=94001759;//kernel.MapEditorOLD2:1759
          _this.row=prompt("input row");
          //$LASTPOS=94001789;//kernel.MapEditorOLD2:1789
          _this.col=prompt("input col");
          //$LASTPOS=94001819;//kernel.MapEditorOLD2:1819
          _this.chipWidth=prompt("input chipWidth");
          //$LASTPOS=94001861;//kernel.MapEditorOLD2:1861
          _this.chipHeight=prompt("input chipHeight");
          //$LASTPOS=94001905;//kernel.MapEditorOLD2:1905
          _this.panel=new Tonyu.classes.kernel.Panel({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
          //$LASTPOS=94001970;//kernel.MapEditorOLD2:1970
          _this.panel.x=_this.panel.width/2+40;
          //$LASTPOS=94002001;//kernel.MapEditorOLD2:2001
          _this.panel.y=_this.panel.height/2+40;
          //$LASTPOS=94002033;//kernel.MapEditorOLD2:2033
          _this.panel.setFillStyle("cyan");
          //$LASTPOS=94002066;//kernel.MapEditorOLD2:2066
          _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
          //$LASTPOS=94002117;//kernel.MapEditorOLD2:2117
          Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.row,col: _this.col,chipWidth: _this.chipWidth,chipHeight: _this.chipHeight});
          
        } else {
          //$LASTPOS=94002428;//kernel.MapEditorOLD2:2428
          Tonyu.globals.$map=new Tonyu.classes.kernel.Map({chipWidth: 32,chipHeight: 32});
          //$LASTPOS=94002475;//kernel.MapEditorOLD2:2475
          Tonyu.globals.$map.load(_this.fileName);
          //$LASTPOS=94002501;//kernel.MapEditorOLD2:2501
          _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
          //$LASTPOS=94002597;//kernel.MapEditorOLD2:2597
          _this.panel.x=_this.panel.width/2+40;
          //$LASTPOS=94002628;//kernel.MapEditorOLD2:2628
          _this.panel.y=_this.panel.height/2+40;
          //$LASTPOS=94002660;//kernel.MapEditorOLD2:2660
          _this.panel.setFillStyle("cyan");
          //$LASTPOS=94002693;//kernel.MapEditorOLD2:2693
          _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
          
        }
        //$LASTPOS=94002743;//kernel.MapEditorOLD2:2743
        _this.mIW=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip].image.width;
        //$LASTPOS=94002799;//kernel.MapEditorOLD2:2799
        _this.mIH=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip].image.height;
        //$LASTPOS=94002856;//kernel.MapEditorOLD2:2856
        _this.mCW=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip+0].width;
        //$LASTPOS=94002908;//kernel.MapEditorOLD2:2908
        _this.mCH=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip+0].height;
        //$LASTPOS=94002961;//kernel.MapEditorOLD2:2961
        Tonyu.globals.$mp=new Tonyu.classes.kernel.Map({row: _this.floor(_this.mIH/_this.mCH),col: _this.floor(_this.mIW/_this.mCW),chipWidth: _this.mCW,chipHeight: _this.mCH});
        //$LASTPOS=94003043;//kernel.MapEditorOLD2:3043
        _this.counter=0;
        //$LASTPOS=94003055;//kernel.MapEditorOLD2:3055
        //$LASTPOS=94003059;//kernel.MapEditorOLD2:3059
        _this.i = 0;
        for (; _this.i<Tonyu.globals.$mp.row ; _this.i++) {
          {
            //$LASTPOS=94003088;//kernel.MapEditorOLD2:3088
            //$LASTPOS=94003092;//kernel.MapEditorOLD2:3092
            _this.j = 0;
            for (; _this.j<Tonyu.globals.$mp.col ; _this.j++) {
              {
                //$LASTPOS=94003125;//kernel.MapEditorOLD2:3125
                Tonyu.globals.$mp.set(_this.j,_this.i,Tonyu.globals.$pat_mapchip+_this.counter);
                //$LASTPOS=94003169;//kernel.MapEditorOLD2:3169
                _this.counter++;
              }
            }
          }
        }
        //$LASTPOS=94003191;//kernel.MapEditorOLD2:3191
        _this.drawPanel();
        //$LASTPOS=94003205;//kernel.MapEditorOLD2:3205
        _this.mode="get";
        //$LASTPOS=94003218;//kernel.MapEditorOLD2:3218
        _this.prevMode="set";
        //$LASTPOS=94003235;//kernel.MapEditorOLD2:3235
        _this.mapp=0;
        //$LASTPOS=94003244;//kernel.MapEditorOLD2:3244
        _this.mx=- 40;
        //$LASTPOS=94003253;//kernel.MapEditorOLD2:3253
        _this.my=- 40;
        //$LASTPOS=94003262;//kernel.MapEditorOLD2:3262
        _this.chipX=- 40;
        //$LASTPOS=94003274;//kernel.MapEditorOLD2:3274
        _this.chipY=- 40;
        //$LASTPOS=94003286;//kernel.MapEditorOLD2:3286
        _this.x=Tonyu.globals.$screenWidth-_this.chipWidth/2;
        //$LASTPOS=94003315;//kernel.MapEditorOLD2:3315
        _this.y=Tonyu.globals.$screenHeight-_this.chipHeight/2;
        //$LASTPOS=94003346;//kernel.MapEditorOLD2:3346
        Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
        //$LASTPOS=94003369;//kernel.MapEditorOLD2:3369
        while (true) {
          //$LASTPOS=94003387;//kernel.MapEditorOLD2:3387
          _this.p=_this.mapp;
          //$LASTPOS=94003400;//kernel.MapEditorOLD2:3400
          if (_this.getkey("e")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640)) {
            //$LASTPOS=94003539;//kernel.MapEditorOLD2:3539
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=94003573;//kernel.MapEditorOLD2:3573
            _this.mode="erase";
            //$LASTPOS=94003596;//kernel.MapEditorOLD2:3596
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=94003629;//kernel.MapEditorOLD2:3629
          if (_this.getkey("s")==1) {
            //$LASTPOS=94003658;//kernel.MapEditorOLD2:3658
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=94003692;//kernel.MapEditorOLD2:3692
            if (_this.mode=="set") {
              //$LASTPOS=94003722;//kernel.MapEditorOLD2:3722
              _this.mode="setOn";
              
            } else {
              //$LASTPOS=94003765;//kernel.MapEditorOLD2:3765
              _this.mode="set";
              
            }
            //$LASTPOS=94003797;//kernel.MapEditorOLD2:3797
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=94003830;//kernel.MapEditorOLD2:3830
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
            //$LASTPOS=94003949;//kernel.MapEditorOLD2:3949
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=94003983;//kernel.MapEditorOLD2:3983
            _this.mode="set";
            //$LASTPOS=94004004;//kernel.MapEditorOLD2:4004
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=94004037;//kernel.MapEditorOLD2:4037
          if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
            //$LASTPOS=94004158;//kernel.MapEditorOLD2:4158
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=94004192;//kernel.MapEditorOLD2:4192
            _this.mode="setOn";
            //$LASTPOS=94004215;//kernel.MapEditorOLD2:4215
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=94004341;//kernel.MapEditorOLD2:4341
          if (_this.getkey("g")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>240&&Tonyu.globals.$touches[0].x<360&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) {
            //$LASTPOS=94004482;//kernel.MapEditorOLD2:4482
            if (_this.mode!="get") {
              //$LASTPOS=94004512;//kernel.MapEditorOLD2:4512
              _this.prevMode=_this.mode;
              //$LASTPOS=94004540;//kernel.MapEditorOLD2:4540
              Tonyu.globals.$mp.scrollTo(- 40,- 40);
              //$LASTPOS=94004576;//kernel.MapEditorOLD2:4576
              _this.mode="get";
              //$LASTPOS=94004601;//kernel.MapEditorOLD2:4601
              _this.chipX=- 40;
              //$LASTPOS=94004625;//kernel.MapEditorOLD2:4625
              _this.chipY=- 40;
              
            } else {
              //$LASTPOS=94004665;//kernel.MapEditorOLD2:4665
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=94004703;//kernel.MapEditorOLD2:4703
              _this.mode=_this.prevMode;
              
            }
            //$LASTPOS=94004738;//kernel.MapEditorOLD2:4738
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=94004771;//kernel.MapEditorOLD2:4771
          if (_this.getkey("p")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>360&&Tonyu.globals.$touches[0].x<480&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) {
            //$LASTPOS=94004927;//kernel.MapEditorOLD2:4927
            if (_this.loadedFile) {
              //$LASTPOS=94004956;//kernel.MapEditorOLD2:4956
              _this.saveFileName=prompt("input json file(*.json)",_this.loadedFile);
              
            } else {
              //$LASTPOS=94005044;//kernel.MapEditorOLD2:5044
              _this.saveFileName=prompt("input json file(*.json)","map.json");
              
            }
            //$LASTPOS=94005544;//kernel.MapEditorOLD2:5544
            if (_this.saveFileName) {
              //$LASTPOS=94005575;//kernel.MapEditorOLD2:5575
              _this.saveDataFile=_this.file("../maps/").rel(_this.saveFileName);
              //$LASTPOS=94005637;//kernel.MapEditorOLD2:5637
              _this.data=[Tonyu.globals.$map.mapTable,Tonyu.globals.$map.mapOnTable,Tonyu.globals.$map.chipWidth,Tonyu.globals.$map.chipHeight];
              //$LASTPOS=94005799;//kernel.MapEditorOLD2:5799
              _this.saveDataFile.obj(_this.data);
              //$LASTPOS=94005836;//kernel.MapEditorOLD2:5836
              _this.print(_this.saveFileName+" Saved");
              
            }
            
          }
          //$LASTPOS=94005943;//kernel.MapEditorOLD2:5943
          if (_this.getkey("c")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640)) {
            //$LASTPOS=94006084;//kernel.MapEditorOLD2:6084
            Tonyu.globals.$mp.scrollTo(1000,1000);
            //$LASTPOS=94006118;//kernel.MapEditorOLD2:6118
            _this.mode="copy";
            //$LASTPOS=94006140;//kernel.MapEditorOLD2:6140
            _this.print(_this.mode+" mode");
            
          }
          //$LASTPOS=94006173;//kernel.MapEditorOLD2:6173
          if (_this.mode!="get") {
            //$LASTPOS=94006199;//kernel.MapEditorOLD2:6199
            if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=94006305;//kernel.MapEditorOLD2:6305
              _this.mx=_this.mx+8;
            }
            //$LASTPOS=94006323;//kernel.MapEditorOLD2:6323
            if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=94006454;//kernel.MapEditorOLD2:6454
              _this.mx=_this.mx-8;
            }
            //$LASTPOS=94006472;//kernel.MapEditorOLD2:6472
            if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
              //$LASTPOS=94006585;//kernel.MapEditorOLD2:6585
              _this.my=_this.my+8;
            }
            //$LASTPOS=94006603;//kernel.MapEditorOLD2:6603
            if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
              //$LASTPOS=94006738;//kernel.MapEditorOLD2:6738
              _this.my=_this.my-8;
            }
            //$LASTPOS=94006756;//kernel.MapEditorOLD2:6756
            Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
            
          } else {
            //$LASTPOS=94006799;//kernel.MapEditorOLD2:6799
            if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=94006905;//kernel.MapEditorOLD2:6905
              _this.chipX=_this.chipX+8;
            }
            //$LASTPOS=94006929;//kernel.MapEditorOLD2:6929
            if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
              //$LASTPOS=94007060;//kernel.MapEditorOLD2:7060
              _this.chipX=_this.chipX-8;
            }
            //$LASTPOS=94007084;//kernel.MapEditorOLD2:7084
            if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
              //$LASTPOS=94007197;//kernel.MapEditorOLD2:7197
              _this.chipY=_this.chipY+8;
            }
            //$LASTPOS=94007221;//kernel.MapEditorOLD2:7221
            if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
              //$LASTPOS=94007356;//kernel.MapEditorOLD2:7356
              _this.chipY=_this.chipY-8;
            }
            //$LASTPOS=94007380;//kernel.MapEditorOLD2:7380
            Tonyu.globals.$mp.scrollTo(_this.chipX,_this.chipY);
            
          }
          //$LASTPOS=94007453;//kernel.MapEditorOLD2:7453
          if (_this.getkey("i")==1) {
            //$LASTPOS=94007482;//kernel.MapEditorOLD2:7482
            Tonyu.globals.$map.chipWidth+=4;
            //$LASTPOS=94007510;//kernel.MapEditorOLD2:7510
            Tonyu.globals.$map.chipHeight+=4;
            //$LASTPOS=94007539;//kernel.MapEditorOLD2:7539
            Tonyu.globals.$map.redrawMap();
            //$LASTPOS=94007566;//kernel.MapEditorOLD2:7566
            _this.panel.die();
            //$LASTPOS=94007588;//kernel.MapEditorOLD2:7588
            _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
            //$LASTPOS=94007688;//kernel.MapEditorOLD2:7688
            _this.panel.x=_this.panel.width/2+40;
            //$LASTPOS=94007723;//kernel.MapEditorOLD2:7723
            _this.panel.y=_this.panel.height/2+40;
            //$LASTPOS=94007759;//kernel.MapEditorOLD2:7759
            _this.panel.setFillStyle("cyan");
            //$LASTPOS=94007796;//kernel.MapEditorOLD2:7796
            _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
            
          }
          //$LASTPOS=94007854;//kernel.MapEditorOLD2:7854
          if (_this.getkey("o")==1) {
            //$LASTPOS=94007883;//kernel.MapEditorOLD2:7883
            Tonyu.globals.$map.chipWidth-=4;
            //$LASTPOS=94007911;//kernel.MapEditorOLD2:7911
            Tonyu.globals.$map.chipHeight-=4;
            //$LASTPOS=94007940;//kernel.MapEditorOLD2:7940
            Tonyu.globals.$map.redrawMap();
            //$LASTPOS=94007967;//kernel.MapEditorOLD2:7967
            _this.panel.die();
            //$LASTPOS=94007989;//kernel.MapEditorOLD2:7989
            _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
            //$LASTPOS=94008089;//kernel.MapEditorOLD2:8089
            _this.panel.x=_this.panel.width/2+40;
            //$LASTPOS=94008124;//kernel.MapEditorOLD2:8124
            _this.panel.y=_this.panel.height/2+40;
            //$LASTPOS=94008160;//kernel.MapEditorOLD2:8160
            _this.panel.setFillStyle("cyan");
            //$LASTPOS=94008197;//kernel.MapEditorOLD2:8197
            _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
            
          }
          //$LASTPOS=94008289;//kernel.MapEditorOLD2:8289
          _this.panel.x=_this.panel.width/2-_this.mx;
          //$LASTPOS=94008320;//kernel.MapEditorOLD2:8320
          _this.panel.y=_this.panel.height/2-_this.my;
          //$LASTPOS=94008352;//kernel.MapEditorOLD2:8352
          if (_this.mode=="set"&&_this.getkey(1)>0&&_this.inRect()) {
            //$LASTPOS=94008405;//kernel.MapEditorOLD2:8405
            Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
            //$LASTPOS=94008454;//kernel.MapEditorOLD2:8454
            Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
            
          } else {
            //$LASTPOS=94008505;//kernel.MapEditorOLD2:8505
            if (_this.mode=="erase"&&_this.getkey(1)>0&&_this.inRect()) {
              //$LASTPOS=94008560;//kernel.MapEditorOLD2:8560
              Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
              
            } else {
              //$LASTPOS=94008609;//kernel.MapEditorOLD2:8609
              if (_this.mode=="get"&&_this.getkey(1)>0&&_this.inRect()) {
                //$LASTPOS=94008662;//kernel.MapEditorOLD2:8662
                _this.mapp=Tonyu.globals.$mp.getAt(Tonyu.globals.$mouseX+_this.chipX,Tonyu.globals.$mouseY+_this.chipY);
                //$LASTPOS=94008716;//kernel.MapEditorOLD2:8716
                _this.mode=_this.prevMode;
                //$LASTPOS=94008740;//kernel.MapEditorOLD2:8740
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=94008774;//kernel.MapEditorOLD2:8774
                _this.print(_this.mode+" mode");
                //$LASTPOS=94008804;//kernel.MapEditorOLD2:8804
                _this.updateEx(10);
                
              } else {
                //$LASTPOS=94008829;//kernel.MapEditorOLD2:8829
                if (_this.mode=="setOn"&&_this.getkey(1)>0&&_this.inRect()) {
                  //$LASTPOS=94008884;//kernel.MapEditorOLD2:8884
                  Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
                  
                } else {
                  //$LASTPOS=94008937;//kernel.MapEditorOLD2:8937
                  if (_this.mode=="copy"&&_this.getkey(1)>0&&_this.inRect()) {
                    //$LASTPOS=94008991;//kernel.MapEditorOLD2:8991
                    _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my);
                    //$LASTPOS=94009040;//kernel.MapEditorOLD2:9040
                    _this.mode="set";
                    //$LASTPOS=94009061;//kernel.MapEditorOLD2:9061
                    _this.print(_this.mode+" mode");
                    //$LASTPOS=94009091;//kernel.MapEditorOLD2:9091
                    _this.updateEx(10);
                    
                  }
                }
              }
            }
          }
          //$LASTPOS=94009117;//kernel.MapEditorOLD2:9117
          _this.update();
          
        }
      },
      fiber$main :function _trc_MapEditorOLD2_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=94000032;//kernel.MapEditorOLD2:32
        Tonyu.globals.$Screen.resize(480,640);
        //$LASTPOS=94000058;//kernel.MapEditorOLD2:58
        _this.loadMode=false;
        //$LASTPOS=94000075;//kernel.MapEditorOLD2:75
        _this.fileExist=false;
        //$LASTPOS=94000093;//kernel.MapEditorOLD2:93
        _this.print("map file(s)");
        
        _thread.enter(function _trc_MapEditorOLD2_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=94000116;//kernel.MapEditorOLD2:116
              _this.fiber$file(_thread, "../maps/");
              __pc=1;return;
            case 1:
              _this.fileList=_thread.retVal;
              
              //$LASTPOS=94000144;//kernel.MapEditorOLD2:144
              if (_this.fileList.exists()) {
                //$LASTPOS=94000168;//kernel.MapEditorOLD2:168
                _this.fileList.recursive((function a(f) {
                  
                  //$LASTPOS=94000207;//kernel.MapEditorOLD2:207
                  f=f+"";
                  //$LASTPOS=94000220;//kernel.MapEditorOLD2:220
                  _this.fNames=f.split("/");
                  //$LASTPOS=94000246;//kernel.MapEditorOLD2:246
                  _this.print(_this.fNames[_this.fNames.length-1]);
                  //$LASTPOS=94000283;//kernel.MapEditorOLD2:283
                  _this.fileExist=true;
                }));
                
              }
              //$LASTPOS=94000308;//kernel.MapEditorOLD2:308
              if (!(_this.fileExist)) { __pc=11    ; break; }
              //$LASTPOS=94000328;//kernel.MapEditorOLD2:328
              _this.print("Load Data?: Y or N");
              //$LASTPOS=94000362;//kernel.MapEditorOLD2:362
            case 2:
              //$LASTPOS=94000384;//kernel.MapEditorOLD2:384
              if (!(_this.getkey("y")>0)) { __pc=3     ; break; }
              //$LASTPOS=94000416;//kernel.MapEditorOLD2:416
              _this.loadMode=true;
              __pc=6     ; break;
              
            case 3     :
              
              //$LASTPOS=94000471;//kernel.MapEditorOLD2:471
              if (!(_this.getkey("n")>0)) { __pc=4     ; break; }
              //$LASTPOS=94000503;//kernel.MapEditorOLD2:503
              _this.loadMode=false;
              __pc=6     ; break;
              
            case 4     :
              
              //$LASTPOS=94000559;//kernel.MapEditorOLD2:559
              _this.fiber$update(_thread);
              __pc=5;return;
            case 5:
              
              __pc=2;break;
            case 6     :
              
              //$LASTPOS=94000581;//kernel.MapEditorOLD2:581
              if (!(_this.loadMode)) { __pc=10    ; break; }
              //$LASTPOS=94000604;//kernel.MapEditorOLD2:604
              _this.fileName=prompt("Input json file (*.json)","map.json");
              //$LASTPOS=94000669;//kernel.MapEditorOLD2:669
              if (_this.fileName) {
                //$LASTPOS=94000696;//kernel.MapEditorOLD2:696
                _this.mapDataFile=_this.file("../maps/").rel(_this.fileName);
                
              }
              //$LASTPOS=94000760;//kernel.MapEditorOLD2:760
              if (!(_this.mapDataFile.obj())) { __pc=7     ; break; }
              {
                //$LASTPOS=94000796;//kernel.MapEditorOLD2:796
                _this.baseData=_this.mapDataFile.obj();
                //$LASTPOS=94000837;//kernel.MapEditorOLD2:837
                _this.loadedFile=_this.fileName;
              }
              __pc=9     ;break;
            case 7     :
              //$LASTPOS=94000887;//kernel.MapEditorOLD2:887
              _this.fiber$file(_thread, _this.fileName);
              __pc=8;return;
            case 8:
              _this.mapDataFile=_thread.retVal;
              
              //$LASTPOS=94000928;//kernel.MapEditorOLD2:928
              if (_this.mapDataFile.obj()) {
                //$LASTPOS=94000968;//kernel.MapEditorOLD2:968
                _this.baseData=_this.mapDataFile.obj();
                //$LASTPOS=94001013;//kernel.MapEditorOLD2:1013
                _this.loadedFile=_this.fileName;
                
              }
            case 9     :
              
              //$LASTPOS=94001069;//kernel.MapEditorOLD2:1069
              if (_this.baseData==undefined) {
                //$LASTPOS=94001107;//kernel.MapEditorOLD2:1107
                _this.print("Load failed");
                //$LASTPOS=94001142;//kernel.MapEditorOLD2:1142
                _this.loadMode=false;
                
              } else {
                //$LASTPOS=94001173;//kernel.MapEditorOLD2:1173
                if (_this.baseData[0]&&_this.baseData[1]) {
                  //$LASTPOS=94001218;//kernel.MapEditorOLD2:1218
                  _this.mapData=_this.baseData[0];
                  //$LASTPOS=94001252;//kernel.MapEditorOLD2:1252
                  _this.mapOnData=_this.baseData[1];
                  //$LASTPOS=94001288;//kernel.MapEditorOLD2:1288
                  if (_this.baseData.length>2) {
                    //$LASTPOS=94001328;//kernel.MapEditorOLD2:1328
                    _this.chipWidth=_this.baseData[_this.baseData.length-2];
                    //$LASTPOS=94001384;//kernel.MapEditorOLD2:1384
                    _this.chipHeight=_this.baseData[_this.baseData.length-1];
                    
                  }
                  
                }
              }
            case 10    :
              
            case 11    :
              
              //$LASTPOS=94001461;//kernel.MapEditorOLD2:1461
              _this.fiber$update(_thread);
              __pc=12;return;
            case 12:
              
              //$LASTPOS=94001739;//kernel.MapEditorOLD2:1739
              if (! _this.loadMode) {
                //$LASTPOS=94001759;//kernel.MapEditorOLD2:1759
                _this.row=prompt("input row");
                //$LASTPOS=94001789;//kernel.MapEditorOLD2:1789
                _this.col=prompt("input col");
                //$LASTPOS=94001819;//kernel.MapEditorOLD2:1819
                _this.chipWidth=prompt("input chipWidth");
                //$LASTPOS=94001861;//kernel.MapEditorOLD2:1861
                _this.chipHeight=prompt("input chipHeight");
                //$LASTPOS=94001905;//kernel.MapEditorOLD2:1905
                _this.panel=new Tonyu.classes.kernel.Panel({width: _this.col*_this.chipWidth,height: _this.row*_this.chipHeight});
                //$LASTPOS=94001970;//kernel.MapEditorOLD2:1970
                _this.panel.x=_this.panel.width/2+40;
                //$LASTPOS=94002001;//kernel.MapEditorOLD2:2001
                _this.panel.y=_this.panel.height/2+40;
                //$LASTPOS=94002033;//kernel.MapEditorOLD2:2033
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=94002066;//kernel.MapEditorOLD2:2066
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
                //$LASTPOS=94002117;//kernel.MapEditorOLD2:2117
                Tonyu.globals.$map=new Tonyu.classes.kernel.Map({row: _this.row,col: _this.col,chipWidth: _this.chipWidth,chipHeight: _this.chipHeight});
                
              } else {
                //$LASTPOS=94002428;//kernel.MapEditorOLD2:2428
                Tonyu.globals.$map=new Tonyu.classes.kernel.Map({chipWidth: 32,chipHeight: 32});
                //$LASTPOS=94002475;//kernel.MapEditorOLD2:2475
                Tonyu.globals.$map.load(_this.fileName);
                //$LASTPOS=94002501;//kernel.MapEditorOLD2:2501
                _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
                //$LASTPOS=94002597;//kernel.MapEditorOLD2:2597
                _this.panel.x=_this.panel.width/2+40;
                //$LASTPOS=94002628;//kernel.MapEditorOLD2:2628
                _this.panel.y=_this.panel.height/2+40;
                //$LASTPOS=94002660;//kernel.MapEditorOLD2:2660
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=94002693;//kernel.MapEditorOLD2:2693
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
                
              }
              //$LASTPOS=94002743;//kernel.MapEditorOLD2:2743
              _this.mIW=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip].image.width;
              //$LASTPOS=94002799;//kernel.MapEditorOLD2:2799
              _this.mIH=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip].image.height;
              //$LASTPOS=94002856;//kernel.MapEditorOLD2:2856
              _this.mCW=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip+0].width;
              //$LASTPOS=94002908;//kernel.MapEditorOLD2:2908
              _this.mCH=Tonyu.globals.$Sprites.getImageList()[Tonyu.globals.$pat_mapchip+0].height;
              //$LASTPOS=94002961;//kernel.MapEditorOLD2:2961
              Tonyu.globals.$mp=new Tonyu.classes.kernel.Map({row: _this.floor(_this.mIH/_this.mCH),col: _this.floor(_this.mIW/_this.mCW),chipWidth: _this.mCW,chipHeight: _this.mCH});
              //$LASTPOS=94003043;//kernel.MapEditorOLD2:3043
              _this.counter=0;
              //$LASTPOS=94003055;//kernel.MapEditorOLD2:3055
              //$LASTPOS=94003059;//kernel.MapEditorOLD2:3059
              _this.i = 0;
              for (; _this.i<Tonyu.globals.$mp.row ; _this.i++) {
                {
                  //$LASTPOS=94003088;//kernel.MapEditorOLD2:3088
                  //$LASTPOS=94003092;//kernel.MapEditorOLD2:3092
                  _this.j = 0;
                  for (; _this.j<Tonyu.globals.$mp.col ; _this.j++) {
                    {
                      //$LASTPOS=94003125;//kernel.MapEditorOLD2:3125
                      Tonyu.globals.$mp.set(_this.j,_this.i,Tonyu.globals.$pat_mapchip+_this.counter);
                      //$LASTPOS=94003169;//kernel.MapEditorOLD2:3169
                      _this.counter++;
                    }
                  }
                }
              }
              //$LASTPOS=94003191;//kernel.MapEditorOLD2:3191
              _this.fiber$drawPanel(_thread);
              __pc=13;return;
            case 13:
              
              //$LASTPOS=94003205;//kernel.MapEditorOLD2:3205
              _this.mode="get";
              //$LASTPOS=94003218;//kernel.MapEditorOLD2:3218
              _this.prevMode="set";
              //$LASTPOS=94003235;//kernel.MapEditorOLD2:3235
              _this.mapp=0;
              //$LASTPOS=94003244;//kernel.MapEditorOLD2:3244
              _this.mx=- 40;
              //$LASTPOS=94003253;//kernel.MapEditorOLD2:3253
              _this.my=- 40;
              //$LASTPOS=94003262;//kernel.MapEditorOLD2:3262
              _this.chipX=- 40;
              //$LASTPOS=94003274;//kernel.MapEditorOLD2:3274
              _this.chipY=- 40;
              //$LASTPOS=94003286;//kernel.MapEditorOLD2:3286
              _this.x=Tonyu.globals.$screenWidth-_this.chipWidth/2;
              //$LASTPOS=94003315;//kernel.MapEditorOLD2:3315
              _this.y=Tonyu.globals.$screenHeight-_this.chipHeight/2;
              //$LASTPOS=94003346;//kernel.MapEditorOLD2:3346
              Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
              //$LASTPOS=94003369;//kernel.MapEditorOLD2:3369
            case 14:
              //$LASTPOS=94003387;//kernel.MapEditorOLD2:3387
              _this.p=_this.mapp;
              //$LASTPOS=94003400;//kernel.MapEditorOLD2:3400
              if (_this.getkey("e")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640)) {
                //$LASTPOS=94003539;//kernel.MapEditorOLD2:3539
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=94003573;//kernel.MapEditorOLD2:3573
                _this.mode="erase";
                //$LASTPOS=94003596;//kernel.MapEditorOLD2:3596
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=94003629;//kernel.MapEditorOLD2:3629
              if (_this.getkey("s")==1) {
                //$LASTPOS=94003658;//kernel.MapEditorOLD2:3658
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=94003692;//kernel.MapEditorOLD2:3692
                if (_this.mode=="set") {
                  //$LASTPOS=94003722;//kernel.MapEditorOLD2:3722
                  _this.mode="setOn";
                  
                } else {
                  //$LASTPOS=94003765;//kernel.MapEditorOLD2:3765
                  _this.mode="set";
                  
                }
                //$LASTPOS=94003797;//kernel.MapEditorOLD2:3797
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=94003830;//kernel.MapEditorOLD2:3830
              if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<120&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
                //$LASTPOS=94003949;//kernel.MapEditorOLD2:3949
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=94003983;//kernel.MapEditorOLD2:3983
                _this.mode="set";
                //$LASTPOS=94004004;//kernel.MapEditorOLD2:4004
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=94004037;//kernel.MapEditorOLD2:4037
              if (Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560) {
                //$LASTPOS=94004158;//kernel.MapEditorOLD2:4158
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=94004192;//kernel.MapEditorOLD2:4192
                _this.mode="setOn";
                //$LASTPOS=94004215;//kernel.MapEditorOLD2:4215
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=94004341;//kernel.MapEditorOLD2:4341
              if (_this.getkey("g")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>240&&Tonyu.globals.$touches[0].x<360&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) {
                //$LASTPOS=94004482;//kernel.MapEditorOLD2:4482
                if (_this.mode!="get") {
                  //$LASTPOS=94004512;//kernel.MapEditorOLD2:4512
                  _this.prevMode=_this.mode;
                  //$LASTPOS=94004540;//kernel.MapEditorOLD2:4540
                  Tonyu.globals.$mp.scrollTo(- 40,- 40);
                  //$LASTPOS=94004576;//kernel.MapEditorOLD2:4576
                  _this.mode="get";
                  //$LASTPOS=94004601;//kernel.MapEditorOLD2:4601
                  _this.chipX=- 40;
                  //$LASTPOS=94004625;//kernel.MapEditorOLD2:4625
                  _this.chipY=- 40;
                  
                } else {
                  //$LASTPOS=94004665;//kernel.MapEditorOLD2:4665
                  Tonyu.globals.$mp.scrollTo(1000,1000);
                  //$LASTPOS=94004703;//kernel.MapEditorOLD2:4703
                  _this.mode=_this.prevMode;
                  
                }
                //$LASTPOS=94004738;//kernel.MapEditorOLD2:4738
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=94004771;//kernel.MapEditorOLD2:4771
              if (_this.getkey("p")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>360&&Tonyu.globals.$touches[0].x<480&&Tonyu.globals.$touches[0].y>480&&Tonyu.globals.$touches[0].y<560)) {
                //$LASTPOS=94004927;//kernel.MapEditorOLD2:4927
                if (_this.loadedFile) {
                  //$LASTPOS=94004956;//kernel.MapEditorOLD2:4956
                  _this.saveFileName=prompt("input json file(*.json)",_this.loadedFile);
                  
                } else {
                  //$LASTPOS=94005044;//kernel.MapEditorOLD2:5044
                  _this.saveFileName=prompt("input json file(*.json)","map.json");
                  
                }
                //$LASTPOS=94005544;//kernel.MapEditorOLD2:5544
                if (_this.saveFileName) {
                  //$LASTPOS=94005575;//kernel.MapEditorOLD2:5575
                  _this.saveDataFile=_this.file("../maps/").rel(_this.saveFileName);
                  //$LASTPOS=94005637;//kernel.MapEditorOLD2:5637
                  _this.data=[Tonyu.globals.$map.mapTable,Tonyu.globals.$map.mapOnTable,Tonyu.globals.$map.chipWidth,Tonyu.globals.$map.chipHeight];
                  //$LASTPOS=94005799;//kernel.MapEditorOLD2:5799
                  _this.saveDataFile.obj(_this.data);
                  //$LASTPOS=94005836;//kernel.MapEditorOLD2:5836
                  _this.print(_this.saveFileName+" Saved");
                  
                }
                
              }
              //$LASTPOS=94005943;//kernel.MapEditorOLD2:5943
              if (_this.getkey("c")==1||(Tonyu.globals.$touches[0].touched==1&&Tonyu.globals.$touches[0].x>120&&Tonyu.globals.$touches[0].x<240&&Tonyu.globals.$touches[0].y>560&&Tonyu.globals.$touches[0].y<640)) {
                //$LASTPOS=94006084;//kernel.MapEditorOLD2:6084
                Tonyu.globals.$mp.scrollTo(1000,1000);
                //$LASTPOS=94006118;//kernel.MapEditorOLD2:6118
                _this.mode="copy";
                //$LASTPOS=94006140;//kernel.MapEditorOLD2:6140
                _this.print(_this.mode+" mode");
                
              }
              //$LASTPOS=94006173;//kernel.MapEditorOLD2:6173
              if (_this.mode!="get") {
                //$LASTPOS=94006199;//kernel.MapEditorOLD2:6199
                if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=94006305;//kernel.MapEditorOLD2:6305
                  _this.mx=_this.mx+8;
                }
                //$LASTPOS=94006323;//kernel.MapEditorOLD2:6323
                if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=94006454;//kernel.MapEditorOLD2:6454
                  _this.mx=_this.mx-8;
                }
                //$LASTPOS=94006472;//kernel.MapEditorOLD2:6472
                if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
                  //$LASTPOS=94006585;//kernel.MapEditorOLD2:6585
                  _this.my=_this.my+8;
                }
                //$LASTPOS=94006603;//kernel.MapEditorOLD2:6603
                if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
                  //$LASTPOS=94006738;//kernel.MapEditorOLD2:6738
                  _this.my=_this.my-8;
                }
                //$LASTPOS=94006756;//kernel.MapEditorOLD2:6756
                Tonyu.globals.$map.scrollTo(_this.mx,_this.my);
                
              } else {
                //$LASTPOS=94006799;//kernel.MapEditorOLD2:6799
                if (_this.getkey("left")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<40&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=94006905;//kernel.MapEditorOLD2:6905
                  _this.chipX=_this.chipX+8;
                }
                //$LASTPOS=94006929;//kernel.MapEditorOLD2:6929
                if (_this.getkey("right")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>Tonyu.globals.$screenWidth-40&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480)) {
                  //$LASTPOS=94007060;//kernel.MapEditorOLD2:7060
                  _this.chipX=_this.chipX-8;
                }
                //$LASTPOS=94007084;//kernel.MapEditorOLD2:7084
                if (_this.getkey("up")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<40)) {
                  //$LASTPOS=94007197;//kernel.MapEditorOLD2:7197
                  _this.chipY=_this.chipY+8;
                }
                //$LASTPOS=94007221;//kernel.MapEditorOLD2:7221
                if (_this.getkey("down")>0||(Tonyu.globals.$touches[0].touched&&Tonyu.globals.$touches[0].x>0&&Tonyu.globals.$touches[0].x<Tonyu.globals.$screenWidth&&Tonyu.globals.$touches[0].y<480&&Tonyu.globals.$touches[0].y>440)) {
                  //$LASTPOS=94007356;//kernel.MapEditorOLD2:7356
                  _this.chipY=_this.chipY-8;
                }
                //$LASTPOS=94007380;//kernel.MapEditorOLD2:7380
                Tonyu.globals.$mp.scrollTo(_this.chipX,_this.chipY);
                
              }
              //$LASTPOS=94007453;//kernel.MapEditorOLD2:7453
              if (_this.getkey("i")==1) {
                //$LASTPOS=94007482;//kernel.MapEditorOLD2:7482
                Tonyu.globals.$map.chipWidth+=4;
                //$LASTPOS=94007510;//kernel.MapEditorOLD2:7510
                Tonyu.globals.$map.chipHeight+=4;
                //$LASTPOS=94007539;//kernel.MapEditorOLD2:7539
                Tonyu.globals.$map.redrawMap();
                //$LASTPOS=94007566;//kernel.MapEditorOLD2:7566
                _this.panel.die();
                //$LASTPOS=94007588;//kernel.MapEditorOLD2:7588
                _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
                //$LASTPOS=94007688;//kernel.MapEditorOLD2:7688
                _this.panel.x=_this.panel.width/2+40;
                //$LASTPOS=94007723;//kernel.MapEditorOLD2:7723
                _this.panel.y=_this.panel.height/2+40;
                //$LASTPOS=94007759;//kernel.MapEditorOLD2:7759
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=94007796;//kernel.MapEditorOLD2:7796
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
                
              }
              //$LASTPOS=94007854;//kernel.MapEditorOLD2:7854
              if (_this.getkey("o")==1) {
                //$LASTPOS=94007883;//kernel.MapEditorOLD2:7883
                Tonyu.globals.$map.chipWidth-=4;
                //$LASTPOS=94007911;//kernel.MapEditorOLD2:7911
                Tonyu.globals.$map.chipHeight-=4;
                //$LASTPOS=94007940;//kernel.MapEditorOLD2:7940
                Tonyu.globals.$map.redrawMap();
                //$LASTPOS=94007967;//kernel.MapEditorOLD2:7967
                _this.panel.die();
                //$LASTPOS=94007989;//kernel.MapEditorOLD2:7989
                _this.panel=new Tonyu.classes.kernel.Panel({width: Tonyu.globals.$map.col*Tonyu.globals.$map.chipWidth,height: Tonyu.globals.$map.row*Tonyu.globals.$map.chipHeight,zOrder: 100});
                //$LASTPOS=94008089;//kernel.MapEditorOLD2:8089
                _this.panel.x=_this.panel.width/2+40;
                //$LASTPOS=94008124;//kernel.MapEditorOLD2:8124
                _this.panel.y=_this.panel.height/2+40;
                //$LASTPOS=94008160;//kernel.MapEditorOLD2:8160
                _this.panel.setFillStyle("cyan");
                //$LASTPOS=94008197;//kernel.MapEditorOLD2:8197
                _this.panel.fillRect(0,0,_this.panel.width,_this.panel.height);
                
              }
              //$LASTPOS=94008289;//kernel.MapEditorOLD2:8289
              _this.panel.x=_this.panel.width/2-_this.mx;
              //$LASTPOS=94008320;//kernel.MapEditorOLD2:8320
              _this.panel.y=_this.panel.height/2-_this.my;
              //$LASTPOS=94008352;//kernel.MapEditorOLD2:8352
              if (!(_this.mode=="set"&&_this.getkey(1)>0&&_this.inRect())) { __pc=15    ; break; }
              {
                //$LASTPOS=94008405;//kernel.MapEditorOLD2:8405
                Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
                //$LASTPOS=94008454;//kernel.MapEditorOLD2:8454
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
              }
              __pc=25    ;break;
            case 15    :
              //$LASTPOS=94008505;//kernel.MapEditorOLD2:8505
              if (!(_this.mode=="erase"&&_this.getkey(1)>0&&_this.inRect())) { __pc=16    ; break; }
              {
                //$LASTPOS=94008560;//kernel.MapEditorOLD2:8560
                Tonyu.globals.$map.setAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,- 1);
              }
              __pc=24    ;break;
            case 16    :
              //$LASTPOS=94008609;//kernel.MapEditorOLD2:8609
              if (!(_this.mode=="get"&&_this.getkey(1)>0&&_this.inRect())) { __pc=18    ; break; }
              //$LASTPOS=94008662;//kernel.MapEditorOLD2:8662
              _this.mapp=Tonyu.globals.$mp.getAt(Tonyu.globals.$mouseX+_this.chipX,Tonyu.globals.$mouseY+_this.chipY);
              //$LASTPOS=94008716;//kernel.MapEditorOLD2:8716
              _this.mode=_this.prevMode;
              //$LASTPOS=94008740;//kernel.MapEditorOLD2:8740
              Tonyu.globals.$mp.scrollTo(1000,1000);
              //$LASTPOS=94008774;//kernel.MapEditorOLD2:8774
              _this.print(_this.mode+" mode");
              //$LASTPOS=94008804;//kernel.MapEditorOLD2:8804
              _this.fiber$updateEx(_thread, 10);
              __pc=17;return;
            case 17:
              
              __pc=23    ;break;
            case 18    :
              //$LASTPOS=94008829;//kernel.MapEditorOLD2:8829
              if (!(_this.mode=="setOn"&&_this.getkey(1)>0&&_this.inRect())) { __pc=19    ; break; }
              {
                //$LASTPOS=94008884;//kernel.MapEditorOLD2:8884
                Tonyu.globals.$map.setOnAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my,_this.mapp);
              }
              __pc=22    ;break;
            case 19    :
              //$LASTPOS=94008937;//kernel.MapEditorOLD2:8937
              if (!(_this.mode=="copy"&&_this.getkey(1)>0&&_this.inRect())) { __pc=21    ; break; }
              //$LASTPOS=94008991;//kernel.MapEditorOLD2:8991
              _this.mapp=Tonyu.globals.$map.getAt(Tonyu.globals.$mouseX+_this.mx,Tonyu.globals.$mouseY+_this.my);
              //$LASTPOS=94009040;//kernel.MapEditorOLD2:9040
              _this.mode="set";
              //$LASTPOS=94009061;//kernel.MapEditorOLD2:9061
              _this.print(_this.mode+" mode");
              //$LASTPOS=94009091;//kernel.MapEditorOLD2:9091
              _this.fiber$updateEx(_thread, 10);
              __pc=20;return;
            case 20:
              
            case 21    :
              
            case 22    :
              
            case 23    :
              
            case 24    :
              
            case 25    :
              
              //$LASTPOS=94009117;//kernel.MapEditorOLD2:9117
              _this.fiber$update(_thread);
              __pc=26;return;
            case 26:
              
              __pc=14;break;
            case 27    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      inRect :function _trc_MapEditorOLD2_inRect() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$mouseX>40&&Tonyu.globals.$mouseX<Tonyu.globals.$screenWidth-40&&Tonyu.globals.$mouseY>40&&Tonyu.globals.$mouseY<Tonyu.globals.$screenHeight-200;
      },
      fiber$inRect :function _trc_MapEditorOLD2_f_inRect(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=Tonyu.globals.$mouseX>40&&Tonyu.globals.$mouseX<Tonyu.globals.$screenWidth-40&&Tonyu.globals.$mouseY>40&&Tonyu.globals.$mouseY<Tonyu.globals.$screenHeight-200;return;
        
        
        _thread.retVal=_this;return;
      },
      drawPanel :function _trc_MapEditorOLD2_drawPanel() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=94009289;//kernel.MapEditorOLD2:9289
        Tonyu.globals.$panel.setFillStyle("gray");
        //$LASTPOS=94009323;//kernel.MapEditorOLD2:9323
        Tonyu.globals.$panel.alpha=128;
        //$LASTPOS=94009346;//kernel.MapEditorOLD2:9346
        Tonyu.globals.$panel.fillRect(0,0,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=94009389;//kernel.MapEditorOLD2:9389
        Tonyu.globals.$panel.fillRect(0,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=94009437;//kernel.MapEditorOLD2:9437
        Tonyu.globals.$panel.fillRect(Tonyu.globals.$screenWidth-40,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=94009499;//kernel.MapEditorOLD2:9499
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-200,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=94009558;//kernel.MapEditorOLD2:9558
        Tonyu.globals.$panel.alpha=255;
        //$LASTPOS=94009581;//kernel.MapEditorOLD2:9581
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=94009635;//kernel.MapEditorOLD2:9635
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009685;//kernel.MapEditorOLD2:9685
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009737;//kernel.MapEditorOLD2:9737
        Tonyu.globals.$panel.fillRect(240,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009789;//kernel.MapEditorOLD2:9789
        Tonyu.globals.$panel.fillRect(360,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009841;//kernel.MapEditorOLD2:9841
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=94009890;//kernel.MapEditorOLD2:9890
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=94009941;//kernel.MapEditorOLD2:9941
        Tonyu.globals.$panel.setFillStyle("white");
        //$LASTPOS=94009976;//kernel.MapEditorOLD2:9976
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010027;//kernel.MapEditorOLD2:10027
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010079;//kernel.MapEditorOLD2:10079
        Tonyu.globals.$panel.fillRect(250,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010131;//kernel.MapEditorOLD2:10131
        Tonyu.globals.$panel.fillRect(370,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010183;//kernel.MapEditorOLD2:10183
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=94010233;//kernel.MapEditorOLD2:10233
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=94010284;//kernel.MapEditorOLD2:10284
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=94010330;//kernel.MapEditorOLD2:10330
        Tonyu.globals.$panel.fillText("↑",Tonyu.globals.$screenWidth/2,30,40,"center");
        //$LASTPOS=94010387;//kernel.MapEditorOLD2:10387
        Tonyu.globals.$panel.fillText("←",20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=94010451;//kernel.MapEditorOLD2:10451
        Tonyu.globals.$panel.fillText("↓",Tonyu.globals.$screenWidth/2,Tonyu.globals.$screenHeight-160-10,40,"center");
        //$LASTPOS=94010526;//kernel.MapEditorOLD2:10526
        Tonyu.globals.$panel.fillText("→",Tonyu.globals.$screenWidth-20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=94010631;//kernel.MapEditorOLD2:10631
        Tonyu.globals.$panel.fillText("set",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=94010708;//kernel.MapEditorOLD2:10708
        Tonyu.globals.$panel.fillText("setOn",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-110,35,"center");
        //$LASTPOS=94010787;//kernel.MapEditorOLD2:10787
        Tonyu.globals.$panel.fillText("get",Tonyu.globals.$screenWidth/2+60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=94010864;//kernel.MapEditorOLD2:10864
        Tonyu.globals.$panel.fillText("save",Tonyu.globals.$screenWidth-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=94010940;//kernel.MapEditorOLD2:10940
        Tonyu.globals.$panel.fillText("erase",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=94011018;//kernel.MapEditorOLD2:11018
        Tonyu.globals.$panel.fillText("copy",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-30,35,"center");
      },
      fiber$drawPanel :function _trc_MapEditorOLD2_f_drawPanel(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=94009289;//kernel.MapEditorOLD2:9289
        Tonyu.globals.$panel.setFillStyle("gray");
        //$LASTPOS=94009323;//kernel.MapEditorOLD2:9323
        Tonyu.globals.$panel.alpha=128;
        //$LASTPOS=94009346;//kernel.MapEditorOLD2:9346
        Tonyu.globals.$panel.fillRect(0,0,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=94009389;//kernel.MapEditorOLD2:9389
        Tonyu.globals.$panel.fillRect(0,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=94009437;//kernel.MapEditorOLD2:9437
        Tonyu.globals.$panel.fillRect(Tonyu.globals.$screenWidth-40,0,40,Tonyu.globals.$screenHeight-160);
        //$LASTPOS=94009499;//kernel.MapEditorOLD2:9499
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-200,Tonyu.globals.$screenWidth,40);
        //$LASTPOS=94009558;//kernel.MapEditorOLD2:9558
        Tonyu.globals.$panel.alpha=255;
        //$LASTPOS=94009581;//kernel.MapEditorOLD2:9581
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=94009635;//kernel.MapEditorOLD2:9635
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009685;//kernel.MapEditorOLD2:9685
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009737;//kernel.MapEditorOLD2:9737
        Tonyu.globals.$panel.fillRect(240,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009789;//kernel.MapEditorOLD2:9789
        Tonyu.globals.$panel.fillRect(360,Tonyu.globals.$screenHeight-160,120,80);
        //$LASTPOS=94009841;//kernel.MapEditorOLD2:9841
        Tonyu.globals.$panel.fillRect(0,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=94009890;//kernel.MapEditorOLD2:9890
        Tonyu.globals.$panel.fillRect(120,Tonyu.globals.$screenHeight-80,120,80);
        //$LASTPOS=94009941;//kernel.MapEditorOLD2:9941
        Tonyu.globals.$panel.setFillStyle("white");
        //$LASTPOS=94009976;//kernel.MapEditorOLD2:9976
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010027;//kernel.MapEditorOLD2:10027
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010079;//kernel.MapEditorOLD2:10079
        Tonyu.globals.$panel.fillRect(250,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010131;//kernel.MapEditorOLD2:10131
        Tonyu.globals.$panel.fillRect(370,Tonyu.globals.$screenHeight-150,100,60);
        //$LASTPOS=94010183;//kernel.MapEditorOLD2:10183
        Tonyu.globals.$panel.fillRect(10,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=94010233;//kernel.MapEditorOLD2:10233
        Tonyu.globals.$panel.fillRect(130,Tonyu.globals.$screenHeight-70,100,60);
        //$LASTPOS=94010284;//kernel.MapEditorOLD2:10284
        Tonyu.globals.$panel.setFillStyle("black");
        //$LASTPOS=94010330;//kernel.MapEditorOLD2:10330
        Tonyu.globals.$panel.fillText("↑",Tonyu.globals.$screenWidth/2,30,40,"center");
        //$LASTPOS=94010387;//kernel.MapEditorOLD2:10387
        Tonyu.globals.$panel.fillText("←",20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=94010451;//kernel.MapEditorOLD2:10451
        Tonyu.globals.$panel.fillText("↓",Tonyu.globals.$screenWidth/2,Tonyu.globals.$screenHeight-160-10,40,"center");
        //$LASTPOS=94010526;//kernel.MapEditorOLD2:10526
        Tonyu.globals.$panel.fillText("→",Tonyu.globals.$screenWidth-20,(Tonyu.globals.$screenHeight-200)/2,40,"center");
        //$LASTPOS=94010631;//kernel.MapEditorOLD2:10631
        Tonyu.globals.$panel.fillText("set",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=94010708;//kernel.MapEditorOLD2:10708
        Tonyu.globals.$panel.fillText("setOn",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-110,35,"center");
        //$LASTPOS=94010787;//kernel.MapEditorOLD2:10787
        Tonyu.globals.$panel.fillText("get",Tonyu.globals.$screenWidth/2+60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=94010864;//kernel.MapEditorOLD2:10864
        Tonyu.globals.$panel.fillText("save",Tonyu.globals.$screenWidth-60,Tonyu.globals.$screenHeight-110,40,"center");
        //$LASTPOS=94010940;//kernel.MapEditorOLD2:10940
        Tonyu.globals.$panel.fillText("erase",Tonyu.globals.$screenWidth/4-60,Tonyu.globals.$screenHeight-30,35,"center");
        //$LASTPOS=94011018;//kernel.MapEditorOLD2:11018
        Tonyu.globals.$panel.fillText("copy",Tonyu.globals.$screenWidth/4+60,Tonyu.globals.$screenHeight-30,35,"center");
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"inRect":{"nowait":false},"drawPanel":{"nowait":false}},"fields":{"i":{},"j":{},"loadMode":{},"fileExist":{},"fileList":{},"fNames":{},"fileName":{},"mapDataFile":{},"baseData":{},"loadedFile":{},"mapData":{},"mapOnData":{},"chipWidth":{},"chipHeight":{},"row":{},"col":{},"panel":{},"mIW":{},"mIH":{},"mCW":{},"mCH":{},"counter":{},"mode":{},"prevMode":{},"mapp":{},"mx":{},"my":{},"chipX":{},"chipY":{},"saveFileName":{},"saveDataFile":{},"data":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Pad',
  shortName: 'Pad',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_Pad_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95019257;//kernel.Pad:19257
        while (true) {
          //$LASTPOS=95019277;//kernel.Pad:19277
          _this.padUpdate();
          //$LASTPOS=95019295;//kernel.Pad:19295
          _this.update();
          
        }
      },
      fiber$main :function _trc_Pad_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95019257;//kernel.Pad:19257
            case 1:
              //$LASTPOS=95019277;//kernel.Pad:19277
              _this.fiber$padUpdate(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=95019295;//kernel.Pad:19295
              _this.fiber$update(_thread);
              __pc=3;return;
            case 3:
              
              __pc=1;break;
            case 4     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initialize :function _trc_Pad_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95000084;//kernel.Pad:84
        __superClass.apply( _this, [opt]);
        //$LASTPOS=95000103;//kernel.Pad:103
        if (! _this.buttonCnt&&(_this.version==null||_this.version==1)&&Tonyu.globals.$pat_inputPad!=undefined) {
          //$LASTPOS=95000231;//kernel.Pad:231
          _this.version=1;
          
        } else {
          //$LASTPOS=95000295;//kernel.Pad:295
          _this.version=2;
          
        }
        //$LASTPOS=95000322;//kernel.Pad:322
        if (_this.version==1) {
          //$LASTPOS=95000351;//kernel.Pad:351
          _this.newPadV1();
          
        } else {
          //$LASTPOS=95000386;//kernel.Pad:386
          _this.newPadV2();
          
        }
        //$LASTPOS=95000412;//kernel.Pad:412
        if (_this.active==null) {
          //$LASTPOS=95000432;//kernel.Pad:432
          _this.active=true;
        }
        //$LASTPOS=95000452;//kernel.Pad:452
        if (_this.active) {
          //$LASTPOS=95000475;//kernel.Pad:475
          _this.activate();
          
        }
      },
      activate :function _trc_Pad_activate(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95000522;//kernel.Pad:522
        if (opt) {
          //$LASTPOS=95000542;//kernel.Pad:542
          if (opt.buttonCnt) {
            //$LASTPOS=95000576;//kernel.Pad:576
            _this.buttonCnt=opt.buttonCnt;
            //$LASTPOS=95000616;//kernel.Pad:616
            _this.drawPanel();
            //$LASTPOS=95000642;//kernel.Pad:642
            _this.setXYPanel();
            
          }
          
        }
        //$LASTPOS=95000679;//kernel.Pad:679
        _this.active=true;
        //$LASTPOS=95000699;//kernel.Pad:699
        if (! _this.actived) {
          //$LASTPOS=95000724;//kernel.Pad:724
          _this.actived=true;
          
        }
      },
      fiber$activate :function _trc_Pad_f_activate(_thread,opt) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_activate(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95000522;//kernel.Pad:522
              if (!(opt)) { __pc=4     ; break; }
              //$LASTPOS=95000542;//kernel.Pad:542
              if (!(opt.buttonCnt)) { __pc=3     ; break; }
              //$LASTPOS=95000576;//kernel.Pad:576
              _this.buttonCnt=opt.buttonCnt;
              //$LASTPOS=95000616;//kernel.Pad:616
              _this.fiber$drawPanel(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95000642;//kernel.Pad:642
              _this.fiber$setXYPanel(_thread);
              __pc=2;return;
            case 2:
              
            case 3     :
              
            case 4     :
              
              //$LASTPOS=95000679;//kernel.Pad:679
              _this.active=true;
              //$LASTPOS=95000699;//kernel.Pad:699
              if (! _this.actived) {
                //$LASTPOS=95000724;//kernel.Pad:724
                _this.actived=true;
                
              }
              _thread.exit(_this);return;
            }
          }
        });
      },
      newPadV2 :function _trc_Pad_newPadV2() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95000772;//kernel.Pad:772
        _this.died=false;
        //$LASTPOS=95000905;//kernel.Pad:905
        if (_this.layout==null) {
          //$LASTPOS=95000925;//kernel.Pad:925
          _this.layout=1;
        }
        //$LASTPOS=95000978;//kernel.Pad:978
        if (_this.buttonCnt==null) {
          //$LASTPOS=95001001;//kernel.Pad:1001
          _this.buttonCnt=1;
        }
        //$LASTPOS=95001048;//kernel.Pad:1048
        if (_this.autoMove==null) {
          //$LASTPOS=95001070;//kernel.Pad:1070
          _this.autoMove=true;
        }
        //$LASTPOS=95001114;//kernel.Pad:1114
        if (_this.layer==null) {
          //$LASTPOS=95001133;//kernel.Pad:1133
          _this.layer=Tonyu.globals.$frontLayer;
        }
        //$LASTPOS=95001161;//kernel.Pad:1161
        _this.initButton();
      },
      fiber$newPadV2 :function _trc_Pad_f_newPadV2(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=95000772;//kernel.Pad:772
        _this.died=false;
        //$LASTPOS=95000905;//kernel.Pad:905
        if (_this.layout==null) {
          //$LASTPOS=95000925;//kernel.Pad:925
          _this.layout=1;
        }
        //$LASTPOS=95000978;//kernel.Pad:978
        if (_this.buttonCnt==null) {
          //$LASTPOS=95001001;//kernel.Pad:1001
          _this.buttonCnt=1;
        }
        //$LASTPOS=95001048;//kernel.Pad:1048
        if (_this.autoMove==null) {
          //$LASTPOS=95001070;//kernel.Pad:1070
          _this.autoMove=true;
        }
        //$LASTPOS=95001114;//kernel.Pad:1114
        if (_this.layer==null) {
          //$LASTPOS=95001133;//kernel.Pad:1133
          _this.layer=Tonyu.globals.$frontLayer;
        }
        
        _thread.enter(function _trc_Pad_ent_newPadV2(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95001161;//kernel.Pad:1161
              _this.fiber$initButton(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      newPadV1 :function _trc_Pad_newPadV1() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95001200;//kernel.Pad:1200
        _this.APAD_DIAG_SIZE=96;
        //$LASTPOS=95001226;//kernel.Pad:1226
        _this.died=false;
        //$LASTPOS=95001245;//kernel.Pad:1245
        _this.padImageP=Tonyu.globals.$pat_inputPad;
        //$LASTPOS=95001277;//kernel.Pad:1277
        _this.padUpdateFrame=- 1;
        //$LASTPOS=95001303;//kernel.Pad:1303
        if (_this.layer==null) {
          //$LASTPOS=95001322;//kernel.Pad:1322
          _this.layer=Tonyu.globals.$frontLayer;
        }
        //$LASTPOS=95001348;//kernel.Pad:1348
        _this.jujiKey=new Tonyu.classes.kernel.Actor({x: 96+1,y: Tonyu.globals.$screenHeight-96-1,p: _this.padImageP+0,zOrder: - 9,layer: _this.layer});
        //$LASTPOS=95001436;//kernel.Pad:1436
        _this.no1Key=new Tonyu.classes.kernel.Actor({x: Tonyu.globals.$screenWidth-96,y: Tonyu.globals.$screenHeight-96,p: _this.padImageP+1,zOrder: - 9,layer: _this.layer});
        //$LASTPOS=95001532;//kernel.Pad:1532
        _this.jujiKey.show();
        //$LASTPOS=95001553;//kernel.Pad:1553
        _this.no1Key.show();
        //$LASTPOS=95001575;//kernel.Pad:1575
        _this.jujiKeyPushU=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x,y: _this.jujiKey.y-60,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001669;//kernel.Pad:1669
        _this.jujiKeyPushL=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x-60,y: _this.jujiKey.y,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001763;//kernel.Pad:1763
        _this.jujiKeyPushR=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x+60,y: _this.jujiKey.y,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001857;//kernel.Pad:1857
        _this.jujiKeyPushD=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x,y: _this.jujiKey.y+60,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001951;//kernel.Pad:1951
        _this.jujiKeyPush1=new Tonyu.classes.kernel.Actor({x: _this.no1Key.x,y: _this.no1Key.y,p: _this.padImageP+2,scaleX: 2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95002050;//kernel.Pad:2050
        _this.jujiKeyPushU.hide();
        //$LASTPOS=95002076;//kernel.Pad:2076
        _this.jujiKeyPushL.hide();
        //$LASTPOS=95002102;//kernel.Pad:2102
        _this.jujiKeyPushR.hide();
        //$LASTPOS=95002128;//kernel.Pad:2128
        _this.jujiKeyPushD.hide();
        //$LASTPOS=95002154;//kernel.Pad:2154
        _this.jujiKeyPush1.hide();
      },
      fiber$newPadV1 :function _trc_Pad_f_newPadV1(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=95001200;//kernel.Pad:1200
        _this.APAD_DIAG_SIZE=96;
        //$LASTPOS=95001226;//kernel.Pad:1226
        _this.died=false;
        //$LASTPOS=95001245;//kernel.Pad:1245
        _this.padImageP=Tonyu.globals.$pat_inputPad;
        //$LASTPOS=95001277;//kernel.Pad:1277
        _this.padUpdateFrame=- 1;
        //$LASTPOS=95001303;//kernel.Pad:1303
        if (_this.layer==null) {
          //$LASTPOS=95001322;//kernel.Pad:1322
          _this.layer=Tonyu.globals.$frontLayer;
        }
        //$LASTPOS=95001348;//kernel.Pad:1348
        _this.jujiKey=new Tonyu.classes.kernel.Actor({x: 96+1,y: Tonyu.globals.$screenHeight-96-1,p: _this.padImageP+0,zOrder: - 9,layer: _this.layer});
        //$LASTPOS=95001436;//kernel.Pad:1436
        _this.no1Key=new Tonyu.classes.kernel.Actor({x: Tonyu.globals.$screenWidth-96,y: Tonyu.globals.$screenHeight-96,p: _this.padImageP+1,zOrder: - 9,layer: _this.layer});
        //$LASTPOS=95001532;//kernel.Pad:1532
        _this.jujiKey.show();
        //$LASTPOS=95001553;//kernel.Pad:1553
        _this.no1Key.show();
        //$LASTPOS=95001575;//kernel.Pad:1575
        _this.jujiKeyPushU=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x,y: _this.jujiKey.y-60,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001669;//kernel.Pad:1669
        _this.jujiKeyPushL=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x-60,y: _this.jujiKey.y,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001763;//kernel.Pad:1763
        _this.jujiKeyPushR=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x+60,y: _this.jujiKey.y,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001857;//kernel.Pad:1857
        _this.jujiKeyPushD=new Tonyu.classes.kernel.Actor({x: _this.jujiKey.x,y: _this.jujiKey.y+60,p: _this.padImageP+2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95001951;//kernel.Pad:1951
        _this.jujiKeyPush1=new Tonyu.classes.kernel.Actor({x: _this.no1Key.x,y: _this.no1Key.y,p: _this.padImageP+2,scaleX: 2,zOrder: - 10,layer: _this.layer});
        //$LASTPOS=95002050;//kernel.Pad:2050
        _this.jujiKeyPushU.hide();
        //$LASTPOS=95002076;//kernel.Pad:2076
        _this.jujiKeyPushL.hide();
        //$LASTPOS=95002102;//kernel.Pad:2102
        _this.jujiKeyPushR.hide();
        //$LASTPOS=95002128;//kernel.Pad:2128
        _this.jujiKeyPushD.hide();
        //$LASTPOS=95002154;//kernel.Pad:2154
        _this.jujiKeyPush1.hide();
        
        _thread.retVal=_this;return;
      },
      die :function _trc_Pad_die() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95002195;//kernel.Pad:2195
        if (_this.version==1) {
          //$LASTPOS=95002224;//kernel.Pad:2224
          _this.dieV1();
          
        } else {
          //$LASTPOS=95002256;//kernel.Pad:2256
          _this.dieV2();
          
        }
        //$LASTPOS=95002277;//kernel.Pad:2277
        __superClass.prototype.die.apply( _this, []);
      },
      dieV2 :function _trc_Pad_dieV2() {
        "use strict";
        var _this=this;
        var i;
        var obj;
        
        //$LASTPOS=95002312;//kernel.Pad:2312
        _this.died=true;
        //$LASTPOS=95002330;//kernel.Pad:2330
        if (_this.buttons!=null) {
          //$LASTPOS=95002362;//kernel.Pad:2362
          //$LASTPOS=95002367;//kernel.Pad:2367
          i = 0;
          for (; i<_this.buttons.length ; i++) {
            {
              //$LASTPOS=95002414;//kernel.Pad:2414
              obj = _this.buttons[i];
              
              //$LASTPOS=95002449;//kernel.Pad:2449
              if (obj) {
                //$LASTPOS=95002477;//kernel.Pad:2477
                obj.die();
                //$LASTPOS=95002505;//kernel.Pad:2505
                _this.buttons[i]=null;
                
              }
            }
          }
          //$LASTPOS=95002559;//kernel.Pad:2559
          _this.buttons=null;
          
        }
        //$LASTPOS=95002587;//kernel.Pad:2587
        if (_this.jujiPads!=null) {
          //$LASTPOS=95002620;//kernel.Pad:2620
          //$LASTPOS=95002625;//kernel.Pad:2625
          i = 0;
          for (; i<_this.jujiPads.length ; i++) {
            {
              //$LASTPOS=95002673;//kernel.Pad:2673
              obj = _this.jujiPads[i];
              
              //$LASTPOS=95002709;//kernel.Pad:2709
              if (obj) {
                //$LASTPOS=95002737;//kernel.Pad:2737
                obj.die();
                //$LASTPOS=95002765;//kernel.Pad:2765
                _this.jujiPads[i]=null;
                
              }
            }
          }
          //$LASTPOS=95002820;//kernel.Pad:2820
          _this.jujiPads=null;
          
        }
      },
      fiber$dieV2 :function _trc_Pad_f_dieV2(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        var obj;
        
        //$LASTPOS=95002312;//kernel.Pad:2312
        _this.died=true;
        //$LASTPOS=95002330;//kernel.Pad:2330
        if (_this.buttons!=null) {
          //$LASTPOS=95002362;//kernel.Pad:2362
          //$LASTPOS=95002367;//kernel.Pad:2367
          i = 0;
          for (; i<_this.buttons.length ; i++) {
            {
              //$LASTPOS=95002414;//kernel.Pad:2414
              obj = _this.buttons[i];
              
              //$LASTPOS=95002449;//kernel.Pad:2449
              if (obj) {
                //$LASTPOS=95002477;//kernel.Pad:2477
                obj.die();
                //$LASTPOS=95002505;//kernel.Pad:2505
                _this.buttons[i]=null;
                
              }
            }
          }
          //$LASTPOS=95002559;//kernel.Pad:2559
          _this.buttons=null;
          
        }
        //$LASTPOS=95002587;//kernel.Pad:2587
        if (_this.jujiPads!=null) {
          //$LASTPOS=95002620;//kernel.Pad:2620
          //$LASTPOS=95002625;//kernel.Pad:2625
          i = 0;
          for (; i<_this.jujiPads.length ; i++) {
            {
              //$LASTPOS=95002673;//kernel.Pad:2673
              obj = _this.jujiPads[i];
              
              //$LASTPOS=95002709;//kernel.Pad:2709
              if (obj) {
                //$LASTPOS=95002737;//kernel.Pad:2737
                obj.die();
                //$LASTPOS=95002765;//kernel.Pad:2765
                _this.jujiPads[i]=null;
                
              }
            }
          }
          //$LASTPOS=95002820;//kernel.Pad:2820
          _this.jujiPads=null;
          
        }
        
        _thread.retVal=_this;return;
      },
      dieV1 :function _trc_Pad_dieV1() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95002866;//kernel.Pad:2866
        _this.died=true;
        //$LASTPOS=95002884;//kernel.Pad:2884
        _this.jujiKey.die();
        //$LASTPOS=95002904;//kernel.Pad:2904
        _this.no1Key.die();
        //$LASTPOS=95002923;//kernel.Pad:2923
        _this.jujiKeyPushU.show();
        //$LASTPOS=95002943;//kernel.Pad:2943
        _this.jujiKeyPushU.die();
        //$LASTPOS=95002968;//kernel.Pad:2968
        _this.jujiKeyPushL.show();
        //$LASTPOS=95002988;//kernel.Pad:2988
        _this.jujiKeyPushL.die();
        //$LASTPOS=95003013;//kernel.Pad:3013
        _this.jujiKeyPushR.show();
        //$LASTPOS=95003033;//kernel.Pad:3033
        _this.jujiKeyPushR.die();
        //$LASTPOS=95003058;//kernel.Pad:3058
        _this.jujiKeyPushD.show();
        //$LASTPOS=95003078;//kernel.Pad:3078
        _this.jujiKeyPushD.die();
        //$LASTPOS=95003103;//kernel.Pad:3103
        _this.jujiKeyPush1.show();
        //$LASTPOS=95003123;//kernel.Pad:3123
        _this.jujiKeyPush1.die();
      },
      fiber$dieV1 :function _trc_Pad_f_dieV1(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=95002866;//kernel.Pad:2866
        _this.died=true;
        //$LASTPOS=95002884;//kernel.Pad:2884
        _this.jujiKey.die();
        //$LASTPOS=95002904;//kernel.Pad:2904
        _this.no1Key.die();
        //$LASTPOS=95002923;//kernel.Pad:2923
        _this.jujiKeyPushU.show();
        //$LASTPOS=95002943;//kernel.Pad:2943
        _this.jujiKeyPushU.die();
        //$LASTPOS=95002968;//kernel.Pad:2968
        _this.jujiKeyPushL.show();
        //$LASTPOS=95002988;//kernel.Pad:2988
        _this.jujiKeyPushL.die();
        //$LASTPOS=95003013;//kernel.Pad:3013
        _this.jujiKeyPushR.show();
        //$LASTPOS=95003033;//kernel.Pad:3033
        _this.jujiKeyPushR.die();
        //$LASTPOS=95003058;//kernel.Pad:3058
        _this.jujiKeyPushD.show();
        //$LASTPOS=95003078;//kernel.Pad:3078
        _this.jujiKeyPushD.die();
        //$LASTPOS=95003103;//kernel.Pad:3103
        _this.jujiKeyPush1.show();
        //$LASTPOS=95003123;//kernel.Pad:3123
        _this.jujiKeyPush1.die();
        
        _thread.retVal=_this;return;
      },
      initButton :function _trc_Pad_initButton() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95003170;//kernel.Pad:3170
        _this.DEFALT_SCREEN_WIDTH=465;
        //$LASTPOS=95003204;//kernel.Pad:3204
        _this.p=- 1;
        //$LASTPOS=95003219;//kernel.Pad:3219
        _this.jujiPads=[];
        //$LASTPOS=95003239;//kernel.Pad:3239
        _this.buttons=[];
        //$LASTPOS=95003258;//kernel.Pad:3258
        _this.padScaleX=1;
        //$LASTPOS=95003278;//kernel.Pad:3278
        _this.padUpdateFrame=- 1;
        //$LASTPOS=95003306;//kernel.Pad:3306
        if (_this.layout==1) {
          //$LASTPOS=95003358;//kernel.Pad:3358
          _this.initButtonLayout1();
          //$LASTPOS=95003388;//kernel.Pad:3388
          _this.setXYPanelLayout1();
          
        }
      },
      fiber$initButton :function _trc_Pad_f_initButton(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=95003170;//kernel.Pad:3170
        _this.DEFALT_SCREEN_WIDTH=465;
        //$LASTPOS=95003204;//kernel.Pad:3204
        _this.p=- 1;
        //$LASTPOS=95003219;//kernel.Pad:3219
        _this.jujiPads=[];
        //$LASTPOS=95003239;//kernel.Pad:3239
        _this.buttons=[];
        //$LASTPOS=95003258;//kernel.Pad:3258
        _this.padScaleX=1;
        //$LASTPOS=95003278;//kernel.Pad:3278
        _this.padUpdateFrame=- 1;
        
        _thread.enter(function _trc_Pad_ent_initButton(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95003306;//kernel.Pad:3306
              if (!(_this.layout==1)) { __pc=3     ; break; }
              //$LASTPOS=95003358;//kernel.Pad:3358
              _this.fiber$initButtonLayout1(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95003388;//kernel.Pad:3388
              _this.fiber$setXYPanelLayout1(_thread);
              __pc=2;return;
            case 2:
              
            case 3     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initButtonLayout1 :function _trc_Pad_initButtonLayout1() {
        "use strict";
        var _this=this;
        var screenSize;
        var tempJujiPadWidth;
        var tempJujiPadHeight;
        var tempJujiPadBorder;
        var i;
        var tempPadWidth;
        var tempPadHeight;
        var tempPadFillColor;
        var tempPadBorder;
        var tempPadBorderColor;
        var tempPadPushColor;
        var tempPadText;
        var tempPadTextSize;
        var tempPadTextColor;
        var obj;
        
        //$LASTPOS=95003450;//kernel.Pad:3450
        screenSize = Tonyu.globals.$screenWidth;
        
        //$LASTPOS=95003486;//kernel.Pad:3486
        if (Tonyu.globals.$screenWidth>Tonyu.globals.$screenHeight) {
          //$LASTPOS=95003520;//kernel.Pad:3520
          screenSize=Tonyu.globals.$screenHeight;
        }
        //$LASTPOS=95003553;//kernel.Pad:3553
        _this.padScaleX=screenSize/465;
        //$LASTPOS=95003588;//kernel.Pad:3588
        _this.oldPadScaleX=_this.padScaleX;
        //$LASTPOS=95003619;//kernel.Pad:3619
        _this.oldButtonCnt=_this.buttonCnt;
        //$LASTPOS=95003652;//kernel.Pad:3652
        tempJujiPadWidth = _this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
        
        //$LASTPOS=95003730;//kernel.Pad:3730
        tempJujiPadHeight = _this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
        
        //$LASTPOS=95003809;//kernel.Pad:3809
        tempJujiPadBorder = 4*_this.padScaleX;
        
        //$LASTPOS=95003855;//kernel.Pad:3855
        if (_this.jujiPadWidth!=null) {
          //$LASTPOS=95003881;//kernel.Pad:3881
          tempJujiPadWidth=_this.jujiPadWidth;
        }
        //$LASTPOS=95003919;//kernel.Pad:3919
        if (_this.jujiPadHeight!=null) {
          //$LASTPOS=95003946;//kernel.Pad:3946
          tempJujiPadHeight=_this.jujiPadHeight;
        }
        //$LASTPOS=95003986;//kernel.Pad:3986
        if (_this.jujiPadBorder!=null) {
          //$LASTPOS=95004013;//kernel.Pad:4013
          tempJujiPadBorder=_this.jujiPadBorder;
        }
        //$LASTPOS=95004055;//kernel.Pad:4055
        _this.jujiPads[0]=new Tonyu.classes.kernel.PadButton({mode: 10001,x: 101,y: Tonyu.globals.$screenHeight-101,alpha: _this.alpha,layer: _this.layer,width: tempJujiPadWidth,height: tempJujiPadHeight,padFillColor: _this.jujiPadFillColor,padBorder: tempJujiPadBorder,padBorderColor: _this.jujiPadBorderColor,padLPushColor: (_this.jujiPadLPushColor==null?_this.jujiPadPushColor:_this.jujiPadLPushColor),padRPushColor: (_this.jujiPadRPushColor==null?_this.jujiPadPushColor:_this.jujiPadRPushColor),padUPushColor: (_this.jujiPadUPushColor==null?_this.jujiPadPushColor:_this.jujiPadUPushColor),padDPushColor: (_this.jujiPadDPushColor==null?_this.jujiPadPushColor:_this.jujiPadDPushColor),padLColor: (_this.jujiPadLColor==null?_this.jujiPadColor:_this.jujiPadLColor),padRColor: (_this.jujiPadRColor==null?_this.jujiPadColor:_this.jujiPadRColor),padUColor: (_this.jujiPadUColor==null?_this.jujiPadColor:_this.jujiPadUColor),padDColor: (_this.jujiPadDColor==null?_this.jujiPadColor:_this.jujiPadDColor),diagonalEnable: _this.jujiPadDiagonalEnable,active: _this.active});
        //$LASTPOS=95005116;//kernel.Pad:5116
        //$LASTPOS=95005121;//kernel.Pad:5121
        i = 0;
        for (; i<4 ; i++) {
          {
            //$LASTPOS=95005151;//kernel.Pad:5151
            tempPadWidth = _this.buttonWidth;
            
            //$LASTPOS=95005198;//kernel.Pad:5198
            tempPadHeight = _this.buttonHeight;
            
            //$LASTPOS=95005246;//kernel.Pad:5246
            tempPadFillColor = _this.buttonFillColor;
            
            //$LASTPOS=95005297;//kernel.Pad:5297
            tempPadBorder = _this.buttonBorder;
            
            //$LASTPOS=95005345;//kernel.Pad:5345
            tempPadBorderColor = _this.buttonBorderColor;
            
            //$LASTPOS=95005398;//kernel.Pad:5398
            tempPadPushColor = _this.buttonPushColor;
            
            //$LASTPOS=95005449;//kernel.Pad:5449
            tempPadText = _this.buttonText;
            
            //$LASTPOS=95005495;//kernel.Pad:5495
            tempPadTextSize = _this.buttonTextSize;
            
            //$LASTPOS=95005545;//kernel.Pad:5545
            tempPadTextColor = _this.buttonTextColor;
            
            //$LASTPOS=95005598;//kernel.Pad:5598
            if (_this.buttonCnt==1) {
              //$LASTPOS=95005633;//kernel.Pad:5633
              tempPadWidth=160*_this.padScaleX;
              //$LASTPOS=95005678;//kernel.Pad:5678
              tempPadHeight=160*_this.padScaleX;
              //$LASTPOS=95005724;//kernel.Pad:5724
              tempPadBorder=1*_this.padScaleX;
              //$LASTPOS=95005768;//kernel.Pad:5768
              tempPadTextSize=120*screenSize/_this.DEFALT_SCREEN_WIDTH;
              
            } else {
              //$LASTPOS=95005842;//kernel.Pad:5842
              if (_this.buttonCnt>=2) {
                //$LASTPOS=95005877;//kernel.Pad:5877
                if (i<4) {
                  //$LASTPOS=95005907;//kernel.Pad:5907
                  obj = _this.buttons[i];
                  
                  //$LASTPOS=95005946;//kernel.Pad:5946
                  if (obj) {
                    //$LASTPOS=95005978;//kernel.Pad:5978
                    if (_this.buttonCnt==3&&i==2) {
                      //$LASTPOS=95006035;//kernel.Pad:6035
                      tempPadWidth=194*_this.padScaleX;
                      
                    } else {
                      //$LASTPOS=95006122;//kernel.Pad:6122
                      tempPadWidth=96*_this.padScaleX;
                      
                    }
                    //$LASTPOS=95006197;//kernel.Pad:6197
                    tempPadHeight=96*_this.padScaleX;
                    //$LASTPOS=95006250;//kernel.Pad:6250
                    tempPadBorder=1*_this.padScaleX;
                    //$LASTPOS=95006302;//kernel.Pad:6302
                    tempPadTextSize=72*screenSize/_this.DEFALT_SCREEN_WIDTH;
                    
                  }
                  
                }
                
              }
            }
            //$LASTPOS=95006415;//kernel.Pad:6415
            if (_this.buttonWidth!=null) {
              //$LASTPOS=95006444;//kernel.Pad:6444
              tempPadWidth=_this.buttonWidth;
            }
            //$LASTPOS=95006484;//kernel.Pad:6484
            if (_this.buttonHeight!=null) {
              //$LASTPOS=95006513;//kernel.Pad:6513
              tempPadHeight=_this.buttonHeight;
            }
            //$LASTPOS=95006554;//kernel.Pad:6554
            if (_this.buttonBorder!=null) {
              //$LASTPOS=95006583;//kernel.Pad:6583
              tempPadBorder=_this.buttonBorder;
            }
            //$LASTPOS=95006624;//kernel.Pad:6624
            if (tempPadTextSize!=null) {
              //$LASTPOS=95006653;//kernel.Pad:6653
              tempPadTextSize=tempPadTextSize;
            }
            //$LASTPOS=95006699;//kernel.Pad:6699
            if (i==0) {
              //$LASTPOS=95006726;//kernel.Pad:6726
              if (_this.button1Width!=null) {
                //$LASTPOS=95006758;//kernel.Pad:6758
                tempPadWidth=_this.button1Width;
              }
              //$LASTPOS=95006806;//kernel.Pad:6806
              if (_this.button1Height!=null) {
                //$LASTPOS=95006838;//kernel.Pad:6838
                tempPadHeight=_this.button1Height;
              }
              //$LASTPOS=95006887;//kernel.Pad:6887
              if (_this.button1FillColor!=null) {
                //$LASTPOS=95006919;//kernel.Pad:6919
                tempPadFillColor=_this.button1FillColor;
              }
              //$LASTPOS=95006971;//kernel.Pad:6971
              if (_this.button1Border!=null) {
                //$LASTPOS=95007003;//kernel.Pad:7003
                tempPadBorder=_this.button1Border;
              }
              //$LASTPOS=95007052;//kernel.Pad:7052
              if (_this.button1BorderColor!=null) {
                //$LASTPOS=95007084;//kernel.Pad:7084
                tempPadBorderColor=_this.button1BorderColor;
              }
              //$LASTPOS=95007138;//kernel.Pad:7138
              if (_this.button1PushColor!=null) {
                //$LASTPOS=95007170;//kernel.Pad:7170
                tempPadPushColor=_this.button1PushColor;
              }
              //$LASTPOS=95007222;//kernel.Pad:7222
              if (_this.button1Text!=null) {
                //$LASTPOS=95007254;//kernel.Pad:7254
                tempPadText=_this.button1Text;
              }
              //$LASTPOS=95007301;//kernel.Pad:7301
              if (_this.button1TextSize!=null) {
                //$LASTPOS=95007333;//kernel.Pad:7333
                tempPadTextSize=_this.button1TextSize;
              }
              //$LASTPOS=95007384;//kernel.Pad:7384
              if (_this.button1TextColor!=null) {
                //$LASTPOS=95007416;//kernel.Pad:7416
                tempPadTextColor=_this.button1TextColor;
              }
              
            } else {
              //$LASTPOS=95007471;//kernel.Pad:7471
              if (i==1) {
                //$LASTPOS=95007498;//kernel.Pad:7498
                if (_this.button2Width!=null) {
                  //$LASTPOS=95007530;//kernel.Pad:7530
                  tempPadWidth=_this.button2Width;
                }
                //$LASTPOS=95007578;//kernel.Pad:7578
                if (_this.button2Height!=null) {
                  //$LASTPOS=95007610;//kernel.Pad:7610
                  tempPadHeight=_this.button2Height;
                }
                //$LASTPOS=95007659;//kernel.Pad:7659
                if (_this.button2FillColor!=null) {
                  //$LASTPOS=95007691;//kernel.Pad:7691
                  tempPadFillColor=_this.button2FillColor;
                }
                //$LASTPOS=95007743;//kernel.Pad:7743
                if (_this.button2Border!=null) {
                  //$LASTPOS=95007775;//kernel.Pad:7775
                  tempPadBorder=_this.button2Border;
                }
                //$LASTPOS=95007824;//kernel.Pad:7824
                if (_this.button2BorderColor!=null) {
                  //$LASTPOS=95007856;//kernel.Pad:7856
                  tempPadBorderColor=_this.button2BorderColor;
                }
                //$LASTPOS=95007910;//kernel.Pad:7910
                if (_this.button2PushColor!=null) {
                  //$LASTPOS=95007942;//kernel.Pad:7942
                  tempPadPushColor=_this.button2PushColor;
                }
                //$LASTPOS=95007994;//kernel.Pad:7994
                if (_this.button2Text!=null) {
                  //$LASTPOS=95008026;//kernel.Pad:8026
                  tempPadText=_this.button2Text;
                }
                //$LASTPOS=95008073;//kernel.Pad:8073
                if (_this.button2TextSize!=null) {
                  //$LASTPOS=95008105;//kernel.Pad:8105
                  tempPadTextSize=_this.button2TextSize;
                }
                //$LASTPOS=95008156;//kernel.Pad:8156
                if (_this.button2TextColor!=null) {
                  //$LASTPOS=95008188;//kernel.Pad:8188
                  tempPadTextColor=_this.button2TextColor;
                }
                
              } else {
                //$LASTPOS=95008243;//kernel.Pad:8243
                if (i==2) {
                  //$LASTPOS=95008270;//kernel.Pad:8270
                  if (_this.button3Width!=null) {
                    //$LASTPOS=95008302;//kernel.Pad:8302
                    tempPadWidth=_this.button3Width;
                  }
                  //$LASTPOS=95008350;//kernel.Pad:8350
                  if (_this.button3Height!=null) {
                    //$LASTPOS=95008382;//kernel.Pad:8382
                    tempPadHeight=_this.button3Height;
                  }
                  //$LASTPOS=95008431;//kernel.Pad:8431
                  if (_this.button3FillColor!=null) {
                    //$LASTPOS=95008463;//kernel.Pad:8463
                    tempPadFillColor=_this.button3FillColor;
                  }
                  //$LASTPOS=95008515;//kernel.Pad:8515
                  if (_this.button3Border!=null) {
                    //$LASTPOS=95008547;//kernel.Pad:8547
                    tempPadBorder=_this.button3Border;
                  }
                  //$LASTPOS=95008596;//kernel.Pad:8596
                  if (_this.button3BorderColor!=null) {
                    //$LASTPOS=95008628;//kernel.Pad:8628
                    tempPadBorderColor=_this.button3BorderColor;
                  }
                  //$LASTPOS=95008682;//kernel.Pad:8682
                  if (_this.button3PushColor!=null) {
                    //$LASTPOS=95008714;//kernel.Pad:8714
                    tempPadPushColor=_this.button3PushColor;
                  }
                  //$LASTPOS=95008766;//kernel.Pad:8766
                  if (_this.button3Text!=null) {
                    //$LASTPOS=95008798;//kernel.Pad:8798
                    tempPadText=_this.button3Text;
                  }
                  //$LASTPOS=95008845;//kernel.Pad:8845
                  if (_this.button3TextSize!=null) {
                    //$LASTPOS=95008877;//kernel.Pad:8877
                    tempPadTextSize=_this.button3TextSize;
                  }
                  //$LASTPOS=95008928;//kernel.Pad:8928
                  if (_this.button3TextColor!=null) {
                    //$LASTPOS=95008960;//kernel.Pad:8960
                    tempPadTextColor=_this.button3TextColor;
                  }
                  
                } else {
                  //$LASTPOS=95009015;//kernel.Pad:9015
                  if (i==3) {
                    //$LASTPOS=95009042;//kernel.Pad:9042
                    if (_this.button4Width!=null) {
                      //$LASTPOS=95009074;//kernel.Pad:9074
                      tempPadWidth=_this.button4Width;
                    }
                    //$LASTPOS=95009122;//kernel.Pad:9122
                    if (_this.button4Height!=null) {
                      //$LASTPOS=95009154;//kernel.Pad:9154
                      tempPadHeight=_this.button4Height;
                    }
                    //$LASTPOS=95009203;//kernel.Pad:9203
                    if (_this.button4FillColor!=null) {
                      //$LASTPOS=95009235;//kernel.Pad:9235
                      tempPadFillColor=_this.button4FillColor;
                    }
                    //$LASTPOS=95009287;//kernel.Pad:9287
                    if (_this.button4Border!=null) {
                      //$LASTPOS=95009319;//kernel.Pad:9319
                      tempPadBorder=_this.button4Border;
                    }
                    //$LASTPOS=95009368;//kernel.Pad:9368
                    if (_this.button4BorderColor!=null) {
                      //$LASTPOS=95009400;//kernel.Pad:9400
                      tempPadBorderColor=_this.button4BorderColor;
                    }
                    //$LASTPOS=95009454;//kernel.Pad:9454
                    if (_this.button4PushColor!=null) {
                      //$LASTPOS=95009486;//kernel.Pad:9486
                      tempPadPushColor=_this.button4PushColor;
                    }
                    //$LASTPOS=95009538;//kernel.Pad:9538
                    if (_this.button4Text!=null) {
                      //$LASTPOS=95009570;//kernel.Pad:9570
                      tempPadText=_this.button4Text;
                    }
                    //$LASTPOS=95009617;//kernel.Pad:9617
                    if (_this.button4TextSize!=null) {
                      //$LASTPOS=95009649;//kernel.Pad:9649
                      tempPadTextSize=_this.button4TextSize;
                    }
                    //$LASTPOS=95009700;//kernel.Pad:9700
                    if (_this.button4TextColor!=null) {
                      //$LASTPOS=95009732;//kernel.Pad:9732
                      tempPadTextColor=_this.button4TextColor;
                    }
                    
                  }
                }
              }
            }
            //$LASTPOS=95009793;//kernel.Pad:9793
            _this.buttons[i]=new Tonyu.classes.kernel.PadButton({mode: 10000,x: 50+(i-4)%4*100,y: 50+_this.trunc((i-4)/4)*100,alpha: _this.alpha,layer: _this.layer,width: tempPadWidth,height: tempPadHeight,padFillColor: tempPadFillColor,padBorder: tempPadBorder,padBorderColor: tempPadBorderColor,padPushColor: tempPadPushColor,padText: tempPadText?tempPadText:i+1,padTextSize: tempPadTextSize,padTextColor: tempPadTextColor,active: _this.active});
            //$LASTPOS=95010374;//kernel.Pad:10374
            _this.buttons[i].drawPanel();
          }
        }
        //$LASTPOS=95010412;//kernel.Pad:10412
        if (_this.autoMove) {
          //$LASTPOS=95010426;//kernel.Pad:10426
          _this.drawPanel();
        }
      },
      fiber$initButtonLayout1 :function _trc_Pad_f_initButtonLayout1(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var screenSize;
        var tempJujiPadWidth;
        var tempJujiPadHeight;
        var tempJujiPadBorder;
        var i;
        var tempPadWidth;
        var tempPadHeight;
        var tempPadFillColor;
        var tempPadBorder;
        var tempPadBorderColor;
        var tempPadPushColor;
        var tempPadText;
        var tempPadTextSize;
        var tempPadTextColor;
        var obj;
        
        //$LASTPOS=95003450;//kernel.Pad:3450
        screenSize = Tonyu.globals.$screenWidth;
        
        //$LASTPOS=95003486;//kernel.Pad:3486
        if (Tonyu.globals.$screenWidth>Tonyu.globals.$screenHeight) {
          //$LASTPOS=95003520;//kernel.Pad:3520
          screenSize=Tonyu.globals.$screenHeight;
        }
        //$LASTPOS=95003553;//kernel.Pad:3553
        _this.padScaleX=screenSize/465;
        //$LASTPOS=95003588;//kernel.Pad:3588
        _this.oldPadScaleX=_this.padScaleX;
        //$LASTPOS=95003619;//kernel.Pad:3619
        _this.oldButtonCnt=_this.buttonCnt;
        //$LASTPOS=95003652;//kernel.Pad:3652
        tempJujiPadWidth = _this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
        
        //$LASTPOS=95003730;//kernel.Pad:3730
        tempJujiPadHeight = _this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
        
        //$LASTPOS=95003809;//kernel.Pad:3809
        tempJujiPadBorder = 4*_this.padScaleX;
        
        //$LASTPOS=95003855;//kernel.Pad:3855
        if (_this.jujiPadWidth!=null) {
          //$LASTPOS=95003881;//kernel.Pad:3881
          tempJujiPadWidth=_this.jujiPadWidth;
        }
        //$LASTPOS=95003919;//kernel.Pad:3919
        if (_this.jujiPadHeight!=null) {
          //$LASTPOS=95003946;//kernel.Pad:3946
          tempJujiPadHeight=_this.jujiPadHeight;
        }
        //$LASTPOS=95003986;//kernel.Pad:3986
        if (_this.jujiPadBorder!=null) {
          //$LASTPOS=95004013;//kernel.Pad:4013
          tempJujiPadBorder=_this.jujiPadBorder;
        }
        //$LASTPOS=95004055;//kernel.Pad:4055
        _this.jujiPads[0]=new Tonyu.classes.kernel.PadButton({mode: 10001,x: 101,y: Tonyu.globals.$screenHeight-101,alpha: _this.alpha,layer: _this.layer,width: tempJujiPadWidth,height: tempJujiPadHeight,padFillColor: _this.jujiPadFillColor,padBorder: tempJujiPadBorder,padBorderColor: _this.jujiPadBorderColor,padLPushColor: (_this.jujiPadLPushColor==null?_this.jujiPadPushColor:_this.jujiPadLPushColor),padRPushColor: (_this.jujiPadRPushColor==null?_this.jujiPadPushColor:_this.jujiPadRPushColor),padUPushColor: (_this.jujiPadUPushColor==null?_this.jujiPadPushColor:_this.jujiPadUPushColor),padDPushColor: (_this.jujiPadDPushColor==null?_this.jujiPadPushColor:_this.jujiPadDPushColor),padLColor: (_this.jujiPadLColor==null?_this.jujiPadColor:_this.jujiPadLColor),padRColor: (_this.jujiPadRColor==null?_this.jujiPadColor:_this.jujiPadRColor),padUColor: (_this.jujiPadUColor==null?_this.jujiPadColor:_this.jujiPadUColor),padDColor: (_this.jujiPadDColor==null?_this.jujiPadColor:_this.jujiPadDColor),diagonalEnable: _this.jujiPadDiagonalEnable,active: _this.active});
        //$LASTPOS=95005116;//kernel.Pad:5116
        //$LASTPOS=95005121;//kernel.Pad:5121
        i = 0;
        for (; i<4 ; i++) {
          {
            //$LASTPOS=95005151;//kernel.Pad:5151
            tempPadWidth = _this.buttonWidth;
            
            //$LASTPOS=95005198;//kernel.Pad:5198
            tempPadHeight = _this.buttonHeight;
            
            //$LASTPOS=95005246;//kernel.Pad:5246
            tempPadFillColor = _this.buttonFillColor;
            
            //$LASTPOS=95005297;//kernel.Pad:5297
            tempPadBorder = _this.buttonBorder;
            
            //$LASTPOS=95005345;//kernel.Pad:5345
            tempPadBorderColor = _this.buttonBorderColor;
            
            //$LASTPOS=95005398;//kernel.Pad:5398
            tempPadPushColor = _this.buttonPushColor;
            
            //$LASTPOS=95005449;//kernel.Pad:5449
            tempPadText = _this.buttonText;
            
            //$LASTPOS=95005495;//kernel.Pad:5495
            tempPadTextSize = _this.buttonTextSize;
            
            //$LASTPOS=95005545;//kernel.Pad:5545
            tempPadTextColor = _this.buttonTextColor;
            
            //$LASTPOS=95005598;//kernel.Pad:5598
            if (_this.buttonCnt==1) {
              //$LASTPOS=95005633;//kernel.Pad:5633
              tempPadWidth=160*_this.padScaleX;
              //$LASTPOS=95005678;//kernel.Pad:5678
              tempPadHeight=160*_this.padScaleX;
              //$LASTPOS=95005724;//kernel.Pad:5724
              tempPadBorder=1*_this.padScaleX;
              //$LASTPOS=95005768;//kernel.Pad:5768
              tempPadTextSize=120*screenSize/_this.DEFALT_SCREEN_WIDTH;
              
            } else {
              //$LASTPOS=95005842;//kernel.Pad:5842
              if (_this.buttonCnt>=2) {
                //$LASTPOS=95005877;//kernel.Pad:5877
                if (i<4) {
                  //$LASTPOS=95005907;//kernel.Pad:5907
                  obj = _this.buttons[i];
                  
                  //$LASTPOS=95005946;//kernel.Pad:5946
                  if (obj) {
                    //$LASTPOS=95005978;//kernel.Pad:5978
                    if (_this.buttonCnt==3&&i==2) {
                      //$LASTPOS=95006035;//kernel.Pad:6035
                      tempPadWidth=194*_this.padScaleX;
                      
                    } else {
                      //$LASTPOS=95006122;//kernel.Pad:6122
                      tempPadWidth=96*_this.padScaleX;
                      
                    }
                    //$LASTPOS=95006197;//kernel.Pad:6197
                    tempPadHeight=96*_this.padScaleX;
                    //$LASTPOS=95006250;//kernel.Pad:6250
                    tempPadBorder=1*_this.padScaleX;
                    //$LASTPOS=95006302;//kernel.Pad:6302
                    tempPadTextSize=72*screenSize/_this.DEFALT_SCREEN_WIDTH;
                    
                  }
                  
                }
                
              }
            }
            //$LASTPOS=95006415;//kernel.Pad:6415
            if (_this.buttonWidth!=null) {
              //$LASTPOS=95006444;//kernel.Pad:6444
              tempPadWidth=_this.buttonWidth;
            }
            //$LASTPOS=95006484;//kernel.Pad:6484
            if (_this.buttonHeight!=null) {
              //$LASTPOS=95006513;//kernel.Pad:6513
              tempPadHeight=_this.buttonHeight;
            }
            //$LASTPOS=95006554;//kernel.Pad:6554
            if (_this.buttonBorder!=null) {
              //$LASTPOS=95006583;//kernel.Pad:6583
              tempPadBorder=_this.buttonBorder;
            }
            //$LASTPOS=95006624;//kernel.Pad:6624
            if (tempPadTextSize!=null) {
              //$LASTPOS=95006653;//kernel.Pad:6653
              tempPadTextSize=tempPadTextSize;
            }
            //$LASTPOS=95006699;//kernel.Pad:6699
            if (i==0) {
              //$LASTPOS=95006726;//kernel.Pad:6726
              if (_this.button1Width!=null) {
                //$LASTPOS=95006758;//kernel.Pad:6758
                tempPadWidth=_this.button1Width;
              }
              //$LASTPOS=95006806;//kernel.Pad:6806
              if (_this.button1Height!=null) {
                //$LASTPOS=95006838;//kernel.Pad:6838
                tempPadHeight=_this.button1Height;
              }
              //$LASTPOS=95006887;//kernel.Pad:6887
              if (_this.button1FillColor!=null) {
                //$LASTPOS=95006919;//kernel.Pad:6919
                tempPadFillColor=_this.button1FillColor;
              }
              //$LASTPOS=95006971;//kernel.Pad:6971
              if (_this.button1Border!=null) {
                //$LASTPOS=95007003;//kernel.Pad:7003
                tempPadBorder=_this.button1Border;
              }
              //$LASTPOS=95007052;//kernel.Pad:7052
              if (_this.button1BorderColor!=null) {
                //$LASTPOS=95007084;//kernel.Pad:7084
                tempPadBorderColor=_this.button1BorderColor;
              }
              //$LASTPOS=95007138;//kernel.Pad:7138
              if (_this.button1PushColor!=null) {
                //$LASTPOS=95007170;//kernel.Pad:7170
                tempPadPushColor=_this.button1PushColor;
              }
              //$LASTPOS=95007222;//kernel.Pad:7222
              if (_this.button1Text!=null) {
                //$LASTPOS=95007254;//kernel.Pad:7254
                tempPadText=_this.button1Text;
              }
              //$LASTPOS=95007301;//kernel.Pad:7301
              if (_this.button1TextSize!=null) {
                //$LASTPOS=95007333;//kernel.Pad:7333
                tempPadTextSize=_this.button1TextSize;
              }
              //$LASTPOS=95007384;//kernel.Pad:7384
              if (_this.button1TextColor!=null) {
                //$LASTPOS=95007416;//kernel.Pad:7416
                tempPadTextColor=_this.button1TextColor;
              }
              
            } else {
              //$LASTPOS=95007471;//kernel.Pad:7471
              if (i==1) {
                //$LASTPOS=95007498;//kernel.Pad:7498
                if (_this.button2Width!=null) {
                  //$LASTPOS=95007530;//kernel.Pad:7530
                  tempPadWidth=_this.button2Width;
                }
                //$LASTPOS=95007578;//kernel.Pad:7578
                if (_this.button2Height!=null) {
                  //$LASTPOS=95007610;//kernel.Pad:7610
                  tempPadHeight=_this.button2Height;
                }
                //$LASTPOS=95007659;//kernel.Pad:7659
                if (_this.button2FillColor!=null) {
                  //$LASTPOS=95007691;//kernel.Pad:7691
                  tempPadFillColor=_this.button2FillColor;
                }
                //$LASTPOS=95007743;//kernel.Pad:7743
                if (_this.button2Border!=null) {
                  //$LASTPOS=95007775;//kernel.Pad:7775
                  tempPadBorder=_this.button2Border;
                }
                //$LASTPOS=95007824;//kernel.Pad:7824
                if (_this.button2BorderColor!=null) {
                  //$LASTPOS=95007856;//kernel.Pad:7856
                  tempPadBorderColor=_this.button2BorderColor;
                }
                //$LASTPOS=95007910;//kernel.Pad:7910
                if (_this.button2PushColor!=null) {
                  //$LASTPOS=95007942;//kernel.Pad:7942
                  tempPadPushColor=_this.button2PushColor;
                }
                //$LASTPOS=95007994;//kernel.Pad:7994
                if (_this.button2Text!=null) {
                  //$LASTPOS=95008026;//kernel.Pad:8026
                  tempPadText=_this.button2Text;
                }
                //$LASTPOS=95008073;//kernel.Pad:8073
                if (_this.button2TextSize!=null) {
                  //$LASTPOS=95008105;//kernel.Pad:8105
                  tempPadTextSize=_this.button2TextSize;
                }
                //$LASTPOS=95008156;//kernel.Pad:8156
                if (_this.button2TextColor!=null) {
                  //$LASTPOS=95008188;//kernel.Pad:8188
                  tempPadTextColor=_this.button2TextColor;
                }
                
              } else {
                //$LASTPOS=95008243;//kernel.Pad:8243
                if (i==2) {
                  //$LASTPOS=95008270;//kernel.Pad:8270
                  if (_this.button3Width!=null) {
                    //$LASTPOS=95008302;//kernel.Pad:8302
                    tempPadWidth=_this.button3Width;
                  }
                  //$LASTPOS=95008350;//kernel.Pad:8350
                  if (_this.button3Height!=null) {
                    //$LASTPOS=95008382;//kernel.Pad:8382
                    tempPadHeight=_this.button3Height;
                  }
                  //$LASTPOS=95008431;//kernel.Pad:8431
                  if (_this.button3FillColor!=null) {
                    //$LASTPOS=95008463;//kernel.Pad:8463
                    tempPadFillColor=_this.button3FillColor;
                  }
                  //$LASTPOS=95008515;//kernel.Pad:8515
                  if (_this.button3Border!=null) {
                    //$LASTPOS=95008547;//kernel.Pad:8547
                    tempPadBorder=_this.button3Border;
                  }
                  //$LASTPOS=95008596;//kernel.Pad:8596
                  if (_this.button3BorderColor!=null) {
                    //$LASTPOS=95008628;//kernel.Pad:8628
                    tempPadBorderColor=_this.button3BorderColor;
                  }
                  //$LASTPOS=95008682;//kernel.Pad:8682
                  if (_this.button3PushColor!=null) {
                    //$LASTPOS=95008714;//kernel.Pad:8714
                    tempPadPushColor=_this.button3PushColor;
                  }
                  //$LASTPOS=95008766;//kernel.Pad:8766
                  if (_this.button3Text!=null) {
                    //$LASTPOS=95008798;//kernel.Pad:8798
                    tempPadText=_this.button3Text;
                  }
                  //$LASTPOS=95008845;//kernel.Pad:8845
                  if (_this.button3TextSize!=null) {
                    //$LASTPOS=95008877;//kernel.Pad:8877
                    tempPadTextSize=_this.button3TextSize;
                  }
                  //$LASTPOS=95008928;//kernel.Pad:8928
                  if (_this.button3TextColor!=null) {
                    //$LASTPOS=95008960;//kernel.Pad:8960
                    tempPadTextColor=_this.button3TextColor;
                  }
                  
                } else {
                  //$LASTPOS=95009015;//kernel.Pad:9015
                  if (i==3) {
                    //$LASTPOS=95009042;//kernel.Pad:9042
                    if (_this.button4Width!=null) {
                      //$LASTPOS=95009074;//kernel.Pad:9074
                      tempPadWidth=_this.button4Width;
                    }
                    //$LASTPOS=95009122;//kernel.Pad:9122
                    if (_this.button4Height!=null) {
                      //$LASTPOS=95009154;//kernel.Pad:9154
                      tempPadHeight=_this.button4Height;
                    }
                    //$LASTPOS=95009203;//kernel.Pad:9203
                    if (_this.button4FillColor!=null) {
                      //$LASTPOS=95009235;//kernel.Pad:9235
                      tempPadFillColor=_this.button4FillColor;
                    }
                    //$LASTPOS=95009287;//kernel.Pad:9287
                    if (_this.button4Border!=null) {
                      //$LASTPOS=95009319;//kernel.Pad:9319
                      tempPadBorder=_this.button4Border;
                    }
                    //$LASTPOS=95009368;//kernel.Pad:9368
                    if (_this.button4BorderColor!=null) {
                      //$LASTPOS=95009400;//kernel.Pad:9400
                      tempPadBorderColor=_this.button4BorderColor;
                    }
                    //$LASTPOS=95009454;//kernel.Pad:9454
                    if (_this.button4PushColor!=null) {
                      //$LASTPOS=95009486;//kernel.Pad:9486
                      tempPadPushColor=_this.button4PushColor;
                    }
                    //$LASTPOS=95009538;//kernel.Pad:9538
                    if (_this.button4Text!=null) {
                      //$LASTPOS=95009570;//kernel.Pad:9570
                      tempPadText=_this.button4Text;
                    }
                    //$LASTPOS=95009617;//kernel.Pad:9617
                    if (_this.button4TextSize!=null) {
                      //$LASTPOS=95009649;//kernel.Pad:9649
                      tempPadTextSize=_this.button4TextSize;
                    }
                    //$LASTPOS=95009700;//kernel.Pad:9700
                    if (_this.button4TextColor!=null) {
                      //$LASTPOS=95009732;//kernel.Pad:9732
                      tempPadTextColor=_this.button4TextColor;
                    }
                    
                  }
                }
              }
            }
            //$LASTPOS=95009793;//kernel.Pad:9793
            _this.buttons[i]=new Tonyu.classes.kernel.PadButton({mode: 10000,x: 50+(i-4)%4*100,y: 50+_this.trunc((i-4)/4)*100,alpha: _this.alpha,layer: _this.layer,width: tempPadWidth,height: tempPadHeight,padFillColor: tempPadFillColor,padBorder: tempPadBorder,padBorderColor: tempPadBorderColor,padPushColor: tempPadPushColor,padText: tempPadText?tempPadText:i+1,padTextSize: tempPadTextSize,padTextColor: tempPadTextColor,active: _this.active});
            //$LASTPOS=95010374;//kernel.Pad:10374
            _this.buttons[i].drawPanel();
          }
        }
        
        _thread.enter(function _trc_Pad_ent_initButtonLayout1(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95010412;//kernel.Pad:10412
              if (!(_this.autoMove)) { __pc=2     ; break; }
              //$LASTPOS=95010426;//kernel.Pad:10426
              _this.fiber$drawPanel(_thread);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      drawPanel :function _trc_Pad_drawPanel() {
        "use strict";
        var _this=this;
        var screenSize;
        var i;
        var obj;
        
        //$LASTPOS=95010465;//kernel.Pad:10465
        if (_this.layout==1) {
          //$LASTPOS=95010493;//kernel.Pad:10493
          screenSize = Tonyu.globals.$screenWidth;
          
          //$LASTPOS=95010533;//kernel.Pad:10533
          if (Tonyu.globals.$screenWidth>Tonyu.globals.$screenHeight) {
            //$LASTPOS=95010567;//kernel.Pad:10567
            screenSize=Tonyu.globals.$screenHeight;
          }
          //$LASTPOS=95010604;//kernel.Pad:10604
          _this.jujiPads[0].width=_this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
          //$LASTPOS=95010683;//kernel.Pad:10683
          _this.jujiPads[0].height=_this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
          //$LASTPOS=95010763;//kernel.Pad:10763
          _this.jujiPads[0].padBorder=1*_this.padScaleX;
          //$LASTPOS=95010813;//kernel.Pad:10813
          if (_this.buttonCnt==1) {
            //$LASTPOS=95010848;//kernel.Pad:10848
            _this.buttons[0].width=160*_this.padScaleX;
            //$LASTPOS=95010897;//kernel.Pad:10897
            _this.buttons[0].height=160*_this.padScaleX;
            //$LASTPOS=95010947;//kernel.Pad:10947
            _this.buttons[0].padBorder=1*_this.padScaleX;
            //$LASTPOS=95010998;//kernel.Pad:10998
            _this.buttons[0].padTextSize=120*screenSize/_this.DEFALT_SCREEN_WIDTH;
            
          } else {
            //$LASTPOS=95011079;//kernel.Pad:11079
            if (_this.buttonCnt>=2) {
              //$LASTPOS=95011114;//kernel.Pad:11114
              //$LASTPOS=95011119;//kernel.Pad:11119
              i = 0;
              for (; i<_this.buttons.length ; i++) {
                {
                  //$LASTPOS=95011170;//kernel.Pad:11170
                  if (i>=4) {
                    break;
                    
                  }
                  //$LASTPOS=95011206;//kernel.Pad:11206
                  obj = _this.buttons[i];
                  
                  //$LASTPOS=95011245;//kernel.Pad:11245
                  if (obj) {
                    //$LASTPOS=95011277;//kernel.Pad:11277
                    if (_this.buttonCnt==3&&i==2) {
                      //$LASTPOS=95011334;//kernel.Pad:11334
                      obj.width=194*_this.padScaleX;
                      
                    } else {
                      //$LASTPOS=95011418;//kernel.Pad:11418
                      obj.width=96*_this.padScaleX;
                      
                    }
                    //$LASTPOS=95011490;//kernel.Pad:11490
                    obj.height=96*_this.padScaleX;
                    //$LASTPOS=95011540;//kernel.Pad:11540
                    obj.padBorder=1*_this.padScaleX;
                    //$LASTPOS=95011592;//kernel.Pad:11592
                    obj.padTextSize=72*screenSize/_this.DEFALT_SCREEN_WIDTH;
                    
                  }
                }
              }
              
            }
          }
          
        }
        //$LASTPOS=95011708;//kernel.Pad:11708
        //$LASTPOS=95011713;//kernel.Pad:11713
        i = 0;
        for (; i<_this.jujiPads.length ; i++) {
          {
            //$LASTPOS=95011757;//kernel.Pad:11757
            obj = _this.jujiPads[i];
            
            //$LASTPOS=95011789;//kernel.Pad:11789
            if (obj) {
              //$LASTPOS=95011798;//kernel.Pad:11798
              obj.drawPanel();
            }
          }
        }
        //$LASTPOS=95011827;//kernel.Pad:11827
        //$LASTPOS=95011832;//kernel.Pad:11832
        i = 0;
        for (; i<_this.buttons.length ; i++) {
          {
            //$LASTPOS=95011875;//kernel.Pad:11875
            obj = _this.buttons[i];
            
            //$LASTPOS=95011906;//kernel.Pad:11906
            if (obj) {
              //$LASTPOS=95011930;//kernel.Pad:11930
              if (i<_this.buttonCnt) {
                //$LASTPOS=95011966;//kernel.Pad:11966
                obj.show();
                //$LASTPOS=95011995;//kernel.Pad:11995
                obj.drawPanel();
                
              } else {
                //$LASTPOS=95012051;//kernel.Pad:12051
                obj.hide();
                
              }
              
            }
          }
        }
      },
      fiber$drawPanel :function _trc_Pad_f_drawPanel(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var screenSize;
        var i;
        var obj;
        
        //$LASTPOS=95010465;//kernel.Pad:10465
        if (_this.layout==1) {
          //$LASTPOS=95010493;//kernel.Pad:10493
          screenSize = Tonyu.globals.$screenWidth;
          
          //$LASTPOS=95010533;//kernel.Pad:10533
          if (Tonyu.globals.$screenWidth>Tonyu.globals.$screenHeight) {
            //$LASTPOS=95010567;//kernel.Pad:10567
            screenSize=Tonyu.globals.$screenHeight;
          }
          //$LASTPOS=95010604;//kernel.Pad:10604
          _this.jujiPads[0].width=_this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
          //$LASTPOS=95010683;//kernel.Pad:10683
          _this.jujiPads[0].height=_this.trunc(72*screenSize/_this.DEFALT_SCREEN_WIDTH)*3;
          //$LASTPOS=95010763;//kernel.Pad:10763
          _this.jujiPads[0].padBorder=1*_this.padScaleX;
          //$LASTPOS=95010813;//kernel.Pad:10813
          if (_this.buttonCnt==1) {
            //$LASTPOS=95010848;//kernel.Pad:10848
            _this.buttons[0].width=160*_this.padScaleX;
            //$LASTPOS=95010897;//kernel.Pad:10897
            _this.buttons[0].height=160*_this.padScaleX;
            //$LASTPOS=95010947;//kernel.Pad:10947
            _this.buttons[0].padBorder=1*_this.padScaleX;
            //$LASTPOS=95010998;//kernel.Pad:10998
            _this.buttons[0].padTextSize=120*screenSize/_this.DEFALT_SCREEN_WIDTH;
            
          } else {
            //$LASTPOS=95011079;//kernel.Pad:11079
            if (_this.buttonCnt>=2) {
              //$LASTPOS=95011114;//kernel.Pad:11114
              //$LASTPOS=95011119;//kernel.Pad:11119
              i = 0;
              for (; i<_this.buttons.length ; i++) {
                {
                  //$LASTPOS=95011170;//kernel.Pad:11170
                  if (i>=4) {
                    break;
                    
                  }
                  //$LASTPOS=95011206;//kernel.Pad:11206
                  obj = _this.buttons[i];
                  
                  //$LASTPOS=95011245;//kernel.Pad:11245
                  if (obj) {
                    //$LASTPOS=95011277;//kernel.Pad:11277
                    if (_this.buttonCnt==3&&i==2) {
                      //$LASTPOS=95011334;//kernel.Pad:11334
                      obj.width=194*_this.padScaleX;
                      
                    } else {
                      //$LASTPOS=95011418;//kernel.Pad:11418
                      obj.width=96*_this.padScaleX;
                      
                    }
                    //$LASTPOS=95011490;//kernel.Pad:11490
                    obj.height=96*_this.padScaleX;
                    //$LASTPOS=95011540;//kernel.Pad:11540
                    obj.padBorder=1*_this.padScaleX;
                    //$LASTPOS=95011592;//kernel.Pad:11592
                    obj.padTextSize=72*screenSize/_this.DEFALT_SCREEN_WIDTH;
                    
                  }
                }
              }
              
            }
          }
          
        }
        //$LASTPOS=95011708;//kernel.Pad:11708
        //$LASTPOS=95011713;//kernel.Pad:11713
        i = 0;
        for (; i<_this.jujiPads.length ; i++) {
          {
            //$LASTPOS=95011757;//kernel.Pad:11757
            obj = _this.jujiPads[i];
            
            //$LASTPOS=95011789;//kernel.Pad:11789
            if (obj) {
              //$LASTPOS=95011798;//kernel.Pad:11798
              obj.drawPanel();
            }
          }
        }
        //$LASTPOS=95011827;//kernel.Pad:11827
        //$LASTPOS=95011832;//kernel.Pad:11832
        i = 0;
        for (; i<_this.buttons.length ; i++) {
          {
            //$LASTPOS=95011875;//kernel.Pad:11875
            obj = _this.buttons[i];
            
            //$LASTPOS=95011906;//kernel.Pad:11906
            if (obj) {
              //$LASTPOS=95011930;//kernel.Pad:11930
              if (i<_this.buttonCnt) {
                //$LASTPOS=95011966;//kernel.Pad:11966
                obj.show();
                //$LASTPOS=95011995;//kernel.Pad:11995
                obj.drawPanel();
                
              } else {
                //$LASTPOS=95012051;//kernel.Pad:12051
                obj.hide();
                
              }
              
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      setXYPanel :function _trc_Pad_setXYPanel() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95012123;//kernel.Pad:12123
        if (_this.layout==1) {
          //$LASTPOS=95012175;//kernel.Pad:12175
          _this.setXYPanelLayout1();
          
        }
      },
      fiber$setXYPanel :function _trc_Pad_f_setXYPanel(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_setXYPanel(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95012123;//kernel.Pad:12123
              if (!(_this.layout==1)) { __pc=2     ; break; }
              //$LASTPOS=95012175;//kernel.Pad:12175
              _this.fiber$setXYPanelLayout1(_thread);
              __pc=1;return;
            case 1:
              
            case 2     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      setXYPanelLayout1 :function _trc_Pad_setXYPanelLayout1() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95012237;//kernel.Pad:12237
        _this.jujiPads[0].x=112*_this.trunc(_this.padScaleX*64)/64;
        //$LASTPOS=95012286;//kernel.Pad:12286
        _this.jujiPads[0].y=Tonyu.globals.$screenHeight-112*_this.trunc(_this.padScaleX*64)/64;
        //$LASTPOS=95012349;//kernel.Pad:12349
        if (_this.buttonCnt==1) {
          //$LASTPOS=95012380;//kernel.Pad:12380
          _this.buttons[0].x=Tonyu.globals.$screenWidth-84*_this.padScaleX;
          //$LASTPOS=95012437;//kernel.Pad:12437
          _this.buttons[0].y=Tonyu.globals.$screenHeight-84*_this.padScaleX;
          
        } else {
          //$LASTPOS=95012497;//kernel.Pad:12497
          if (_this.buttonCnt==2) {
            //$LASTPOS=95012528;//kernel.Pad:12528
            _this.buttons[0].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
            //$LASTPOS=95012585;//kernel.Pad:12585
            _this.buttons[0].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
            //$LASTPOS=95012642;//kernel.Pad:12642
            _this.buttons[1].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
            //$LASTPOS=95012699;//kernel.Pad:12699
            _this.buttons[1].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
            
          } else {
            //$LASTPOS=95012759;//kernel.Pad:12759
            if (_this.buttonCnt==3) {
              //$LASTPOS=95012790;//kernel.Pad:12790
              _this.buttons[0].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
              //$LASTPOS=95012847;//kernel.Pad:12847
              _this.buttons[0].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
              //$LASTPOS=95012904;//kernel.Pad:12904
              _this.buttons[1].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
              //$LASTPOS=95012961;//kernel.Pad:12961
              _this.buttons[1].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
              //$LASTPOS=95013018;//kernel.Pad:13018
              _this.buttons[2].x=Tonyu.globals.$screenWidth-101*_this.padScaleX;
              //$LASTPOS=95013075;//kernel.Pad:13075
              _this.buttons[2].y=Tonyu.globals.$screenHeight-150*_this.padScaleX;
              
            } else {
              //$LASTPOS=95013135;//kernel.Pad:13135
              if (_this.buttonCnt>=4) {
                //$LASTPOS=95013166;//kernel.Pad:13166
                _this.buttons[0].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
                //$LASTPOS=95013223;//kernel.Pad:13223
                _this.buttons[0].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
                //$LASTPOS=95013280;//kernel.Pad:13280
                _this.buttons[1].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
                //$LASTPOS=95013337;//kernel.Pad:13337
                _this.buttons[1].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
                //$LASTPOS=95013394;//kernel.Pad:13394
                _this.buttons[2].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
                //$LASTPOS=95013451;//kernel.Pad:13451
                _this.buttons[2].y=Tonyu.globals.$screenHeight-150*_this.padScaleX;
                //$LASTPOS=95013508;//kernel.Pad:13508
                _this.buttons[3].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
                //$LASTPOS=95013565;//kernel.Pad:13565
                _this.buttons[3].y=Tonyu.globals.$screenHeight-150*_this.padScaleX;
                
              }
            }
          }
        }
      },
      fiber$setXYPanelLayout1 :function _trc_Pad_f_setXYPanelLayout1(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=95012237;//kernel.Pad:12237
        _this.jujiPads[0].x=112*_this.trunc(_this.padScaleX*64)/64;
        //$LASTPOS=95012286;//kernel.Pad:12286
        _this.jujiPads[0].y=Tonyu.globals.$screenHeight-112*_this.trunc(_this.padScaleX*64)/64;
        //$LASTPOS=95012349;//kernel.Pad:12349
        if (_this.buttonCnt==1) {
          //$LASTPOS=95012380;//kernel.Pad:12380
          _this.buttons[0].x=Tonyu.globals.$screenWidth-84*_this.padScaleX;
          //$LASTPOS=95012437;//kernel.Pad:12437
          _this.buttons[0].y=Tonyu.globals.$screenHeight-84*_this.padScaleX;
          
        } else {
          //$LASTPOS=95012497;//kernel.Pad:12497
          if (_this.buttonCnt==2) {
            //$LASTPOS=95012528;//kernel.Pad:12528
            _this.buttons[0].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
            //$LASTPOS=95012585;//kernel.Pad:12585
            _this.buttons[0].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
            //$LASTPOS=95012642;//kernel.Pad:12642
            _this.buttons[1].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
            //$LASTPOS=95012699;//kernel.Pad:12699
            _this.buttons[1].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
            
          } else {
            //$LASTPOS=95012759;//kernel.Pad:12759
            if (_this.buttonCnt==3) {
              //$LASTPOS=95012790;//kernel.Pad:12790
              _this.buttons[0].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
              //$LASTPOS=95012847;//kernel.Pad:12847
              _this.buttons[0].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
              //$LASTPOS=95012904;//kernel.Pad:12904
              _this.buttons[1].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
              //$LASTPOS=95012961;//kernel.Pad:12961
              _this.buttons[1].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
              //$LASTPOS=95013018;//kernel.Pad:13018
              _this.buttons[2].x=Tonyu.globals.$screenWidth-101*_this.padScaleX;
              //$LASTPOS=95013075;//kernel.Pad:13075
              _this.buttons[2].y=Tonyu.globals.$screenHeight-150*_this.padScaleX;
              
            } else {
              //$LASTPOS=95013135;//kernel.Pad:13135
              if (_this.buttonCnt>=4) {
                //$LASTPOS=95013166;//kernel.Pad:13166
                _this.buttons[0].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
                //$LASTPOS=95013223;//kernel.Pad:13223
                _this.buttons[0].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
                //$LASTPOS=95013280;//kernel.Pad:13280
                _this.buttons[1].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
                //$LASTPOS=95013337;//kernel.Pad:13337
                _this.buttons[1].y=Tonyu.globals.$screenHeight-52*_this.padScaleX;
                //$LASTPOS=95013394;//kernel.Pad:13394
                _this.buttons[2].x=Tonyu.globals.$screenWidth-52*_this.padScaleX;
                //$LASTPOS=95013451;//kernel.Pad:13451
                _this.buttons[2].y=Tonyu.globals.$screenHeight-150*_this.padScaleX;
                //$LASTPOS=95013508;//kernel.Pad:13508
                _this.buttons[3].x=Tonyu.globals.$screenWidth-150*_this.padScaleX;
                //$LASTPOS=95013565;//kernel.Pad:13565
                _this.buttons[3].y=Tonyu.globals.$screenHeight-150*_this.padScaleX;
                
              }
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      padUpdate :function _trc_Pad_padUpdate() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95013646;//kernel.Pad:13646
        if (! _this.active) {
          return _this;
        }
        //$LASTPOS=95013672;//kernel.Pad:13672
        _this.activate();
        //$LASTPOS=95013691;//kernel.Pad:13691
        if (_this.version==1) {
          //$LASTPOS=95013720;//kernel.Pad:13720
          _this.padUpdateV1();
          
        } else {
          //$LASTPOS=95013758;//kernel.Pad:13758
          _this.padUpdateV2();
          
        }
      },
      fiber$padUpdate :function _trc_Pad_f_padUpdate(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=95013646;//kernel.Pad:13646
        if (! _this.active) {
          _thread.retVal=_this;return;
          
        }
        
        _thread.enter(function _trc_Pad_ent_padUpdate(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95013672;//kernel.Pad:13672
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95013691;//kernel.Pad:13691
              if (!(_this.version==1)) { __pc=3     ; break; }
              //$LASTPOS=95013720;//kernel.Pad:13720
              _this.fiber$padUpdateV1(_thread);
              __pc=2;return;
            case 2:
              
              __pc=5     ;break;
            case 3     :
              //$LASTPOS=95013758;//kernel.Pad:13758
              _this.fiber$padUpdateV2(_thread);
              __pc=4;return;
            case 4:
              
            case 5     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      padUpdateV2 :function _trc_Pad_padUpdateV2() {
        "use strict";
        var _this=this;
        var screenSize;
        
        //$LASTPOS=95013808;//kernel.Pad:13808
        _this.padsUpdateV2();
        //$LASTPOS=95013860;//kernel.Pad:13860
        screenSize = Tonyu.globals.$screenWidth;
        
        //$LASTPOS=95013896;//kernel.Pad:13896
        if (Tonyu.globals.$screenWidth>Tonyu.globals.$screenHeight) {
          //$LASTPOS=95013930;//kernel.Pad:13930
          screenSize=Tonyu.globals.$screenHeight;
        }
        //$LASTPOS=95013963;//kernel.Pad:13963
        _this.padScaleX=screenSize/465;
        //$LASTPOS=95013998;//kernel.Pad:13998
        if (_this.padScaleX!=_this.oldPadScaleX) {
          //$LASTPOS=95014073;//kernel.Pad:14073
          if (_this.autoMove) {
            //$LASTPOS=95014087;//kernel.Pad:14087
            _this.drawPanel();
          }
          //$LASTPOS=95014109;//kernel.Pad:14109
          _this.oldPadScaleX=_this.padScaleX;
          
        }
        //$LASTPOS=95014179;//kernel.Pad:14179
        if (Tonyu.globals.$screenWidth!=_this.oldScreenWidth||Tonyu.globals.$screenHeight!=_this.oldScreenHeight) {
          //$LASTPOS=95014295;//kernel.Pad:14295
          if (_this.autoMove) {
            //$LASTPOS=95014309;//kernel.Pad:14309
            _this.setXYPanel();
          }
          //$LASTPOS=95014332;//kernel.Pad:14332
          _this.oldScreenWidth=Tonyu.globals.$screenWidth;
          //$LASTPOS=95014372;//kernel.Pad:14372
          _this.oldScreenHeight=Tonyu.globals.$screenHeight;
          //$LASTPOS=95014414;//kernel.Pad:14414
          _this.oldButtonCnt=_this.buttonCnt;
          
        }
      },
      fiber$padUpdateV2 :function _trc_Pad_f_padUpdateV2(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var screenSize;
        
        
        _thread.enter(function _trc_Pad_ent_padUpdateV2(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95013808;//kernel.Pad:13808
              _this.fiber$padsUpdateV2(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95013860;//kernel.Pad:13860
              screenSize = Tonyu.globals.$screenWidth;
              
              //$LASTPOS=95013896;//kernel.Pad:13896
              if (Tonyu.globals.$screenWidth>Tonyu.globals.$screenHeight) {
                //$LASTPOS=95013930;//kernel.Pad:13930
                screenSize=Tonyu.globals.$screenHeight;
              }
              //$LASTPOS=95013963;//kernel.Pad:13963
              _this.padScaleX=screenSize/465;
              //$LASTPOS=95013998;//kernel.Pad:13998
              if (!(_this.padScaleX!=_this.oldPadScaleX)) { __pc=4     ; break; }
              //$LASTPOS=95014073;//kernel.Pad:14073
              if (!(_this.autoMove)) { __pc=3     ; break; }
              //$LASTPOS=95014087;//kernel.Pad:14087
              _this.fiber$drawPanel(_thread);
              __pc=2;return;
            case 2:
              
            case 3     :
              
              //$LASTPOS=95014109;//kernel.Pad:14109
              _this.oldPadScaleX=_this.padScaleX;
            case 4     :
              
              //$LASTPOS=95014179;//kernel.Pad:14179
              if (!(Tonyu.globals.$screenWidth!=_this.oldScreenWidth||Tonyu.globals.$screenHeight!=_this.oldScreenHeight)) { __pc=7     ; break; }
              //$LASTPOS=95014295;//kernel.Pad:14295
              if (!(_this.autoMove)) { __pc=6     ; break; }
              //$LASTPOS=95014309;//kernel.Pad:14309
              _this.fiber$setXYPanel(_thread);
              __pc=5;return;
            case 5:
              
            case 6     :
              
              //$LASTPOS=95014332;//kernel.Pad:14332
              _this.oldScreenWidth=Tonyu.globals.$screenWidth;
              //$LASTPOS=95014372;//kernel.Pad:14372
              _this.oldScreenHeight=Tonyu.globals.$screenHeight;
              //$LASTPOS=95014414;//kernel.Pad:14414
              _this.oldButtonCnt=_this.buttonCnt;
            case 7     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      padUpdateV1 :function _trc_Pad_padUpdateV1() {
        "use strict";
        var _this=this;
        var i;
        var t;
        
        //$LASTPOS=95014498;//kernel.Pad:14498
        if (_this.padUpdateFrame==Tonyu.globals.$frameCount) {
          return _this;
        }
        //$LASTPOS=95014546;//kernel.Pad:14546
        _this.padUpdateFrame=Tonyu.globals.$frameCount;
        //$LASTPOS=95014597;//kernel.Pad:14597
        _this.keyPushL=0;
        //$LASTPOS=95014616;//kernel.Pad:14616
        _this.keyPushR=0;
        //$LASTPOS=95014635;//kernel.Pad:14635
        _this.keyPushU=0;
        //$LASTPOS=95014654;//kernel.Pad:14654
        _this.keyPushD=0;
        //$LASTPOS=95014673;//kernel.Pad:14673
        _this.keyPush1=0;
        //$LASTPOS=95014694;//kernel.Pad:14694
        _this.padKeyNotapCnt++;
        //$LASTPOS=95014718;//kernel.Pad:14718
        //$LASTPOS=95014723;//kernel.Pad:14723
        i = 0;
        for (; i<5 ; i++) {
          {
            //$LASTPOS=95014771;//kernel.Pad:14771
            t = Tonyu.globals.$touches[i];
            
            //$LASTPOS=95014801;//kernel.Pad:14801
            if (t.touched) {
              //$LASTPOS=95014831;//kernel.Pad:14831
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32-_this.APAD_DIAG_SIZE/2,_this.jujiKey.y-32-64,64+_this.APAD_DIAG_SIZE,64)) {
                //$LASTPOS=95014928;//kernel.Pad:14928
                _this.keyPushU=1;
              }
              //$LASTPOS=95014955;//kernel.Pad:14955
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32-_this.APAD_DIAG_SIZE/2,_this.jujiKey.y-32+64,64+_this.APAD_DIAG_SIZE,64)) {
                //$LASTPOS=95015052;//kernel.Pad:15052
                _this.keyPushD=1;
              }
              //$LASTPOS=95015079;//kernel.Pad:15079
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32-64,_this.jujiKey.y-32-_this.APAD_DIAG_SIZE/2,64,64+_this.APAD_DIAG_SIZE)) {
                //$LASTPOS=95015176;//kernel.Pad:15176
                _this.keyPushL=1;
              }
              //$LASTPOS=95015203;//kernel.Pad:15203
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32+64,_this.jujiKey.y-32-_this.APAD_DIAG_SIZE/2,64,64+_this.APAD_DIAG_SIZE)) {
                //$LASTPOS=95015300;//kernel.Pad:15300
                _this.keyPushR=1;
              }
              //$LASTPOS=95015327;//kernel.Pad:15327
              if (_this.isOnRectWH(t.x,t.y,_this.no1Key.x-64,_this.no1Key.y-64,128,128)) {
                //$LASTPOS=95015389;//kernel.Pad:15389
                _this.keyPush1=1;
              }
              //$LASTPOS=95015416;//kernel.Pad:15416
              _this.padKeySW=1;
              //$LASTPOS=95015443;//kernel.Pad:15443
              _this.padKeyNotapCnt=0;
              
            }
          }
        }
        //$LASTPOS=95015504;//kernel.Pad:15504
        if (_this.keyPushL) {
          //$LASTPOS=95015518;//kernel.Pad:15518
          _this.keyCntL++;
        } else {
          //$LASTPOS=95015535;//kernel.Pad:15535
          _this.keyCntL=0;
        }
        //$LASTPOS=95015553;//kernel.Pad:15553
        if (_this.keyPushR) {
          //$LASTPOS=95015567;//kernel.Pad:15567
          _this.keyCntR++;
        } else {
          //$LASTPOS=95015584;//kernel.Pad:15584
          _this.keyCntR=0;
        }
        //$LASTPOS=95015602;//kernel.Pad:15602
        if (_this.keyPushU) {
          //$LASTPOS=95015616;//kernel.Pad:15616
          _this.keyCntU++;
        } else {
          //$LASTPOS=95015633;//kernel.Pad:15633
          _this.keyCntU=0;
        }
        //$LASTPOS=95015651;//kernel.Pad:15651
        if (_this.keyPushD) {
          //$LASTPOS=95015665;//kernel.Pad:15665
          _this.keyCntD++;
        } else {
          //$LASTPOS=95015682;//kernel.Pad:15682
          _this.keyCntD=0;
        }
        //$LASTPOS=95015700;//kernel.Pad:15700
        if (_this.keyPush1) {
          //$LASTPOS=95015714;//kernel.Pad:15714
          _this.keyCnt1++;
        } else {
          //$LASTPOS=95015731;//kernel.Pad:15731
          _this.keyCnt1=0;
        }
        //$LASTPOS=95015762;//kernel.Pad:15762
        if (_this.keyPushL) {
          //$LASTPOS=95015776;//kernel.Pad:15776
          _this.jujiKeyPushL.show();
        } else {
          //$LASTPOS=95015802;//kernel.Pad:15802
          _this.jujiKeyPushL.hide();
        }
        //$LASTPOS=95015828;//kernel.Pad:15828
        if (_this.keyPushR) {
          //$LASTPOS=95015842;//kernel.Pad:15842
          _this.jujiKeyPushR.show();
        } else {
          //$LASTPOS=95015868;//kernel.Pad:15868
          _this.jujiKeyPushR.hide();
        }
        //$LASTPOS=95015894;//kernel.Pad:15894
        if (_this.keyPushU) {
          //$LASTPOS=95015908;//kernel.Pad:15908
          _this.jujiKeyPushU.show();
        } else {
          //$LASTPOS=95015934;//kernel.Pad:15934
          _this.jujiKeyPushU.hide();
        }
        //$LASTPOS=95015960;//kernel.Pad:15960
        if (_this.keyPushD) {
          //$LASTPOS=95015974;//kernel.Pad:15974
          _this.jujiKeyPushD.show();
        } else {
          //$LASTPOS=95016000;//kernel.Pad:16000
          _this.jujiKeyPushD.hide();
        }
        //$LASTPOS=95016026;//kernel.Pad:16026
        if (_this.keyPush1) {
          //$LASTPOS=95016040;//kernel.Pad:16040
          _this.jujiKeyPush1.show();
        } else {
          //$LASTPOS=95016066;//kernel.Pad:16066
          _this.jujiKeyPush1.hide();
        }
      },
      fiber$padUpdateV1 :function _trc_Pad_f_padUpdateV1(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        var t;
        
        //$LASTPOS=95014498;//kernel.Pad:14498
        if (_this.padUpdateFrame==Tonyu.globals.$frameCount) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=95014546;//kernel.Pad:14546
        _this.padUpdateFrame=Tonyu.globals.$frameCount;
        //$LASTPOS=95014597;//kernel.Pad:14597
        _this.keyPushL=0;
        //$LASTPOS=95014616;//kernel.Pad:14616
        _this.keyPushR=0;
        //$LASTPOS=95014635;//kernel.Pad:14635
        _this.keyPushU=0;
        //$LASTPOS=95014654;//kernel.Pad:14654
        _this.keyPushD=0;
        //$LASTPOS=95014673;//kernel.Pad:14673
        _this.keyPush1=0;
        //$LASTPOS=95014694;//kernel.Pad:14694
        _this.padKeyNotapCnt++;
        //$LASTPOS=95014718;//kernel.Pad:14718
        //$LASTPOS=95014723;//kernel.Pad:14723
        i = 0;
        for (; i<5 ; i++) {
          {
            //$LASTPOS=95014771;//kernel.Pad:14771
            t = Tonyu.globals.$touches[i];
            
            //$LASTPOS=95014801;//kernel.Pad:14801
            if (t.touched) {
              //$LASTPOS=95014831;//kernel.Pad:14831
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32-_this.APAD_DIAG_SIZE/2,_this.jujiKey.y-32-64,64+_this.APAD_DIAG_SIZE,64)) {
                //$LASTPOS=95014928;//kernel.Pad:14928
                _this.keyPushU=1;
              }
              //$LASTPOS=95014955;//kernel.Pad:14955
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32-_this.APAD_DIAG_SIZE/2,_this.jujiKey.y-32+64,64+_this.APAD_DIAG_SIZE,64)) {
                //$LASTPOS=95015052;//kernel.Pad:15052
                _this.keyPushD=1;
              }
              //$LASTPOS=95015079;//kernel.Pad:15079
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32-64,_this.jujiKey.y-32-_this.APAD_DIAG_SIZE/2,64,64+_this.APAD_DIAG_SIZE)) {
                //$LASTPOS=95015176;//kernel.Pad:15176
                _this.keyPushL=1;
              }
              //$LASTPOS=95015203;//kernel.Pad:15203
              if (_this.isOnRectWH(t.x,t.y,_this.jujiKey.x-32+64,_this.jujiKey.y-32-_this.APAD_DIAG_SIZE/2,64,64+_this.APAD_DIAG_SIZE)) {
                //$LASTPOS=95015300;//kernel.Pad:15300
                _this.keyPushR=1;
              }
              //$LASTPOS=95015327;//kernel.Pad:15327
              if (_this.isOnRectWH(t.x,t.y,_this.no1Key.x-64,_this.no1Key.y-64,128,128)) {
                //$LASTPOS=95015389;//kernel.Pad:15389
                _this.keyPush1=1;
              }
              //$LASTPOS=95015416;//kernel.Pad:15416
              _this.padKeySW=1;
              //$LASTPOS=95015443;//kernel.Pad:15443
              _this.padKeyNotapCnt=0;
              
            }
          }
        }
        //$LASTPOS=95015504;//kernel.Pad:15504
        if (_this.keyPushL) {
          //$LASTPOS=95015518;//kernel.Pad:15518
          _this.keyCntL++;
        } else {
          //$LASTPOS=95015535;//kernel.Pad:15535
          _this.keyCntL=0;
        }
        //$LASTPOS=95015553;//kernel.Pad:15553
        if (_this.keyPushR) {
          //$LASTPOS=95015567;//kernel.Pad:15567
          _this.keyCntR++;
        } else {
          //$LASTPOS=95015584;//kernel.Pad:15584
          _this.keyCntR=0;
        }
        //$LASTPOS=95015602;//kernel.Pad:15602
        if (_this.keyPushU) {
          //$LASTPOS=95015616;//kernel.Pad:15616
          _this.keyCntU++;
        } else {
          //$LASTPOS=95015633;//kernel.Pad:15633
          _this.keyCntU=0;
        }
        //$LASTPOS=95015651;//kernel.Pad:15651
        if (_this.keyPushD) {
          //$LASTPOS=95015665;//kernel.Pad:15665
          _this.keyCntD++;
        } else {
          //$LASTPOS=95015682;//kernel.Pad:15682
          _this.keyCntD=0;
        }
        //$LASTPOS=95015700;//kernel.Pad:15700
        if (_this.keyPush1) {
          //$LASTPOS=95015714;//kernel.Pad:15714
          _this.keyCnt1++;
        } else {
          //$LASTPOS=95015731;//kernel.Pad:15731
          _this.keyCnt1=0;
        }
        //$LASTPOS=95015762;//kernel.Pad:15762
        if (_this.keyPushL) {
          //$LASTPOS=95015776;//kernel.Pad:15776
          _this.jujiKeyPushL.show();
        } else {
          //$LASTPOS=95015802;//kernel.Pad:15802
          _this.jujiKeyPushL.hide();
        }
        //$LASTPOS=95015828;//kernel.Pad:15828
        if (_this.keyPushR) {
          //$LASTPOS=95015842;//kernel.Pad:15842
          _this.jujiKeyPushR.show();
        } else {
          //$LASTPOS=95015868;//kernel.Pad:15868
          _this.jujiKeyPushR.hide();
        }
        //$LASTPOS=95015894;//kernel.Pad:15894
        if (_this.keyPushU) {
          //$LASTPOS=95015908;//kernel.Pad:15908
          _this.jujiKeyPushU.show();
        } else {
          //$LASTPOS=95015934;//kernel.Pad:15934
          _this.jujiKeyPushU.hide();
        }
        //$LASTPOS=95015960;//kernel.Pad:15960
        if (_this.keyPushD) {
          //$LASTPOS=95015974;//kernel.Pad:15974
          _this.jujiKeyPushD.show();
        } else {
          //$LASTPOS=95016000;//kernel.Pad:16000
          _this.jujiKeyPushD.hide();
        }
        //$LASTPOS=95016026;//kernel.Pad:16026
        if (_this.keyPush1) {
          //$LASTPOS=95016040;//kernel.Pad:16040
          _this.jujiKeyPush1.show();
        } else {
          //$LASTPOS=95016066;//kernel.Pad:16066
          _this.jujiKeyPush1.hide();
        }
        
        _thread.retVal=_this;return;
      },
      padsUpdateV2 :function _trc_Pad_padsUpdateV2() {
        "use strict";
        var _this=this;
        var i;
        var obj;
        
        //$LASTPOS=95016139;//kernel.Pad:16139
        if (_this.padUpdateFrame==Tonyu.globals.$frameCount) {
          return _this;
        }
        //$LASTPOS=95016187;//kernel.Pad:16187
        _this.padUpdateFrame=Tonyu.globals.$frameCount;
        //$LASTPOS=95016244;//kernel.Pad:16244
        //$LASTPOS=95016249;//kernel.Pad:16249
        i = 0;
        for (; i<_this.buttons.length ; i++) {
          {
            //$LASTPOS=95016292;//kernel.Pad:16292
            obj = _this.buttons[i];
            
            //$LASTPOS=95016323;//kernel.Pad:16323
            if (obj) {
              //$LASTPOS=95016332;//kernel.Pad:16332
              obj.padUpdate();
            }
          }
        }
        //$LASTPOS=95016361;//kernel.Pad:16361
        //$LASTPOS=95016366;//kernel.Pad:16366
        i = 0;
        for (; i<_this.jujiPads.length ; i++) {
          {
            //$LASTPOS=95016410;//kernel.Pad:16410
            obj = _this.jujiPads[i];
            
            //$LASTPOS=95016442;//kernel.Pad:16442
            if (obj) {
              //$LASTPOS=95016451;//kernel.Pad:16451
              obj.padUpdate();
            }
          }
        }
      },
      fiber$padsUpdateV2 :function _trc_Pad_f_padsUpdateV2(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        var obj;
        
        //$LASTPOS=95016139;//kernel.Pad:16139
        if (_this.padUpdateFrame==Tonyu.globals.$frameCount) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=95016187;//kernel.Pad:16187
        _this.padUpdateFrame=Tonyu.globals.$frameCount;
        //$LASTPOS=95016244;//kernel.Pad:16244
        //$LASTPOS=95016249;//kernel.Pad:16249
        i = 0;
        for (; i<_this.buttons.length ; i++) {
          {
            //$LASTPOS=95016292;//kernel.Pad:16292
            obj = _this.buttons[i];
            
            //$LASTPOS=95016323;//kernel.Pad:16323
            if (obj) {
              //$LASTPOS=95016332;//kernel.Pad:16332
              obj.padUpdate();
            }
          }
        }
        //$LASTPOS=95016361;//kernel.Pad:16361
        //$LASTPOS=95016366;//kernel.Pad:16366
        i = 0;
        for (; i<_this.jujiPads.length ; i++) {
          {
            //$LASTPOS=95016410;//kernel.Pad:16410
            obj = _this.jujiPads[i];
            
            //$LASTPOS=95016442;//kernel.Pad:16442
            if (obj) {
              //$LASTPOS=95016451;//kernel.Pad:16451
              obj.padUpdate();
            }
          }
        }
        
        _thread.retVal=_this;return;
      },
      getUp :function _trc_Pad_getUp(i) {
        "use strict";
        var _this=this;
        var value;
        
        //$LASTPOS=95016498;//kernel.Pad:16498
        if (_this.died) {
          return 0;
        }
        //$LASTPOS=95016523;//kernel.Pad:16523
        _this.activate();
        //$LASTPOS=95016540;//kernel.Pad:16540
        _this.padUpdate();
        //$LASTPOS=95016558;//kernel.Pad:16558
        value = 0;
        
        //$LASTPOS=95016578;//kernel.Pad:16578
        if (_this.version==1) {
          return _this.keyCntU;
          
        } else {
          //$LASTPOS=95016662;//kernel.Pad:16662
          if (i==null) {
            //$LASTPOS=95016677;//kernel.Pad:16677
            i=0;
          }
          //$LASTPOS=95016693;//kernel.Pad:16693
          if (i>=0&&i<_this.jujiPads.length) {
            //$LASTPOS=95016728;//kernel.Pad:16728
            value=_this.jujiPads[i].padCntU;
          }
          
        }
        return value;
      },
      fiber$getUp :function _trc_Pad_f_getUp(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var value;
        
        //$LASTPOS=95016498;//kernel.Pad:16498
        if (_this.died) {
          _thread.retVal=0;return;
          
        }
        
        _thread.enter(function _trc_Pad_ent_getUp(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95016523;//kernel.Pad:16523
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95016540;//kernel.Pad:16540
              _this.fiber$padUpdate(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=95016558;//kernel.Pad:16558
              value = 0;
              
              //$LASTPOS=95016578;//kernel.Pad:16578
              if (!(_this.version==1)) { __pc=3     ; break; }
              _thread.exit(_this.keyCntU);return;
              __pc=4     ;break;
            case 3     :
              {
                //$LASTPOS=95016662;//kernel.Pad:16662
                if (i==null) {
                  //$LASTPOS=95016677;//kernel.Pad:16677
                  i=0;
                }
                //$LASTPOS=95016693;//kernel.Pad:16693
                if (i>=0&&i<_this.jujiPads.length) {
                  //$LASTPOS=95016728;//kernel.Pad:16728
                  value=_this.jujiPads[i].padCntU;
                }
              }
            case 4     :
              
              _thread.exit(value);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getDown :function _trc_Pad_getDown(i) {
        "use strict";
        var _this=this;
        var value;
        
        //$LASTPOS=95016809;//kernel.Pad:16809
        if (_this.died) {
          return 0;
        }
        //$LASTPOS=95016834;//kernel.Pad:16834
        _this.activate();
        //$LASTPOS=95016851;//kernel.Pad:16851
        _this.padUpdate();
        //$LASTPOS=95016869;//kernel.Pad:16869
        value = 0;
        
        //$LASTPOS=95016889;//kernel.Pad:16889
        if (_this.jujiPads==null) {
          return _this.keyCntD;
          
        } else {
          //$LASTPOS=95016977;//kernel.Pad:16977
          if (i==null) {
            //$LASTPOS=95016992;//kernel.Pad:16992
            i=0;
          }
          //$LASTPOS=95017008;//kernel.Pad:17008
          if (i>=0&&i<_this.jujiPads.length) {
            //$LASTPOS=95017043;//kernel.Pad:17043
            value=_this.jujiPads[i].padCntD;
          }
          
        }
        return value;
      },
      fiber$getDown :function _trc_Pad_f_getDown(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var value;
        
        //$LASTPOS=95016809;//kernel.Pad:16809
        if (_this.died) {
          _thread.retVal=0;return;
          
        }
        
        _thread.enter(function _trc_Pad_ent_getDown(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95016834;//kernel.Pad:16834
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95016851;//kernel.Pad:16851
              _this.fiber$padUpdate(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=95016869;//kernel.Pad:16869
              value = 0;
              
              //$LASTPOS=95016889;//kernel.Pad:16889
              if (!(_this.jujiPads==null)) { __pc=3     ; break; }
              _thread.exit(_this.keyCntD);return;
              __pc=4     ;break;
            case 3     :
              {
                //$LASTPOS=95016977;//kernel.Pad:16977
                if (i==null) {
                  //$LASTPOS=95016992;//kernel.Pad:16992
                  i=0;
                }
                //$LASTPOS=95017008;//kernel.Pad:17008
                if (i>=0&&i<_this.jujiPads.length) {
                  //$LASTPOS=95017043;//kernel.Pad:17043
                  value=_this.jujiPads[i].padCntD;
                }
              }
            case 4     :
              
              _thread.exit(value);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getLeft :function _trc_Pad_getLeft(i) {
        "use strict";
        var _this=this;
        var value;
        
        //$LASTPOS=95017123;//kernel.Pad:17123
        if (_this.died) {
          return 0;
        }
        //$LASTPOS=95017148;//kernel.Pad:17148
        _this.activate();
        //$LASTPOS=95017165;//kernel.Pad:17165
        _this.padUpdate();
        //$LASTPOS=95017183;//kernel.Pad:17183
        value = 0;
        
        //$LASTPOS=95017203;//kernel.Pad:17203
        if (_this.jujiPads==null) {
          return _this.keyCntL;
          
        } else {
          //$LASTPOS=95017291;//kernel.Pad:17291
          if (i==null) {
            //$LASTPOS=95017306;//kernel.Pad:17306
            i=0;
          }
          //$LASTPOS=95017322;//kernel.Pad:17322
          if (i>=0&&i<_this.jujiPads.length) {
            //$LASTPOS=95017357;//kernel.Pad:17357
            value=_this.jujiPads[i].padCntL;
          }
          
        }
        return value;
      },
      fiber$getLeft :function _trc_Pad_f_getLeft(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var value;
        
        //$LASTPOS=95017123;//kernel.Pad:17123
        if (_this.died) {
          _thread.retVal=0;return;
          
        }
        
        _thread.enter(function _trc_Pad_ent_getLeft(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95017148;//kernel.Pad:17148
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95017165;//kernel.Pad:17165
              _this.fiber$padUpdate(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=95017183;//kernel.Pad:17183
              value = 0;
              
              //$LASTPOS=95017203;//kernel.Pad:17203
              if (!(_this.jujiPads==null)) { __pc=3     ; break; }
              _thread.exit(_this.keyCntL);return;
              __pc=4     ;break;
            case 3     :
              {
                //$LASTPOS=95017291;//kernel.Pad:17291
                if (i==null) {
                  //$LASTPOS=95017306;//kernel.Pad:17306
                  i=0;
                }
                //$LASTPOS=95017322;//kernel.Pad:17322
                if (i>=0&&i<_this.jujiPads.length) {
                  //$LASTPOS=95017357;//kernel.Pad:17357
                  value=_this.jujiPads[i].padCntL;
                }
              }
            case 4     :
              
              _thread.exit(value);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getRight :function _trc_Pad_getRight(i) {
        "use strict";
        var _this=this;
        var value;
        
        //$LASTPOS=95017438;//kernel.Pad:17438
        if (_this.died) {
          return 0;
        }
        //$LASTPOS=95017463;//kernel.Pad:17463
        _this.activate();
        //$LASTPOS=95017480;//kernel.Pad:17480
        _this.padUpdate();
        //$LASTPOS=95017498;//kernel.Pad:17498
        value = 0;
        
        //$LASTPOS=95017518;//kernel.Pad:17518
        if (_this.jujiPads==null) {
          return _this.keyCntR;
          
        } else {
          //$LASTPOS=95017606;//kernel.Pad:17606
          if (i==null) {
            //$LASTPOS=95017621;//kernel.Pad:17621
            i=0;
          }
          //$LASTPOS=95017637;//kernel.Pad:17637
          if (i>=0&&i<_this.jujiPads.length) {
            //$LASTPOS=95017672;//kernel.Pad:17672
            value=_this.jujiPads[i].padCntR;
          }
          
        }
        return value;
      },
      fiber$getRight :function _trc_Pad_f_getRight(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var value;
        
        //$LASTPOS=95017438;//kernel.Pad:17438
        if (_this.died) {
          _thread.retVal=0;return;
          
        }
        
        _thread.enter(function _trc_Pad_ent_getRight(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95017463;//kernel.Pad:17463
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95017480;//kernel.Pad:17480
              _this.fiber$padUpdate(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=95017498;//kernel.Pad:17498
              value = 0;
              
              //$LASTPOS=95017518;//kernel.Pad:17518
              if (!(_this.jujiPads==null)) { __pc=3     ; break; }
              _thread.exit(_this.keyCntR);return;
              __pc=4     ;break;
            case 3     :
              {
                //$LASTPOS=95017606;//kernel.Pad:17606
                if (i==null) {
                  //$LASTPOS=95017621;//kernel.Pad:17621
                  i=0;
                }
                //$LASTPOS=95017637;//kernel.Pad:17637
                if (i>=0&&i<_this.jujiPads.length) {
                  //$LASTPOS=95017672;//kernel.Pad:17672
                  value=_this.jujiPads[i].padCntR;
                }
              }
            case 4     :
              
              _thread.exit(value);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getButton :function _trc_Pad_getButton(i) {
        "use strict";
        var _this=this;
        var value;
        
        //$LASTPOS=95017754;//kernel.Pad:17754
        if (_this.died) {
          return 0;
        }
        //$LASTPOS=95017779;//kernel.Pad:17779
        _this.activate();
        //$LASTPOS=95017796;//kernel.Pad:17796
        _this.padUpdate();
        //$LASTPOS=95017814;//kernel.Pad:17814
        value = 0;
        
        //$LASTPOS=95017834;//kernel.Pad:17834
        if (_this.buttons==null) {
          //$LASTPOS=95017874;//kernel.Pad:17874
          if (i==0) {
            //$LASTPOS=95017886;//kernel.Pad:17886
            value=_this.keyCnt1;
          }
          
        } else {
          //$LASTPOS=95017934;//kernel.Pad:17934
          if (! i) {
            //$LASTPOS=95017942;//kernel.Pad:17942
            i=1;
          }
          //$LASTPOS=95017958;//kernel.Pad:17958
          i--;
          //$LASTPOS=95017972;//kernel.Pad:17972
          if (i>=0&&i<_this.buttons.length) {
            //$LASTPOS=95018006;//kernel.Pad:18006
            value=_this.buttons[i].padCnt;
          }
          
        }
        return value;
      },
      fiber$getButton :function _trc_Pad_f_getButton(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var value;
        
        //$LASTPOS=95017754;//kernel.Pad:17754
        if (_this.died) {
          _thread.retVal=0;return;
          
        }
        
        _thread.enter(function _trc_Pad_ent_getButton(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95017779;//kernel.Pad:17779
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95017796;//kernel.Pad:17796
              _this.fiber$padUpdate(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=95017814;//kernel.Pad:17814
              value = 0;
              
              //$LASTPOS=95017834;//kernel.Pad:17834
              if (_this.buttons==null) {
                //$LASTPOS=95017874;//kernel.Pad:17874
                if (i==0) {
                  //$LASTPOS=95017886;//kernel.Pad:17886
                  value=_this.keyCnt1;
                }
                
              } else {
                //$LASTPOS=95017934;//kernel.Pad:17934
                if (! i) {
                  //$LASTPOS=95017942;//kernel.Pad:17942
                  i=1;
                }
                //$LASTPOS=95017958;//kernel.Pad:17958
                i--;
                //$LASTPOS=95017972;//kernel.Pad:17972
                if (i>=0&&i<_this.buttons.length) {
                  //$LASTPOS=95018006;//kernel.Pad:18006
                  value=_this.buttons[i].padCnt;
                }
                
              }
              _thread.exit(value);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getJujiPadObj :function _trc_Pad_getJujiPadObj(i) {
        "use strict";
        var _this=this;
        var obj;
        
        //$LASTPOS=95018121;//kernel.Pad:18121
        _this.activate();
        //$LASTPOS=95018138;//kernel.Pad:18138
        if (_this.jujiPads==null) {
          return null;
        }
        //$LASTPOS=95018178;//kernel.Pad:18178
        obj = null;
        
        //$LASTPOS=95018199;//kernel.Pad:18199
        if (i==null) {
          //$LASTPOS=95018214;//kernel.Pad:18214
          i=0;
        }
        //$LASTPOS=95018226;//kernel.Pad:18226
        if (i>=0&&i<_this.jujiPads.length) {
          //$LASTPOS=95018261;//kernel.Pad:18261
          obj=_this.jujiPads[i];
        }
        return obj;
      },
      fiber$getJujiPadObj :function _trc_Pad_f_getJujiPadObj(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var obj;
        
        
        _thread.enter(function _trc_Pad_ent_getJujiPadObj(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95018121;//kernel.Pad:18121
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95018138;//kernel.Pad:18138
              if (!(_this.jujiPads==null)) { __pc=2     ; break; }
              _thread.exit(null);return;
            case 2     :
              
              //$LASTPOS=95018178;//kernel.Pad:18178
              obj = null;
              
              //$LASTPOS=95018199;//kernel.Pad:18199
              if (i==null) {
                //$LASTPOS=95018214;//kernel.Pad:18214
                i=0;
              }
              //$LASTPOS=95018226;//kernel.Pad:18226
              if (i>=0&&i<_this.jujiPads.length) {
                //$LASTPOS=95018261;//kernel.Pad:18261
                obj=_this.jujiPads[i];
              }
              _thread.exit(obj);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getJujiPadObjLength :function _trc_Pad_getJujiPadObjLength(i) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95018356;//kernel.Pad:18356
        _this.activate();
        //$LASTPOS=95018373;//kernel.Pad:18373
        if (_this.jujiPads==null) {
          return null;
        }
        return _this.jujiPads.length;
      },
      fiber$getJujiPadObjLength :function _trc_Pad_f_getJujiPadObjLength(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_getJujiPadObjLength(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95018356;//kernel.Pad:18356
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95018373;//kernel.Pad:18373
              if (!(_this.jujiPads==null)) { __pc=2     ; break; }
              _thread.exit(null);return;
            case 2     :
              
              _thread.exit(_this.jujiPads.length);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getButtonObj :function _trc_Pad_getButtonObj(i) {
        "use strict";
        var _this=this;
        var obj;
        
        //$LASTPOS=95018497;//kernel.Pad:18497
        _this.activate();
        //$LASTPOS=95018514;//kernel.Pad:18514
        if (_this.buttons==null) {
          return null;
        }
        //$LASTPOS=95018553;//kernel.Pad:18553
        obj = null;
        
        //$LASTPOS=95018574;//kernel.Pad:18574
        if (i==null) {
          //$LASTPOS=95018589;//kernel.Pad:18589
          i=0;
        }
        //$LASTPOS=95018601;//kernel.Pad:18601
        if (i>=0&&i<_this.buttons.length) {
          //$LASTPOS=95018635;//kernel.Pad:18635
          obj=_this.buttons[i];
        }
        return obj;
      },
      fiber$getButtonObj :function _trc_Pad_f_getButtonObj(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var obj;
        
        
        _thread.enter(function _trc_Pad_ent_getButtonObj(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95018497;//kernel.Pad:18497
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95018514;//kernel.Pad:18514
              if (!(_this.buttons==null)) { __pc=2     ; break; }
              _thread.exit(null);return;
            case 2     :
              
              //$LASTPOS=95018553;//kernel.Pad:18553
              obj = null;
              
              //$LASTPOS=95018574;//kernel.Pad:18574
              if (i==null) {
                //$LASTPOS=95018589;//kernel.Pad:18589
                i=0;
              }
              //$LASTPOS=95018601;//kernel.Pad:18601
              if (i>=0&&i<_this.buttons.length) {
                //$LASTPOS=95018635;//kernel.Pad:18635
                obj=_this.buttons[i];
              }
              _thread.exit(obj);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getButtonObjLength :function _trc_Pad_getButtonObjLength(i) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=95018727;//kernel.Pad:18727
        _this.activate();
        //$LASTPOS=95018744;//kernel.Pad:18744
        if (_this.buttons==null) {
          return null;
        }
        return _this.buttons.length;
      },
      fiber$getButtonObjLength :function _trc_Pad_f_getButtonObjLength(_thread,i) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_getButtonObjLength(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=95018727;//kernel.Pad:18727
              _this.fiber$activate(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=95018744;//kernel.Pad:18744
              if (!(_this.buttons==null)) { __pc=2     ; break; }
              _thread.exit(null);return;
            case 2     :
              
              _thread.exit(_this.buttons.length);return;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getPadUp :function _trc_Pad_getPadUp() {
        "use strict";
        var _this=this;
        
        return _this.getUp();
      },
      fiber$getPadUp :function _trc_Pad_f_getPadUp(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_getPadUp(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$getUp(_thread);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getPadDown :function _trc_Pad_getPadDown() {
        "use strict";
        var _this=this;
        
        return _this.getDown();
      },
      fiber$getPadDown :function _trc_Pad_f_getPadDown(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_getPadDown(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$getDown(_thread);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getPadLeft :function _trc_Pad_getPadLeft() {
        "use strict";
        var _this=this;
        
        return _this.getLeft();
      },
      fiber$getPadLeft :function _trc_Pad_f_getPadLeft(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_getPadLeft(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$getLeft(_thread);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getPadRight :function _trc_Pad_getPadRight() {
        "use strict";
        var _this=this;
        
        return _this.getRight();
      },
      fiber$getPadRight :function _trc_Pad_f_getPadRight(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_getPadRight(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$getRight(_thread);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      getPadButton :function _trc_Pad_getPadButton() {
        "use strict";
        var _this=this;
        
        return _this.getButton();
      },
      fiber$getPadButton :function _trc_Pad_f_getPadButton(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Pad_ent_getPadButton(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              _this.fiber$getButton(_thread);
              __pc=1;return;
            case 1:
              _thread.exit(_thread.retVal);return;
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      isOnRect :function _trc_Pad_isOnRect(mx,my,rx,ry,rx2,ry2) {
        "use strict";
        var _this=this;
        
        return (rx<=mx&&mx<rx2&&ry<=my&&my<ry2);
      },
      fiber$isOnRect :function _trc_Pad_f_isOnRect(_thread,mx,my,rx,ry,rx2,ry2) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=(rx<=mx&&mx<rx2&&ry<=my&&my<ry2);return;
        
        
        _thread.retVal=_this;return;
      },
      isOnRectWH :function _trc_Pad_isOnRectWH(mx,my,rx,ry,rw,rh) {
        "use strict";
        var _this=this;
        
        return (rx<=mx&&mx<rx+rw&&ry<=my&&my<ry+rh);
      },
      fiber$isOnRectWH :function _trc_Pad_f_isOnRectWH(_thread,mx,my,rx,ry,rw,rh) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=(rx<=mx&&mx<rx+rw&&ry<=my&&my<ry+rh);return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"activate":{"nowait":false},"newPadV2":{"nowait":false},"newPadV1":{"nowait":false},"die":{"nowait":true},"dieV2":{"nowait":false},"dieV1":{"nowait":false},"initButton":{"nowait":false},"initButtonLayout1":{"nowait":false},"drawPanel":{"nowait":false},"setXYPanel":{"nowait":false},"setXYPanelLayout1":{"nowait":false},"padUpdate":{"nowait":false},"padUpdateV2":{"nowait":false},"padUpdateV1":{"nowait":false},"padsUpdateV2":{"nowait":false},"getUp":{"nowait":false},"getDown":{"nowait":false},"getLeft":{"nowait":false},"getRight":{"nowait":false},"getButton":{"nowait":false},"getJujiPadObj":{"nowait":false},"getJujiPadObjLength":{"nowait":false},"getButtonObj":{"nowait":false},"getButtonObjLength":{"nowait":false},"getPadUp":{"nowait":false},"getPadDown":{"nowait":false},"getPadLeft":{"nowait":false},"getPadRight":{"nowait":false},"getPadButton":{"nowait":false},"isOnRect":{"nowait":false},"isOnRectWH":{"nowait":false}},"fields":{"buttonCnt":{},"version":{},"active":{},"actived":{},"died":{},"layout":{},"autoMove":{},"APAD_DIAG_SIZE":{},"padImageP":{},"padUpdateFrame":{},"jujiKey":{},"no1Key":{},"jujiKeyPushU":{},"jujiKeyPushL":{},"jujiKeyPushR":{},"jujiKeyPushD":{},"jujiKeyPush1":{},"buttons":{},"jujiPads":{},"DEFALT_SCREEN_WIDTH":{},"padScaleX":{},"oldPadScaleX":{},"oldButtonCnt":{},"jujiPadWidth":{},"jujiPadHeight":{},"jujiPadBorder":{},"jujiPadFillColor":{},"jujiPadBorderColor":{},"jujiPadLPushColor":{},"jujiPadPushColor":{},"jujiPadRPushColor":{},"jujiPadUPushColor":{},"jujiPadDPushColor":{},"jujiPadLColor":{},"jujiPadColor":{},"jujiPadRColor":{},"jujiPadUColor":{},"jujiPadDColor":{},"jujiPadDiagonalEnable":{},"buttonWidth":{},"buttonHeight":{},"buttonFillColor":{},"buttonBorder":{},"buttonBorderColor":{},"buttonPushColor":{},"buttonText":{},"buttonTextSize":{},"buttonTextColor":{},"button1Width":{},"button1Height":{},"button1FillColor":{},"button1Border":{},"button1BorderColor":{},"button1PushColor":{},"button1Text":{},"button1TextSize":{},"button1TextColor":{},"button2Width":{},"button2Height":{},"button2FillColor":{},"button2Border":{},"button2BorderColor":{},"button2PushColor":{},"button2Text":{},"button2TextSize":{},"button2TextColor":{},"button3Width":{},"button3Height":{},"button3FillColor":{},"button3Border":{},"button3BorderColor":{},"button3PushColor":{},"button3Text":{},"button3TextSize":{},"button3TextColor":{},"button4Width":{},"button4Height":{},"button4FillColor":{},"button4Border":{},"button4BorderColor":{},"button4PushColor":{},"button4Text":{},"button4TextSize":{},"button4TextColor":{},"oldScreenWidth":{},"oldScreenHeight":{},"keyPushL":{},"keyPushR":{},"keyPushU":{},"keyPushD":{},"keyPush1":{},"padKeyNotapCnt":{},"padKeySW":{},"keyCntL":{},"keyCntR":{},"keyCntU":{},"keyCntD":{},"keyCnt1":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.PadButton',
  shortName: 'PadButton',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_PadButton_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=96015100;//kernel.PadButton:15100
        while (_this.loop) {
          //$LASTPOS=96015120;//kernel.PadButton:15120
          _this.padUpdate();
          //$LASTPOS=96015138;//kernel.PadButton:15138
          _this.update();
          
        }
      },
      fiber$main :function _trc_PadButton_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_PadButton_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=96015100;//kernel.PadButton:15100
            case 1:
              if (!(_this.loop)) { __pc=4     ; break; }
              //$LASTPOS=96015120;//kernel.PadButton:15120
              _this.fiber$padUpdate(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=96015138;//kernel.PadButton:15138
              _this.fiber$update(_thread);
              __pc=3;return;
            case 3:
              
              __pc=1;break;
            case 4     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initialize :function _trc_PadButton_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=96000090;//kernel.PadButton:90
        __superClass.apply( _this, [opt]);
        //$LASTPOS=96000107;//kernel.PadButton:107
        _this.died=false;
        //$LASTPOS=96000126;//kernel.PadButton:126
        _this.zOrder=- 10000;
        //$LASTPOS=96000148;//kernel.PadButton:148
        _this.init();
      },
      die :function _trc_PadButton_die() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=96000548;//kernel.PadButton:548
        _this.died=true;
        //$LASTPOS=96000566;//kernel.PadButton:566
        _this.padCnt=0;
        //$LASTPOS=96000583;//kernel.PadButton:583
        _this.padCntL=0;
        //$LASTPOS=96000601;//kernel.PadButton:601
        _this.padCntR=0;
        //$LASTPOS=96000619;//kernel.PadButton:619
        _this.padCntU=0;
        //$LASTPOS=96000637;//kernel.PadButton:637
        _this.padCntD=0;
        //$LASTPOS=96000655;//kernel.PadButton:655
        if (_this.panel!=null) {
          //$LASTPOS=96000685;//kernel.PadButton:685
          _this.panel.hide();
          //$LASTPOS=96000708;//kernel.PadButton:708
          _this.panel.die();
          
        }
        //$LASTPOS=96000733;//kernel.PadButton:733
        if (_this.panelPush!=null) {
          //$LASTPOS=96000767;//kernel.PadButton:767
          _this.panelPush.hide();
          //$LASTPOS=96000794;//kernel.PadButton:794
          _this.panelPush.die();
          
        }
        //$LASTPOS=96000823;//kernel.PadButton:823
        if (_this.panelPushL!=null) {
          //$LASTPOS=96000858;//kernel.PadButton:858
          _this.panelPushL.hide();
          //$LASTPOS=96000886;//kernel.PadButton:886
          _this.panelPushL.die();
          
        }
        //$LASTPOS=96000916;//kernel.PadButton:916
        if (_this.panelPushR!=null) {
          //$LASTPOS=96000951;//kernel.PadButton:951
          _this.panelPushR.hide();
          //$LASTPOS=96000979;//kernel.PadButton:979
          _this.panelPushR.die();
          
        }
        //$LASTPOS=96001009;//kernel.PadButton:1009
        if (_this.panelPushU!=null) {
          //$LASTPOS=96001044;//kernel.PadButton:1044
          _this.panelPushU.hide();
          //$LASTPOS=96001072;//kernel.PadButton:1072
          _this.panelPushU.die();
          
        }
        //$LASTPOS=96001102;//kernel.PadButton:1102
        if (_this.panelPushD!=null) {
          //$LASTPOS=96001137;//kernel.PadButton:1137
          _this.panelPushD.hide();
          //$LASTPOS=96001165;//kernel.PadButton:1165
          _this.panelPushD.die();
          
        }
        //$LASTPOS=96001195;//kernel.PadButton:1195
        __superClass.prototype.die.apply( _this, []);
      },
      hide :function _trc_PadButton_hide() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=96001229;//kernel.PadButton:1229
        if (_this.panel!=null) {
          //$LASTPOS=96001259;//kernel.PadButton:1259
          _this.panel.hide();
          
        }
      },
      show :function _trc_PadButton_show() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=96001322;//kernel.PadButton:1322
        if (_this.panel!=null) {
          //$LASTPOS=96001352;//kernel.PadButton:1352
          _this.panel.show();
          
        }
      },
      init :function _trc_PadButton_init() {
        "use strict";
        var _this=this;
        var i;
        
        //$LASTPOS=96001415;//kernel.PadButton:1415
        _this.TOUCHES_MAX=5;
        //$LASTPOS=96001448;//kernel.PadButton:1448
        _this.loop=true;
        //$LASTPOS=96001478;//kernel.PadButton:1478
        _this.padCnt=0;
        //$LASTPOS=96001495;//kernel.PadButton:1495
        _this.padCntL=0;
        //$LASTPOS=96001513;//kernel.PadButton:1513
        _this.padCntR=0;
        //$LASTPOS=96001531;//kernel.PadButton:1531
        _this.padCntU=0;
        //$LASTPOS=96001549;//kernel.PadButton:1549
        _this.padCntD=0;
        //$LASTPOS=96001567;//kernel.PadButton:1567
        _this.padNotapCnt=0;
        //$LASTPOS=96001589;//kernel.PadButton:1589
        _this.padUpdateFrame=- 1;
        //$LASTPOS=96001617;//kernel.PadButton:1617
        if (_this.mode==0) {
          //$LASTPOS=96001830;//kernel.PadButton:1830
          if (_this.p==null) {
            //$LASTPOS=96001845;//kernel.PadButton:1845
            _this.p=0;
          }
          //$LASTPOS=96001861;//kernel.PadButton:1861
          if (_this.pushP==null) {
            //$LASTPOS=96001880;//kernel.PadButton:1880
            _this.pushP=1;
          }
          //$LASTPOS=96001900;//kernel.PadButton:1900
          if (_this.drawMode==null) {
            //$LASTPOS=96001922;//kernel.PadButton:1922
            _this.drawMode=0;
          }
          
        } else {
          //$LASTPOS=96001950;//kernel.PadButton:1950
          if (_this.mode==1) {
            //$LASTPOS=96002360;//kernel.PadButton:2360
            if (_this.p==null) {
              //$LASTPOS=96002380;//kernel.PadButton:2380
              _this.p=0;
            }
            //$LASTPOS=96002401;//kernel.PadButton:2401
            if (_this.pushLP==null) {
              //$LASTPOS=96002421;//kernel.PadButton:2421
              _this.pushLP=1;
            }
            //$LASTPOS=96002442;//kernel.PadButton:2442
            if (_this.pushRP==null) {
              //$LASTPOS=96002462;//kernel.PadButton:2462
              _this.pushRP=1;
            }
            //$LASTPOS=96002483;//kernel.PadButton:2483
            if (_this.pushUP==null) {
              //$LASTPOS=96002503;//kernel.PadButton:2503
              _this.pushUP=1;
            }
            //$LASTPOS=96002524;//kernel.PadButton:2524
            if (_this.pushDP==null) {
              //$LASTPOS=96002544;//kernel.PadButton:2544
              _this.pushDP=1;
            }
            //$LASTPOS=96002565;//kernel.PadButton:2565
            if (_this.drawMode==null) {
              //$LASTPOS=96002587;//kernel.PadButton:2587
              _this.drawMode=0;
            }
            //$LASTPOS=96002610;//kernel.PadButton:2610
            if (_this.diagonalEnable==null) {
              //$LASTPOS=96002638;//kernel.PadButton:2638
              _this.diagonalEnable=true;
            }
            
          } else {
            //$LASTPOS=96002675;//kernel.PadButton:2675
            if (_this.mode==2) {
              //$LASTPOS=96002720;//kernel.PadButton:2720
              if (_this.p==null) {
                //$LASTPOS=96002735;//kernel.PadButton:2735
                _this.p=0;
              }
              //$LASTPOS=96002751;//kernel.PadButton:2751
              if (_this.pushP==null) {
                //$LASTPOS=96002770;//kernel.PadButton:2770
                _this.pushP=1;
              }
              
            } else {
              //$LASTPOS=96002795;//kernel.PadButton:2795
              if (_this.mode==10000) {
                //$LASTPOS=96003197;//kernel.PadButton:3197
                _this.p=- 1;
                //$LASTPOS=96003214;//kernel.PadButton:3214
                if (_this.width==null) {
                  //$LASTPOS=96003233;//kernel.PadButton:3233
                  _this.width=96;
                }
                //$LASTPOS=96003254;//kernel.PadButton:3254
                if (_this.height==null) {
                  //$LASTPOS=96003274;//kernel.PadButton:3274
                  _this.height=96;
                }
                //$LASTPOS=96003296;//kernel.PadButton:3296
                if (_this.padFillColor==null) {
                  //$LASTPOS=96003322;//kernel.PadButton:3322
                  _this.padFillColor="rgba(0,0,0,0.125)";
                }
                //$LASTPOS=96003367;//kernel.PadButton:3367
                if (_this.padBorder==null) {
                  //$LASTPOS=96003390;//kernel.PadButton:3390
                  _this.padBorder=1;
                }
                //$LASTPOS=96003414;//kernel.PadButton:3414
                if (_this.padBorderColor==null) {
                  //$LASTPOS=96003442;//kernel.PadButton:3442
                  _this.padBorderColor="rgba(255,255,255,0.5)";
                }
                //$LASTPOS=96003493;//kernel.PadButton:3493
                if (_this.padPushColor==null) {
                  //$LASTPOS=96003519;//kernel.PadButton:3519
                  _this.padPushColor="rgba(255,255,255,0.25)";
                }
                //$LASTPOS=96003569;//kernel.PadButton:3569
                if (_this.padText==null) {
                  //$LASTPOS=96003590;//kernel.PadButton:3590
                  _this.padText="";
                }
                //$LASTPOS=96003613;//kernel.PadButton:3613
                if (_this.padTextSize==null) {
                  //$LASTPOS=96003638;//kernel.PadButton:3638
                  _this.padTextSize=72;
                }
                //$LASTPOS=96003665;//kernel.PadButton:3665
                if (_this.padTextColor==null) {
                  //$LASTPOS=96003691;//kernel.PadButton:3691
                  _this.padTextColor="rgba(255,255,255,0.625)";
                }
                //$LASTPOS=96003744;//kernel.PadButton:3744
                _this.panel=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
                //$LASTPOS=96003782;//kernel.PadButton:3782
                _this.panelPush=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
                //$LASTPOS=96003824;//kernel.PadButton:3824
                _this.drawPanel();
                //$LASTPOS=96003873;//kernel.PadButton:3873
                _this.padPush=0;
                //$LASTPOS=96003895;//kernel.PadButton:3895
                _this.padPushList=[];
                //$LASTPOS=96003922;//kernel.PadButton:3922
                //$LASTPOS=96003927;//kernel.PadButton:3927
                i = 0;
                for (; i<_this.TOUCHES_MAX ; i++) {
                  {
                    //$LASTPOS=96003971;//kernel.PadButton:3971
                    _this.padPushList[i]=false;
                  }
                }
                
              } else {
                //$LASTPOS=96004020;//kernel.PadButton:4020
                if (_this.mode==10001) {
                  //$LASTPOS=96004634;//kernel.PadButton:4634
                  _this.p=- 1;
                  //$LASTPOS=96004651;//kernel.PadButton:4651
                  if (_this.width==null) {
                    //$LASTPOS=96004670;//kernel.PadButton:4670
                    _this.width=216;
                  }
                  //$LASTPOS=96004692;//kernel.PadButton:4692
                  if (_this.height==null) {
                    //$LASTPOS=96004712;//kernel.PadButton:4712
                    _this.height=216;
                  }
                  //$LASTPOS=96004735;//kernel.PadButton:4735
                  if (_this.padFillColor==null) {
                    //$LASTPOS=96004761;//kernel.PadButton:4761
                    _this.padFillColor="rgba(0,0,0,0.125)";
                  }
                  //$LASTPOS=96004806;//kernel.PadButton:4806
                  if (_this.padBorder==null) {
                    //$LASTPOS=96004829;//kernel.PadButton:4829
                    _this.padBorder=1;
                  }
                  //$LASTPOS=96004853;//kernel.PadButton:4853
                  if (_this.padBorderColor==null) {
                    //$LASTPOS=96004881;//kernel.PadButton:4881
                    _this.padBorderColor="rgba(255,255,255,0.5)";
                  }
                  //$LASTPOS=96004932;//kernel.PadButton:4932
                  if (_this.padLPushColor==null) {
                    //$LASTPOS=96004959;//kernel.PadButton:4959
                    _this.padLPushColor="rgba(255,255,255,0.25)";
                  }
                  //$LASTPOS=96005010;//kernel.PadButton:5010
                  if (_this.padRPushColor==null) {
                    //$LASTPOS=96005037;//kernel.PadButton:5037
                    _this.padRPushColor="rgba(255,255,255,0.25)";
                  }
                  //$LASTPOS=96005088;//kernel.PadButton:5088
                  if (_this.padUPushColor==null) {
                    //$LASTPOS=96005115;//kernel.PadButton:5115
                    _this.padUPushColor="rgba(255,255,255,0.25)";
                  }
                  //$LASTPOS=96005166;//kernel.PadButton:5166
                  if (_this.padDPushColor==null) {
                    //$LASTPOS=96005193;//kernel.PadButton:5193
                    _this.padDPushColor="rgba(255,255,255,0.25)";
                  }
                  //$LASTPOS=96005244;//kernel.PadButton:5244
                  if (_this.padLColor==null) {
                    //$LASTPOS=96005267;//kernel.PadButton:5267
                    _this.padLColor="rgba(255,255,255,0.625)";
                  }
                  //$LASTPOS=96005315;//kernel.PadButton:5315
                  if (_this.padRColor==null) {
                    //$LASTPOS=96005338;//kernel.PadButton:5338
                    _this.padRColor="rgba(255,255,255,0.625)";
                  }
                  //$LASTPOS=96005386;//kernel.PadButton:5386
                  if (_this.padUColor==null) {
                    //$LASTPOS=96005409;//kernel.PadButton:5409
                    _this.padUColor="rgba(255,255,255,0.625)";
                  }
                  //$LASTPOS=96005457;//kernel.PadButton:5457
                  if (_this.padDColor==null) {
                    //$LASTPOS=96005480;//kernel.PadButton:5480
                    _this.padDColor="rgba(255,255,255,0.625)";
                  }
                  //$LASTPOS=96005528;//kernel.PadButton:5528
                  if (_this.diagonalEnable==null) {
                    //$LASTPOS=96005556;//kernel.PadButton:5556
                    _this.diagonalEnable=true;
                  }
                  //$LASTPOS=96005590;//kernel.PadButton:5590
                  _this.panel=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
                  //$LASTPOS=96005628;//kernel.PadButton:5628
                  _this.panelPushL=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
                  //$LASTPOS=96005671;//kernel.PadButton:5671
                  _this.panelPushR=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
                  //$LASTPOS=96005714;//kernel.PadButton:5714
                  _this.panelPushU=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
                  //$LASTPOS=96005757;//kernel.PadButton:5757
                  _this.panelPushD=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
                  //$LASTPOS=96005800;//kernel.PadButton:5800
                  _this.drawPanel();
                  //$LASTPOS=96005849;//kernel.PadButton:5849
                  _this.padPushTouchNo=- 1;
                  
                } else {
                  //$LASTPOS=96005884;//kernel.PadButton:5884
                  if (_this.mode==10002) {
                    //$LASTPOS=96005950;//kernel.PadButton:5950
                    _this.p=- 1;
                    //$LASTPOS=96005969;//kernel.PadButton:5969
                    _this.panel=new Tonyu.classes.kernel.PadPanel;
                    //$LASTPOS=96006000;//kernel.PadButton:6000
                    _this.drawPanel();
                    
                  }
                }
              }
            }
          }
        }
      },
      fiber$init :function _trc_PadButton_f_init(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var i;
        
        //$LASTPOS=96001415;//kernel.PadButton:1415
        _this.TOUCHES_MAX=5;
        //$LASTPOS=96001448;//kernel.PadButton:1448
        _this.loop=true;
        //$LASTPOS=96001478;//kernel.PadButton:1478
        _this.padCnt=0;
        //$LASTPOS=96001495;//kernel.PadButton:1495
        _this.padCntL=0;
        //$LASTPOS=96001513;//kernel.PadButton:1513
        _this.padCntR=0;
        //$LASTPOS=96001531;//kernel.PadButton:1531
        _this.padCntU=0;
        //$LASTPOS=96001549;//kernel.PadButton:1549
        _this.padCntD=0;
        //$LASTPOS=96001567;//kernel.PadButton:1567
        _this.padNotapCnt=0;
        //$LASTPOS=96001589;//kernel.PadButton:1589
        _this.padUpdateFrame=- 1;
        
        _thread.enter(function _trc_PadButton_ent_init(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=96001617;//kernel.PadButton:1617
              if (!(_this.mode==0)) { __pc=1     ; break; }
              {
                //$LASTPOS=96001830;//kernel.PadButton:1830
                if (_this.p==null) {
                  //$LASTPOS=96001845;//kernel.PadButton:1845
                  _this.p=0;
                }
                //$LASTPOS=96001861;//kernel.PadButton:1861
                if (_this.pushP==null) {
                  //$LASTPOS=96001880;//kernel.PadButton:1880
                  _this.pushP=1;
                }
                //$LASTPOS=96001900;//kernel.PadButton:1900
                if (_this.drawMode==null) {
                  //$LASTPOS=96001922;//kernel.PadButton:1922
                  _this.drawMode=0;
                }
              }
              __pc=14    ;break;
            case 1     :
              //$LASTPOS=96001950;//kernel.PadButton:1950
              if (!(_this.mode==1)) { __pc=2     ; break; }
              {
                //$LASTPOS=96002360;//kernel.PadButton:2360
                if (_this.p==null) {
                  //$LASTPOS=96002380;//kernel.PadButton:2380
                  _this.p=0;
                }
                //$LASTPOS=96002401;//kernel.PadButton:2401
                if (_this.pushLP==null) {
                  //$LASTPOS=96002421;//kernel.PadButton:2421
                  _this.pushLP=1;
                }
                //$LASTPOS=96002442;//kernel.PadButton:2442
                if (_this.pushRP==null) {
                  //$LASTPOS=96002462;//kernel.PadButton:2462
                  _this.pushRP=1;
                }
                //$LASTPOS=96002483;//kernel.PadButton:2483
                if (_this.pushUP==null) {
                  //$LASTPOS=96002503;//kernel.PadButton:2503
                  _this.pushUP=1;
                }
                //$LASTPOS=96002524;//kernel.PadButton:2524
                if (_this.pushDP==null) {
                  //$LASTPOS=96002544;//kernel.PadButton:2544
                  _this.pushDP=1;
                }
                //$LASTPOS=96002565;//kernel.PadButton:2565
                if (_this.drawMode==null) {
                  //$LASTPOS=96002587;//kernel.PadButton:2587
                  _this.drawMode=0;
                }
                //$LASTPOS=96002610;//kernel.PadButton:2610
                if (_this.diagonalEnable==null) {
                  //$LASTPOS=96002638;//kernel.PadButton:2638
                  _this.diagonalEnable=true;
                }
              }
              __pc=13    ;break;
            case 2     :
              //$LASTPOS=96002675;//kernel.PadButton:2675
              if (!(_this.mode==2)) { __pc=3     ; break; }
              {
                //$LASTPOS=96002720;//kernel.PadButton:2720
                if (_this.p==null) {
                  //$LASTPOS=96002735;//kernel.PadButton:2735
                  _this.p=0;
                }
                //$LASTPOS=96002751;//kernel.PadButton:2751
                if (_this.pushP==null) {
                  //$LASTPOS=96002770;//kernel.PadButton:2770
                  _this.pushP=1;
                }
              }
              __pc=12    ;break;
            case 3     :
              //$LASTPOS=96002795;//kernel.PadButton:2795
              if (!(_this.mode==10000)) { __pc=5     ; break; }
              //$LASTPOS=96003197;//kernel.PadButton:3197
              _this.p=- 1;
              //$LASTPOS=96003214;//kernel.PadButton:3214
              if (_this.width==null) {
                //$LASTPOS=96003233;//kernel.PadButton:3233
                _this.width=96;
              }
              //$LASTPOS=96003254;//kernel.PadButton:3254
              if (_this.height==null) {
                //$LASTPOS=96003274;//kernel.PadButton:3274
                _this.height=96;
              }
              //$LASTPOS=96003296;//kernel.PadButton:3296
              if (_this.padFillColor==null) {
                //$LASTPOS=96003322;//kernel.PadButton:3322
                _this.padFillColor="rgba(0,0,0,0.125)";
              }
              //$LASTPOS=96003367;//kernel.PadButton:3367
              if (_this.padBorder==null) {
                //$LASTPOS=96003390;//kernel.PadButton:3390
                _this.padBorder=1;
              }
              //$LASTPOS=96003414;//kernel.PadButton:3414
              if (_this.padBorderColor==null) {
                //$LASTPOS=96003442;//kernel.PadButton:3442
                _this.padBorderColor="rgba(255,255,255,0.5)";
              }
              //$LASTPOS=96003493;//kernel.PadButton:3493
              if (_this.padPushColor==null) {
                //$LASTPOS=96003519;//kernel.PadButton:3519
                _this.padPushColor="rgba(255,255,255,0.25)";
              }
              //$LASTPOS=96003569;//kernel.PadButton:3569
              if (_this.padText==null) {
                //$LASTPOS=96003590;//kernel.PadButton:3590
                _this.padText="";
              }
              //$LASTPOS=96003613;//kernel.PadButton:3613
              if (_this.padTextSize==null) {
                //$LASTPOS=96003638;//kernel.PadButton:3638
                _this.padTextSize=72;
              }
              //$LASTPOS=96003665;//kernel.PadButton:3665
              if (_this.padTextColor==null) {
                //$LASTPOS=96003691;//kernel.PadButton:3691
                _this.padTextColor="rgba(255,255,255,0.625)";
              }
              //$LASTPOS=96003744;//kernel.PadButton:3744
              _this.panel=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
              //$LASTPOS=96003782;//kernel.PadButton:3782
              _this.panelPush=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
              //$LASTPOS=96003824;//kernel.PadButton:3824
              _this.fiber$drawPanel(_thread);
              __pc=4;return;
            case 4:
              
              //$LASTPOS=96003873;//kernel.PadButton:3873
              _this.padPush=0;
              //$LASTPOS=96003895;//kernel.PadButton:3895
              _this.padPushList=[];
              //$LASTPOS=96003922;//kernel.PadButton:3922
              //$LASTPOS=96003927;//kernel.PadButton:3927
              i = 0;
              for (; i<_this.TOUCHES_MAX ; i++) {
                {
                  //$LASTPOS=96003971;//kernel.PadButton:3971
                  _this.padPushList[i]=false;
                }
              }
              __pc=11    ;break;
            case 5     :
              //$LASTPOS=96004020;//kernel.PadButton:4020
              if (!(_this.mode==10001)) { __pc=7     ; break; }
              //$LASTPOS=96004634;//kernel.PadButton:4634
              _this.p=- 1;
              //$LASTPOS=96004651;//kernel.PadButton:4651
              if (_this.width==null) {
                //$LASTPOS=96004670;//kernel.PadButton:4670
                _this.width=216;
              }
              //$LASTPOS=96004692;//kernel.PadButton:4692
              if (_this.height==null) {
                //$LASTPOS=96004712;//kernel.PadButton:4712
                _this.height=216;
              }
              //$LASTPOS=96004735;//kernel.PadButton:4735
              if (_this.padFillColor==null) {
                //$LASTPOS=96004761;//kernel.PadButton:4761
                _this.padFillColor="rgba(0,0,0,0.125)";
              }
              //$LASTPOS=96004806;//kernel.PadButton:4806
              if (_this.padBorder==null) {
                //$LASTPOS=96004829;//kernel.PadButton:4829
                _this.padBorder=1;
              }
              //$LASTPOS=96004853;//kernel.PadButton:4853
              if (_this.padBorderColor==null) {
                //$LASTPOS=96004881;//kernel.PadButton:4881
                _this.padBorderColor="rgba(255,255,255,0.5)";
              }
              //$LASTPOS=96004932;//kernel.PadButton:4932
              if (_this.padLPushColor==null) {
                //$LASTPOS=96004959;//kernel.PadButton:4959
                _this.padLPushColor="rgba(255,255,255,0.25)";
              }
              //$LASTPOS=96005010;//kernel.PadButton:5010
              if (_this.padRPushColor==null) {
                //$LASTPOS=96005037;//kernel.PadButton:5037
                _this.padRPushColor="rgba(255,255,255,0.25)";
              }
              //$LASTPOS=96005088;//kernel.PadButton:5088
              if (_this.padUPushColor==null) {
                //$LASTPOS=96005115;//kernel.PadButton:5115
                _this.padUPushColor="rgba(255,255,255,0.25)";
              }
              //$LASTPOS=96005166;//kernel.PadButton:5166
              if (_this.padDPushColor==null) {
                //$LASTPOS=96005193;//kernel.PadButton:5193
                _this.padDPushColor="rgba(255,255,255,0.25)";
              }
              //$LASTPOS=96005244;//kernel.PadButton:5244
              if (_this.padLColor==null) {
                //$LASTPOS=96005267;//kernel.PadButton:5267
                _this.padLColor="rgba(255,255,255,0.625)";
              }
              //$LASTPOS=96005315;//kernel.PadButton:5315
              if (_this.padRColor==null) {
                //$LASTPOS=96005338;//kernel.PadButton:5338
                _this.padRColor="rgba(255,255,255,0.625)";
              }
              //$LASTPOS=96005386;//kernel.PadButton:5386
              if (_this.padUColor==null) {
                //$LASTPOS=96005409;//kernel.PadButton:5409
                _this.padUColor="rgba(255,255,255,0.625)";
              }
              //$LASTPOS=96005457;//kernel.PadButton:5457
              if (_this.padDColor==null) {
                //$LASTPOS=96005480;//kernel.PadButton:5480
                _this.padDColor="rgba(255,255,255,0.625)";
              }
              //$LASTPOS=96005528;//kernel.PadButton:5528
              if (_this.diagonalEnable==null) {
                //$LASTPOS=96005556;//kernel.PadButton:5556
                _this.diagonalEnable=true;
              }
              //$LASTPOS=96005590;//kernel.PadButton:5590
              _this.panel=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
              //$LASTPOS=96005628;//kernel.PadButton:5628
              _this.panelPushL=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
              //$LASTPOS=96005671;//kernel.PadButton:5671
              _this.panelPushR=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
              //$LASTPOS=96005714;//kernel.PadButton:5714
              _this.panelPushU=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
              //$LASTPOS=96005757;//kernel.PadButton:5757
              _this.panelPushD=new Tonyu.classes.kernel.PadPanel({layer: _this.layer});
              //$LASTPOS=96005800;//kernel.PadButton:5800
              _this.fiber$drawPanel(_thread);
              __pc=6;return;
            case 6:
              
              //$LASTPOS=96005849;//kernel.PadButton:5849
              _this.padPushTouchNo=- 1;
              __pc=10    ;break;
            case 7     :
              //$LASTPOS=96005884;//kernel.PadButton:5884
              if (!(_this.mode==10002)) { __pc=9     ; break; }
              //$LASTPOS=96005950;//kernel.PadButton:5950
              _this.p=- 1;
              //$LASTPOS=96005969;//kernel.PadButton:5969
              _this.panel=new Tonyu.classes.kernel.PadPanel;
              //$LASTPOS=96006000;//kernel.PadButton:6000
              _this.fiber$drawPanel(_thread);
              __pc=8;return;
            case 8:
              
            case 9     :
              
            case 10    :
              
            case 11    :
              
            case 12    :
              
            case 13    :
              
            case 14    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      drawPanel :function _trc_PadButton_drawPanel() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=96006092;//kernel.PadButton:6092
        if (_this.mode==10000) {
          //$LASTPOS=96006122;//kernel.PadButton:6122
          _this.drawPanelMode10000();
          
        } else {
          //$LASTPOS=96006156;//kernel.PadButton:6156
          if (_this.mode==10001) {
            //$LASTPOS=96006186;//kernel.PadButton:6186
            _this.drawPanelMode10001();
            
          } else {
            //$LASTPOS=96006220;//kernel.PadButton:6220
            if (_this.mode==10002) {
              //$LASTPOS=96006250;//kernel.PadButton:6250
              _this.drawPanelMode10002();
              
            }
          }
        }
      },
      fiber$drawPanel :function _trc_PadButton_f_drawPanel(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_PadButton_ent_drawPanel(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=96006092;//kernel.PadButton:6092
              if (!(_this.mode==10000)) { __pc=2     ; break; }
              //$LASTPOS=96006122;//kernel.PadButton:6122
              _this.fiber$drawPanelMode10000(_thread);
              __pc=1;return;
            case 1:
              
              __pc=8     ;break;
            case 2     :
              //$LASTPOS=96006156;//kernel.PadButton:6156
              if (!(_this.mode==10001)) { __pc=4     ; break; }
              //$LASTPOS=96006186;//kernel.PadButton:6186
              _this.fiber$drawPanelMode10001(_thread);
              __pc=3;return;
            case 3:
              
              __pc=7     ;break;
            case 4     :
              //$LASTPOS=96006220;//kernel.PadButton:6220
              if (!(_this.mode==10002)) { __pc=6     ; break; }
              //$LASTPOS=96006250;//kernel.PadButton:6250
              _this.fiber$drawPanelMode10002(_thread);
              __pc=5;return;
            case 5:
              
            case 6     :
              
            case 7     :
              
            case 8     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      drawPanelMode10000 :function _trc_PadButton_drawPanelMode10000() {
        "use strict";
        var _this=this;
        var w;
        var h;
        var bw;
        var bh;
        var ts;
        
        
        
        
        //$LASTPOS=96006361;//kernel.PadButton:6361
        w=_this.width;
        //$LASTPOS=96006377;//kernel.PadButton:6377
        h=_this.height;
        //$LASTPOS=96006394;//kernel.PadButton:6394
        bw=_this.padBorder;
        //$LASTPOS=96006415;//kernel.PadButton:6415
        bh=_this.padBorder;
        //$LASTPOS=96006436;//kernel.PadButton:6436
        ts=_this.padTextSize;
        //$LASTPOS=96006459;//kernel.PadButton:6459
        if (bw<0) {
          //$LASTPOS=96006471;//kernel.PadButton:6471
          bw=0;
        }
        //$LASTPOS=96006484;//kernel.PadButton:6484
        if (bh<0) {
          //$LASTPOS=96006496;//kernel.PadButton:6496
          bh=0;
        }
        //$LASTPOS=96006509;//kernel.PadButton:6509
        if (w<4) {
          //$LASTPOS=96006520;//kernel.PadButton:6520
          w=4;
        }
        //$LASTPOS=96006532;//kernel.PadButton:6532
        if (h<4) {
          //$LASTPOS=96006543;//kernel.PadButton:6543
          h=4;
        }
        //$LASTPOS=96006555;//kernel.PadButton:6555
        _this.panel.setPanel(w+2,h+2);
        //$LASTPOS=96006586;//kernel.PadButton:6586
        _this.panel.clearRect(0,0,w+2,h+2);
        //$LASTPOS=96006624;//kernel.PadButton:6624
        _this.panel.setFillStyle(_this.padBorderColor);
        //$LASTPOS=96006665;//kernel.PadButton:6665
        _this.panel.fillRect(1,1,w,h);
        //$LASTPOS=96006698;//kernel.PadButton:6698
        _this.panel.clearRect(1+bw,1+bh,w-bw*2,h-bh*2);
        //$LASTPOS=96006748;//kernel.PadButton:6748
        _this.panel.setFillStyle(_this.padFillColor);
        //$LASTPOS=96006787;//kernel.PadButton:6787
        _this.panel.fillRect(1+bw,1+bh,w-bw*2,h-bh*2);
        //$LASTPOS=96006836;//kernel.PadButton:6836
        _this.panel.fillText(_this.padText,w/2,h/2,_this.padTextColor,ts,"center","middle");
        //$LASTPOS=96006916;//kernel.PadButton:6916
        _this.panelPush.setPanel(w+2,h+2);
        //$LASTPOS=96006951;//kernel.PadButton:6951
        _this.panelPush.clearRect(0,0,w+2,h+2);
        //$LASTPOS=96006993;//kernel.PadButton:6993
        _this.panelPush.setFillStyle(_this.padPushColor);
        //$LASTPOS=96007036;//kernel.PadButton:7036
        _this.panelPush.fillRect(1,1,w,h);
      },
      fiber$drawPanelMode10000 :function _trc_PadButton_f_drawPanelMode10000(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var w;
        var h;
        var bw;
        var bh;
        var ts;
        
        
        
        
        //$LASTPOS=96006361;//kernel.PadButton:6361
        w=_this.width;
        //$LASTPOS=96006377;//kernel.PadButton:6377
        h=_this.height;
        //$LASTPOS=96006394;//kernel.PadButton:6394
        bw=_this.padBorder;
        //$LASTPOS=96006415;//kernel.PadButton:6415
        bh=_this.padBorder;
        //$LASTPOS=96006436;//kernel.PadButton:6436
        ts=_this.padTextSize;
        //$LASTPOS=96006459;//kernel.PadButton:6459
        if (bw<0) {
          //$LASTPOS=96006471;//kernel.PadButton:6471
          bw=0;
        }
        //$LASTPOS=96006484;//kernel.PadButton:6484
        if (bh<0) {
          //$LASTPOS=96006496;//kernel.PadButton:6496
          bh=0;
        }
        //$LASTPOS=96006509;//kernel.PadButton:6509
        if (w<4) {
          //$LASTPOS=96006520;//kernel.PadButton:6520
          w=4;
        }
        //$LASTPOS=96006532;//kernel.PadButton:6532
        if (h<4) {
          //$LASTPOS=96006543;//kernel.PadButton:6543
          h=4;
        }
        //$LASTPOS=96006555;//kernel.PadButton:6555
        _this.panel.setPanel(w+2,h+2);
        //$LASTPOS=96006586;//kernel.PadButton:6586
        _this.panel.clearRect(0,0,w+2,h+2);
        //$LASTPOS=96006624;//kernel.PadButton:6624
        _this.panel.setFillStyle(_this.padBorderColor);
        //$LASTPOS=96006665;//kernel.PadButton:6665
        _this.panel.fillRect(1,1,w,h);
        //$LASTPOS=96006698;//kernel.PadButton:6698
        _this.panel.clearRect(1+bw,1+bh,w-bw*2,h-bh*2);
        //$LASTPOS=96006748;//kernel.PadButton:6748
        _this.panel.setFillStyle(_this.padFillColor);
        //$LASTPOS=96006787;//kernel.PadButton:6787
        _this.panel.fillRect(1+bw,1+bh,w-bw*2,h-bh*2);
        //$LASTPOS=96006836;//kernel.PadButton:6836
        _this.panel.fillText(_this.padText,w/2,h/2,_this.padTextColor,ts,"center","middle");
        //$LASTPOS=96006916;//kernel.PadButton:6916
        _this.panelPush.setPanel(w+2,h+2);
        //$LASTPOS=96006951;//kernel.PadButton:6951
        _this.panelPush.clearRect(0,0,w+2,h+2);
        //$LASTPOS=96006993;//kernel.PadButton:6993
        _this.panelPush.setFillStyle(_this.padPushColor);
        //$LASTPOS=96007036;//kernel.PadButton:7036
        _this.panelPush.fillRect(1,1,w,h);
        
        _thread.retVal=_this;return;
      },
      drawPanelMode10001 :function _trc_PadButton_drawPanelMode10001() {
        "use strict";
        var _this=this;
        var screenSize;
        var w;
        var h;
        var tsx;
        var tsy;
        var cw;
        var ch;
        var cw2;
        var ch2;
        var bw;
        var bh;
        
        
        
        
        
        
        
        //$LASTPOS=96007213;//kernel.PadButton:7213
        w=_this.width;
        //$LASTPOS=96007229;//kernel.PadButton:7229
        h=_this.height;
        //$LASTPOS=96007246;//kernel.PadButton:7246
        if (w<4) {
          //$LASTPOS=96007257;//kernel.PadButton:7257
          w=4;
        }
        //$LASTPOS=96007269;//kernel.PadButton:7269
        if (h<4) {
          //$LASTPOS=96007280;//kernel.PadButton:7280
          h=4;
        }
        //$LASTPOS=96007292;//kernel.PadButton:7292
        cw=w/3;
        //$LASTPOS=96007309;//kernel.PadButton:7309
        ch=h/3;
        //$LASTPOS=96007326;//kernel.PadButton:7326
        cw2=w*2/3;
        //$LASTPOS=96007348;//kernel.PadButton:7348
        ch2=h*2/3;
        //$LASTPOS=96007370;//kernel.PadButton:7370
        tsx=w/(64*3);
        //$LASTPOS=96007395;//kernel.PadButton:7395
        tsy=h/(64*3);
        //$LASTPOS=96007420;//kernel.PadButton:7420
        bw=_this.padBorder;
        //$LASTPOS=96007441;//kernel.PadButton:7441
        bh=_this.padBorder;
        //$LASTPOS=96007462;//kernel.PadButton:7462
        if (bw<0) {
          //$LASTPOS=96007474;//kernel.PadButton:7474
          bw=0;
        }
        //$LASTPOS=96007487;//kernel.PadButton:7487
        if (bh<0) {
          //$LASTPOS=96007499;//kernel.PadButton:7499
          bh=0;
        }
        //$LASTPOS=96007514;//kernel.PadButton:7514
        _this.panel.setPanel(w,h);
        //$LASTPOS=96007541;//kernel.PadButton:7541
        _this.panel.clearRect(0,0,w+2,h+2);
        //$LASTPOS=96007579;//kernel.PadButton:7579
        _this.panel.setFillStyle(_this.padBorderColor);
        //$LASTPOS=96007620;//kernel.PadButton:7620
        _this.panel.fillRect(cw,0,cw,ch);
        //$LASTPOS=96007656;//kernel.PadButton:7656
        _this.panel.fillRect(0,ch,w,ch);
        //$LASTPOS=96007691;//kernel.PadButton:7691
        _this.panel.fillRect(cw,ch2,cw,ch);
        //$LASTPOS=96007729;//kernel.PadButton:7729
        _this.panel.clearRect(cw+bw,bh,cw-bw*2,h-bh*2);
        //$LASTPOS=96007779;//kernel.PadButton:7779
        _this.panel.clearRect(bw,ch+bh,w-bw*2,ch-bh*2);
        //$LASTPOS=96007829;//kernel.PadButton:7829
        _this.panel.setFillStyle(_this.padFillColor);
        //$LASTPOS=96007868;//kernel.PadButton:7868
        _this.panel.fillRect(cw+bw,bh,cw-bw*2,ch);
        //$LASTPOS=96007913;//kernel.PadButton:7913
        _this.panel.fillRect(bw,ch+bh,w-bw*2,ch-bh*2);
        //$LASTPOS=96007962;//kernel.PadButton:7962
        _this.panel.fillRect(cw+bw,ch2-bh,cw-bw*2,ch);
        //$LASTPOS=96008011;//kernel.PadButton:8011
        _this.panel.fillPolygon3(96*tsx,14.5*tsy,113*tsx,48*tsy,79*tsx,48*tsy,_this.padUColor);
        //$LASTPOS=96008098;//kernel.PadButton:8098
        _this.panel.fillPolygon3(14.5*tsx,96*tsy,48*tsx,79*tsy,48*tsx,113*tsy,_this.padLColor);
        //$LASTPOS=96008185;//kernel.PadButton:8185
        _this.panel.fillPolygon3(96*tsx,177.5*tsy,79*tsx,144*tsy,113*tsx,144*tsy,_this.padDColor);
        //$LASTPOS=96008275;//kernel.PadButton:8275
        _this.panel.fillPolygon3(177.5*tsx,96*tsy,144*tsx,113*tsy,144*tsx,79*tsy,_this.padRColor);
        //$LASTPOS=96008367;//kernel.PadButton:8367
        _this.panelPushL.setPanel(cw+bw,ch);
        //$LASTPOS=96008404;//kernel.PadButton:8404
        _this.panelPushL.clearRect(0,0,cw+bw+2,ch+2);
        //$LASTPOS=96008452;//kernel.PadButton:8452
        _this.panelPushL.setFillStyle(_this.padLPushColor);
        //$LASTPOS=96008497;//kernel.PadButton:8497
        _this.panelPushL.fillRect(0,0,cw+bw,ch);
        //$LASTPOS=96008542;//kernel.PadButton:8542
        _this.panelPushR.setPanel(cw+bw,ch);
        //$LASTPOS=96008579;//kernel.PadButton:8579
        _this.panelPushR.clearRect(0,0,cw+bw+2,ch+2);
        //$LASTPOS=96008627;//kernel.PadButton:8627
        _this.panelPushR.setFillStyle(_this.padRPushColor);
        //$LASTPOS=96008672;//kernel.PadButton:8672
        _this.panelPushR.fillRect(0,0,cw+bw,ch);
        //$LASTPOS=96008717;//kernel.PadButton:8717
        _this.panelPushU.setPanel(cw,ch+bh);
        //$LASTPOS=96008754;//kernel.PadButton:8754
        _this.panelPushU.clearRect(0,0,cw+2,ch+bh+2);
        //$LASTPOS=96008802;//kernel.PadButton:8802
        _this.panelPushU.setFillStyle(_this.padUPushColor);
        //$LASTPOS=96008847;//kernel.PadButton:8847
        _this.panelPushU.fillRect(0,0,cw,ch+bh);
        //$LASTPOS=96008892;//kernel.PadButton:8892
        _this.panelPushD.setPanel(cw,ch+bh);
        //$LASTPOS=96008929;//kernel.PadButton:8929
        _this.panelPushD.clearRect(0,0,cw+2,ch+bh+2);
        //$LASTPOS=96008977;//kernel.PadButton:8977
        _this.panelPushD.setFillStyle(_this.padDPushColor);
        //$LASTPOS=96009022;//kernel.PadButton:9022
        _this.panelPushD.fillRect(0,0,cw,ch+bh);
      },
      fiber$drawPanelMode10001 :function _trc_PadButton_f_drawPanelMode10001(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var screenSize;
        var w;
        var h;
        var tsx;
        var tsy;
        var cw;
        var ch;
        var cw2;
        var ch2;
        var bw;
        var bh;
        
        
        
        
        
        
        
        //$LASTPOS=96007213;//kernel.PadButton:7213
        w=_this.width;
        //$LASTPOS=96007229;//kernel.PadButton:7229
        h=_this.height;
        //$LASTPOS=96007246;//kernel.PadButton:7246
        if (w<4) {
          //$LASTPOS=96007257;//kernel.PadButton:7257
          w=4;
        }
        //$LASTPOS=96007269;//kernel.PadButton:7269
        if (h<4) {
          //$LASTPOS=96007280;//kernel.PadButton:7280
          h=4;
        }
        //$LASTPOS=96007292;//kernel.PadButton:7292
        cw=w/3;
        //$LASTPOS=96007309;//kernel.PadButton:7309
        ch=h/3;
        //$LASTPOS=96007326;//kernel.PadButton:7326
        cw2=w*2/3;
        //$LASTPOS=96007348;//kernel.PadButton:7348
        ch2=h*2/3;
        //$LASTPOS=96007370;//kernel.PadButton:7370
        tsx=w/(64*3);
        //$LASTPOS=96007395;//kernel.PadButton:7395
        tsy=h/(64*3);
        //$LASTPOS=96007420;//kernel.PadButton:7420
        bw=_this.padBorder;
        //$LASTPOS=96007441;//kernel.PadButton:7441
        bh=_this.padBorder;
        //$LASTPOS=96007462;//kernel.PadButton:7462
        if (bw<0) {
          //$LASTPOS=96007474;//kernel.PadButton:7474
          bw=0;
        }
        //$LASTPOS=96007487;//kernel.PadButton:7487
        if (bh<0) {
          //$LASTPOS=96007499;//kernel.PadButton:7499
          bh=0;
        }
        //$LASTPOS=96007514;//kernel.PadButton:7514
        _this.panel.setPanel(w,h);
        //$LASTPOS=96007541;//kernel.PadButton:7541
        _this.panel.clearRect(0,0,w+2,h+2);
        //$LASTPOS=96007579;//kernel.PadButton:7579
        _this.panel.setFillStyle(_this.padBorderColor);
        //$LASTPOS=96007620;//kernel.PadButton:7620
        _this.panel.fillRect(cw,0,cw,ch);
        //$LASTPOS=96007656;//kernel.PadButton:7656
        _this.panel.fillRect(0,ch,w,ch);
        //$LASTPOS=96007691;//kernel.PadButton:7691
        _this.panel.fillRect(cw,ch2,cw,ch);
        //$LASTPOS=96007729;//kernel.PadButton:7729
        _this.panel.clearRect(cw+bw,bh,cw-bw*2,h-bh*2);
        //$LASTPOS=96007779;//kernel.PadButton:7779
        _this.panel.clearRect(bw,ch+bh,w-bw*2,ch-bh*2);
        //$LASTPOS=96007829;//kernel.PadButton:7829
        _this.panel.setFillStyle(_this.padFillColor);
        //$LASTPOS=96007868;//kernel.PadButton:7868
        _this.panel.fillRect(cw+bw,bh,cw-bw*2,ch);
        //$LASTPOS=96007913;//kernel.PadButton:7913
        _this.panel.fillRect(bw,ch+bh,w-bw*2,ch-bh*2);
        //$LASTPOS=96007962;//kernel.PadButton:7962
        _this.panel.fillRect(cw+bw,ch2-bh,cw-bw*2,ch);
        //$LASTPOS=96008011;//kernel.PadButton:8011
        _this.panel.fillPolygon3(96*tsx,14.5*tsy,113*tsx,48*tsy,79*tsx,48*tsy,_this.padUColor);
        //$LASTPOS=96008098;//kernel.PadButton:8098
        _this.panel.fillPolygon3(14.5*tsx,96*tsy,48*tsx,79*tsy,48*tsx,113*tsy,_this.padLColor);
        //$LASTPOS=96008185;//kernel.PadButton:8185
        _this.panel.fillPolygon3(96*tsx,177.5*tsy,79*tsx,144*tsy,113*tsx,144*tsy,_this.padDColor);
        //$LASTPOS=96008275;//kernel.PadButton:8275
        _this.panel.fillPolygon3(177.5*tsx,96*tsy,144*tsx,113*tsy,144*tsx,79*tsy,_this.padRColor);
        //$LASTPOS=96008367;//kernel.PadButton:8367
        _this.panelPushL.setPanel(cw+bw,ch);
        //$LASTPOS=96008404;//kernel.PadButton:8404
        _this.panelPushL.clearRect(0,0,cw+bw+2,ch+2);
        //$LASTPOS=96008452;//kernel.PadButton:8452
        _this.panelPushL.setFillStyle(_this.padLPushColor);
        //$LASTPOS=96008497;//kernel.PadButton:8497
        _this.panelPushL.fillRect(0,0,cw+bw,ch);
        //$LASTPOS=96008542;//kernel.PadButton:8542
        _this.panelPushR.setPanel(cw+bw,ch);
        //$LASTPOS=96008579;//kernel.PadButton:8579
        _this.panelPushR.clearRect(0,0,cw+bw+2,ch+2);
        //$LASTPOS=96008627;//kernel.PadButton:8627
        _this.panelPushR.setFillStyle(_this.padRPushColor);
        //$LASTPOS=96008672;//kernel.PadButton:8672
        _this.panelPushR.fillRect(0,0,cw+bw,ch);
        //$LASTPOS=96008717;//kernel.PadButton:8717
        _this.panelPushU.setPanel(cw,ch+bh);
        //$LASTPOS=96008754;//kernel.PadButton:8754
        _this.panelPushU.clearRect(0,0,cw+2,ch+bh+2);
        //$LASTPOS=96008802;//kernel.PadButton:8802
        _this.panelPushU.setFillStyle(_this.padUPushColor);
        //$LASTPOS=96008847;//kernel.PadButton:8847
        _this.panelPushU.fillRect(0,0,cw,ch+bh);
        //$LASTPOS=96008892;//kernel.PadButton:8892
        _this.panelPushD.setPanel(cw,ch+bh);
        //$LASTPOS=96008929;//kernel.PadButton:8929
        _this.panelPushD.clearRect(0,0,cw+2,ch+bh+2);
        //$LASTPOS=96008977;//kernel.PadButton:8977
        _this.panelPushD.setFillStyle(_this.padDPushColor);
        //$LASTPOS=96009022;//kernel.PadButton:9022
        _this.panelPushD.fillRect(0,0,cw,ch+bh);
        
        _thread.retVal=_this;return;
      },
      drawPanelMode10002 :function _trc_PadButton_drawPanelMode10002() {
        "use strict";
        var _this=this;
        
      },
      fiber$drawPanelMode10002 :function _trc_PadButton_f_drawPanelMode10002(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      padUpdate :function _trc_PadButton_padUpdate() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=96009156;//kernel.PadButton:9156
        if (_this.padUpdateFrame==Tonyu.globals.$frameCount) {
          return _this;
        }
        //$LASTPOS=96009204;//kernel.PadButton:9204
        _this.padUpdateFrame=Tonyu.globals.$frameCount;
        //$LASTPOS=96009239;//kernel.PadButton:9239
        if (_this.mode==0) {
          //$LASTPOS=96009265;//kernel.PadButton:9265
          _this.padUpdateMode0();
          
        } else {
          //$LASTPOS=96009295;//kernel.PadButton:9295
          if (_this.mode==1) {
            //$LASTPOS=96009321;//kernel.PadButton:9321
            _this.padUpdateMode1();
            
          } else {
            //$LASTPOS=96009351;//kernel.PadButton:9351
            if (_this.mode==2) {
              //$LASTPOS=96009377;//kernel.PadButton:9377
              _this.padUpdateMode2();
              
            } else {
              //$LASTPOS=96009407;//kernel.PadButton:9407
              if (_this.mode==10000) {
                //$LASTPOS=96009437;//kernel.PadButton:9437
                _this.padUpdateMode10000();
                
              } else {
                //$LASTPOS=96009471;//kernel.PadButton:9471
                if (_this.mode==10001) {
                  //$LASTPOS=96009501;//kernel.PadButton:9501
                  _this.padUpdateMode10001();
                  
                } else {
                  //$LASTPOS=96009535;//kernel.PadButton:9535
                  if (_this.mode==10002) {
                    //$LASTPOS=96009565;//kernel.PadButton:9565
                    _this.padUpdateMode10002();
                    
                  }
                }
              }
            }
          }
        }
      },
      fiber$padUpdate :function _trc_PadButton_f_padUpdate(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=96009156;//kernel.PadButton:9156
        if (_this.padUpdateFrame==Tonyu.globals.$frameCount) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=96009204;//kernel.PadButton:9204
        _this.padUpdateFrame=Tonyu.globals.$frameCount;
        
        _thread.enter(function _trc_PadButton_ent_padUpdate(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=96009239;//kernel.PadButton:9239
              if (!(_this.mode==0)) { __pc=2     ; break; }
              //$LASTPOS=96009265;//kernel.PadButton:9265
              _this.fiber$padUpdateMode0(_thread);
              __pc=1;return;
            case 1:
              
              __pc=17    ;break;
            case 2     :
              //$LASTPOS=96009295;//kernel.PadButton:9295
              if (!(_this.mode==1)) { __pc=4     ; break; }
              //$LASTPOS=96009321;//kernel.PadButton:9321
              _this.fiber$padUpdateMode1(_thread);
              __pc=3;return;
            case 3:
              
              __pc=16    ;break;
            case 4     :
              //$LASTPOS=96009351;//kernel.PadButton:9351
              if (!(_this.mode==2)) { __pc=6     ; break; }
              //$LASTPOS=96009377;//kernel.PadButton:9377
              _this.fiber$padUpdateMode2(_thread);
              __pc=5;return;
            case 5:
              
              __pc=15    ;break;
            case 6     :
              //$LASTPOS=96009407;//kernel.PadButton:9407
              if (!(_this.mode==10000)) { __pc=8     ; break; }
              //$LASTPOS=96009437;//kernel.PadButton:9437
              _this.fiber$padUpdateMode10000(_thread);
              __pc=7;return;
            case 7:
              
              __pc=14    ;break;
            case 8     :
              //$LASTPOS=96009471;//kernel.PadButton:9471
              if (!(_this.mode==10001)) { __pc=10    ; break; }
              //$LASTPOS=96009501;//kernel.PadButton:9501
              _this.fiber$padUpdateMode10001(_thread);
              __pc=9;return;
            case 9:
              
              __pc=13    ;break;
            case 10    :
              //$LASTPOS=96009535;//kernel.PadButton:9535
              if (!(_this.mode==10002)) { __pc=12    ; break; }
              //$LASTPOS=96009565;//kernel.PadButton:9565
              _this.fiber$padUpdateMode10002(_thread);
              __pc=11;return;
            case 11:
              
            case 12    :
              
            case 13    :
              
            case 14    :
              
            case 15    :
              
            case 16    :
              
            case 17    :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      padUpdateMode0 :function _trc_PadButton_padUpdateMode0() {
        "use strict";
        var _this=this;
        
      },
      fiber$padUpdateMode0 :function _trc_PadButton_f_padUpdateMode0(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      padUpdateMode1 :function _trc_PadButton_padUpdateMode1() {
        "use strict";
        var _this=this;
        
      },
      fiber$padUpdateMode1 :function _trc_PadButton_f_padUpdateMode1(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      padUpdateMode2 :function _trc_PadButton_padUpdateMode2() {
        "use strict";
        var _this=this;
        
      },
      fiber$padUpdateMode2 :function _trc_PadButton_f_padUpdateMode2(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      padUpdateMode10000 :function _trc_PadButton_padUpdateMode10000() {
        "use strict";
        var _this=this;
        var allNoTouche;
        var i;
        var t;
        
        //$LASTPOS=96009713;//kernel.PadButton:9713
        if (_this.died) {
          return _this;
        }
        //$LASTPOS=96009738;//kernel.PadButton:9738
        _this.panel.x=_this.x;
        //$LASTPOS=96009756;//kernel.PadButton:9756
        _this.panel.y=_this.y;
        //$LASTPOS=96009774;//kernel.PadButton:9774
        _this.panel.zOrder=_this.zOrder;
        //$LASTPOS=96009802;//kernel.PadButton:9802
        _this.panel.alpha=_this.alpha;
        //$LASTPOS=96009828;//kernel.PadButton:9828
        _this.panel.layer=_this.layer;
        //$LASTPOS=96009907;//kernel.PadButton:9907
        allNoTouche = true;
        
        //$LASTPOS=96009936;//kernel.PadButton:9936
        //$LASTPOS=96009941;//kernel.PadButton:9941
        i = 0;
        for (; i<_this.TOUCHES_MAX ; i++) {
          {
            //$LASTPOS=96009981;//kernel.PadButton:9981
            t = Tonyu.globals.$touches[i];
            
            //$LASTPOS=96010011;//kernel.PadButton:10011
            if (t.touched==1) {
              //$LASTPOS=96010046;//kernel.PadButton:10046
              if (_this.crashXY10000(t.x,t.y)) {
                //$LASTPOS=96010093;//kernel.PadButton:10093
                _this.padPush=1;
                //$LASTPOS=96010123;//kernel.PadButton:10123
                _this.padPushList[i]=true;
                
              }
              
            } else {
              //$LASTPOS=96010177;//kernel.PadButton:10177
              if (t.touched==0) {
                //$LASTPOS=96010212;//kernel.PadButton:10212
                _this.padPushList[i]=false;
                
              }
            }
            //$LASTPOS=96010256;//kernel.PadButton:10256
            if (_this.padPushList[i]) {
              //$LASTPOS=96010291;//kernel.PadButton:10291
              allNoTouche=false;
              
            }
          }
        }
        //$LASTPOS=96010335;//kernel.PadButton:10335
        if (allNoTouche) {
          //$LASTPOS=96010363;//kernel.PadButton:10363
          _this.padPush=0;
          
        }
        //$LASTPOS=96010388;//kernel.PadButton:10388
        if (_this.padPush) {
          //$LASTPOS=96010412;//kernel.PadButton:10412
          _this.padCnt++;
          //$LASTPOS=96010432;//kernel.PadButton:10432
          _this.padNotapCnt=0;
          //$LASTPOS=96010458;//kernel.PadButton:10458
          _this.panelPush.x=_this.x;
          //$LASTPOS=96010484;//kernel.PadButton:10484
          _this.panelPush.y=_this.y;
          //$LASTPOS=96010510;//kernel.PadButton:10510
          _this.panelPush.zOrder=_this.zOrder;
          //$LASTPOS=96010546;//kernel.PadButton:10546
          _this.panelPush.alpha=_this.alpha;
          //$LASTPOS=96010580;//kernel.PadButton:10580
          _this.panelPush.layer=_this.layer;
          //$LASTPOS=96010614;//kernel.PadButton:10614
          _this.panelPush.show();
          
        } else {
          //$LASTPOS=96010655;//kernel.PadButton:10655
          _this.padCnt=0;
          //$LASTPOS=96010676;//kernel.PadButton:10676
          _this.padNotapCnt++;
          //$LASTPOS=96010701;//kernel.PadButton:10701
          _this.panelPush.hide();
          
        }
      },
      fiber$padUpdateMode10000 :function _trc_PadButton_f_padUpdateMode10000(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var allNoTouche;
        var i;
        var t;
        
        //$LASTPOS=96009713;//kernel.PadButton:9713
        if (_this.died) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=96009738;//kernel.PadButton:9738
        _this.panel.x=_this.x;
        //$LASTPOS=96009756;//kernel.PadButton:9756
        _this.panel.y=_this.y;
        //$LASTPOS=96009774;//kernel.PadButton:9774
        _this.panel.zOrder=_this.zOrder;
        //$LASTPOS=96009802;//kernel.PadButton:9802
        _this.panel.alpha=_this.alpha;
        //$LASTPOS=96009828;//kernel.PadButton:9828
        _this.panel.layer=_this.layer;
        //$LASTPOS=96009907;//kernel.PadButton:9907
        allNoTouche = true;
        
        //$LASTPOS=96009936;//kernel.PadButton:9936
        //$LASTPOS=96009941;//kernel.PadButton:9941
        i = 0;
        for (; i<_this.TOUCHES_MAX ; i++) {
          {
            //$LASTPOS=96009981;//kernel.PadButton:9981
            t = Tonyu.globals.$touches[i];
            
            //$LASTPOS=96010011;//kernel.PadButton:10011
            if (t.touched==1) {
              //$LASTPOS=96010046;//kernel.PadButton:10046
              if (_this.crashXY10000(t.x,t.y)) {
                //$LASTPOS=96010093;//kernel.PadButton:10093
                _this.padPush=1;
                //$LASTPOS=96010123;//kernel.PadButton:10123
                _this.padPushList[i]=true;
                
              }
              
            } else {
              //$LASTPOS=96010177;//kernel.PadButton:10177
              if (t.touched==0) {
                //$LASTPOS=96010212;//kernel.PadButton:10212
                _this.padPushList[i]=false;
                
              }
            }
            //$LASTPOS=96010256;//kernel.PadButton:10256
            if (_this.padPushList[i]) {
              //$LASTPOS=96010291;//kernel.PadButton:10291
              allNoTouche=false;
              
            }
          }
        }
        //$LASTPOS=96010335;//kernel.PadButton:10335
        if (allNoTouche) {
          //$LASTPOS=96010363;//kernel.PadButton:10363
          _this.padPush=0;
          
        }
        //$LASTPOS=96010388;//kernel.PadButton:10388
        if (_this.padPush) {
          //$LASTPOS=96010412;//kernel.PadButton:10412
          _this.padCnt++;
          //$LASTPOS=96010432;//kernel.PadButton:10432
          _this.padNotapCnt=0;
          //$LASTPOS=96010458;//kernel.PadButton:10458
          _this.panelPush.x=_this.x;
          //$LASTPOS=96010484;//kernel.PadButton:10484
          _this.panelPush.y=_this.y;
          //$LASTPOS=96010510;//kernel.PadButton:10510
          _this.panelPush.zOrder=_this.zOrder;
          //$LASTPOS=96010546;//kernel.PadButton:10546
          _this.panelPush.alpha=_this.alpha;
          //$LASTPOS=96010580;//kernel.PadButton:10580
          _this.panelPush.layer=_this.layer;
          //$LASTPOS=96010614;//kernel.PadButton:10614
          _this.panelPush.show();
          
        } else {
          //$LASTPOS=96010655;//kernel.PadButton:10655
          _this.padCnt=0;
          //$LASTPOS=96010676;//kernel.PadButton:10676
          _this.padNotapCnt++;
          //$LASTPOS=96010701;//kernel.PadButton:10701
          _this.panelPush.hide();
          
        }
        
        _thread.retVal=_this;return;
      },
      padUpdateMode10001 :function _trc_PadButton_padUpdateMode10001() {
        "use strict";
        var _this=this;
        var w;
        var h;
        var cw;
        var ch;
        var cw2;
        var ch2;
        var cwh;
        var chh;
        var bw;
        var bh;
        var i;
        var t;
        var subX;
        var subY;
        
        //$LASTPOS=96010761;//kernel.PadButton:10761
        if (_this.died) {
          return _this;
        }
        
        
        
        
        
        //$LASTPOS=96010875;//kernel.PadButton:10875
        cw=_this.width/3;
        //$LASTPOS=96010896;//kernel.PadButton:10896
        ch=_this.height/3;
        //$LASTPOS=96010918;//kernel.PadButton:10918
        cw2=_this.width*2/3;
        //$LASTPOS=96010944;//kernel.PadButton:10944
        ch2=_this.height*2/3;
        //$LASTPOS=96010971;//kernel.PadButton:10971
        cwh=_this.trunc(cw/2);
        //$LASTPOS=96010997;//kernel.PadButton:10997
        chh=_this.trunc(ch/2);
        //$LASTPOS=96011023;//kernel.PadButton:11023
        w=_this.width;
        //$LASTPOS=96011039;//kernel.PadButton:11039
        h=_this.height;
        //$LASTPOS=96011056;//kernel.PadButton:11056
        bw=_this.padBorder;
        //$LASTPOS=96011077;//kernel.PadButton:11077
        bh=_this.padBorder;
        //$LASTPOS=96011100;//kernel.PadButton:11100
        _this.panel.x=_this.x;
        //$LASTPOS=96011118;//kernel.PadButton:11118
        _this.panel.y=_this.y;
        //$LASTPOS=96011136;//kernel.PadButton:11136
        _this.panel.zOrder=_this.zOrder;
        //$LASTPOS=96011164;//kernel.PadButton:11164
        _this.panel.alpha=_this.alpha;
        //$LASTPOS=96011190;//kernel.PadButton:11190
        _this.panel.layer=_this.layer;
        //$LASTPOS=96011216;//kernel.PadButton:11216
        _this.padPushL=0;
        //$LASTPOS=96011235;//kernel.PadButton:11235
        _this.padPushR=0;
        //$LASTPOS=96011254;//kernel.PadButton:11254
        _this.padPushU=0;
        //$LASTPOS=96011273;//kernel.PadButton:11273
        _this.padPushD=0;
        //$LASTPOS=96011292;//kernel.PadButton:11292
        if (_this.padPushTouchNo==- 1) {
          //$LASTPOS=96011337;//kernel.PadButton:11337
          _this.padNotapCnt++;
          //$LASTPOS=96011362;//kernel.PadButton:11362
          //$LASTPOS=96011367;//kernel.PadButton:11367
          i = 0;
          for (; i<_this.TOUCHES_MAX ; i++) {
            {
              //$LASTPOS=96011429;//kernel.PadButton:11429
              t = Tonyu.globals.$touches[i];
              
              //$LASTPOS=96011463;//kernel.PadButton:11463
              if (t.touched==1) {
                //$LASTPOS=96011515;//kernel.PadButton:11515
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,w,h)) {
                  //$LASTPOS=96011567;//kernel.PadButton:11567
                  _this.padPushTouchNo=i;
                }
                //$LASTPOS=96011604;//kernel.PadButton:11604
                _this.padNotapCnt=0;
                break;
                
                
              }
            }
          }
          
        }
        //$LASTPOS=96011683;//kernel.PadButton:11683
        if (_this.padPushTouchNo!=- 1) {
          //$LASTPOS=96011728;//kernel.PadButton:11728
          t = Tonyu.globals.$touches[_this.padPushTouchNo];
          
          //$LASTPOS=96011771;//kernel.PadButton:11771
          if (t.touched==0) {
            //$LASTPOS=96011817;//kernel.PadButton:11817
            _this.padPushTouchNo=- 1;
            
          } else {
            //$LASTPOS=96011882;//kernel.PadButton:11882
            if (_this.diagonalEnable) {
              //$LASTPOS=96011921;//kernel.PadButton:11921
              if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,w,h)) {
                //$LASTPOS=96012007;//kernel.PadButton:12007
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,cw,h)) {
                  //$LASTPOS=96012060;//kernel.PadButton:12060
                  _this.padPushL=1;
                }
                //$LASTPOS=96012095;//kernel.PadButton:12095
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh+cw,_this.y-chh-ch,cw,h)) {
                  //$LASTPOS=96012148;//kernel.PadButton:12148
                  _this.padPushR=1;
                }
                //$LASTPOS=96012183;//kernel.PadButton:12183
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,w,ch)) {
                  //$LASTPOS=96012236;//kernel.PadButton:12236
                  _this.padPushU=1;
                }
                //$LASTPOS=96012271;//kernel.PadButton:12271
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh+ch,w,ch)) {
                  //$LASTPOS=96012324;//kernel.PadButton:12324
                  _this.padPushD=1;
                }
                
              } else {
                //$LASTPOS=96012396;//kernel.PadButton:12396
                subX = t.x-_this.x;
                
                //$LASTPOS=96012437;//kernel.PadButton:12437
                subY = t.y-_this.y;
                
                //$LASTPOS=96012478;//kernel.PadButton:12478
                if (subX<- cwh-(_this.abs(subY)-chh-ch)/2) {
                  //$LASTPOS=96012516;//kernel.PadButton:12516
                  _this.padPushL=1;
                }
                //$LASTPOS=96012551;//kernel.PadButton:12551
                if (subX>cwh+(_this.abs(subY)-chh-ch)/2) {
                  //$LASTPOS=96012589;//kernel.PadButton:12589
                  _this.padPushR=1;
                }
                //$LASTPOS=96012624;//kernel.PadButton:12624
                if (subY<- chh-(_this.abs(subX)-cwh-cw)/2) {
                  //$LASTPOS=96012662;//kernel.PadButton:12662
                  _this.padPushU=1;
                }
                //$LASTPOS=96012697;//kernel.PadButton:12697
                if (subY>chh+(_this.abs(subX)-cwh-cw)/2) {
                  //$LASTPOS=96012735;//kernel.PadButton:12735
                  _this.padPushD=1;
                }
                
              }
              
            } else {
              //$LASTPOS=96012807;//kernel.PadButton:12807
              if (! _this.isOnRectWH(t.x,t.y,_this.x-cwh,_this.y-chh,cw,ch)) {
                //$LASTPOS=96012893;//kernel.PadButton:12893
                subX = t.x-_this.x;
                
                //$LASTPOS=96012934;//kernel.PadButton:12934
                subY = t.y-_this.y;
                
                //$LASTPOS=96012975;//kernel.PadButton:12975
                if (subX<=- _this.abs(subY)) {
                  //$LASTPOS=96012999;//kernel.PadButton:12999
                  _this.padPushL=1;
                } else {
                  //$LASTPOS=96013039;//kernel.PadButton:13039
                  if (subY<=- _this.abs(subX)) {
                    //$LASTPOS=96013063;//kernel.PadButton:13063
                    _this.padPushU=1;
                  } else {
                    //$LASTPOS=96013103;//kernel.PadButton:13103
                    if (subX>=_this.abs(subY)) {
                      //$LASTPOS=96013127;//kernel.PadButton:13127
                      _this.padPushR=1;
                    } else {
                      //$LASTPOS=96013167;//kernel.PadButton:13167
                      if (subY>=_this.abs(subX)) {
                        //$LASTPOS=96013191;//kernel.PadButton:13191
                        _this.padPushD=1;
                      }
                    }
                  }
                }
                
              }
              
            }
            
          }
          
        }
        //$LASTPOS=96013262;//kernel.PadButton:13262
        if (_this.padPushL) {
          //$LASTPOS=96013287;//kernel.PadButton:13287
          _this.padCntL++;
          //$LASTPOS=96013308;//kernel.PadButton:13308
          _this.panelPushL.x=_this.x-cw+bw/2;
          //$LASTPOS=96013347;//kernel.PadButton:13347
          _this.panelPushL.y=_this.y;
          //$LASTPOS=96013374;//kernel.PadButton:13374
          _this.panelPushL.zOrder=_this.zOrder;
          //$LASTPOS=96013411;//kernel.PadButton:13411
          _this.panelPushL.alpha=_this.alpha;
          //$LASTPOS=96013446;//kernel.PadButton:13446
          _this.panelPushL.layer=_this.layer;
          //$LASTPOS=96013481;//kernel.PadButton:13481
          _this.panelPushL.show();
          
        } else {
          //$LASTPOS=96013523;//kernel.PadButton:13523
          _this.padCntL=0;
          //$LASTPOS=96013545;//kernel.PadButton:13545
          _this.panelPushL.hide();
          
        }
        //$LASTPOS=96013576;//kernel.PadButton:13576
        if (_this.padPushR) {
          //$LASTPOS=96013601;//kernel.PadButton:13601
          _this.padCntR++;
          //$LASTPOS=96013622;//kernel.PadButton:13622
          _this.panelPushR.x=_this.x+cw-bw/2;
          //$LASTPOS=96013661;//kernel.PadButton:13661
          _this.panelPushR.y=_this.y;
          //$LASTPOS=96013688;//kernel.PadButton:13688
          _this.panelPushR.zOrder=_this.zOrder;
          //$LASTPOS=96013725;//kernel.PadButton:13725
          _this.panelPushR.alpha=_this.alpha;
          //$LASTPOS=96013760;//kernel.PadButton:13760
          _this.panelPushR.layer=_this.layer;
          //$LASTPOS=96013795;//kernel.PadButton:13795
          _this.panelPushR.show();
          
        } else {
          //$LASTPOS=96013837;//kernel.PadButton:13837
          _this.padCntR=0;
          //$LASTPOS=96013859;//kernel.PadButton:13859
          _this.panelPushR.hide();
          
        }
        //$LASTPOS=96013890;//kernel.PadButton:13890
        if (_this.padPushU) {
          //$LASTPOS=96013915;//kernel.PadButton:13915
          _this.padCntU++;
          //$LASTPOS=96013936;//kernel.PadButton:13936
          _this.panelPushU.x=_this.x;
          //$LASTPOS=96013963;//kernel.PadButton:13963
          _this.panelPushU.y=_this.y-ch+bh/2;
          //$LASTPOS=96014002;//kernel.PadButton:14002
          _this.panelPushU.zOrder=_this.zOrder;
          //$LASTPOS=96014039;//kernel.PadButton:14039
          _this.panelPushU.alpha=_this.alpha;
          //$LASTPOS=96014074;//kernel.PadButton:14074
          _this.panelPushU.layer=_this.layer;
          //$LASTPOS=96014109;//kernel.PadButton:14109
          _this.panelPushU.show();
          
        } else {
          //$LASTPOS=96014151;//kernel.PadButton:14151
          _this.padCntU=0;
          //$LASTPOS=96014173;//kernel.PadButton:14173
          _this.panelPushU.hide();
          
        }
        //$LASTPOS=96014204;//kernel.PadButton:14204
        if (_this.padPushD) {
          //$LASTPOS=96014229;//kernel.PadButton:14229
          _this.padCntD++;
          //$LASTPOS=96014250;//kernel.PadButton:14250
          _this.panelPushD.x=_this.x;
          //$LASTPOS=96014277;//kernel.PadButton:14277
          _this.panelPushD.y=_this.y+ch-bh/2;
          //$LASTPOS=96014316;//kernel.PadButton:14316
          _this.panelPushD.zOrder=_this.zOrder;
          //$LASTPOS=96014353;//kernel.PadButton:14353
          _this.panelPushD.alpha=_this.alpha;
          //$LASTPOS=96014388;//kernel.PadButton:14388
          _this.panelPushD.layer=_this.layer;
          //$LASTPOS=96014423;//kernel.PadButton:14423
          _this.panelPushD.show();
          
        } else {
          //$LASTPOS=96014465;//kernel.PadButton:14465
          _this.padCntD=0;
          //$LASTPOS=96014487;//kernel.PadButton:14487
          _this.panelPushD.hide();
          
        }
      },
      fiber$padUpdateMode10001 :function _trc_PadButton_f_padUpdateMode10001(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var w;
        var h;
        var cw;
        var ch;
        var cw2;
        var ch2;
        var cwh;
        var chh;
        var bw;
        var bh;
        var i;
        var t;
        var subX;
        var subY;
        
        //$LASTPOS=96010761;//kernel.PadButton:10761
        if (_this.died) {
          _thread.retVal=_this;return;
          
        }
        
        
        
        
        
        //$LASTPOS=96010875;//kernel.PadButton:10875
        cw=_this.width/3;
        //$LASTPOS=96010896;//kernel.PadButton:10896
        ch=_this.height/3;
        //$LASTPOS=96010918;//kernel.PadButton:10918
        cw2=_this.width*2/3;
        //$LASTPOS=96010944;//kernel.PadButton:10944
        ch2=_this.height*2/3;
        //$LASTPOS=96010971;//kernel.PadButton:10971
        cwh=_this.trunc(cw/2);
        //$LASTPOS=96010997;//kernel.PadButton:10997
        chh=_this.trunc(ch/2);
        //$LASTPOS=96011023;//kernel.PadButton:11023
        w=_this.width;
        //$LASTPOS=96011039;//kernel.PadButton:11039
        h=_this.height;
        //$LASTPOS=96011056;//kernel.PadButton:11056
        bw=_this.padBorder;
        //$LASTPOS=96011077;//kernel.PadButton:11077
        bh=_this.padBorder;
        //$LASTPOS=96011100;//kernel.PadButton:11100
        _this.panel.x=_this.x;
        //$LASTPOS=96011118;//kernel.PadButton:11118
        _this.panel.y=_this.y;
        //$LASTPOS=96011136;//kernel.PadButton:11136
        _this.panel.zOrder=_this.zOrder;
        //$LASTPOS=96011164;//kernel.PadButton:11164
        _this.panel.alpha=_this.alpha;
        //$LASTPOS=96011190;//kernel.PadButton:11190
        _this.panel.layer=_this.layer;
        //$LASTPOS=96011216;//kernel.PadButton:11216
        _this.padPushL=0;
        //$LASTPOS=96011235;//kernel.PadButton:11235
        _this.padPushR=0;
        //$LASTPOS=96011254;//kernel.PadButton:11254
        _this.padPushU=0;
        //$LASTPOS=96011273;//kernel.PadButton:11273
        _this.padPushD=0;
        //$LASTPOS=96011292;//kernel.PadButton:11292
        if (_this.padPushTouchNo==- 1) {
          //$LASTPOS=96011337;//kernel.PadButton:11337
          _this.padNotapCnt++;
          //$LASTPOS=96011362;//kernel.PadButton:11362
          //$LASTPOS=96011367;//kernel.PadButton:11367
          i = 0;
          for (; i<_this.TOUCHES_MAX ; i++) {
            {
              //$LASTPOS=96011429;//kernel.PadButton:11429
              t = Tonyu.globals.$touches[i];
              
              //$LASTPOS=96011463;//kernel.PadButton:11463
              if (t.touched==1) {
                //$LASTPOS=96011515;//kernel.PadButton:11515
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,w,h)) {
                  //$LASTPOS=96011567;//kernel.PadButton:11567
                  _this.padPushTouchNo=i;
                }
                //$LASTPOS=96011604;//kernel.PadButton:11604
                _this.padNotapCnt=0;
                break;
                
                
              }
            }
          }
          
        }
        //$LASTPOS=96011683;//kernel.PadButton:11683
        if (_this.padPushTouchNo!=- 1) {
          //$LASTPOS=96011728;//kernel.PadButton:11728
          t = Tonyu.globals.$touches[_this.padPushTouchNo];
          
          //$LASTPOS=96011771;//kernel.PadButton:11771
          if (t.touched==0) {
            //$LASTPOS=96011817;//kernel.PadButton:11817
            _this.padPushTouchNo=- 1;
            
          } else {
            //$LASTPOS=96011882;//kernel.PadButton:11882
            if (_this.diagonalEnable) {
              //$LASTPOS=96011921;//kernel.PadButton:11921
              if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,w,h)) {
                //$LASTPOS=96012007;//kernel.PadButton:12007
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,cw,h)) {
                  //$LASTPOS=96012060;//kernel.PadButton:12060
                  _this.padPushL=1;
                }
                //$LASTPOS=96012095;//kernel.PadButton:12095
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh+cw,_this.y-chh-ch,cw,h)) {
                  //$LASTPOS=96012148;//kernel.PadButton:12148
                  _this.padPushR=1;
                }
                //$LASTPOS=96012183;//kernel.PadButton:12183
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh-ch,w,ch)) {
                  //$LASTPOS=96012236;//kernel.PadButton:12236
                  _this.padPushU=1;
                }
                //$LASTPOS=96012271;//kernel.PadButton:12271
                if (_this.isOnRectWH(t.x,t.y,_this.x-cwh-cw,_this.y-chh+ch,w,ch)) {
                  //$LASTPOS=96012324;//kernel.PadButton:12324
                  _this.padPushD=1;
                }
                
              } else {
                //$LASTPOS=96012396;//kernel.PadButton:12396
                subX = t.x-_this.x;
                
                //$LASTPOS=96012437;//kernel.PadButton:12437
                subY = t.y-_this.y;
                
                //$LASTPOS=96012478;//kernel.PadButton:12478
                if (subX<- cwh-(_this.abs(subY)-chh-ch)/2) {
                  //$LASTPOS=96012516;//kernel.PadButton:12516
                  _this.padPushL=1;
                }
                //$LASTPOS=96012551;//kernel.PadButton:12551
                if (subX>cwh+(_this.abs(subY)-chh-ch)/2) {
                  //$LASTPOS=96012589;//kernel.PadButton:12589
                  _this.padPushR=1;
                }
                //$LASTPOS=96012624;//kernel.PadButton:12624
                if (subY<- chh-(_this.abs(subX)-cwh-cw)/2) {
                  //$LASTPOS=96012662;//kernel.PadButton:12662
                  _this.padPushU=1;
                }
                //$LASTPOS=96012697;//kernel.PadButton:12697
                if (subY>chh+(_this.abs(subX)-cwh-cw)/2) {
                  //$LASTPOS=96012735;//kernel.PadButton:12735
                  _this.padPushD=1;
                }
                
              }
              
            } else {
              //$LASTPOS=96012807;//kernel.PadButton:12807
              if (! _this.isOnRectWH(t.x,t.y,_this.x-cwh,_this.y-chh,cw,ch)) {
                //$LASTPOS=96012893;//kernel.PadButton:12893
                subX = t.x-_this.x;
                
                //$LASTPOS=96012934;//kernel.PadButton:12934
                subY = t.y-_this.y;
                
                //$LASTPOS=96012975;//kernel.PadButton:12975
                if (subX<=- _this.abs(subY)) {
                  //$LASTPOS=96012999;//kernel.PadButton:12999
                  _this.padPushL=1;
                } else {
                  //$LASTPOS=96013039;//kernel.PadButton:13039
                  if (subY<=- _this.abs(subX)) {
                    //$LASTPOS=96013063;//kernel.PadButton:13063
                    _this.padPushU=1;
                  } else {
                    //$LASTPOS=96013103;//kernel.PadButton:13103
                    if (subX>=_this.abs(subY)) {
                      //$LASTPOS=96013127;//kernel.PadButton:13127
                      _this.padPushR=1;
                    } else {
                      //$LASTPOS=96013167;//kernel.PadButton:13167
                      if (subY>=_this.abs(subX)) {
                        //$LASTPOS=96013191;//kernel.PadButton:13191
                        _this.padPushD=1;
                      }
                    }
                  }
                }
                
              }
              
            }
            
          }
          
        }
        //$LASTPOS=96013262;//kernel.PadButton:13262
        if (_this.padPushL) {
          //$LASTPOS=96013287;//kernel.PadButton:13287
          _this.padCntL++;
          //$LASTPOS=96013308;//kernel.PadButton:13308
          _this.panelPushL.x=_this.x-cw+bw/2;
          //$LASTPOS=96013347;//kernel.PadButton:13347
          _this.panelPushL.y=_this.y;
          //$LASTPOS=96013374;//kernel.PadButton:13374
          _this.panelPushL.zOrder=_this.zOrder;
          //$LASTPOS=96013411;//kernel.PadButton:13411
          _this.panelPushL.alpha=_this.alpha;
          //$LASTPOS=96013446;//kernel.PadButton:13446
          _this.panelPushL.layer=_this.layer;
          //$LASTPOS=96013481;//kernel.PadButton:13481
          _this.panelPushL.show();
          
        } else {
          //$LASTPOS=96013523;//kernel.PadButton:13523
          _this.padCntL=0;
          //$LASTPOS=96013545;//kernel.PadButton:13545
          _this.panelPushL.hide();
          
        }
        //$LASTPOS=96013576;//kernel.PadButton:13576
        if (_this.padPushR) {
          //$LASTPOS=96013601;//kernel.PadButton:13601
          _this.padCntR++;
          //$LASTPOS=96013622;//kernel.PadButton:13622
          _this.panelPushR.x=_this.x+cw-bw/2;
          //$LASTPOS=96013661;//kernel.PadButton:13661
          _this.panelPushR.y=_this.y;
          //$LASTPOS=96013688;//kernel.PadButton:13688
          _this.panelPushR.zOrder=_this.zOrder;
          //$LASTPOS=96013725;//kernel.PadButton:13725
          _this.panelPushR.alpha=_this.alpha;
          //$LASTPOS=96013760;//kernel.PadButton:13760
          _this.panelPushR.layer=_this.layer;
          //$LASTPOS=96013795;//kernel.PadButton:13795
          _this.panelPushR.show();
          
        } else {
          //$LASTPOS=96013837;//kernel.PadButton:13837
          _this.padCntR=0;
          //$LASTPOS=96013859;//kernel.PadButton:13859
          _this.panelPushR.hide();
          
        }
        //$LASTPOS=96013890;//kernel.PadButton:13890
        if (_this.padPushU) {
          //$LASTPOS=96013915;//kernel.PadButton:13915
          _this.padCntU++;
          //$LASTPOS=96013936;//kernel.PadButton:13936
          _this.panelPushU.x=_this.x;
          //$LASTPOS=96013963;//kernel.PadButton:13963
          _this.panelPushU.y=_this.y-ch+bh/2;
          //$LASTPOS=96014002;//kernel.PadButton:14002
          _this.panelPushU.zOrder=_this.zOrder;
          //$LASTPOS=96014039;//kernel.PadButton:14039
          _this.panelPushU.alpha=_this.alpha;
          //$LASTPOS=96014074;//kernel.PadButton:14074
          _this.panelPushU.layer=_this.layer;
          //$LASTPOS=96014109;//kernel.PadButton:14109
          _this.panelPushU.show();
          
        } else {
          //$LASTPOS=96014151;//kernel.PadButton:14151
          _this.padCntU=0;
          //$LASTPOS=96014173;//kernel.PadButton:14173
          _this.panelPushU.hide();
          
        }
        //$LASTPOS=96014204;//kernel.PadButton:14204
        if (_this.padPushD) {
          //$LASTPOS=96014229;//kernel.PadButton:14229
          _this.padCntD++;
          //$LASTPOS=96014250;//kernel.PadButton:14250
          _this.panelPushD.x=_this.x;
          //$LASTPOS=96014277;//kernel.PadButton:14277
          _this.panelPushD.y=_this.y+ch-bh/2;
          //$LASTPOS=96014316;//kernel.PadButton:14316
          _this.panelPushD.zOrder=_this.zOrder;
          //$LASTPOS=96014353;//kernel.PadButton:14353
          _this.panelPushD.alpha=_this.alpha;
          //$LASTPOS=96014388;//kernel.PadButton:14388
          _this.panelPushD.layer=_this.layer;
          //$LASTPOS=96014423;//kernel.PadButton:14423
          _this.panelPushD.show();
          
        } else {
          //$LASTPOS=96014465;//kernel.PadButton:14465
          _this.padCntD=0;
          //$LASTPOS=96014487;//kernel.PadButton:14487
          _this.panelPushD.hide();
          
        }
        
        _thread.retVal=_this;return;
      },
      padUpdateMode10002 :function _trc_PadButton_padUpdateMode10002() {
        "use strict";
        var _this=this;
        
      },
      fiber$padUpdateMode10002 :function _trc_PadButton_f_padUpdateMode10002(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      isOnRect :function _trc_PadButton_isOnRect(mx,my,rx,ry,rx2,ry2) {
        "use strict";
        var _this=this;
        
        return (mx>=rx&&mx<rx2&&my>=ry&&my<ry2);
      },
      fiber$isOnRect :function _trc_PadButton_f_isOnRect(_thread,mx,my,rx,ry,rx2,ry2) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=(mx>=rx&&mx<rx2&&my>=ry&&my<ry2);return;
        
        
        _thread.retVal=_this;return;
      },
      isOnRectWH :function _trc_PadButton_isOnRectWH(mx,my,rx,ry,rw,rh) {
        "use strict";
        var _this=this;
        
        return (mx>=rx&&mx<rx+rw&&my>=ry&&my<ry+rh);
      },
      fiber$isOnRectWH :function _trc_PadButton_f_isOnRectWH(_thread,mx,my,rx,ry,rw,rh) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=(mx>=rx&&mx<rx+rw&&my>=ry&&my<ry+rh);return;
        
        
        _thread.retVal=_this;return;
      },
      crashXY :function _trc_PadButton_crashXY(mx,my) {
        "use strict";
        var _this=this;
        
        return (mx>=_this.x-_this.width/2&&mx<_this.x+_this.width/2&&my>=_this.y-_this.height/2&&my<_this.y+_this.height/2);
      },
      fiber$crashXY :function _trc_PadButton_f_crashXY(_thread,mx,my) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        _thread.retVal=(mx>=_this.x-_this.width/2&&mx<_this.x+_this.width/2&&my>=_this.y-_this.height/2&&my<_this.y+_this.height/2);return;
        
        
        _thread.retVal=_this;return;
      },
      crashXY10000 :function _trc_PadButton_crashXY10000(mx,my) {
        "use strict";
        var _this=this;
        var w;
        var h;
        
        
        //$LASTPOS=96014979;//kernel.PadButton:14979
        w=_this.width+2;
        //$LASTPOS=96015000;//kernel.PadButton:15000
        h=_this.height+2;
        return (mx>=_this.x-w/2-1&&mx<_this.x+w/2-1&&my>=_this.y-h/2-1&&my<_this.y+h/2-1);
      },
      fiber$crashXY10000 :function _trc_PadButton_f_crashXY10000(_thread,mx,my) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var w;
        var h;
        
        
        //$LASTPOS=96014979;//kernel.PadButton:14979
        w=_this.width+2;
        //$LASTPOS=96015000;//kernel.PadButton:15000
        h=_this.height+2;
        _thread.retVal=(mx>=_this.x-w/2-1&&mx<_this.x+w/2-1&&my>=_this.y-h/2-1&&my<_this.y+h/2-1);return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"die":{"nowait":true},"hide":{"nowait":true},"show":{"nowait":true},"init":{"nowait":false},"drawPanel":{"nowait":false},"drawPanelMode10000":{"nowait":false},"drawPanelMode10001":{"nowait":false},"drawPanelMode10002":{"nowait":false},"padUpdate":{"nowait":false},"padUpdateMode0":{"nowait":false},"padUpdateMode1":{"nowait":false},"padUpdateMode2":{"nowait":false},"padUpdateMode10000":{"nowait":false},"padUpdateMode10001":{"nowait":false},"padUpdateMode10002":{"nowait":false},"isOnRect":{"nowait":false},"isOnRectWH":{"nowait":false},"crashXY":{"nowait":false},"crashXY10000":{"nowait":false}},"fields":{"loop":{},"died":{},"padCnt":{},"padCntL":{},"padCntR":{},"padCntU":{},"padCntD":{},"panel":{},"panelPush":{},"panelPushL":{},"panelPushR":{},"panelPushU":{},"panelPushD":{},"TOUCHES_MAX":{},"padNotapCnt":{},"padUpdateFrame":{},"mode":{},"pushP":{},"drawMode":{},"pushLP":{},"pushRP":{},"pushUP":{},"pushDP":{},"diagonalEnable":{},"padFillColor":{},"padBorder":{},"padBorderColor":{},"padPushColor":{},"padText":{},"padTextSize":{},"padTextColor":{},"padPush":{},"padPushList":{},"padLPushColor":{},"padRPushColor":{},"padUPushColor":{},"padDPushColor":{},"padLColor":{},"padRColor":{},"padUColor":{},"padDColor":{},"padPushTouchNo":{},"padPushL":{},"padPushR":{},"padPushU":{},"padPushD":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.PadPanel',
  shortName: 'PadPanel',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Panel,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_PadPanel_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_PadPanel_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      fillPolygon3 :function _trc_PadPanel_fillPolygon3(x1,y1,x2,y2,x3,y3,color,color2) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=97000171;//kernel.PadPanel:171
        _this.ctx=_this.getContext();
        //$LASTPOS=97000194;//kernel.PadPanel:194
        _this.ctx.save();
        //$LASTPOS=97000211;//kernel.PadPanel:211
        _this.ctx.beginPath();
        //$LASTPOS=97000233;//kernel.PadPanel:233
        _this.ctx.moveTo(x1,y1);
        //$LASTPOS=97000258;//kernel.PadPanel:258
        _this.ctx.lineTo(x2,y2);
        //$LASTPOS=97000283;//kernel.PadPanel:283
        _this.ctx.lineTo(x3,y3);
        //$LASTPOS=97000308;//kernel.PadPanel:308
        _this.ctx.closePath();
        //$LASTPOS=97000330;//kernel.PadPanel:330
        if (color==null) {
          //$LASTPOS=97000358;//kernel.PadPanel:358
          _this.ctx.fillStyle=_this.fillStyle;
          
        } else {
          //$LASTPOS=97000406;//kernel.PadPanel:406
          _this.ctx.fillStyle=color;
          
        }
        //$LASTPOS=97000439;//kernel.PadPanel:439
        _this.ctx.fill();
        //$LASTPOS=97000764;//kernel.PadPanel:764
        _this.ctx.restore();
      },
      fiber$fillPolygon3 :function _trc_PadPanel_f_fillPolygon3(_thread,x1,y1,x2,y2,x3,y3,color,color2) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_PadPanel_ent_fillPolygon3(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=97000171;//kernel.PadPanel:171
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              _this.ctx=_thread.retVal;
              
              //$LASTPOS=97000194;//kernel.PadPanel:194
              _this.ctx.save();
              //$LASTPOS=97000211;//kernel.PadPanel:211
              _this.ctx.beginPath();
              //$LASTPOS=97000233;//kernel.PadPanel:233
              _this.ctx.moveTo(x1,y1);
              //$LASTPOS=97000258;//kernel.PadPanel:258
              _this.ctx.lineTo(x2,y2);
              //$LASTPOS=97000283;//kernel.PadPanel:283
              _this.ctx.lineTo(x3,y3);
              //$LASTPOS=97000308;//kernel.PadPanel:308
              _this.ctx.closePath();
              //$LASTPOS=97000330;//kernel.PadPanel:330
              if (color==null) {
                //$LASTPOS=97000358;//kernel.PadPanel:358
                _this.ctx.fillStyle=_this.fillStyle;
                
              } else {
                //$LASTPOS=97000406;//kernel.PadPanel:406
                _this.ctx.fillStyle=color;
                
              }
              //$LASTPOS=97000439;//kernel.PadPanel:439
              _this.ctx.fill();
              //$LASTPOS=97000764;//kernel.PadPanel:764
              _this.ctx.restore();
              _thread.exit(_this);return;
            }
          }
        });
      },
      fillRect :function _trc_PadPanel_fillRect(x,y,rectWidth,rectHeight,color) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=97000845;//kernel.PadPanel:845
        _this.ctx=_this.getContext();
        //$LASTPOS=97000868;//kernel.PadPanel:868
        _this.ctx.save();
        //$LASTPOS=97000935;//kernel.PadPanel:935
        if (color==null) {
          //$LASTPOS=97000963;//kernel.PadPanel:963
          _this.ctx.fillStyle=_this.fillStyle;
          
        } else {
          //$LASTPOS=97001011;//kernel.PadPanel:1011
          _this.ctx.fillStyle=color;
          
        }
        //$LASTPOS=97001050;//kernel.PadPanel:1050
        _this.ctx.fillRect(x,y,rectWidth,rectHeight);
        //$LASTPOS=97001095;//kernel.PadPanel:1095
        _this.ctx.restore();
      },
      fillText :function _trc_PadPanel_fillText(text,x,y,color,size,align,baseline) {
        "use strict";
        var _this=this;
        var splits;
        var colCount;
        
        //$LASTPOS=97001193;//kernel.PadPanel:1193
        _this.ctx=_this.getContext();
        //$LASTPOS=97001216;//kernel.PadPanel:1216
        _this.ctx.save();
        //$LASTPOS=97001233;//kernel.PadPanel:1233
        text=text+"";
        //$LASTPOS=97001252;//kernel.PadPanel:1252
        splits = text.split("\n");
        
        //$LASTPOS=97001338;//kernel.PadPanel:1338
        _this.ctx.textAlign=align;
        //$LASTPOS=97001366;//kernel.PadPanel:1366
        if (baseline!=null) {
          //$LASTPOS=97001397;//kernel.PadPanel:1397
          _this.ctx.textBaseline=baseline;
          
        }
        //$LASTPOS=97001438;//kernel.PadPanel:1438
        if (color==null) {
          //$LASTPOS=97001466;//kernel.PadPanel:1466
          _this.ctx.fillStyle=_this.fillStyle;
          
        } else {
          //$LASTPOS=97001514;//kernel.PadPanel:1514
          _this.ctx.fillStyle=color;
          
        }
        //$LASTPOS=97001553;//kernel.PadPanel:1553
        _this.ctx.font=size+"px 'Courier New'";
        //$LASTPOS=97001592;//kernel.PadPanel:1592
        //$LASTPOS=97001596;//kernel.PadPanel:1596
        colCount = 0;
        for (; colCount<splits.length ; colCount++) {
          {
            //$LASTPOS=97001656;//kernel.PadPanel:1656
            _this.ctx.fillText(splits[colCount],x,y);
            //$LASTPOS=97001701;//kernel.PadPanel:1701
            y+=size;
          }
        }
        //$LASTPOS=97001722;//kernel.PadPanel:1722
        _this.ctx.restore();
      },
      fiber$fillText :function _trc_PadPanel_f_fillText(_thread,text,x,y,color,size,align,baseline) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var splits;
        var colCount;
        
        
        _thread.enter(function _trc_PadPanel_ent_fillText(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=97001193;//kernel.PadPanel:1193
              _this.fiber$getContext(_thread);
              __pc=1;return;
            case 1:
              _this.ctx=_thread.retVal;
              
              //$LASTPOS=97001216;//kernel.PadPanel:1216
              _this.ctx.save();
              //$LASTPOS=97001233;//kernel.PadPanel:1233
              text=text+"";
              //$LASTPOS=97001252;//kernel.PadPanel:1252
              splits = text.split("\n");
              
              //$LASTPOS=97001338;//kernel.PadPanel:1338
              _this.ctx.textAlign=align;
              //$LASTPOS=97001366;//kernel.PadPanel:1366
              if (baseline!=null) {
                //$LASTPOS=97001397;//kernel.PadPanel:1397
                _this.ctx.textBaseline=baseline;
                
              }
              //$LASTPOS=97001438;//kernel.PadPanel:1438
              if (color==null) {
                //$LASTPOS=97001466;//kernel.PadPanel:1466
                _this.ctx.fillStyle=_this.fillStyle;
                
              } else {
                //$LASTPOS=97001514;//kernel.PadPanel:1514
                _this.ctx.fillStyle=color;
                
              }
              //$LASTPOS=97001553;//kernel.PadPanel:1553
              _this.ctx.font=size+"px 'Courier New'";
              //$LASTPOS=97001592;//kernel.PadPanel:1592
              //$LASTPOS=97001596;//kernel.PadPanel:1596
              colCount = 0;
              for (; colCount<splits.length ; colCount++) {
                {
                  //$LASTPOS=97001656;//kernel.PadPanel:1656
                  _this.ctx.fillText(splits[colCount],x,y);
                  //$LASTPOS=97001701;//kernel.PadPanel:1701
                  y+=size;
                }
              }
              //$LASTPOS=97001722;//kernel.PadPanel:1722
              _this.ctx.restore();
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"fillPolygon3":{"nowait":false},"fillRect":{"nowait":true},"fillText":{"nowait":false}},"fields":{"ctx":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.UILayout',
  shortName: 'UILayout',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_UILayout_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=98000018;//kernel.UILayout:18
        _this.doLayout();
        //$LASTPOS=98000031;//kernel.UILayout:31
        Tonyu.globals.$Screen.on("resize",Tonyu.bindFunc(_this,_this.doLayout));
        //$LASTPOS=98000063;//kernel.UILayout:63
        Tonyu.globals.$uiScreen.on("resize",Tonyu.bindFunc(_this,_this.doLayout));
      },
      fiber$main :function _trc_UILayout_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_UILayout_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=98000018;//kernel.UILayout:18
              _this.fiber$doLayout(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=98000031;//kernel.UILayout:31
              Tonyu.globals.$Screen.on("resize",Tonyu.bindFunc(_this,_this.doLayout));
              //$LASTPOS=98000063;//kernel.UILayout:63
              Tonyu.globals.$uiScreen.on("resize",Tonyu.bindFunc(_this,_this.doLayout));
              _thread.exit(_this);return;
            }
          }
        });
      },
      doLayout :function _trc_UILayout_doLayout() {
        "use strict";
        var _this=this;
        var cw;
        var ch;
        var width;
        var height;
        var calcw;
        var calch;
        var scl;
        var isPC;
        
        //$LASTPOS=98000116;//kernel.UILayout:116
        cw = Tonyu.globals.$uiScreen.width;
        
        //$LASTPOS=98000145;//kernel.UILayout:145
        ch = Tonyu.globals.$uiScreen.height;
        
        //$LASTPOS=98000175;//kernel.UILayout:175
        width = Tonyu.globals.$Screen.width;
        
        //$LASTPOS=98000205;//kernel.UILayout:205
        height = Tonyu.globals.$Screen.height;
        
        //$LASTPOS=98000243;//kernel.UILayout:243
        calcw = ch/height*width;
        
        //$LASTPOS=98000295;//kernel.UILayout:295
        calch = cw/width*height;
        
        //$LASTPOS=98000347;//kernel.UILayout:347
        if (calch>ch) {
          //$LASTPOS=98000361;//kernel.UILayout:361
          calch=ch;
        }
        //$LASTPOS=98000376;//kernel.UILayout:376
        if (calcw>cw) {
          //$LASTPOS=98000390;//kernel.UILayout:390
          calcw=cw;
        }
        //$LASTPOS=98000405;//kernel.UILayout:405
        scl = 1;
        
        //$LASTPOS=98000421;//kernel.UILayout:421
        isPC = ! (Tonyu.globals.$Navigator.isTablet()||Tonyu.globals.$Navigator.isMobile());
        
        //$LASTPOS=98000486;//kernel.UILayout:486
        if (isPC&&_this.shouldDraw1x1(width,height,calcw,calch)) {
          //$LASTPOS=98000548;//kernel.UILayout:548
          calcw=width;
          //$LASTPOS=98000560;//kernel.UILayout:560
          calch=height;
          //$LASTPOS=98000583;//kernel.UILayout:583
          Tonyu.globals.$Screen.scaleX=1;
          
        } else {
          //$LASTPOS=98000624;//kernel.UILayout:624
          Tonyu.globals.$Screen.scaleX=calcw/width;
          
        }
        //$LASTPOS=98000668;//kernel.UILayout:668
        Tonyu.globals.$Screen.x=_this.trunc(cw/2)+width/2%1;
        //$LASTPOS=98000706;//kernel.UILayout:706
        Tonyu.globals.$Screen.y=_this.trunc(ch/2)+height/2%1;
      },
      fiber$doLayout :function _trc_UILayout_f_doLayout(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var cw;
        var ch;
        var width;
        var height;
        var calcw;
        var calch;
        var scl;
        var isPC;
        
        //$LASTPOS=98000116;//kernel.UILayout:116
        cw = Tonyu.globals.$uiScreen.width;
        
        //$LASTPOS=98000145;//kernel.UILayout:145
        ch = Tonyu.globals.$uiScreen.height;
        
        //$LASTPOS=98000175;//kernel.UILayout:175
        width = Tonyu.globals.$Screen.width;
        
        //$LASTPOS=98000205;//kernel.UILayout:205
        height = Tonyu.globals.$Screen.height;
        
        //$LASTPOS=98000243;//kernel.UILayout:243
        calcw = ch/height*width;
        
        //$LASTPOS=98000295;//kernel.UILayout:295
        calch = cw/width*height;
        
        //$LASTPOS=98000347;//kernel.UILayout:347
        if (calch>ch) {
          //$LASTPOS=98000361;//kernel.UILayout:361
          calch=ch;
        }
        //$LASTPOS=98000376;//kernel.UILayout:376
        if (calcw>cw) {
          //$LASTPOS=98000390;//kernel.UILayout:390
          calcw=cw;
        }
        //$LASTPOS=98000405;//kernel.UILayout:405
        scl = 1;
        
        //$LASTPOS=98000421;//kernel.UILayout:421
        isPC = ! (Tonyu.globals.$Navigator.isTablet()||Tonyu.globals.$Navigator.isMobile());
        
        //$LASTPOS=98000486;//kernel.UILayout:486
        if (isPC&&_this.shouldDraw1x1(width,height,calcw,calch)) {
          //$LASTPOS=98000548;//kernel.UILayout:548
          calcw=width;
          //$LASTPOS=98000560;//kernel.UILayout:560
          calch=height;
          //$LASTPOS=98000583;//kernel.UILayout:583
          Tonyu.globals.$Screen.scaleX=1;
          
        } else {
          //$LASTPOS=98000624;//kernel.UILayout:624
          Tonyu.globals.$Screen.scaleX=calcw/width;
          
        }
        //$LASTPOS=98000668;//kernel.UILayout:668
        Tonyu.globals.$Screen.x=_this.trunc(cw/2)+width/2%1;
        //$LASTPOS=98000706;//kernel.UILayout:706
        Tonyu.globals.$Screen.y=_this.trunc(ch/2)+height/2%1;
        
        _thread.retVal=_this;return;
      },
      shouldDraw1x1 :function _trc_UILayout_shouldDraw1x1(srcw,srch,dstw,dsth) {
        "use strict";
        var _this=this;
        var larger;
        var smaller;
        
        //$LASTPOS=98000832;//kernel.UILayout:832
        larger = 100;
        
        //$LASTPOS=98000853;//kernel.UILayout:853
        smaller = 0;
        
        return srcw-smaller<=dstw&&dstw<=srcw+larger&&srch-smaller<=dsth&&dsth<=srch+larger;
      },
      fiber$shouldDraw1x1 :function _trc_UILayout_f_shouldDraw1x1(_thread,srcw,srch,dstw,dsth) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var larger;
        var smaller;
        
        //$LASTPOS=98000832;//kernel.UILayout:832
        larger = 100;
        
        //$LASTPOS=98000853;//kernel.UILayout:853
        smaller = 0;
        
        _thread.retVal=srcw-smaller<=dstw&&dstw<=srcw+larger&&srch-smaller<=dsth&&dsth<=srch+larger;return;
        
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"doLayout":{"nowait":false},"shouldDraw1x1":{"nowait":false}},"fields":{}}
});
Tonyu.klass.define({
  fullName: 'kernel.WebPage',
  shortName: 'WebPage',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_WebPage_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=99000080;//kernel.WebPage:80
        _this.eventWindowOpen=(function anonymous_98(e) {
          
          //$LASTPOS=99000161;//kernel.WebPage:161
          window.open(_this.postUrl);
          //$LASTPOS=99000188;//kernel.WebPage:188
          if (_this.canvas.removeEventListener) {
            //$LASTPOS=99000231;//kernel.WebPage:231
            _this.canvas.removeEventListener("click",_this.eventWindowOpen,false);
            //$LASTPOS=99000301;//kernel.WebPage:301
            _this.canvas.removeEventListener("touchend",_this.eventWindowOpen,false);
            //$LASTPOS=99000374;//kernel.WebPage:374
            _this.listenerExists=false;
            
          } else {
            //$LASTPOS=99000410;//kernel.WebPage:410
            if (_this.canvas.detachEvent) {
              //$LASTPOS=99000444;//kernel.WebPage:444
              _this.canvas.detachEvent("onclick",_this.eventWindowOpen);
              //$LASTPOS=99000501;//kernel.WebPage:501
              _this.canvas.detachEvent("touchend",_this.eventWindowOpen);
              //$LASTPOS=99000559;//kernel.WebPage:559
              _this.listenerExists=false;
              
            }
          }
        });
      },
      fiber$main :function _trc_WebPage_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=99000080;//kernel.WebPage:80
        _this.eventWindowOpen=(function anonymous_98(e) {
          
          //$LASTPOS=99000161;//kernel.WebPage:161
          window.open(_this.postUrl);
          //$LASTPOS=99000188;//kernel.WebPage:188
          if (_this.canvas.removeEventListener) {
            //$LASTPOS=99000231;//kernel.WebPage:231
            _this.canvas.removeEventListener("click",_this.eventWindowOpen,false);
            //$LASTPOS=99000301;//kernel.WebPage:301
            _this.canvas.removeEventListener("touchend",_this.eventWindowOpen,false);
            //$LASTPOS=99000374;//kernel.WebPage:374
            _this.listenerExists=false;
            
          } else {
            //$LASTPOS=99000410;//kernel.WebPage:410
            if (_this.canvas.detachEvent) {
              //$LASTPOS=99000444;//kernel.WebPage:444
              _this.canvas.detachEvent("onclick",_this.eventWindowOpen);
              //$LASTPOS=99000501;//kernel.WebPage:501
              _this.canvas.detachEvent("touchend",_this.eventWindowOpen);
              //$LASTPOS=99000559;//kernel.WebPage:559
              _this.listenerExists=false;
              
            }
          }
        });
        
        _thread.retVal=_this;return;
      },
      openNewWindow :function _trc_WebPage_openNewWindow(url) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=99000624;//kernel.WebPage:624
        _this.postUrl=url;
        //$LASTPOS=99000704;//kernel.WebPage:704
        _this.canvas=document.querySelector("canvas.tonyu-canvas")||document.getElementsByTagName("canvas")[0];
        //$LASTPOS=99000820;//kernel.WebPage:820
        if (! _this.listenerExists) {
          //$LASTPOS=99000852;//kernel.WebPage:852
          if (_this.canvas.addEventListener) {
            //$LASTPOS=99000896;//kernel.WebPage:896
            _this.canvas.addEventListener("click",_this.eventWindowOpen,false);
            //$LASTPOS=99000967;//kernel.WebPage:967
            _this.canvas.addEventListener("touchend",_this.eventWindowOpen,false);
            //$LASTPOS=99001110;//kernel.WebPage:1110
            _this.listenerExists=true;
            
          } else {
            //$LASTPOS=99001149;//kernel.WebPage:1149
            if (_this.canvas.attachEvent) {
              //$LASTPOS=99001187;//kernel.WebPage:1187
              _this.canvas.attachEvent("onclick",_this.eventWindowOpen);
              //$LASTPOS=99001248;//kernel.WebPage:1248
              _this.canvas.attachEvent("touchend",_this.eventWindowOpen);
              //$LASTPOS=99001310;//kernel.WebPage:1310
              _this.listenerExists=true;
              
            }
          }
          
        }
      },
      fiber$openNewWindow :function _trc_WebPage_f_openNewWindow(_thread,url) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=99000624;//kernel.WebPage:624
        _this.postUrl=url;
        //$LASTPOS=99000704;//kernel.WebPage:704
        _this.canvas=document.querySelector("canvas.tonyu-canvas")||document.getElementsByTagName("canvas")[0];
        //$LASTPOS=99000820;//kernel.WebPage:820
        if (! _this.listenerExists) {
          //$LASTPOS=99000852;//kernel.WebPage:852
          if (_this.canvas.addEventListener) {
            //$LASTPOS=99000896;//kernel.WebPage:896
            _this.canvas.addEventListener("click",_this.eventWindowOpen,false);
            //$LASTPOS=99000967;//kernel.WebPage:967
            _this.canvas.addEventListener("touchend",_this.eventWindowOpen,false);
            //$LASTPOS=99001110;//kernel.WebPage:1110
            _this.listenerExists=true;
            
          } else {
            //$LASTPOS=99001149;//kernel.WebPage:1149
            if (_this.canvas.attachEvent) {
              //$LASTPOS=99001187;//kernel.WebPage:1187
              _this.canvas.attachEvent("onclick",_this.eventWindowOpen);
              //$LASTPOS=99001248;//kernel.WebPage:1248
              _this.canvas.attachEvent("touchend",_this.eventWindowOpen);
              //$LASTPOS=99001310;//kernel.WebPage:1310
              _this.listenerExists=true;
              
            }
          }
          
        }
        
        _thread.retVal=_this;return;
      },
      openPage :function _trc_WebPage_openPage(url) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=99001379;//kernel.WebPage:1379
        window.location.href=url;
      },
      fiber$openPage :function _trc_WebPage_f_openPage(_thread,url) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=99001379;//kernel.WebPage:1379
        window.location.href=url;
        
        _thread.retVal=_this;return;
      },
      openTweet :function _trc_WebPage_openTweet(text,url,hashtags,via,related,tl) {
        "use strict";
        var _this=this;
        var sendUrl;
        
        //$LASTPOS=99001962;//kernel.WebPage:1962
        sendUrl = "https://twitter.com/intent/tweet?";
        
        //$LASTPOS=99002018;//kernel.WebPage:2018
        sendUrl+="text="+encodeURIComponent(text);
        //$LASTPOS=99002070;//kernel.WebPage:2070
        if (url!=null) {
          //$LASTPOS=99002098;//kernel.WebPage:2098
          sendUrl+="&";
          //$LASTPOS=99002123;//kernel.WebPage:2123
          sendUrl+="url="+encodeURIComponent(url);
          
        }
        //$LASTPOS=99002180;//kernel.WebPage:2180
        if (hashtags!=null) {
          //$LASTPOS=99002213;//kernel.WebPage:2213
          sendUrl+="&";
          //$LASTPOS=99002238;//kernel.WebPage:2238
          sendUrl+="hashtags="+encodeURIComponent(hashtags);
          
        }
        //$LASTPOS=99002305;//kernel.WebPage:2305
        if (via!=null) {
          //$LASTPOS=99002333;//kernel.WebPage:2333
          sendUrl+="&";
          //$LASTPOS=99002358;//kernel.WebPage:2358
          sendUrl+="via="+encodeURIComponent(via);
          
        }
        //$LASTPOS=99002415;//kernel.WebPage:2415
        if (related!=null) {
          //$LASTPOS=99002447;//kernel.WebPage:2447
          sendUrl+="&";
          //$LASTPOS=99002472;//kernel.WebPage:2472
          sendUrl+="related="+encodeURIComponent(related);
          
        }
        //$LASTPOS=99002537;//kernel.WebPage:2537
        if (tl) {
          //$LASTPOS=99002556;//kernel.WebPage:2556
          sendUrl+="&";
          //$LASTPOS=99002581;//kernel.WebPage:2581
          sendUrl+="source=webclient";
          
        }
        //$LASTPOS=99002624;//kernel.WebPage:2624
        _this.openNewWindow(sendUrl);
      },
      fiber$openTweet :function _trc_WebPage_f_openTweet(_thread,text,url,hashtags,via,related,tl) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var sendUrl;
        
        //$LASTPOS=99001962;//kernel.WebPage:1962
        sendUrl = "https://twitter.com/intent/tweet?";
        
        //$LASTPOS=99002018;//kernel.WebPage:2018
        sendUrl+="text="+encodeURIComponent(text);
        //$LASTPOS=99002070;//kernel.WebPage:2070
        if (url!=null) {
          //$LASTPOS=99002098;//kernel.WebPage:2098
          sendUrl+="&";
          //$LASTPOS=99002123;//kernel.WebPage:2123
          sendUrl+="url="+encodeURIComponent(url);
          
        }
        //$LASTPOS=99002180;//kernel.WebPage:2180
        if (hashtags!=null) {
          //$LASTPOS=99002213;//kernel.WebPage:2213
          sendUrl+="&";
          //$LASTPOS=99002238;//kernel.WebPage:2238
          sendUrl+="hashtags="+encodeURIComponent(hashtags);
          
        }
        //$LASTPOS=99002305;//kernel.WebPage:2305
        if (via!=null) {
          //$LASTPOS=99002333;//kernel.WebPage:2333
          sendUrl+="&";
          //$LASTPOS=99002358;//kernel.WebPage:2358
          sendUrl+="via="+encodeURIComponent(via);
          
        }
        //$LASTPOS=99002415;//kernel.WebPage:2415
        if (related!=null) {
          //$LASTPOS=99002447;//kernel.WebPage:2447
          sendUrl+="&";
          //$LASTPOS=99002472;//kernel.WebPage:2472
          sendUrl+="related="+encodeURIComponent(related);
          
        }
        //$LASTPOS=99002537;//kernel.WebPage:2537
        if (tl) {
          //$LASTPOS=99002556;//kernel.WebPage:2556
          sendUrl+="&";
          //$LASTPOS=99002581;//kernel.WebPage:2581
          sendUrl+="source=webclient";
          
        }
        
        _thread.enter(function _trc_WebPage_ent_openTweet(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=99002624;//kernel.WebPage:2624
              _this.fiber$openNewWindow(_thread, sendUrl);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      openShareTweet :function _trc_WebPage_openShareTweet(text,url,hashtags,via,related,tl) {
        "use strict";
        var _this=this;
        var sendUrl;
        var tempText;
        
        //$LASTPOS=99003565;//kernel.WebPage:3565
        sendUrl = "https://twitter.com/intent/tweet?";
        
        //$LASTPOS=99003680;//kernel.WebPage:3680
        if (arguments.length==2) {
          //$LASTPOS=99003716;//kernel.WebPage:3716
          if (text==null||text.match(/^http/)) {
            //$LASTPOS=99003770;//kernel.WebPage:3770
            tempText = text;
            
            //$LASTPOS=99003802;//kernel.WebPage:3802
            text=url;
            //$LASTPOS=99003811;//kernel.WebPage:3811
            url=tempText;
            
          }
          
        }
        //$LASTPOS=99003848;//kernel.WebPage:3848
        sendUrl+="text="+encodeURIComponent(text);
        //$LASTPOS=99003900;//kernel.WebPage:3900
        sendUrl+="&";
        //$LASTPOS=99003921;//kernel.WebPage:3921
        if (url==null) {
          //$LASTPOS=99003949;//kernel.WebPage:3949
          sendUrl+="url="+window.location.href;
          
        } else {
          //$LASTPOS=99004014;//kernel.WebPage:4014
          sendUrl+="url="+encodeURIComponent(url);
          
        }
        //$LASTPOS=99004071;//kernel.WebPage:4071
        if (hashtags!=null) {
          //$LASTPOS=99004104;//kernel.WebPage:4104
          sendUrl+="&";
          //$LASTPOS=99004129;//kernel.WebPage:4129
          sendUrl+="hashtags="+encodeURIComponent(hashtags);
          
        }
        //$LASTPOS=99004196;//kernel.WebPage:4196
        if (via!=null) {
          //$LASTPOS=99004224;//kernel.WebPage:4224
          sendUrl+="&";
          //$LASTPOS=99004249;//kernel.WebPage:4249
          sendUrl+="via="+encodeURIComponent(via);
          
        }
        //$LASTPOS=99004306;//kernel.WebPage:4306
        if (related!=null) {
          //$LASTPOS=99004338;//kernel.WebPage:4338
          sendUrl+="&";
          //$LASTPOS=99004363;//kernel.WebPage:4363
          sendUrl+="related="+encodeURIComponent(related);
          
        }
        //$LASTPOS=99004428;//kernel.WebPage:4428
        if (tl) {
          //$LASTPOS=99004447;//kernel.WebPage:4447
          sendUrl+="&";
          //$LASTPOS=99004472;//kernel.WebPage:4472
          sendUrl+="source=webclient";
          
        }
        //$LASTPOS=99004515;//kernel.WebPage:4515
        _this.openNewWindow(sendUrl);
      },
      fiber$openShareTweet :function _trc_WebPage_f_openShareTweet(_thread,text,url,hashtags,via,related,tl) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var sendUrl;
        var tempText;
        
        //$LASTPOS=99003565;//kernel.WebPage:3565
        sendUrl = "https://twitter.com/intent/tweet?";
        
        //$LASTPOS=99003680;//kernel.WebPage:3680
        if (_arguments.length==2) {
          //$LASTPOS=99003716;//kernel.WebPage:3716
          if (text==null||text.match(/^http/)) {
            //$LASTPOS=99003770;//kernel.WebPage:3770
            tempText = text;
            
            //$LASTPOS=99003802;//kernel.WebPage:3802
            text=url;
            //$LASTPOS=99003811;//kernel.WebPage:3811
            url=tempText;
            
          }
          
        }
        //$LASTPOS=99003848;//kernel.WebPage:3848
        sendUrl+="text="+encodeURIComponent(text);
        //$LASTPOS=99003900;//kernel.WebPage:3900
        sendUrl+="&";
        //$LASTPOS=99003921;//kernel.WebPage:3921
        if (url==null) {
          //$LASTPOS=99003949;//kernel.WebPage:3949
          sendUrl+="url="+window.location.href;
          
        } else {
          //$LASTPOS=99004014;//kernel.WebPage:4014
          sendUrl+="url="+encodeURIComponent(url);
          
        }
        //$LASTPOS=99004071;//kernel.WebPage:4071
        if (hashtags!=null) {
          //$LASTPOS=99004104;//kernel.WebPage:4104
          sendUrl+="&";
          //$LASTPOS=99004129;//kernel.WebPage:4129
          sendUrl+="hashtags="+encodeURIComponent(hashtags);
          
        }
        //$LASTPOS=99004196;//kernel.WebPage:4196
        if (via!=null) {
          //$LASTPOS=99004224;//kernel.WebPage:4224
          sendUrl+="&";
          //$LASTPOS=99004249;//kernel.WebPage:4249
          sendUrl+="via="+encodeURIComponent(via);
          
        }
        //$LASTPOS=99004306;//kernel.WebPage:4306
        if (related!=null) {
          //$LASTPOS=99004338;//kernel.WebPage:4338
          sendUrl+="&";
          //$LASTPOS=99004363;//kernel.WebPage:4363
          sendUrl+="related="+encodeURIComponent(related);
          
        }
        //$LASTPOS=99004428;//kernel.WebPage:4428
        if (tl) {
          //$LASTPOS=99004447;//kernel.WebPage:4447
          sendUrl+="&";
          //$LASTPOS=99004472;//kernel.WebPage:4472
          sendUrl+="source=webclient";
          
        }
        
        _thread.enter(function _trc_WebPage_ent_openShareTweet(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=99004515;//kernel.WebPage:4515
              _this.fiber$openNewWindow(_thread, sendUrl);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"openNewWindow":{"nowait":false},"openPage":{"nowait":false},"openTweet":{"nowait":false},"openShareTweet":{"nowait":false}},"fields":{"eventWindowOpen":{},"postUrl":{},"canvas":{},"listenerExists":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.Boot',
  shortName: 'Boot',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Actor,
  includes: [Tonyu.classes.kernel.T2MediaPlayer],
  methods: function (__superClass) {
    return {
      main :function _trc_Boot_main() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100000281;//kernel.Boot:281
        if (typeof  performance==="undefined") {
          //$LASTPOS=100000326;//kernel.Boot:326
          _this.window.performance={};
          
        }
        //$LASTPOS=100000355;//kernel.Boot:355
        if (! performance.now) {
          //$LASTPOS=100000384;//kernel.Boot:384
          performance.now=(function now() {
            
            return Date.now();
          });
          
        }
        //$LASTPOS=100000461;//kernel.Boot:461
        Tonyu.resetLoopCheck(10000);
        //$LASTPOS=100000491;//kernel.Boot:491
        Tonyu.globals.$Boot=_this;
        //$LASTPOS=100000504;//kernel.Boot:504
        _this._scheduler=Tonyu.globals.$Scheduler=new Tonyu.classes.kernel.Scheduler;
        //$LASTPOS=100000542;//kernel.Boot:542
        _this.initGlobals();
        //$LASTPOS=100000575;//kernel.Boot:575
        _this.initLayers();
        //$LASTPOS=100000590;//kernel.Boot:590
        _this.initPeripherals();
        //$LASTPOS=100000610;//kernel.Boot:610
        _this.loadPlugins();
        //$LASTPOS=100000626;//kernel.Boot:626
        _this.loadImages();
        //$LASTPOS=100000641;//kernel.Boot:641
        _this.loadSounds();
        //$LASTPOS=100000656;//kernel.Boot:656
        _this.createMainObject();
        //$LASTPOS=100000677;//kernel.Boot:677
        _this.progress();
        //$LASTPOS=100000690;//kernel.Boot:690
        _this.mainLoop();
      },
      fiber$main :function _trc_Boot_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100000281;//kernel.Boot:281
        if (typeof  performance==="undefined") {
          //$LASTPOS=100000326;//kernel.Boot:326
          _this.window.performance={};
          
        }
        //$LASTPOS=100000355;//kernel.Boot:355
        if (! performance.now) {
          //$LASTPOS=100000384;//kernel.Boot:384
          performance.now=(function now() {
            
            return Date.now();
          });
          
        }
        //$LASTPOS=100000461;//kernel.Boot:461
        Tonyu.resetLoopCheck(10000);
        //$LASTPOS=100000491;//kernel.Boot:491
        Tonyu.globals.$Boot=_this;
        //$LASTPOS=100000504;//kernel.Boot:504
        _this._scheduler=Tonyu.globals.$Scheduler=new Tonyu.classes.kernel.Scheduler;
        
        _thread.enter(function _trc_Boot_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100000542;//kernel.Boot:542
              _this.fiber$initGlobals(_thread);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=100000575;//kernel.Boot:575
              _this.fiber$initLayers(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=100000590;//kernel.Boot:590
              _this.fiber$initPeripherals(_thread);
              __pc=3;return;
            case 3:
              
              //$LASTPOS=100000610;//kernel.Boot:610
              _this.fiber$loadPlugins(_thread);
              __pc=4;return;
            case 4:
              
              //$LASTPOS=100000626;//kernel.Boot:626
              _this.fiber$loadImages(_thread);
              __pc=5;return;
            case 5:
              
              //$LASTPOS=100000641;//kernel.Boot:641
              _this.fiber$loadSounds(_thread);
              __pc=6;return;
            case 6:
              
              //$LASTPOS=100000656;//kernel.Boot:656
              _this.fiber$createMainObject(_thread);
              __pc=7;return;
            case 7:
              
              //$LASTPOS=100000677;//kernel.Boot:677
              _this.fiber$progress(_thread);
              __pc=8;return;
            case 8:
              
              //$LASTPOS=100000690;//kernel.Boot:690
              _this.fiber$mainLoop(_thread);
              __pc=9;return;
            case 9:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initialize :function _trc_Boot_initialize(param) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100000724;//kernel.Boot:724
        _this.extend(param);
        //$LASTPOS=100000744;//kernel.Boot:744
        _this.initSymbol();
        //$LASTPOS=100000763;//kernel.Boot:763
        _this._th=Tonyu.thread();
        //$LASTPOS=100000788;//kernel.Boot:788
        _this._th.apply(_this,"main");
        //$LASTPOS=100000817;//kernel.Boot:817
        _this._th.stepsLoop();
        //$LASTPOS=100000839;//kernel.Boot:839
        _this.on("die",(function anonymous_850() {
          
          //$LASTPOS=100000862;//kernel.Boot:862
          if (_this._th) {
            //$LASTPOS=100000871;//kernel.Boot:871
            _this._th.kill();
          }
        }));
      },
      initSymbol :function _trc_Boot_initSymbol() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100000916;//kernel.Boot:916
        Tonyu.globals.$Symbol={subActors: "__SUBACTOR"};
      },
      fiber$initSymbol :function _trc_Boot_f_initSymbol(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100000916;//kernel.Boot:916
        Tonyu.globals.$Symbol={subActors: "__SUBACTOR"};
        
        _thread.retVal=_this;return;
      },
      timeStop :function _trc_Boot_timeStop(except) {
        "use strict";
        var _this=this;
        var oldS;
        var newS;
        var res;
        
        //$LASTPOS=100000995;//kernel.Boot:995
        oldS = _this._scheduler;
        
        //$LASTPOS=100001021;//kernel.Boot:1021
        _this._scheduler=Tonyu.globals.$Scheduler=new Tonyu.classes.kernel.Scheduler;
        //$LASTPOS=100001063;//kernel.Boot:1063
        newS = _this._scheduler;
        
        //$LASTPOS=100001089;//kernel.Boot:1089
        oldS.doTimeStop();
        //$LASTPOS=100001113;//kernel.Boot:1113
        res = {release: (function anonymous_1141(a) {
          
          //$LASTPOS=100001161;//kernel.Boot:1161
          if (! a) {
            return res.releaseAll();
          }
          //$LASTPOS=100001207;//kernel.Boot:1207
          a._scheduler=newS;
          //$LASTPOS=100001239;//kernel.Boot:1239
          oldS.findByThreadGroup(a).forEach((function anonymous_1273(th) {
            
            //$LASTPOS=100001298;//kernel.Boot:1298
            if (th.scheduled===newS) {
              return _this;
            }
            //$LASTPOS=100001348;//kernel.Boot:1348
            th.scheduled=null;
            //$LASTPOS=100001384;//kernel.Boot:1384
            newS.addToNext(th);
            //$LASTPOS=100001421;//kernel.Boot:1421
            newS.checkDuplicate();
          }));
        }),releaseAll: (function anonymous_1493() {
          var a;
          var e;
          var _it_912;
          
          //$LASTPOS=100001509;//kernel.Boot:1509
          a = Tonyu.globals.$Screen.all();
          
          //$LASTPOS=100001543;//kernel.Boot:1543
          _it_912=Tonyu.iterator(a,1);
          while(_it_912.next()) {
            e=_it_912[0];
            
            //$LASTPOS=100001579;//kernel.Boot:1579
            res.release(e);
            
          }
        })};
        
        //$LASTPOS=100001634;//kernel.Boot:1634
        res.release(except);
        return res;
      },
      fiber$timeStop :function _trc_Boot_f_timeStop(_thread,except) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var oldS;
        var newS;
        var res;
        
        //$LASTPOS=100000995;//kernel.Boot:995
        oldS = _this._scheduler;
        
        //$LASTPOS=100001021;//kernel.Boot:1021
        _this._scheduler=Tonyu.globals.$Scheduler=new Tonyu.classes.kernel.Scheduler;
        //$LASTPOS=100001063;//kernel.Boot:1063
        newS = _this._scheduler;
        
        //$LASTPOS=100001089;//kernel.Boot:1089
        oldS.doTimeStop();
        //$LASTPOS=100001113;//kernel.Boot:1113
        res = {release: (function anonymous_1141(a) {
          
          //$LASTPOS=100001161;//kernel.Boot:1161
          if (! a) {
            return res.releaseAll();
          }
          //$LASTPOS=100001207;//kernel.Boot:1207
          a._scheduler=newS;
          //$LASTPOS=100001239;//kernel.Boot:1239
          oldS.findByThreadGroup(a).forEach((function anonymous_1273(th) {
            
            //$LASTPOS=100001298;//kernel.Boot:1298
            if (th.scheduled===newS) {
              return _this;
            }
            //$LASTPOS=100001348;//kernel.Boot:1348
            th.scheduled=null;
            //$LASTPOS=100001384;//kernel.Boot:1384
            newS.addToNext(th);
            //$LASTPOS=100001421;//kernel.Boot:1421
            newS.checkDuplicate();
          }));
        }),releaseAll: (function anonymous_1493() {
          var a;
          var e;
          var _it_912;
          
          //$LASTPOS=100001509;//kernel.Boot:1509
          a = Tonyu.globals.$Screen.all();
          
          //$LASTPOS=100001543;//kernel.Boot:1543
          _it_912=Tonyu.iterator(a,1);
          while(_it_912.next()) {
            e=_it_912[0];
            
            //$LASTPOS=100001579;//kernel.Boot:1579
            res.release(e);
            
          }
        })};
        
        //$LASTPOS=100001634;//kernel.Boot:1634
        res.release(except);
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      update :function _trc_Boot_update() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100001693;//kernel.Boot:1693
        _this.waitFor(Tonyu.timeout(50));
      },
      fiber$update :function _trc_Boot_f_update(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Boot_ent_update(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100001693;//kernel.Boot:1693
              _this.fiber$waitFor(_thread, Tonyu.timeout(50));
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      initGlobals :function _trc_Boot_initGlobals() {
        "use strict";
        var _this=this;
        var opt;
        var g;
        var name;
        var _it_916;
        
        //$LASTPOS=100001772;//kernel.Boot:1772
        opt = Tonyu.currentProject.getOptions();
        
        //$LASTPOS=100001818;//kernel.Boot:1818
        if (opt.run&&opt.run.globals) {
          //$LASTPOS=100001857;//kernel.Boot:1857
          g = opt.run.globals;
          
          //$LASTPOS=100001885;//kernel.Boot:1885
          _it_916=Tonyu.iterator(g,1);
          while(_it_916.next()) {
            name=_it_916[0];
            
            //$LASTPOS=100001914;//kernel.Boot:1914
            Tonyu.setGlobal(name,g[name]);
            
          }
          
        }
        //$LASTPOS=100001961;//kernel.Boot:1961
        Tonyu.globals.$fixProductOrder=true;
      },
      fiber$initGlobals :function _trc_Boot_f_initGlobals(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var opt;
        var g;
        var name;
        var _it_916;
        
        //$LASTPOS=100001772;//kernel.Boot:1772
        opt = Tonyu.currentProject.getOptions();
        
        //$LASTPOS=100001818;//kernel.Boot:1818
        if (opt.run&&opt.run.globals) {
          //$LASTPOS=100001857;//kernel.Boot:1857
          g = opt.run.globals;
          
          //$LASTPOS=100001885;//kernel.Boot:1885
          _it_916=Tonyu.iterator(g,1);
          while(_it_916.next()) {
            name=_it_916[0];
            
            //$LASTPOS=100001914;//kernel.Boot:1914
            Tonyu.setGlobal(name,g[name]);
            
          }
          
        }
        //$LASTPOS=100001961;//kernel.Boot:1961
        Tonyu.globals.$fixProductOrder=true;
        
        _thread.retVal=_this;return;
      },
      initPeripherals :function _trc_Boot_initPeripherals() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100002199;//kernel.Boot:2199
        Tonyu.globals.$InputDevice=new Tonyu.classes.kernel.InputDevice;
        //$LASTPOS=100002234;//kernel.Boot:2234
        Tonyu.globals.$Screen.multiLayerTouches=new Tonyu.classes.kernel.MultiLayerTouches({screen: Tonyu.globals.$Screen});
        //$LASTPOS=100002373;//kernel.Boot:2373
        Tonyu.globals.$InputDevice.on("touchstart",(function anonymous_2403(e) {
          var a;
          
          //$LASTPOS=100002419;//kernel.Boot:2419
          a = Tonyu.globals.$Screen.multiLayerTouches.findActor(e.finger);
          
          //$LASTPOS=100002481;//kernel.Boot:2481
          if (a) {
            //$LASTPOS=100002503;//kernel.Boot:2503
            e.actor=a;
            //$LASTPOS=100002527;//kernel.Boot:2527
            a.fireEvent("touchstart",e);
            
          }
        }));
        //$LASTPOS=100002580;//kernel.Boot:2580
        Tonyu.globals.$InputBox=UIDiag;
        //$LASTPOS=100002603;//kernel.Boot:2603
        Tonyu.globals.$InputDevice.initCanvasEvents(_this.cvj);
        //$LASTPOS=100002644;//kernel.Boot:2644
        Tonyu.globals.$ObjectPool=new Tonyu.classes.kernel.ObjectPool;
        //$LASTPOS=100002677;//kernel.Boot:2677
        Tonyu.globals.$pat_fruits=30;
        //$LASTPOS=100002698;//kernel.Boot:2698
        Tonyu.globals.$Keys=new Tonyu.classes.kernel.Keys;
        //$LASTPOS=100002719;//kernel.Boot:2719
        Tonyu.globals.$Math=Math;
        //$LASTPOS=100002736;//kernel.Boot:2736
        Tonyu.globals.$consolePanel=new Tonyu.classes.kernel.ConsolePanel({align: "center",x: 465/2,y: 465/2,width: 465,height: 465,zOrder: - 10,layer: Tonyu.globals.$FrontSprites});
        //$LASTPOS=100002857;//kernel.Boot:2857
        Tonyu.globals.$printColor=null;
        //$LASTPOS=100002880;//kernel.Boot:2880
        Tonyu.globals.$printSize=20;
        //$LASTPOS=100002900;//kernel.Boot:2900
        Tonyu.globals.$consolePrintY=465;
        //$LASTPOS=100002925;//kernel.Boot:2925
        Tonyu.globals.$panel=new Tonyu.classes.kernel.Panel({align: "center",x: Tonyu.globals.$screenWidth/2,y: Tonyu.globals.$screenHeight/2,width: Tonyu.globals.$screenWidth,height: Tonyu.globals.$screenHeight,zOrder: - 1,layer: Tonyu.globals.$FrontSprites});
        //$LASTPOS=100003069;//kernel.Boot:3069
        _this.initFPSParams();
        //$LASTPOS=100003091;//kernel.Boot:3091
        Tonyu.globals.$WebPage=new Tonyu.classes.kernel.WebPage;
        //$LASTPOS=100003118;//kernel.Boot:3118
        Tonyu.globals.$Navigator=new Tonyu.classes.kernel.Navigator;
        //$LASTPOS=100003149;//kernel.Boot:3149
        Tonyu.globals.$mouseX=Tonyu.globals.$mouseX||0;
        //$LASTPOS=100003174;//kernel.Boot:3174
        Tonyu.globals.$mouseY=Tonyu.globals.$mouseY||0;
        //$LASTPOS=100003199;//kernel.Boot:3199
        _this.debugCnt=50;
        //$LASTPOS=100003217;//kernel.Boot:3217
        _this.newLimit=1000;
        //$LASTPOS=100003237;//kernel.Boot:3237
        Tonyu.globals.$printLimit=500;
      },
      fiber$initPeripherals :function _trc_Boot_f_initPeripherals(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100002199;//kernel.Boot:2199
        Tonyu.globals.$InputDevice=new Tonyu.classes.kernel.InputDevice;
        //$LASTPOS=100002234;//kernel.Boot:2234
        Tonyu.globals.$Screen.multiLayerTouches=new Tonyu.classes.kernel.MultiLayerTouches({screen: Tonyu.globals.$Screen});
        //$LASTPOS=100002373;//kernel.Boot:2373
        Tonyu.globals.$InputDevice.on("touchstart",(function anonymous_2403(e) {
          var a;
          
          //$LASTPOS=100002419;//kernel.Boot:2419
          a = Tonyu.globals.$Screen.multiLayerTouches.findActor(e.finger);
          
          //$LASTPOS=100002481;//kernel.Boot:2481
          if (a) {
            //$LASTPOS=100002503;//kernel.Boot:2503
            e.actor=a;
            //$LASTPOS=100002527;//kernel.Boot:2527
            a.fireEvent("touchstart",e);
            
          }
        }));
        //$LASTPOS=100002580;//kernel.Boot:2580
        Tonyu.globals.$InputBox=UIDiag;
        //$LASTPOS=100002603;//kernel.Boot:2603
        Tonyu.globals.$InputDevice.initCanvasEvents(_this.cvj);
        //$LASTPOS=100002644;//kernel.Boot:2644
        Tonyu.globals.$ObjectPool=new Tonyu.classes.kernel.ObjectPool;
        //$LASTPOS=100002677;//kernel.Boot:2677
        Tonyu.globals.$pat_fruits=30;
        //$LASTPOS=100002698;//kernel.Boot:2698
        Tonyu.globals.$Keys=new Tonyu.classes.kernel.Keys;
        //$LASTPOS=100002719;//kernel.Boot:2719
        Tonyu.globals.$Math=Math;
        //$LASTPOS=100002736;//kernel.Boot:2736
        Tonyu.globals.$consolePanel=new Tonyu.classes.kernel.ConsolePanel({align: "center",x: 465/2,y: 465/2,width: 465,height: 465,zOrder: - 10,layer: Tonyu.globals.$FrontSprites});
        //$LASTPOS=100002857;//kernel.Boot:2857
        Tonyu.globals.$printColor=null;
        //$LASTPOS=100002880;//kernel.Boot:2880
        Tonyu.globals.$printSize=20;
        //$LASTPOS=100002900;//kernel.Boot:2900
        Tonyu.globals.$consolePrintY=465;
        //$LASTPOS=100002925;//kernel.Boot:2925
        Tonyu.globals.$panel=new Tonyu.classes.kernel.Panel({align: "center",x: Tonyu.globals.$screenWidth/2,y: Tonyu.globals.$screenHeight/2,width: Tonyu.globals.$screenWidth,height: Tonyu.globals.$screenHeight,zOrder: - 1,layer: Tonyu.globals.$FrontSprites});
        //$LASTPOS=100003069;//kernel.Boot:3069
        _this.initFPSParams();
        //$LASTPOS=100003091;//kernel.Boot:3091
        Tonyu.globals.$WebPage=new Tonyu.classes.kernel.WebPage;
        //$LASTPOS=100003118;//kernel.Boot:3118
        Tonyu.globals.$Navigator=new Tonyu.classes.kernel.Navigator;
        //$LASTPOS=100003149;//kernel.Boot:3149
        Tonyu.globals.$mouseX=Tonyu.globals.$mouseX||0;
        //$LASTPOS=100003174;//kernel.Boot:3174
        Tonyu.globals.$mouseY=Tonyu.globals.$mouseY||0;
        //$LASTPOS=100003199;//kernel.Boot:3199
        _this.debugCnt=50;
        //$LASTPOS=100003217;//kernel.Boot:3217
        _this.newLimit=1000;
        //$LASTPOS=100003237;//kernel.Boot:3237
        Tonyu.globals.$printLimit=500;
        
        _thread.retVal=_this;return;
      },
      initLayers :function _trc_Boot_initLayers() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100003279;//kernel.Boot:3279
        Tonyu.globals.$screenWidth=465;
        //$LASTPOS=100003302;//kernel.Boot:3302
        Tonyu.globals.$screenHeight=465;
        //$LASTPOS=100003326;//kernel.Boot:3326
        Tonyu.globals.$mainLayer=Tonyu.globals.$Sprites=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003366;//kernel.Boot:3366
        Tonyu.globals.$frontLayer=Tonyu.globals.$FrontSprites=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003412;//kernel.Boot:3412
        Tonyu.globals.$backLayer=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003443;//kernel.Boot:3443
        Tonyu.globals.$uiLayer=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003472;//kernel.Boot:3472
        Tonyu.globals.$sprites3D=new Tonyu.classes.kernel.Sprites3D;
        //$LASTPOS=100003503;//kernel.Boot:3503
        Tonyu.globals.$camera3D=new Tonyu.classes.kernel.Camera3D({layer: Tonyu.globals.$sprites3D,x: 0,y: 0,z: - 100});
        //$LASTPOS=100003565;//kernel.Boot:3565
        Tonyu.globals.$mainLayer3D=new Tonyu.classes.kernel.Layer3D({group: Tonyu.globals.$sprites3D,camera: Tonyu.globals.$camera3D});
        //$LASTPOS=100003658;//kernel.Boot:3658
        _this.cvj=Tonyu.globals.$mainCanvas||$("canvas");
        //$LASTPOS=100003693;//kernel.Boot:3693
        Tonyu.globals.$Screen=new Tonyu.classes.kernel.Screen({width: Tonyu.globals.$screenWidth,height: Tonyu.globals.$screenHeight,layer: Tonyu.globals.$uiLayer});
        //$LASTPOS=100003776;//kernel.Boot:3776
        Tonyu.globals.$Screen.on("resize",(function anonymous_3797() {
          
          //$LASTPOS=100003809;//kernel.Boot:3809
          Tonyu.globals.$screenWidth=Tonyu.globals.$Screen.width;
          //$LASTPOS=100003846;//kernel.Boot:3846
          Tonyu.globals.$screenHeight=Tonyu.globals.$Screen.height;
          //$LASTPOS=100003885;//kernel.Boot:3885
          if (Tonyu.globals.$panel) {
            //$LASTPOS=100003910;//kernel.Boot:3910
            Tonyu.globals.$panel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
            //$LASTPOS=100003968;//kernel.Boot:3968
            Tonyu.globals.$panel.x=Tonyu.globals.$screenWidth/2;
            //$LASTPOS=100004006;//kernel.Boot:4006
            Tonyu.globals.$panel.y=Tonyu.globals.$screenHeight/2;
            
          }
          //$LASTPOS=100004052;//kernel.Boot:4052
          if (Tonyu.globals.$consolePanel) {
            //$LASTPOS=100004084;//kernel.Boot:4084
            Tonyu.globals.$consolePanel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
            //$LASTPOS=100004149;//kernel.Boot:4149
            Tonyu.globals.$consolePanel.x=Tonyu.globals.$screenWidth/2;
            //$LASTPOS=100004194;//kernel.Boot:4194
            Tonyu.globals.$consolePanel.y=Tonyu.globals.$screenHeight/2;
            //$LASTPOS=100004240;//kernel.Boot:4240
            Tonyu.globals.$consolePrintY=Tonyu.globals.$screenHeight;
            
          }
        }));
        //$LASTPOS=100004294;//kernel.Boot:4294
        Tonyu.globals.$Screen.addLayer(Tonyu.globals.$frontLayer);
        //$LASTPOS=100004330;//kernel.Boot:4330
        Tonyu.globals.$camera2D=Tonyu.globals.$Screen.addLayer(Tonyu.globals.$mainLayer);
        //$LASTPOS=100004375;//kernel.Boot:4375
        Tonyu.globals.$Screen.addLayer(Tonyu.globals.$mainLayer3D);
        //$LASTPOS=100004412;//kernel.Boot:4412
        Tonyu.globals.$Screen.addLayer(Tonyu.globals.$backLayer);
        //$LASTPOS=100004447;//kernel.Boot:4447
        Tonyu.globals.$Screen.setBGColor("rgb(20,80,180)");
        //$LASTPOS=100004490;//kernel.Boot:4490
        Tonyu.globals.$Screen.selectLayer(Tonyu.globals.$mainLayer);
        //$LASTPOS=100004528;//kernel.Boot:4528
        Tonyu.globals.$rootLayer=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100004559;//kernel.Boot:4559
        Tonyu.globals.$uiScreen=new Tonyu.classes.kernel.Screen({canvas: _this.cvj[0],layer: Tonyu.globals.$rootLayer});
        //$LASTPOS=100004618;//kernel.Boot:4618
        Tonyu.globals.$uiScreen.setBGColor("#888");
        //$LASTPOS=100004653;//kernel.Boot:4653
        Tonyu.globals.$uiScreen.addLayer(Tonyu.globals.$uiLayer);
        //$LASTPOS=100004688;//kernel.Boot:4688
        Tonyu.globals.$layoutManager=new Tonyu.classes.kernel.UILayout({layer: Tonyu.globals.$uiLayer});
      },
      fiber$initLayers :function _trc_Boot_f_initLayers(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100003279;//kernel.Boot:3279
        Tonyu.globals.$screenWidth=465;
        //$LASTPOS=100003302;//kernel.Boot:3302
        Tonyu.globals.$screenHeight=465;
        //$LASTPOS=100003326;//kernel.Boot:3326
        Tonyu.globals.$mainLayer=Tonyu.globals.$Sprites=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003366;//kernel.Boot:3366
        Tonyu.globals.$frontLayer=Tonyu.globals.$FrontSprites=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003412;//kernel.Boot:3412
        Tonyu.globals.$backLayer=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003443;//kernel.Boot:3443
        Tonyu.globals.$uiLayer=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100003472;//kernel.Boot:3472
        Tonyu.globals.$sprites3D=new Tonyu.classes.kernel.Sprites3D;
        //$LASTPOS=100003503;//kernel.Boot:3503
        Tonyu.globals.$camera3D=new Tonyu.classes.kernel.Camera3D({layer: Tonyu.globals.$sprites3D,x: 0,y: 0,z: - 100});
        //$LASTPOS=100003565;//kernel.Boot:3565
        Tonyu.globals.$mainLayer3D=new Tonyu.classes.kernel.Layer3D({group: Tonyu.globals.$sprites3D,camera: Tonyu.globals.$camera3D});
        //$LASTPOS=100003658;//kernel.Boot:3658
        _this.cvj=Tonyu.globals.$mainCanvas||$("canvas");
        //$LASTPOS=100003693;//kernel.Boot:3693
        Tonyu.globals.$Screen=new Tonyu.classes.kernel.Screen({width: Tonyu.globals.$screenWidth,height: Tonyu.globals.$screenHeight,layer: Tonyu.globals.$uiLayer});
        //$LASTPOS=100003776;//kernel.Boot:3776
        Tonyu.globals.$Screen.on("resize",(function anonymous_3797() {
          
          //$LASTPOS=100003809;//kernel.Boot:3809
          Tonyu.globals.$screenWidth=Tonyu.globals.$Screen.width;
          //$LASTPOS=100003846;//kernel.Boot:3846
          Tonyu.globals.$screenHeight=Tonyu.globals.$Screen.height;
          //$LASTPOS=100003885;//kernel.Boot:3885
          if (Tonyu.globals.$panel) {
            //$LASTPOS=100003910;//kernel.Boot:3910
            Tonyu.globals.$panel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
            //$LASTPOS=100003968;//kernel.Boot:3968
            Tonyu.globals.$panel.x=Tonyu.globals.$screenWidth/2;
            //$LASTPOS=100004006;//kernel.Boot:4006
            Tonyu.globals.$panel.y=Tonyu.globals.$screenHeight/2;
            
          }
          //$LASTPOS=100004052;//kernel.Boot:4052
          if (Tonyu.globals.$consolePanel) {
            //$LASTPOS=100004084;//kernel.Boot:4084
            Tonyu.globals.$consolePanel.setPanel(Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
            //$LASTPOS=100004149;//kernel.Boot:4149
            Tonyu.globals.$consolePanel.x=Tonyu.globals.$screenWidth/2;
            //$LASTPOS=100004194;//kernel.Boot:4194
            Tonyu.globals.$consolePanel.y=Tonyu.globals.$screenHeight/2;
            //$LASTPOS=100004240;//kernel.Boot:4240
            Tonyu.globals.$consolePrintY=Tonyu.globals.$screenHeight;
            
          }
        }));
        //$LASTPOS=100004294;//kernel.Boot:4294
        Tonyu.globals.$Screen.addLayer(Tonyu.globals.$frontLayer);
        //$LASTPOS=100004330;//kernel.Boot:4330
        Tonyu.globals.$camera2D=Tonyu.globals.$Screen.addLayer(Tonyu.globals.$mainLayer);
        //$LASTPOS=100004375;//kernel.Boot:4375
        Tonyu.globals.$Screen.addLayer(Tonyu.globals.$mainLayer3D);
        //$LASTPOS=100004412;//kernel.Boot:4412
        Tonyu.globals.$Screen.addLayer(Tonyu.globals.$backLayer);
        //$LASTPOS=100004447;//kernel.Boot:4447
        Tonyu.globals.$Screen.setBGColor("rgb(20,80,180)");
        //$LASTPOS=100004490;//kernel.Boot:4490
        Tonyu.globals.$Screen.selectLayer(Tonyu.globals.$mainLayer);
        //$LASTPOS=100004528;//kernel.Boot:4528
        Tonyu.globals.$rootLayer=new Tonyu.classes.kernel.Sprites();
        //$LASTPOS=100004559;//kernel.Boot:4559
        Tonyu.globals.$uiScreen=new Tonyu.classes.kernel.Screen({canvas: _this.cvj[0],layer: Tonyu.globals.$rootLayer});
        //$LASTPOS=100004618;//kernel.Boot:4618
        Tonyu.globals.$uiScreen.setBGColor("#888");
        //$LASTPOS=100004653;//kernel.Boot:4653
        Tonyu.globals.$uiScreen.addLayer(Tonyu.globals.$uiLayer);
        //$LASTPOS=100004688;//kernel.Boot:4688
        Tonyu.globals.$layoutManager=new Tonyu.classes.kernel.UILayout({layer: Tonyu.globals.$uiLayer});
        
        _thread.retVal=_this;return;
      },
      debug :function _trc_Boot_debug() {
        "use strict";
        var _this=this;
        var a;
        
        //$LASTPOS=100004773;//kernel.Boot:4773
        if (! _this.debugCnt) {
          return _this;
        }
        //$LASTPOS=100004801;//kernel.Boot:4801
        _this.debugCnt--;
        //$LASTPOS=100004818;//kernel.Boot:4818
        a = Array.prototype.slice.call(arguments);
        
        //$LASTPOS=100004868;//kernel.Boot:4868
        a.unshift(_this.debugCnt);
        //$LASTPOS=100004894;//kernel.Boot:4894
        a.unshift("DEBUG");
        //$LASTPOS=100004919;//kernel.Boot:4919
        console.log.apply(console,a);
      },
      fiber$debug :function _trc_Boot_f_debug(_thread) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        
        //$LASTPOS=100004773;//kernel.Boot:4773
        if (! _this.debugCnt) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=100004801;//kernel.Boot:4801
        _this.debugCnt--;
        //$LASTPOS=100004818;//kernel.Boot:4818
        a = Array.prototype.slice.call(_arguments);
        
        //$LASTPOS=100004868;//kernel.Boot:4868
        a.unshift(_this.debugCnt);
        //$LASTPOS=100004894;//kernel.Boot:4894
        a.unshift("DEBUG");
        //$LASTPOS=100004919;//kernel.Boot:4919
        console.log.apply(console,a);
        
        _thread.retVal=_this;return;
      },
      loadPlugins :function _trc_Boot_loadPlugins() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100004975;//kernel.Boot:4975
        _this.progress("Loading plugins..");
        //$LASTPOS=100005011;//kernel.Boot:5011
        _this.runAsync((function anonymous_5020(r) {
          
          //$LASTPOS=100005036;//kernel.Boot:5036
          Tonyu.globals.$currentProject.loadPlugins(r);
        }));
        //$LASTPOS=100005081;//kernel.Boot:5081
        _this.progress("Loading plugins done");
      },
      fiber$loadPlugins :function _trc_Boot_f_loadPlugins(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Boot_ent_loadPlugins(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100004975;//kernel.Boot:4975
              _this.fiber$progress(_thread, "Loading plugins..");
              __pc=1;return;
            case 1:
              
              //$LASTPOS=100005011;//kernel.Boot:5011
              _this.fiber$runAsync(_thread, (function anonymous_5020(r) {
                
                //$LASTPOS=100005036;//kernel.Boot:5036
                Tonyu.globals.$currentProject.loadPlugins(r);
              }));
              __pc=2;return;
            case 2:
              
              //$LASTPOS=100005081;//kernel.Boot:5081
              _this.fiber$progress(_thread, "Loading plugins done");
              __pc=3;return;
            case 3:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      loadImages :function _trc_Boot_loadImages() {
        "use strict";
        var _this=this;
        var rs;
        var r;
        var name;
        var val;
        var _it_925;
        
        //$LASTPOS=100005140;//kernel.Boot:5140
        _this.progress("Loading pats..");
        //$LASTPOS=100005173;//kernel.Boot:5173
        rs = Tonyu.globals.$currentProject.getResource();
        
        
        //$LASTPOS=100005228;//kernel.Boot:5228
        r=_this.runAsync((function anonymous_5239(succ) {
          
          //$LASTPOS=100005258;//kernel.Boot:5258
          ImageList.load(rs.images,succ,{baseDir: Tonyu.globals.$currentProject.getDir(),prj: Tonyu.globals.$currentProject});
        }));
        //$LASTPOS=100005417;//kernel.Boot:5417
        Tonyu.globals.$imageList=r[0];
        //$LASTPOS=100005475;//kernel.Boot:5475
        _it_925=Tonyu.iterator(r[0].names,2);
        while(_it_925.next()) {
          name=_it_925[0];
          val=_it_925[1];
          
          //$LASTPOS=100005519;//kernel.Boot:5519
          Tonyu.setGlobal(name,val);
          
        }
        //$LASTPOS=100005559;//kernel.Boot:5559
        _this.progress("Loading pats done.");
      },
      fiber$loadImages :function _trc_Boot_f_loadImages(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var rs;
        var r;
        var name;
        var val;
        var _it_925;
        
        
        _thread.enter(function _trc_Boot_ent_loadImages(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100005140;//kernel.Boot:5140
              _this.fiber$progress(_thread, "Loading pats..");
              __pc=1;return;
            case 1:
              
              //$LASTPOS=100005173;//kernel.Boot:5173
              rs = Tonyu.globals.$currentProject.getResource();
              
              
              //$LASTPOS=100005228;//kernel.Boot:5228
              _this.fiber$runAsync(_thread, (function anonymous_5239(succ) {
                
                //$LASTPOS=100005258;//kernel.Boot:5258
                ImageList.load(rs.images,succ,{baseDir: Tonyu.globals.$currentProject.getDir(),prj: Tonyu.globals.$currentProject});
              }));
              __pc=2;return;
            case 2:
              r=_thread.retVal;
              
              //$LASTPOS=100005417;//kernel.Boot:5417
              Tonyu.globals.$imageList=r[0];
              //$LASTPOS=100005475;//kernel.Boot:5475
              _it_925=Tonyu.iterator(r[0].names,2);
              while(_it_925.next()) {
                name=_it_925[0];
                val=_it_925[1];
                
                //$LASTPOS=100005519;//kernel.Boot:5519
                Tonyu.setGlobal(name,val);
                
              }
              //$LASTPOS=100005559;//kernel.Boot:5559
              _this.fiber$progress(_thread, "Loading pats done.");
              __pc=3;return;
            case 3:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      loadSounds :function _trc_Boot_loadSounds() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100005616;//kernel.Boot:5616
        _this.progress("Loading sounds...");
        //$LASTPOS=100005652;//kernel.Boot:5652
        _this.initT2MediaPlayer();
        //$LASTPOS=100005678;//kernel.Boot:5678
        _this.loadFromProject(Tonyu.globals.$currentProject);
        //$LASTPOS=100005717;//kernel.Boot:5717
        _this.progress("Loading sounds done.");
        //$LASTPOS=100005756;//kernel.Boot:5756
        _this.on("stop",(function anonymous_5766() {
          
          //$LASTPOS=100005778;//kernel.Boot:5778
          _this.allResetBGM();
        }));
        //$LASTPOS=100005838;//kernel.Boot:5838
        Tonyu.globals.$sound=_this;
      },
      fiber$loadSounds :function _trc_Boot_f_loadSounds(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Boot_ent_loadSounds(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100005616;//kernel.Boot:5616
              _this.fiber$progress(_thread, "Loading sounds...");
              __pc=1;return;
            case 1:
              
              //$LASTPOS=100005652;//kernel.Boot:5652
              _this.fiber$initT2MediaPlayer(_thread);
              __pc=2;return;
            case 2:
              
              //$LASTPOS=100005678;//kernel.Boot:5678
              _this.fiber$loadFromProject(_thread, Tonyu.globals.$currentProject);
              __pc=3;return;
            case 3:
              
              //$LASTPOS=100005717;//kernel.Boot:5717
              _this.fiber$progress(_thread, "Loading sounds done.");
              __pc=4;return;
            case 4:
              
              //$LASTPOS=100005756;//kernel.Boot:5756
              _this.on("stop",(function anonymous_5766() {
                
                //$LASTPOS=100005778;//kernel.Boot:5778
                _this.allResetBGM();
              }));
              //$LASTPOS=100005838;//kernel.Boot:5838
              Tonyu.globals.$sound=_this;
              _thread.exit(_this);return;
            }
          }
        });
      },
      createMainObject :function _trc_Boot_createMainObject() {
        "use strict";
        var _this=this;
        var o;
        var mainClassName;
        
        //$LASTPOS=100005884;//kernel.Boot:5884
        o = Tonyu.currentProject.getOptions();
        
        //$LASTPOS=100005930;//kernel.Boot:5930
        mainClassName = o.run.mainClass;
        
        //$LASTPOS=100005970;//kernel.Boot:5970
        _this.progress("MainClass= "+mainClassName);
        //$LASTPOS=100006014;//kernel.Boot:6014
        _this.mainClass=Tonyu.getClass(mainClassName);
        //$LASTPOS=100006060;//kernel.Boot:6060
        if (! _this.mainClass) {
          throw new Error(mainClassName+" というクラスはありません");
          
          
        }
        //$LASTPOS=100006148;//kernel.Boot:6148
        Tonyu.globals.$excludeFromAll=Tonyu.globals.$Screen.all();
        //$LASTPOS=100006184;//kernel.Boot:6184
        new _this.mainClass();
      },
      fiber$createMainObject :function _trc_Boot_f_createMainObject(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var o;
        var mainClassName;
        
        //$LASTPOS=100005884;//kernel.Boot:5884
        o = Tonyu.currentProject.getOptions();
        
        //$LASTPOS=100005930;//kernel.Boot:5930
        mainClassName = o.run.mainClass;
        
        
        _thread.enter(function _trc_Boot_ent_createMainObject(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100005970;//kernel.Boot:5970
              _this.fiber$progress(_thread, "MainClass= "+mainClassName);
              __pc=1;return;
            case 1:
              
              //$LASTPOS=100006014;//kernel.Boot:6014
              _this.mainClass=Tonyu.getClass(mainClassName);
              //$LASTPOS=100006060;//kernel.Boot:6060
              if (! _this.mainClass) {
                throw new Error(mainClassName+" というクラスはありません");
                
                
              }
              //$LASTPOS=100006148;//kernel.Boot:6148
              Tonyu.globals.$excludeFromAll=Tonyu.globals.$Screen.all();
              //$LASTPOS=100006184;//kernel.Boot:6184
              new _this.mainClass();
              _thread.exit(_this);return;
            }
          }
        });
      },
      loadPage :function _trc_Boot_loadPage(page,arg) {
        "use strict";
        var _this=this;
        var a;
        
        //$LASTPOS=100006232;//kernel.Boot:6232
        a = Tonyu.globals.$Screen.all();
        
        //$LASTPOS=100006258;//kernel.Boot:6258
        a=a.find((function anonymous_6267(e) {
          
          return ! Tonyu.globals.$excludeFromAll.contains(e);
        }));
        //$LASTPOS=100006319;//kernel.Boot:6319
        a.die();
        //$LASTPOS=100006333;//kernel.Boot:6333
        new page(arg);
      },
      fiber$loadPage :function _trc_Boot_f_loadPage(_thread,page,arg) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var a;
        
        //$LASTPOS=100006232;//kernel.Boot:6232
        a = Tonyu.globals.$Screen.all();
        
        //$LASTPOS=100006258;//kernel.Boot:6258
        a=a.find((function anonymous_6267(e) {
          
          return ! Tonyu.globals.$excludeFromAll.contains(e);
        }));
        //$LASTPOS=100006319;//kernel.Boot:6319
        a.die();
        //$LASTPOS=100006333;//kernel.Boot:6333
        new page(arg);
        
        _thread.retVal=_this;return;
      },
      stop :function _trc_Boot_stop() {
        "use strict";
        var _this=this;
        var res;
        var evt;
        var e;
        var r;
        
        //$LASTPOS=100006367;//kernel.Boot:6367
        res = new $.Deferred();
        
        //$LASTPOS=100006398;//kernel.Boot:6398
        evt = {die: (function anonymous_6422() {
          
          //$LASTPOS=100006438;//kernel.Boot:6438
          _this.die();
          //$LASTPOS=100006458;//kernel.Boot:6458
          res.resolve();
        }),preventDefault: (function anonymous_6510() {
          
          //$LASTPOS=100006512;//kernel.Boot:6512
          evt.defaultPrevented=true;
        })};
        
        try {
          //$LASTPOS=100006568;//kernel.Boot:6568
          Tonyu.globals.$sound.stopAllSE();
          
        } catch (e) {
          //$LASTPOS=100006615;//kernel.Boot:6615
          console.error(e.stack);
          
        }
        //$LASTPOS=100006651;//kernel.Boot:6651
        r = _this.fireEvent("stop",evt);
        
        //$LASTPOS=100006685;//kernel.Boot:6685
        if (! evt.defaultPrevented) {
          //$LASTPOS=100006722;//kernel.Boot:6722
          evt.die();
          //$LASTPOS=100006742;//kernel.Boot:6742
          res.resolve();
          
        }
        return res;
      },
      fiber$stop :function _trc_Boot_f_stop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var res;
        var evt;
        var e;
        var r;
        
        //$LASTPOS=100006367;//kernel.Boot:6367
        res = new $.Deferred();
        
        //$LASTPOS=100006398;//kernel.Boot:6398
        evt = {die: (function anonymous_6422() {
          
          //$LASTPOS=100006438;//kernel.Boot:6438
          _this.die();
          //$LASTPOS=100006458;//kernel.Boot:6458
          res.resolve();
        }),preventDefault: (function anonymous_6510() {
          
          //$LASTPOS=100006512;//kernel.Boot:6512
          evt.defaultPrevented=true;
        })};
        
        try {
          //$LASTPOS=100006568;//kernel.Boot:6568
          Tonyu.globals.$sound.stopAllSE();
          
        } catch (e) {
          //$LASTPOS=100006615;//kernel.Boot:6615
          console.error(e.stack);
          
        }
        //$LASTPOS=100006651;//kernel.Boot:6651
        r = _this.fireEvent("stop",evt);
        
        //$LASTPOS=100006685;//kernel.Boot:6685
        if (! evt.defaultPrevented) {
          //$LASTPOS=100006722;//kernel.Boot:6722
          evt.die();
          //$LASTPOS=100006742;//kernel.Boot:6742
          res.resolve();
          
        }
        _thread.retVal=res;return;
        
        
        _thread.retVal=_this;return;
      },
      hide :function _trc_Boot_hide() {
        "use strict";
        var _this=this;
        
      },
      schedule :function _trc_Boot_schedule(obj,method,args) {
        "use strict";
        var _this=this;
        var s;
        var th;
        
        //$LASTPOS=100006833;//kernel.Boot:6833
        if (! method) {
          throw new Error("指定されたメソッドは定義されていません:"+method);
          
        }
        //$LASTPOS=100006899;//kernel.Boot:6899
        args=args||[];
        //$LASTPOS=100006919;//kernel.Boot:6919
        s = obj._scheduler||_this._scheduler;
        
        //$LASTPOS=100006958;//kernel.Boot:6958
        th = s.newThread(obj,method,args);
        
        //$LASTPOS=100007002;//kernel.Boot:7002
        obj.setThreadGroup(_this);
        //$LASTPOS=100007033;//kernel.Boot:7033
        th.setThreadGroup(obj);
        return th;
      },
      fiber$schedule :function _trc_Boot_f_schedule(_thread,obj,method,args) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var s;
        var th;
        
        //$LASTPOS=100006833;//kernel.Boot:6833
        if (! method) {
          throw new Error("指定されたメソッドは定義されていません:"+method);
          
        }
        //$LASTPOS=100006899;//kernel.Boot:6899
        args=args||[];
        //$LASTPOS=100006919;//kernel.Boot:6919
        s = obj._scheduler||_this._scheduler;
        
        //$LASTPOS=100006958;//kernel.Boot:6958
        th = s.newThread(obj,method,args);
        
        //$LASTPOS=100007002;//kernel.Boot:7002
        obj.setThreadGroup(_this);
        //$LASTPOS=100007033;//kernel.Boot:7033
        th.setThreadGroup(obj);
        _thread.retVal=th;return;
        
        
        _thread.retVal=_this;return;
      },
      progress :function _trc_Boot_progress(m) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100007097;//kernel.Boot:7097
        if (typeof  SplashScreen=="undefined") {
          return _this;
        }
        //$LASTPOS=100007148;//kernel.Boot:7148
        if (m) {
          //$LASTPOS=100007166;//kernel.Boot:7166
          console.log.apply(console,arguments);
          //$LASTPOS=100007213;//kernel.Boot:7213
          SplashScreen.progress(m);
          
        } else {
          //$LASTPOS=100007251;//kernel.Boot:7251
          SplashScreen.hide();
        }
      },
      fiber$progress :function _trc_Boot_f_progress(_thread,m) {
        "use strict";
        var _this=this;
        var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100007097;//kernel.Boot:7097
        if (typeof  SplashScreen=="undefined") {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=100007148;//kernel.Boot:7148
        if (m) {
          //$LASTPOS=100007166;//kernel.Boot:7166
          console.log.apply(console,_arguments);
          //$LASTPOS=100007213;//kernel.Boot:7213
          SplashScreen.progress(m);
          
        } else {
          //$LASTPOS=100007251;//kernel.Boot:7251
          SplashScreen.hide();
        }
        
        _thread.retVal=_this;return;
      },
      progressNoLog :function _trc_Boot_progressNoLog(m) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100007301;//kernel.Boot:7301
        if (typeof  SplashScreen=="undefined") {
          return _this;
        }
        //$LASTPOS=100007352;//kernel.Boot:7352
        if (m) {
          //$LASTPOS=100007370;//kernel.Boot:7370
          SplashScreen.progress(m);
          
        } else {
          //$LASTPOS=100007408;//kernel.Boot:7408
          SplashScreen.hide();
        }
      },
      fiber$progressNoLog :function _trc_Boot_f_progressNoLog(_thread,m) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100007301;//kernel.Boot:7301
        if (typeof  SplashScreen=="undefined") {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=100007352;//kernel.Boot:7352
        if (m) {
          //$LASTPOS=100007370;//kernel.Boot:7370
          SplashScreen.progress(m);
          
        } else {
          //$LASTPOS=100007408;//kernel.Boot:7408
          SplashScreen.hide();
        }
        
        _thread.retVal=_this;return;
      },
      mainLoop :function _trc_Boot_mainLoop() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100007454;//kernel.Boot:7454
        Tonyu.globals.$frameCount=0;
        //$LASTPOS=100007474;//kernel.Boot:7474
        Tonyu.globals.$drawnFrameCount=0;
        //$LASTPOS=100007499;//kernel.Boot:7499
        while (true) {
          //$LASTPOS=100007520;//kernel.Boot:7520
          if (_this._useRAF) {
            //$LASTPOS=100007533;//kernel.Boot:7533
            _this.loopRAF();
          } else {
            //$LASTPOS=100007555;//kernel.Boot:7555
            _this.loopTimer();
          }
          //$LASTPOS=100007577;//kernel.Boot:7577
          _this.measureFps();
          //$LASTPOS=100007597;//kernel.Boot:7597
          _this.handlePause();
          //$LASTPOS=100007621;//kernel.Boot:7621
          Tonyu.globals.$drawnFrameCount++;
          
        }
      },
      fiber$mainLoop :function _trc_Boot_f_mainLoop(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100007454;//kernel.Boot:7454
        Tonyu.globals.$frameCount=0;
        //$LASTPOS=100007474;//kernel.Boot:7474
        Tonyu.globals.$drawnFrameCount=0;
        
        _thread.enter(function _trc_Boot_ent_mainLoop(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100007499;//kernel.Boot:7499
            case 1:
              //$LASTPOS=100007520;//kernel.Boot:7520
              if (!(_this._useRAF)) { __pc=3     ; break; }
              //$LASTPOS=100007533;//kernel.Boot:7533
              _this.fiber$loopRAF(_thread);
              __pc=2;return;
            case 2:
              
              __pc=5     ;break;
            case 3     :
              //$LASTPOS=100007555;//kernel.Boot:7555
              _this.fiber$loopTimer(_thread);
              __pc=4;return;
            case 4:
              
            case 5     :
              
              //$LASTPOS=100007577;//kernel.Boot:7577
              _this.measureFps();
              //$LASTPOS=100007597;//kernel.Boot:7597
              _this.fiber$handlePause(_thread);
              __pc=6;return;
            case 6:
              
              //$LASTPOS=100007621;//kernel.Boot:7621
              Tonyu.globals.$drawnFrameCount++;
              __pc=1;break;
            case 7     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      loopRAF :function _trc_Boot_loopRAF() {
        "use strict";
        var _this=this;
        var nowTime;
        var frameTime;
        var moves;
        var bufferTime;
        
        //$LASTPOS=100007670;//kernel.Boot:7670
        nowTime = _this.now();
        
        //$LASTPOS=100007711;//kernel.Boot:7711
        frameTime = 1000/_this._fps;
        
        //$LASTPOS=100007755;//kernel.Boot:7755
        moves = 0;
        
        
        //$LASTPOS=100007834;//kernel.Boot:7834
        _this.subTime=_this.trunc(nowTime-_this.rafProcNowTime);
        //$LASTPOS=100007882;//kernel.Boot:7882
        _this.procCnt=_this.subTime/frameTime;
        //$LASTPOS=100007934;//kernel.Boot:7934
        bufferTime=(0.5*_this._fps/60);
        //$LASTPOS=100007967;//kernel.Boot:7967
        if (_this._fps<60) {
          //$LASTPOS=100007982;//kernel.Boot:7982
          bufferTime=0;
        }
        //$LASTPOS=100008085;//kernel.Boot:8085
        if (_this.procCnt>=1-bufferTime&&_this.procCnt<=1+bufferTime) {
          //$LASTPOS=100008145;//kernel.Boot:8145
          _this.procCnt=1;
        }
        //$LASTPOS=100008165;//kernel.Boot:8165
        _this.procCnt=_this.floor(_this.procCnt);
        //$LASTPOS=100008196;//kernel.Boot:8196
        if (_this.procCnt>_this.maxFrameSkip) {
          //$LASTPOS=100008235;//kernel.Boot:8235
          _this.procCnt=_this.maxFrameSkip;
          //$LASTPOS=100008268;//kernel.Boot:8268
          _this.rafProcNowTime=nowTime;
          
        } else {
          //$LASTPOS=100008317;//kernel.Boot:8317
          _this.rafProcNowTime+=_this.procCnt*frameTime;
          
        }
        //$LASTPOS=100008414;//kernel.Boot:8414
        while (moves<_this.procCnt) {
          //$LASTPOS=100008440;//kernel.Boot:8440
          _this.moveFrame();
          //$LASTPOS=100008456;//kernel.Boot:8456
          moves++;
          //$LASTPOS=100008471;//kernel.Boot:8471
          if (moves<_this.procCnt) {
            //$LASTPOS=100008490;//kernel.Boot:8490
            _this.afterDraw({drawn: false});
          }
          
        }
        //$LASTPOS=100008549;//kernel.Boot:8549
        if (moves>0) {
          //$LASTPOS=100008575;//kernel.Boot:8575
          _this.drawFrame();
          //$LASTPOS=100008597;//kernel.Boot:8597
          _this.afterDraw({drawn: true});
          
        }
        //$LASTPOS=100008681;//kernel.Boot:8681
        _this.waitRAF();
      },
      fiber$loopRAF :function _trc_Boot_f_loopRAF(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var nowTime;
        var frameTime;
        var moves;
        var bufferTime;
        
        //$LASTPOS=100007670;//kernel.Boot:7670
        nowTime = _this.now();
        
        //$LASTPOS=100007711;//kernel.Boot:7711
        frameTime = 1000/_this._fps;
        
        //$LASTPOS=100007755;//kernel.Boot:7755
        moves = 0;
        
        
        //$LASTPOS=100007834;//kernel.Boot:7834
        _this.subTime=_this.trunc(nowTime-_this.rafProcNowTime);
        //$LASTPOS=100007882;//kernel.Boot:7882
        _this.procCnt=_this.subTime/frameTime;
        //$LASTPOS=100007934;//kernel.Boot:7934
        bufferTime=(0.5*_this._fps/60);
        //$LASTPOS=100007967;//kernel.Boot:7967
        if (_this._fps<60) {
          //$LASTPOS=100007982;//kernel.Boot:7982
          bufferTime=0;
        }
        //$LASTPOS=100008085;//kernel.Boot:8085
        if (_this.procCnt>=1-bufferTime&&_this.procCnt<=1+bufferTime) {
          //$LASTPOS=100008145;//kernel.Boot:8145
          _this.procCnt=1;
        }
        //$LASTPOS=100008165;//kernel.Boot:8165
        _this.procCnt=_this.floor(_this.procCnt);
        //$LASTPOS=100008196;//kernel.Boot:8196
        if (_this.procCnt>_this.maxFrameSkip) {
          //$LASTPOS=100008235;//kernel.Boot:8235
          _this.procCnt=_this.maxFrameSkip;
          //$LASTPOS=100008268;//kernel.Boot:8268
          _this.rafProcNowTime=nowTime;
          
        } else {
          //$LASTPOS=100008317;//kernel.Boot:8317
          _this.rafProcNowTime+=_this.procCnt*frameTime;
          
        }
        
        _thread.enter(function _trc_Boot_ent_loopRAF(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100008414;//kernel.Boot:8414
            case 1:
              if (!(moves<_this.procCnt)) { __pc=2     ; break; }
              {
                //$LASTPOS=100008440;//kernel.Boot:8440
                _this.moveFrame();
                //$LASTPOS=100008456;//kernel.Boot:8456
                moves++;
                //$LASTPOS=100008471;//kernel.Boot:8471
                if (moves<_this.procCnt) {
                  //$LASTPOS=100008490;//kernel.Boot:8490
                  _this.afterDraw({drawn: false});
                }
              }
              __pc=1;break;
            case 2     :
              
              //$LASTPOS=100008549;//kernel.Boot:8549
              if (moves>0) {
                //$LASTPOS=100008575;//kernel.Boot:8575
                _this.drawFrame();
                //$LASTPOS=100008597;//kernel.Boot:8597
                _this.afterDraw({drawn: true});
                
              }
              //$LASTPOS=100008681;//kernel.Boot:8681
              _this.fiber$waitRAF(_thread);
              __pc=3;return;
            case 3:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      waitRAF :function _trc_Boot_waitRAF() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100009120;//kernel.Boot:9120
        _this.waitFor(Tonyu.animationFrame());
      },
      fiber$waitRAF :function _trc_Boot_f_waitRAF(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Boot_ent_waitRAF(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100009120;//kernel.Boot:9120
              _this.fiber$waitFor(_thread, Tonyu.animationFrame());
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      loopTimer :function _trc_Boot_loopTimer() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100009294;//kernel.Boot:9294
        _this.moveFrame();
        //$LASTPOS=100009312;//kernel.Boot:9312
        _this.doDraw=_this.now()<_this.deadLine;
        //$LASTPOS=100009340;//kernel.Boot:9340
        if (! _this.doDraw&&_this.frameSkipped>=_this.maxFrameSkip) {
          //$LASTPOS=100009394;//kernel.Boot:9394
          _this.doDraw=true;
          //$LASTPOS=100009416;//kernel.Boot:9416
          _this.resetDeadLine();
          
        }
        //$LASTPOS=100009445;//kernel.Boot:9445
        if (_this.doDraw) {
          //$LASTPOS=100009482;//kernel.Boot:9482
          _this.drawFrame();
          //$LASTPOS=100009504;//kernel.Boot:9504
          _this.frameSkipped=0;
          
        } else {
          //$LASTPOS=100009543;//kernel.Boot:9543
          _this.frameSkipped++;
          
        }
        //$LASTPOS=100009571;//kernel.Boot:9571
        _this.afterDraw({drawn: _this.doDraw});
        //$LASTPOS=100009601;//kernel.Boot:9601
        _this.waitFrame();
      },
      fiber$loopTimer :function _trc_Boot_f_loopTimer(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100009294;//kernel.Boot:9294
        _this.moveFrame();
        //$LASTPOS=100009312;//kernel.Boot:9312
        _this.doDraw=_this.now()<_this.deadLine;
        //$LASTPOS=100009340;//kernel.Boot:9340
        if (! _this.doDraw&&_this.frameSkipped>=_this.maxFrameSkip) {
          //$LASTPOS=100009394;//kernel.Boot:9394
          _this.doDraw=true;
          //$LASTPOS=100009416;//kernel.Boot:9416
          _this.resetDeadLine();
          
        }
        //$LASTPOS=100009445;//kernel.Boot:9445
        if (_this.doDraw) {
          //$LASTPOS=100009482;//kernel.Boot:9482
          _this.drawFrame();
          //$LASTPOS=100009504;//kernel.Boot:9504
          _this.frameSkipped=0;
          
        } else {
          //$LASTPOS=100009543;//kernel.Boot:9543
          _this.frameSkipped++;
          
        }
        //$LASTPOS=100009571;//kernel.Boot:9571
        _this.afterDraw({drawn: _this.doDraw});
        
        _thread.enter(function _trc_Boot_ent_loopTimer(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100009601;//kernel.Boot:9601
              _this.fiber$waitFrame(_thread);
              __pc=1;return;
            case 1:
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      handlePause :function _trc_Boot_handlePause() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100009688;//kernel.Boot:9688
        if (_this.economyMode&&_this._scheduler.isEmpty) {
          //$LASTPOS=100009738;//kernel.Boot:9738
          _this.isIdle=true;
          //$LASTPOS=100009760;//kernel.Boot:9760
          while (_this._scheduler.isEmpty) {
            //$LASTPOS=100009801;//kernel.Boot:9801
            _this.runPromise(requestAnimationFrame);
            
          }
          //$LASTPOS=100009856;//kernel.Boot:9856
          _this.resetDeadLine();
          
        }
        //$LASTPOS=100009885;//kernel.Boot:9885
        while (_this.paused) {
          //$LASTPOS=100009910;//kernel.Boot:9910
          _this.isIdle=true;
          //$LASTPOS=100009932;//kernel.Boot:9932
          _this.runPromise(requestAnimationFrame);
          //$LASTPOS=100009976;//kernel.Boot:9976
          if (! _this.paused) {
            //$LASTPOS=100009989;//kernel.Boot:9989
            _this.resetDeadLine();
          }
          
        }
        //$LASTPOS=100010018;//kernel.Boot:10018
        _this.isIdle=false;
      },
      fiber$handlePause :function _trc_Boot_f_handlePause(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.enter(function _trc_Boot_ent_handlePause(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100009688;//kernel.Boot:9688
              if (!(_this.economyMode&&_this._scheduler.isEmpty)) { __pc=4     ; break; }
              //$LASTPOS=100009738;//kernel.Boot:9738
              _this.isIdle=true;
              //$LASTPOS=100009760;//kernel.Boot:9760
            case 1:
              if (!(_this._scheduler.isEmpty)) { __pc=3     ; break; }
              //$LASTPOS=100009801;//kernel.Boot:9801
              _this.fiber$runPromise(_thread, requestAnimationFrame);
              __pc=2;return;
            case 2:
              
              __pc=1;break;
            case 3     :
              
              //$LASTPOS=100009856;//kernel.Boot:9856
              _this.resetDeadLine();
            case 4     :
              
              //$LASTPOS=100009885;//kernel.Boot:9885
            case 5:
              if (!(_this.paused)) { __pc=7     ; break; }
              //$LASTPOS=100009910;//kernel.Boot:9910
              _this.isIdle=true;
              //$LASTPOS=100009932;//kernel.Boot:9932
              _this.fiber$runPromise(_thread, requestAnimationFrame);
              __pc=6;return;
            case 6:
              
              //$LASTPOS=100009976;//kernel.Boot:9976
              if (! _this.paused) {
                //$LASTPOS=100009989;//kernel.Boot:9989
                _this.resetDeadLine();
              }
              __pc=5;break;
            case 7     :
              
              //$LASTPOS=100010018;//kernel.Boot:10018
              _this.isIdle=false;
              _thread.exit(_this);return;
            }
          }
        });
      },
      drawFrame :function _trc_Boot_drawFrame() {
        "use strict";
        var _this=this;
        var s;
        
        //$LASTPOS=100010124;//kernel.Boot:10124
        s = _this.now();
        
        //$LASTPOS=100010142;//kernel.Boot:10142
        Tonyu.globals.$uiScreen.drawLayers();
        //$LASTPOS=100010171;//kernel.Boot:10171
        _this.drawTime=_this.now()-s;
        //$LASTPOS=100010194;//kernel.Boot:10194
        _this.fps_fpsCnt++;
      },
      moveFrame :function _trc_Boot_moveFrame() {
        "use strict";
        var _this=this;
        var s;
        var sc;
        
        //$LASTPOS=100010237;//kernel.Boot:10237
        s = _this.now();
        
        //$LASTPOS=100010255;//kernel.Boot:10255
        Tonyu.globals.$_printCount=0;
        //$LASTPOS=100010276;//kernel.Boot:10276
        Tonyu.resetLoopCheck();
        //$LASTPOS=100010305;//kernel.Boot:10305
        if (_this.newLimit) {
          //$LASTPOS=100010319;//kernel.Boot:10319
          _this.newLimitCount=_this.newLimit;
        }
        //$LASTPOS=100010377;//kernel.Boot:10377
        sc = _this._scheduler.stepsAll();
        
        //$LASTPOS=100010441;//kernel.Boot:10441
        Tonyu.globals.$Keys.update();
        //$LASTPOS=100010491;//kernel.Boot:10491
        Tonyu.globals.$InputDevice.update();
        //$LASTPOS=100010579;//kernel.Boot:10579
        Tonyu.globals.$screenWidth=Tonyu.globals.$Screen.width;
        //$LASTPOS=100010612;//kernel.Boot:10612
        Tonyu.globals.$screenHeight=Tonyu.globals.$Screen.height;
        //$LASTPOS=100010647;//kernel.Boot:10647
        _this.moveTime=_this.now()-s;
        //$LASTPOS=100010670;//kernel.Boot:10670
        _this.fps_rpsCnt++;
        //$LASTPOS=100010690;//kernel.Boot:10690
        Tonyu.globals.$frameCount++;
      },
      afterDraw :function _trc_Boot_afterDraw(e) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100010863;//kernel.Boot:10863
        Tonyu.globals.$Sprites.checkHit();
        //$LASTPOS=100010918;//kernel.Boot:10918
        Tonyu.globals.$Sprites.removeOneframes(e.drawn);
        //$LASTPOS=100010958;//kernel.Boot:10958
        _this.sendEvent("afterDraw",e);
      },
      initFPSParams :function _trc_Boot_initFPSParams() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100011067;//kernel.Boot:11067
        _this._fps=Tonyu.globals.$defaultFPS||30;
        //$LASTPOS=100011098;//kernel.Boot:11098
        _this.maxFrameSkip=5;
        //$LASTPOS=100011121;//kernel.Boot:11121
        _this.minFrameSkip=1;
        //$LASTPOS=100011171;//kernel.Boot:11171
        _this.frameCnt=0;
        //$LASTPOS=100011190;//kernel.Boot:11190
        _this.resetDeadLine();
        //$LASTPOS=100011212;//kernel.Boot:11212
        _this.lastMeasured=_this.now();
        //$LASTPOS=100011237;//kernel.Boot:11237
        _this.fps_fps=_this.fps_rps=_this.fps_fpsCnt=_this.fps_rpsCnt=0;
        //$LASTPOS=100011283;//kernel.Boot:11283
        _this.drawTime=5;
        //$LASTPOS=100011294;//kernel.Boot:11294
        _this.moveTime=5;
        //$LASTPOS=100011352;//kernel.Boot:11352
        _this._useRAF=true;
        //$LASTPOS=100011406;//kernel.Boot:11406
        _this.rafProcNowTime=_this.now();
      },
      now :function _trc_Boot_now() {
        "use strict";
        var _this=this;
        
        return performance.now();
      },
      resetDeadLine :function _trc_Boot_resetDeadLine() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100011514;//kernel.Boot:11514
        _this.deadLine=_this.now()+1000/_this._fps;
        //$LASTPOS=100011545;//kernel.Boot:11545
        _this.frameSkipped=0;
      },
      waitFrame :function _trc_Boot_waitFrame() {
        "use strict";
        var _this=this;
        var wt;
        
        //$LASTPOS=100011589;//kernel.Boot:11589
        wt = _this.deadLine-_this.now();
        
        //$LASTPOS=100011617;//kernel.Boot:11617
        if (wt<1) {
          //$LASTPOS=100011638;//kernel.Boot:11638
          if (wt<- 1000) {
            //$LASTPOS=100011652;//kernel.Boot:11652
            _this.resetDeadLine();
          }
          //$LASTPOS=100011678;//kernel.Boot:11678
          wt=1;
          
        }
        //$LASTPOS=100011696;//kernel.Boot:11696
        wt=_this.floor(wt);
        //$LASTPOS=100011715;//kernel.Boot:11715
        _this.waitFor(Tonyu.timeout(wt));
        //$LASTPOS=100011748;//kernel.Boot:11748
        _this.deadLine+=1000/_this._fps;
      },
      fiber$waitFrame :function _trc_Boot_f_waitFrame(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        var wt;
        
        //$LASTPOS=100011589;//kernel.Boot:11589
        wt = _this.deadLine-_this.now();
        
        //$LASTPOS=100011617;//kernel.Boot:11617
        if (wt<1) {
          //$LASTPOS=100011638;//kernel.Boot:11638
          if (wt<- 1000) {
            //$LASTPOS=100011652;//kernel.Boot:11652
            _this.resetDeadLine();
          }
          //$LASTPOS=100011678;//kernel.Boot:11678
          wt=1;
          
        }
        //$LASTPOS=100011696;//kernel.Boot:11696
        wt=_this.floor(wt);
        
        _thread.enter(function _trc_Boot_ent_waitFrame(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=100011715;//kernel.Boot:11715
              _this.fiber$waitFor(_thread, Tonyu.timeout(wt));
              __pc=1;return;
            case 1:
              
              //$LASTPOS=100011748;//kernel.Boot:11748
              _this.deadLine+=1000/_this._fps;
              _thread.exit(_this);return;
            }
          }
        });
      },
      getFrameRate :function _trc_Boot_getFrameRate() {
        "use strict";
        var _this=this;
        
        return _this._fps;
      },
      setFrameRate :function _trc_Boot_setFrameRate(fps,maxFrameSkip) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100011908;//kernel.Boot:11908
        _this._fps=fps;
        //$LASTPOS=100011925;//kernel.Boot:11925
        if (typeof  maxFrameSkip!="number") {
          //$LASTPOS=100011960;//kernel.Boot:11960
          maxFrameSkip=5;
        }
        //$LASTPOS=100011981;//kernel.Boot:11981
        if (maxFrameSkip<=0) {
          //$LASTPOS=100012002;//kernel.Boot:12002
          maxFrameSkip=1;
        }
        //$LASTPOS=100012023;//kernel.Boot:12023
        _this.maxFrameSkip=maxFrameSkip;
        //$LASTPOS=100012062;//kernel.Boot:12062
        _this.resetDeadLine();
      },
      __getter__useRAF :function _trc_Boot___getter__useRAF() {
        "use strict";
        var _this=this;
        
        return _this._useRAF;
      },
      __setter__useRAF :function _trc_Boot___setter__useRAF(v) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100012166;//kernel.Boot:12166
        if (v) {
          //$LASTPOS=100012184;//kernel.Boot:12184
          _this.rafProcNowTime=_this.now();
          
        } else {
          //$LASTPOS=100012229;//kernel.Boot:12229
          _this.resetDeadLine();
          
        }
        return _this._useRAF=v;
      },
      getMeasuredFps :function _trc_Boot_getMeasuredFps() {
        "use strict";
        var _this=this;
        
        return _this.fps_fps;
      },
      getMeasuredRps :function _trc_Boot_getMeasuredRps() {
        "use strict";
        var _this=this;
        
        return _this.fps_rps;
      },
      measureFps :function _trc_Boot_measureFps() {
        "use strict";
        var _this=this;
        var nowTime;
        
        //$LASTPOS=100012467;//kernel.Boot:12467
        nowTime = _this.now();
        
        //$LASTPOS=100012493;//kernel.Boot:12493
        if (nowTime>=_this.lastMeasured+1000) {
          //$LASTPOS=100012536;//kernel.Boot:12536
          _this.fps_fps=_this.fps_fpsCnt;
          //$LASTPOS=100012565;//kernel.Boot:12565
          _this.fps_rps=_this.fps_rpsCnt;
          //$LASTPOS=100012594;//kernel.Boot:12594
          _this.fps_fpsCnt=0;
          //$LASTPOS=100012617;//kernel.Boot:12617
          _this.fps_rpsCnt=0;
          //$LASTPOS=100012640;//kernel.Boot:12640
          _this.lastMeasured=nowTime;
          
        }
      },
      requestDrawFrame :function _trc_Boot_requestDrawFrame() {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100012700;//kernel.Boot:12700
        if (! _this.isIdle) {
          return _this;
        }
        //$LASTPOS=100012726;//kernel.Boot:12726
        if (_this._drawFrameRequested) {
          return _this;
        }
        //$LASTPOS=100012764;//kernel.Boot:12764
        _this._drawFrameRequested=true;
        //$LASTPOS=100012795;//kernel.Boot:12795
        requestAnimationFrame((function anonymous_12817() {
          
          //$LASTPOS=100012829;//kernel.Boot:12829
          _this.drawFrame();
          //$LASTPOS=100012851;//kernel.Boot:12851
          _this._drawFrameRequested=false;
        }));
      },
      fiber$requestDrawFrame :function _trc_Boot_f_requestDrawFrame(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100012700;//kernel.Boot:12700
        if (! _this.isIdle) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=100012726;//kernel.Boot:12726
        if (_this._drawFrameRequested) {
          _thread.retVal=_this;return;
          
        }
        //$LASTPOS=100012764;//kernel.Boot:12764
        _this._drawFrameRequested=true;
        //$LASTPOS=100012795;//kernel.Boot:12795
        requestAnimationFrame((function anonymous_12817() {
          
          //$LASTPOS=100012829;//kernel.Boot:12829
          _this.drawFrame();
          //$LASTPOS=100012851;//kernel.Boot:12851
          _this._drawFrameRequested=false;
        }));
        
        _thread.retVal=_this;return;
      },
      setEconomyMode :function _trc_Boot_setEconomyMode(options) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=100012953;//kernel.Boot:12953
        _this.economyMode=options;
      },
      fiber$setEconomyMode :function _trc_Boot_f_setEconomyMode(_thread,options) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        //$LASTPOS=100012953;//kernel.Boot:12953
        _this.economyMode=options;
        
        _thread.retVal=_this;return;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"initSymbol":{"nowait":false},"timeStop":{"nowait":false},"update":{"nowait":false},"initGlobals":{"nowait":false},"initPeripherals":{"nowait":false},"initLayers":{"nowait":false},"debug":{"nowait":false},"loadPlugins":{"nowait":false},"loadImages":{"nowait":false},"loadSounds":{"nowait":false},"createMainObject":{"nowait":false},"loadPage":{"nowait":false},"stop":{"nowait":false},"hide":{"nowait":true},"schedule":{"nowait":false},"progress":{"nowait":false},"progressNoLog":{"nowait":false},"mainLoop":{"nowait":false},"loopRAF":{"nowait":false},"waitRAF":{"nowait":false},"loopTimer":{"nowait":false},"handlePause":{"nowait":false},"drawFrame":{"nowait":true},"moveFrame":{"nowait":true},"afterDraw":{"nowait":true},"initFPSParams":{"nowait":true},"now":{"nowait":true},"resetDeadLine":{"nowait":true},"waitFrame":{"nowait":false},"getFrameRate":{"nowait":true},"setFrameRate":{"nowait":true},"__getter__useRAF":{"nowait":true},"__setter__useRAF":{"nowait":true},"getMeasuredFps":{"nowait":true},"getMeasuredRps":{"nowait":true},"measureFps":{"nowait":true},"requestDrawFrame":{"nowait":false},"setEconomyMode":{"nowait":false}},"fields":{"window":{},"cvj":{},"debugCnt":{},"newLimit":{},"mainClass":{},"_useRAF":{},"_fps":{},"subTime":{},"rafProcNowTime":{},"procCnt":{},"maxFrameSkip":{},"doDraw":{},"deadLine":{},"frameSkipped":{},"economyMode":{},"isIdle":{},"paused":{},"drawTime":{},"fps_fpsCnt":{},"newLimitCount":{},"moveTime":{},"fps_rpsCnt":{},"minFrameSkip":{},"frameCnt":{},"lastMeasured":{},"fps_fps":{},"fps_rps":{},"_drawFrameRequested":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.ConsolePanel',
  shortName: 'ConsolePanel',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Panel,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_ConsolePanel_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_ConsolePanel_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_ConsolePanel_initialize(opt) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=101000053;//kernel.ConsolePanel:53
        _this.printAry=[];
        //$LASTPOS=101000071;//kernel.ConsolePanel:71
        _this.printStart=0;
        //$LASTPOS=101000090;//kernel.ConsolePanel:90
        _this.printCnt=0;
        //$LASTPOS=101000107;//kernel.ConsolePanel:107
        _this.screenCol=null;
        //$LASTPOS=101000128;//kernel.ConsolePanel:128
        _this.defaultCol="white";
        //$LASTPOS=101000153;//kernel.ConsolePanel:153
        __superClass.apply( _this, [opt]);
      },
      print :function _trc_ConsolePanel_print() {
        "use strict";
        var _this=this;
        var mergedArg;
        var argCount;
        var printColor;
        var printSize;
        var splits;
        var printCount;
        
        //$LASTPOS=101000187;//kernel.ConsolePanel:187
        mergedArg = "";
        
        //$LASTPOS=101000210;//kernel.ConsolePanel:210
        //$LASTPOS=101000214;//kernel.ConsolePanel:214
        argCount = 0;
        for (; argCount<arguments.length ; argCount++) {
          {
            //$LASTPOS=101000277;//kernel.ConsolePanel:277
            mergedArg=mergedArg+arguments[argCount]+" ";
          }
        }
        //$LASTPOS=101000334;//kernel.ConsolePanel:334
        if (Tonyu.globals.$printColor==null&&Tonyu.globals.$Screen) {
          //$LASTPOS=101000377;//kernel.ConsolePanel:377
          if (Tonyu.globals.$Screen._color!=_this.screenCol) {
            //$LASTPOS=101000425;//kernel.ConsolePanel:425
            _this.screenCol=Tonyu.globals.$Screen._color;
            //$LASTPOS=101000464;//kernel.ConsolePanel:464
            _this.defaultCol=new Tonyu.classes.kernel.Color(Tonyu.globals.$Screen._color).l<=0.5?"white":"black";
            
          }
          
        }
        //$LASTPOS=101000552;//kernel.ConsolePanel:552
        printColor = Tonyu.globals.$printColor!=null?Tonyu.globals.$printColor:_this.defaultCol;
        
        //$LASTPOS=101000618;//kernel.ConsolePanel:618
        printSize = ! Tonyu.globals.$printSize?20:Tonyu.globals.$printSize;
        
        //$LASTPOS=101000668;//kernel.ConsolePanel:668
        splits = mergedArg.split("\n");
        
        //$LASTPOS=101000707;//kernel.ConsolePanel:707
        //$LASTPOS=101000711;//kernel.ConsolePanel:711
        printCount = 0;
        for (; printCount<splits.length ; printCount++) {
          {
            //$LASTPOS=101000976;//kernel.ConsolePanel:976
            _this.printAry.push({text: splits[printCount],color: printColor,size: printSize});
            //$LASTPOS=101001061;//kernel.ConsolePanel:1061
            _this.printCnt++;
          }
        }
      },
      draw :function _trc_ConsolePanel_draw(ctx) {
        "use strict";
        var _this=this;
        var scrollY;
        var i;
        var p;
        var drawY;
        var a;
        
        //$LASTPOS=101001103;//kernel.ConsolePanel:1103
        scrollY = 0;
        
        //$LASTPOS=101001123;//kernel.ConsolePanel:1123
        //$LASTPOS=101001127;//kernel.ConsolePanel:1127
        i = _this.printStart;
        for (; i<_this.printStart+_this.printCnt ; i++) {
          {
            //$LASTPOS=101001183;//kernel.ConsolePanel:1183
            p = _this.printAry[i];
            
            //$LASTPOS=101001211;//kernel.ConsolePanel:1211
            if (! p) {
              continue;
              
            }
            //$LASTPOS=101001236;//kernel.ConsolePanel:1236
            scrollY+=p.size;
            //$LASTPOS=101001264;//kernel.ConsolePanel:1264
            if (scrollY>Tonyu.globals.$screenHeight) {
              break;
              
            }
          }
        }
        //$LASTPOS=101001308;//kernel.ConsolePanel:1308
        if (scrollY>0) {
          //$LASTPOS=101001332;//kernel.ConsolePanel:1332
          Tonyu.globals.$consolePanel.scroll(0,scrollY);
          //$LASTPOS=101001374;//kernel.ConsolePanel:1374
          drawY = Tonyu.globals.$consolePrintY;
          
          //$LASTPOS=101001409;//kernel.ConsolePanel:1409
          a = 0;
          
          //$LASTPOS=101001427;//kernel.ConsolePanel:1427
          //$LASTPOS=101001431;//kernel.ConsolePanel:1431
          i = _this.printStart+_this.printCnt-1;
          for (; i>=_this.printStart ; i--) {
            {
              //$LASTPOS=101001494;//kernel.ConsolePanel:1494
              p = _this.printAry[i];
              
              //$LASTPOS=101001526;//kernel.ConsolePanel:1526
              if (! p) {
                continue;
                
              }
              //$LASTPOS=101001555;//kernel.ConsolePanel:1555
              Tonyu.globals.$consolePanel.setFillStyle(p.color);
              //$LASTPOS=101001605;//kernel.ConsolePanel:1605
              Tonyu.globals.$consolePanel.fillText(p.text,0,drawY,p.size,"left","bottom");
              //$LASTPOS=101001681;//kernel.ConsolePanel:1681
              drawY-=p.size;
              //$LASTPOS=101001709;//kernel.ConsolePanel:1709
              a++;
              //$LASTPOS=101001727;//kernel.ConsolePanel:1727
              if (drawY<0) {
                //$LASTPOS=101001757;//kernel.ConsolePanel:1757
                _this.printCnt-=i;
                //$LASTPOS=101001787;//kernel.ConsolePanel:1787
                _this.printAry.splice(0,i);
                break;
                
                
              }
            }
          }
          //$LASTPOS=101001868;//kernel.ConsolePanel:1868
          _this.printStart=_this.printCnt;
          
        }
        //$LASTPOS=101001943;//kernel.ConsolePanel:1943
        __superClass.prototype.draw.apply( _this, [ctx]);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"print":{"nowait":true},"draw":{"nowait":true}},"fields":{"printAry":{},"printStart":{},"printCnt":{},"screenCol":{},"defaultCol":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.FadeEffect',
  shortName: 'FadeEffect',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.Panel,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_FadeEffect_main() {
        "use strict";
        var _this=this;
        
        
        
        
        //$LASTPOS=102000070;//kernel.FadeEffect:70
        _this.fillStyle = _this.fillStyle||"black";
        
        
        
        //$LASTPOS=102000159;//kernel.FadeEffect:159
        _this.duration = _this.duration||30;
        
        switch (_this.type) {
        case "in":
          //$LASTPOS=102000228;//kernel.FadeEffect:228
          _this.alpha=255;
          //$LASTPOS=102000238;//kernel.FadeEffect:238
          _this.alphaTo=0;
          break;
          
        case "out":
          //$LASTPOS=102000275;//kernel.FadeEffect:275
          _this.alpha=0;
          //$LASTPOS=102000283;//kernel.FadeEffect:283
          _this.alphaTo=255;
          break;
          
        }
        //$LASTPOS=102000304;//kernel.FadeEffect:304
        _this.fillRect(0,0,Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
        //$LASTPOS=102000346;//kernel.FadeEffect:346
        _this.sa=_this.alpha;
        //$LASTPOS=102000356;//kernel.FadeEffect:356
        //$LASTPOS=102000361;//kernel.FadeEffect:361
        _this.i=0;for (; _this.i<_this.duration ; _this.i++) {
          {
            //$LASTPOS=102000387;//kernel.FadeEffect:387
            _this.progress=_this.i/(_this.duration-1);
            //$LASTPOS=102000416;//kernel.FadeEffect:416
            _this.alpha=_this.alphaTo*_this.progress+_this.sa*(1-_this.progress);
            //$LASTPOS=102000460;//kernel.FadeEffect:460
            _this.update();
          }
        }
        //$LASTPOS=102000472;//kernel.FadeEffect:472
        _this.sendEvent("complete");
        //$LASTPOS=102000495;//kernel.FadeEffect:495
        if (_this.page) {
          //$LASTPOS=102000511;//kernel.FadeEffect:511
          _this.loadPage(_this.page,_this.params||{});
          
        }
      },
      fiber$main :function _trc_FadeEffect_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        
        
        //$LASTPOS=102000070;//kernel.FadeEffect:70
        _this.fillStyle = _this.fillStyle||"black";
        
        
        
        //$LASTPOS=102000159;//kernel.FadeEffect:159
        _this.duration = _this.duration||30;
        
        switch (_this.type) {
        case "in":
          //$LASTPOS=102000228;//kernel.FadeEffect:228
          _this.alpha=255;
          //$LASTPOS=102000238;//kernel.FadeEffect:238
          _this.alphaTo=0;
          break;
          
        case "out":
          //$LASTPOS=102000275;//kernel.FadeEffect:275
          _this.alpha=0;
          //$LASTPOS=102000283;//kernel.FadeEffect:283
          _this.alphaTo=255;
          break;
          
        }
        //$LASTPOS=102000304;//kernel.FadeEffect:304
        _this.fillRect(0,0,Tonyu.globals.$screenWidth,Tonyu.globals.$screenHeight);
        //$LASTPOS=102000346;//kernel.FadeEffect:346
        _this.sa=_this.alpha;
        
        _thread.enter(function _trc_FadeEffect_ent_main(_thread) {
          if (_thread.lastEx) __pc=_thread.catchPC;
          for(var __cnt=100 ; __cnt--;) {
            switch (__pc) {
            case 0:
              //$LASTPOS=102000356;//kernel.FadeEffect:356
              //$LASTPOS=102000361;//kernel.FadeEffect:361
              _this.i=0;
            case 1:
              if (!(_this.i<_this.duration)) { __pc=4     ; break; }
              //$LASTPOS=102000387;//kernel.FadeEffect:387
              _this.progress=_this.i/(_this.duration-1);
              //$LASTPOS=102000416;//kernel.FadeEffect:416
              _this.alpha=_this.alphaTo*_this.progress+_this.sa*(1-_this.progress);
              //$LASTPOS=102000460;//kernel.FadeEffect:460
              _this.fiber$update(_thread);
              __pc=2;return;
            case 2:
              
            case 3     :
              _this.i++;
              __pc=1;break;
            case 4     :
              
              //$LASTPOS=102000472;//kernel.FadeEffect:472
              _this.sendEvent("complete");
              //$LASTPOS=102000495;//kernel.FadeEffect:495
              if (!(_this.page)) { __pc=6     ; break; }
              //$LASTPOS=102000511;//kernel.FadeEffect:511
              _this.fiber$loadPage(_thread, _this.page, _this.params||{});
              __pc=5;return;
            case 5:
              
            case 6     :
              
              _thread.exit(_this);return;
            }
          }
        });
      },
      __getter__defaultLayer :function _trc_FadeEffect___getter__defaultLayer() {
        "use strict";
        var _this=this;
        
        return Tonyu.globals.$frontLayer;
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"__getter__defaultLayer":{"nowait":true}},"fields":{"type":{},"alphaTo":{},"alpha":{},"fillStyle":{},"page":{},"params":{},"duration":{},"sa":{},"i":{},"progress":{}}}
});
Tonyu.klass.define({
  fullName: 'kernel.DxChar',
  shortName: 'DxChar',
  namespace: 'kernel',
  superclass: Tonyu.classes.kernel.SpriteChar,
  includes: [],
  methods: function (__superClass) {
    return {
      main :function _trc_DxChar_main() {
        "use strict";
        var _this=this;
        
      },
      fiber$main :function _trc_DxChar_f_main(_thread) {
        "use strict";
        var _this=this;
        //var _arguments=Tonyu.A(arguments);
        var __pc=0;
        
        
        _thread.retVal=_this;return;
      },
      initialize :function _trc_DxChar_initialize(xx,yy,pp,ff,sz,rt,al) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=103000057;//kernel.DxChar:57
        __superClass.apply( _this, [xx,yy,pp,ff]);
        //$LASTPOS=103000082;//kernel.DxChar:82
        _this.scaleX=1;
        //$LASTPOS=103000097;//kernel.DxChar:97
        if (sz) {
          //$LASTPOS=103000105;//kernel.DxChar:105
          _this.scaleX=sz;
        }
        //$LASTPOS=103000121;//kernel.DxChar:121
        _this.angle=0;
        //$LASTPOS=103000135;//kernel.DxChar:135
        if (rt) {
          //$LASTPOS=103000143;//kernel.DxChar:143
          _this.angle=rt;
        }
        //$LASTPOS=103000158;//kernel.DxChar:158
        _this.alpha=255;
        //$LASTPOS=103000174;//kernel.DxChar:174
        if (al) {
          //$LASTPOS=103000182;//kernel.DxChar:182
          _this.alpha=al;
        }
      },
      draw :function _trc_DxChar_draw(c) {
        "use strict";
        var _this=this;
        
        //$LASTPOS=103000212;//kernel.DxChar:212
        if (_this._isInvisible) {
          return _this;
        }
        //$LASTPOS=103000243;//kernel.DxChar:243
        _this.onDraw();
        //$LASTPOS=103000258;//kernel.DxChar:258
        _this.prepareImage();
        //$LASTPOS=103000279;//kernel.DxChar:279
        _this.drawDxSprite(_this.x,_this.y,_this.p,_this.f,_this.zOrder,_this.angle,_this.alpha,_this.scaleX,_this.scaleY);
      },
      __dummy: false
    };
  },
  decls: {"methods":{"main":{"nowait":false},"new":{"nowait":false},"draw":{"nowait":true}},"fields":{"angle":{}}}
});

//# sourceMappingURL=concat.js.map