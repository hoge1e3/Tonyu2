function HttpHelper(t){var e={},n=t.lineMark;return e.buf=$("<div>"),e.bufs=[e.buf],e.maxLineNo=-1,e.cur=function(){return e.bufs[e.bufs.length-1]},e.p=function(t){"string"==typeof t&&(t=t.length>0?$("<span>").text(t):null),e.cur()?(e.lineNo>e.maxLineNo&&(e.maxLineNo=e.lineNo,e.cur().append($("<a>").attr({id:n+"-"+e.lineNo,name:n+"-"+e.lineNo}))),t&&e.cur().append(t)):console.log("Warning - Stack underflow")},e.enter=function(t){"string"==typeof t&&(t=$(t)),e.bufs.push(t)},e.exit=function(){var t=e.bufs.pop();e.p(t)},e.h=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},e}!function(){var t={};return t.def=function(e,n,r){var i=t.getModuleInfo(t.curName);i.type=r,t.setReqs(i,e),i.func=function(){return n.apply(this,t.getObjs(e))},t.loadIfAvailable(i)},define=function(e,n){t.def(e,n,"define")},requirejs=function(e,n){t.def(e,n,"require")},t.setReqs=function(e,n){n.forEach(function(n){var r=t.getModuleInfo(n);r.loaded||(e.reqs[n]=r,r.revReqs[e.name]=e)})},t.getModuleInfo=function(e){var n=t.modules;return n[e]||(n[e]={name:e,reqs:{},revReqs:{}}),n[e]},t.doLoad=function(e){var n=t.getModuleInfo(e);if(n.loaded)return n.obj;n.loaded=!0;var r=null;if(n.func)r=n.func();else{var i=e.split(/\./);r=function(){return this}(),i.forEach(function(t){r&&(r=r[t])}),null==r&&console.log("Warning: No obj for "+e)}if("define"==n.type&&null==r)throw"No obj for "+e;n.obj=r;for(var o in n.revReqs)t.notifyLoaded(n.revReqs[o],n.name);return r},t.notifyLoaded=function(e,n){delete e.reqs[n],t.loadIfAvailable(e)},t.loadIfAvailable=function(e){for(var n in e.reqs)return;t.doLoad(e.name)},t.getObjs=function(e){var n=[];return e.forEach(function(e){var r=t.doLoad(e);n.push(r)}),n},t.modules={},t.setName=function(e){t.curName&&(t.getModuleInfo(t.curName).func||t.doLoad(t.curName)),e&&(t.curName=e)},requireSimulator=t,t}(),requireSimulator.setName("extend"),define([],function(){return function(t,e){for(var n in e)t[n]=e[n]}}),requireSimulator.setName("assert"),define([],function(){function t(e){if(e instanceof Array){var n=[];return e.forEach(function(e){n=n.concat(t(e))}),n}return[e]}var e=function(e){this.failMesg=t(e||"Assertion failed: ")};e.prototype={fail:function(){var e=$a(arguments);throw e=t(e),e=this.failMesg.concat(e),console.log.apply(console,e),new Error(e.join(" "))},subAssertion:function(){var n=$a(arguments);return n=t(n),new e(this.failMesg.concat(n))},assert:function(t,e){return t||this.fail(e),t},eq:function(t,e){return t!==e&&this.fail(t,"!==",e),t},is:function(t,e){var n=e,r=t;if(null==n)return n;if(n._assert_func)return n._assert_func.apply(this,[r]),t;if(this.assert(null!=t,[t,"should be ",n]),n instanceof Array||"object"==typeof global&&"function"==typeof global.Array&&n instanceof global.Array){t&&"number"==typeof t.length||this.fail(t,"should be array:");for(var i=this,o=0;o<n.length;o++){var s=i.subAssertion("failed at ",t,"[",o,"]: ");s.is(r[o],n[o])}return t}if(n===String||"string"==n)return this.assert("string"==typeof r,[r,"should be a string "]),t;if(n===Number||"number"==n)return this.assert("number"==typeof r,[r,"should be a number"]),t;if(n instanceof RegExp||"object"==typeof global&&"function"==typeof global.RegExp&&n instanceof global.RegExp)return this.is(r,String),this.assert(n.exec(r),[r,"does not match to",n]),t;if("function"==typeof n)return this.assert(r instanceof n,[r,"should be ",n]),t;if(n&&"object"==typeof n){for(var a in n){var s=this.subAssertion("failed at ",t,".",a,":");s.is(t[a],n[a])}return t}this.fail("Invaild type: ",n)},ensureError:function(t,e){try{t()}catch(n){return"string"==typeof e&&r(n+""===e,t+" thrown an error "+n+" but expected:"+e),void console.log("Error thrown successfully: ",n.message)}this.fail(t,"should throw an error",e)}},$a=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e};var n=new e,r=function(){try{return n.assert.apply(n,arguments)}catch(t){throw new Error(t.message)}};return r.is=function(){try{return n.is.apply(n,arguments)}catch(t){throw new Error(t.message)}},r.eq=function(){try{return n.eq.apply(n,arguments)}catch(t){throw new Error(t.message)}},r.ensureError=function(){try{return n.ensureError.apply(n,arguments)}catch(t){throw new Error(t.message)}},r.fail=n.fail.bind(n),r.f=function(t){return{_assert_func:t}},r.and=function(){var t=$a(arguments);return r(t instanceof Array),r.f(function(e){for(var n=this,r=0;r<t.length;r++)n.is(e,t[r])})},r}),requireSimulator.setName("PathUtil"),define(["assert"],function(t){function e(e,n){return t.is(arguments,[String,String]),e.substring(e.length-n.length)===n}function n(e,n){return t.is(arguments,[String,String]),e.substring(0,n.length)===n}var r,i=/^([a-zA-Z]):/,o=t.f(function(t){this.is(t,String),this.assert(r.isPath(t),[t," is not a path"])}),s=t.f(function(t){this.is(t,String),this.assert(r.isAbsolutePath(t),[t," is not a absolute path"])}),a=t.f(function(t){this.is(t,String),this.assert(!r.isAbsolutePath(t),[t," is not a relative path"])}),u=t.and(c,s),c=t.f(function(t){this.is(t,o),this.assert(r.isDir(t),[t," is not a directory path"])}),l=t.f(function(t){this.is(t,o),this.assert(!r.isDir(t),[t," is not a file path"])}),f="/";return r={Path:o,Absolute:s,Relative:a,Dir:c,File:l,AbsDir:u,SEP:f,endsWith:e,startsWith:n,hasDriveLetter:function(t){return i.exec(t)},isPath:function(e){return t.is(arguments,[String]),!e.match(/\/\//)},isRelativePath:function(e){return t.is(arguments,[String]),r.isPath(e)&&!r.isAbsolutePath(e)},isAbsolutePath:function(e){return t.is(arguments,[String]),r.isPath(e)&&(r.startsWith(e,f)||r.hasDriveLetter(e))},isDir:function(n){return t.is(arguments,[o]),e(n,f)},splitPath:function(e){t.is(arguments,[o]);var n=e.split(f);return""==n[n.length-1]&&(n[n.length-2]+=f,n.pop()),n},name:function(e){return t.is(arguments,[String]),r.splitPath(e).pop()},ext:function(e){t.is(arguments,[String]);var n=r.name(e),i=/\.[a-zA-Z0-9]+$/.exec(n);return i?i[0]:null},truncExt:function(e,n){t.is(e,String);var i=r.name(e);return n=n||r.ext(e),t.is(n,String),i.substring(0,i.length-n.length)},truncSEP:function(e){return t.is(arguments,[o]),r.isDir(e)?e.substring(0,e.length-1):e},endsWith:function(n,i){return t.is(arguments,[String,String]),e(r.name(n),i)},parent:function(e){return t.is(arguments,[String]),r.up(e)},rel:function(e,n){if(""==n)return e;t.is(arguments,[u,a]);var i=r.splitPath(n),o=e;o=o.replace(/\/$/,"");var s=r;return i.forEach(function(t){".."==t||"../"==t?o=s.up(o):(o=o.replace(/\/$/,""),o+=f+("."==t||"./"==t?"":t))}),o},relPath:function(e,n){return t.is(arguments,[u,u]),e.substring(0,n.length)!=n?"../"+r.relPath(e,this.up(n)):e.substring(n.length)},up:function(e){if(t.is(arguments,[o]),e==f)return null;var n=r.splitPath(e);return n.pop(),n.join(f)+f}}}),requireSimulator.setName("MIMETypes"),define([],function(){return{".png":"image/png",".gif":"image/gif",".jpeg":"image/jpeg",".jpg":"image/jpeg",".ico":"image/icon",".mp3":"audio/mp3",".ogg":"audio/ogg",".txt":"text/plain",".html":"text/html",".htm":"text/html",".css":"text/css",".js":"text/javascript",".json":"text/json",".zip":"application/zip",".swf":"application/x-shockwave-flash",".pdf":"application/pdf",".doc":"application/word",".xls":"application/excel",".ppt":"application/powerpoint",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".docm":"application/vnd.ms-word.document.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dotm":"application/vnd.ms-word.template.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".tonyu":"text/tonyu"}}),requireSimulator.setName("DataURL"),define(["extend","assert"],function(t,e){function n(t){return t instanceof ArrayBuffer||"undefined"!=typeof Buffer&&t instanceof Buffer}function r(t){function e(e){throw console.log(e),console.log(t,l),new Error(e)}t=t.replace(/[\n=]/g,"");var n=new Object;n[65]=0,n[66]=1,n[67]=2,n[68]=3,n[69]=4,n[70]=5,n[71]=6,n[72]=7,n[73]=8,n[74]=9,n[75]=10,n[76]=11,n[77]=12,n[78]=13,n[79]=14,n[80]=15,n[81]=16,n[82]=17,n[83]=18,n[84]=19,n[85]=20,n[86]=21,n[87]=22,n[88]=23,n[89]=24,n[90]=25,n[97]=26,n[98]=27,n[99]=28,n[100]=29,n[101]=30,n[102]=31,n[103]=32,n[104]=33,n[105]=34,n[106]=35,n[107]=36,n[108]=37,n[109]=38,n[110]=39,n[111]=40,n[112]=41,n[113]=42,n[114]=43,n[115]=44,n[116]=45,n[117]=46,n[118]=47,n[119]=48,n[120]=49,n[121]=50,n[122]=51,n[48]=52,n[49]=53,n[50]=54,n[51]=55,n[52]=56,n[53]=57,n[54]=58,n[55]=59,n[56]=60,n[57]=61,n[43]=62,n[47]=63;var r,i=t.length,s=0,a=0;if(!i)return new o(0);r=Math.floor(i/4*3),"="==t.charAt(i-1)&&(r-=1),"="==t.charAt(i-2)&&(r-=1);for(var u=new o(r),c="undefined"!=typeof Buffer?u:new Uint8Array(u),l=0,f=0;r>f&&(a=n[t.charCodeAt(l)],void 0===a&&e("Invalid letter: "+t.charCodeAt(l)),s=a<<2,l++,a=n[t.charCodeAt(l)],void 0===a&&e("Invalid letter: "+t.charCodeAt(l)),c[f]=s|a>>4&3,s=(15&a)<<4,l++,f++,!(f>=r))&&(a=n[t.charCodeAt(l)],void 0===a&&e("Invalid letter: "+t.charCodeAt(l)),c[f]=s|a>>2&15,s=(3&a)<<6,l++,f++,!(f>=r));)a=n[t.charCodeAt(l)],void 0===a&&e("Invalid letter: "+t.charCodeAt(l)),c[f]=s|a,l++,f++;return u}function i(t){for(var e=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],n="",r=new Uint8Array(t),i=r.length,o=0,s=0,a=0;i>a&&(s=r[a],n+=e[s>>2],o=(3&s)<<4,a++,!(a>=i))&&(s=r[a],n+=e[o|s>>4],o=(15&s)<<2,a++,!(a>=i));)s=r[a],n+=e[o|s>>6],n+=e[63&s],a++;var u=i%3;return u&&(n+=e[o]),1==u?n+="==":2==u&&(n+="="),n}var o="undefined"!=typeof Buffer?Buffer:ArrayBuffer,s=function(t,r){"string"==typeof t?(this.url=t,this.dataURL2bin(t)):t&&n(t.buffer)?(this.buffer=t.buffer,e.is(r,String),this.contentType=r,this.bin2dataURL(this.buffer,this.contentType)):n(t)?(this.buffer=t,e.is(r,String),this.contentType=r,this.bin2dataURL(this.buffer,this.contentType)):e.fail("Invalid args: ",arguments)};return t(s.prototype,{bin2dataURL:function(t,r){e(n(t)),e.is(r,String);var o=this.dataHeader(r),s=i(t);return e.is(s,String),this.url=o+s},dataURL2bin:function(t){e.is(arguments,[String]);var n=/^data:([^;]+);base64,/i,i=n.exec(t);return e(i,["malformed dataURL:",t]),this.contentType=i[1],this.buffer=r(t.substring(i[0].length)),e.is(this.buffer,o)},dataHeader:function(t){return e.is(arguments,[String]),"data:"+t+";base64,"},toString:function(){return e.is(this.url,String)}}),s}),requireSimulator.setName("Contents"),define(["DataURL"],function(t){var e={convert:function(e,n){var r;if("string"==typeof e&&(r=String),e instanceof t&&(r=t),e instanceof ArrayBuffer&&(r=ArrayBuffer),r==n)return e;throw new Error("Cannot convert from "+r+" to "+n)}};return e}),requireSimulator.setName("Util"),Util=function(){function t(t,n){null==n&&(n=""),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+t+"=([^&#]*)"),i=r.exec(window.location.href);return null==i?n:e(i[1])}function e(t){return decodeURIComponent(t.replace(/\+/g,"%20"))}function n(t,e){return t.substring(t.length-e.length)===e}function r(t,e){return t.substring(0,e.length)===e}function i(t){function e(e){throw console.log(e),console.log(t,c),new Error(e)}t=t.replace(/[\n=]/g,"");var n=new Object;n[65]=0,n[66]=1,n[67]=2,n[68]=3,n[69]=4,n[70]=5,n[71]=6,n[72]=7,n[73]=8,n[74]=9,n[75]=10,n[76]=11,n[77]=12,n[78]=13,n[79]=14,n[80]=15,n[81]=16,n[82]=17,n[83]=18,n[84]=19,n[85]=20,n[86]=21,n[87]=22,n[88]=23,n[89]=24,n[90]=25,n[97]=26,n[98]=27,n[99]=28,n[100]=29,n[101]=30,n[102]=31,n[103]=32,n[104]=33,n[105]=34,n[106]=35,n[107]=36,n[108]=37,n[109]=38,n[110]=39,n[111]=40,n[112]=41,n[113]=42,n[114]=43,n[115]=44,n[116]=45,n[117]=46,n[118]=47,n[119]=48,n[120]=49,n[121]=50,n[122]=51,n[48]=52,n[49]=53,n[50]=54,n[51]=55,n[52]=56,n[53]=57,n[54]=58,n[55]=59,n[56]=60,n[57]=61,n[43]=62,n[47]=63;var r,i=t.length,o=0,s=0;if(!i)return new ArrayBuffer(0);r=Math.floor(i/4*3),"="==t.charAt(i-1)&&(r-=1),"="==t.charAt(i-2)&&(r-=1);for(var a=new ArrayBuffer(r),u=new Uint8Array(a),c=0,l=0;r>l&&(s=n[t.charCodeAt(c)],void 0===s&&e("Invalid letter: "+t.charCodeAt(c)),o=s<<2,c++,s=n[t.charCodeAt(c)],void 0===s&&e("Invalid letter: "+t.charCodeAt(c)),u[l]=o|s>>4&3,o=(15&s)<<4,c++,l++,!(l>=r))&&(s=n[t.charCodeAt(c)],void 0===s&&e("Invalid letter: "+t.charCodeAt(c)),u[l]=o|s>>2&15,o=(3&s)<<6,c++,l++,!(l>=r));)s=n[t.charCodeAt(c)],void 0===s&&e("Invalid letter: "+t.charCodeAt(c)),u[l]=o|s,c++,l++;return a}function o(t){for(var e=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],n="",r=new Uint8Array(t),i=r.length,o=0,s=0,a=0;i>a&&(s=r[a],n+=e[s>>2],o=(3&s)<<4,a++,!(a>=i))&&(s=r[a],n+=e[o|s>>4],o=(15&s)<<2,a++,!(a>=i));)s=r[a],n+=e[o|s>>6],n+=e[63&s],a++;var u=i%3;return u&&(n+=e[o]),1==u?n+="==":2==u&&(n+="="),n}function s(t){if(t.__privatized)return t;var e={__privatized:!0};for(var n in t)!function(n){var r=t[n];n.match(/^_/)||"function"==typeof r&&(e[n]=function(){var e=r.apply(t,arguments);return e})}(n);return e}return{getQueryString:t,endsWith:n,startsWith:r,Base64_To_ArrayBuffer:i,Base64_From_ArrayBuffer:o,privatize:s}}(),requireSimulator.setName("SFile"),define(["Contents","extend","assert","PathUtil","Util"],function(e,n,r,i,o){var s=function(t,e){r.is(e,i.Absolute),r(t&&t.getReturnTypes),this._path=e,this.fs=t,this.isDir()&&!i.isDir(e)&&(this._path+=i.SEP)};return s.is=function(t){return t&&"function"==typeof t.isSFile&&t.isSFile()},s.prototype={isSFile:function(){return!0},setPolicy:function(t){if(this.policy)throw new Error("policy already set");return this.policy=t,this._clone()},_clone:function(){return this._resolve(this.path())},_resolve:function(t,e){var n;if(e=e||{},s.is(t))n=t;else{r.is(t,i.Absolute);var a,u=e.policy||this.policy;if(u&&(a=u.topDir)&&(a.path&&(a=a.path()),!i.startsWith(t,a)))throw new Error(t+": cannot access. Restricted to "+a);n=this.fs.getRootFS().get(t),n.policy=u}return n.policy?o.privatize(n):n},contains:function(t){return r(s.is(t),t+" shoud be a SFile object."),this.isDir()?i.startsWith(t.path(),this.path()):!1},path:function(){return this._path},name:function(){return i.name(this.path())},truncExt:function(t){return i.truncExt(this.path(),t)},ext:function(){return i.ext(this.path())},relPath:function(t){var e=t.path?t.path():t;return i.relPath(this.path(),r.is(e,i.Absolute))},up:function(){var t=this.path(),e=i.up(t);return null==e?null:this._resolve(e)},rel:function(t){r.is(t,i.Relative),this.assertDir();var e=this.path();return this._resolve(i.rel(e,t))},startsWith:function(t){return i.startsWith(this.name(),t)},endsWith:function(t){return i.endsWith(this.name(),t)},equals:function(t){return t&&"function"==typeof t.path&&t.path()==this.path()},toString:function(){return this.path()},touch:function(){this.fs.touch(this.path())},isReadOnly:function(){this.fs.isReadOnly(this.path())},isTrashed:function(){var t=this.metaInfo();return t?t.trashed:!1},metaInfo:function(){return 0==arguments.length?this.getMetaInfo.apply(this,arguments):this.setMetaInfo.apply(this,arguments)},getMetaInfo:function(t){return this.fs.getMetaInfo(this.path(),t)},setMetaInfo:function(t,e){return this.fs.setMetaInfo(this.path(),t,e)},lastUpdate:function(){return r(this.exists()),this.metaInfo().lastUpdate},exists:function(t){t=t||{};var e=this.fs.exists(this.path(),t);return e||t.noFollowLink?e:this._resolveLinkNoPolicy().exists({noFollowLink:!0})},rm:function(t){if(t=t||{},!this.exists({noFollowLink:!0})){var e=this._resolveLinkNoPolicy();if(!this.equals(e))return e.rm(t)}this.isDir()&&(t.recursive||t.r)&&this.each(function(e){e.rm(t)});var n=this.path();this.fs.rm(n,t)},removeWithoutTrash:function(t){t=t||{},t.noTrash=!0,this.rm(t)},isDir:function(){return this.fs.isDir(this.path())},text:function(){var t=this._resolveLinkNoPolicy();return this.equals(t)?arguments.length>0?void this.setText(arguments[0]):this.getText():t.text.apply(t,arguments)},setText:function(t){r.is(t,String),this.fs.setContent(this.path(),t)},getText:function(){return this.fs.getContent(this.path(),{type:String})},isText:function(){return this.fs.isText(this.path())},setBytes:function(e){return r.is(t,ArrayBuffer),this.fs.setContent(e)},getBytes:function(){return this.fs.getContent(this.path(),{type:ArrayBuffer})},getURL:function(){return this.fs.getURL(this.path())},lines:function(){return this.text().split("\n")},obj:function(){var t=this;if(0==arguments.length){var e=t.text();return e?JSON.parse(e):null}t.text(JSON.stringify(r.is(arguments[0],Object)))},copyTo:function(t,e){return t.copyFrom(this,e)},copyFrom:function(t,e){var n=this,e=e||{},o=t.isDir(),s=n.isDir();if(!o&&s&&(n=n.rel(t.name()),r(!n.isDir(),n+" is a directory."),s=!1),o&&!s)this.err("Cannot move dir to file");else{if(!o&&!s)return e.echo&&e.echo(t+" -> "+n),this.fs.cp(r.is(t.path(),i.Absolute),n.path(),e);r(o&&s),t.each(function(t){n.rel(t.name()).copyFrom(t,e)})}},moveFrom:function(t,e){var n=this.copyFrom(t,e);return t.rm({recursive:!0}),n},assertDir:function(){return r.is(this.path(),i.Dir),this},each:function(t,e){var n=this.assertDir();n.listFiles(e).forEach(t)},recursive:function(t,e){var n=this.assertDir();n.each(function(e){e.isDir()?e.recursive(t):t(e)},e)},listFiles:function(t){r(null==t||"object"==typeof t);var e=this.assertDir(),n=this._resolveLinkNoPolicy();if(!this.equals(n))return n.listFiles.apply(n,arguments).map(function(t){return e.rel(t.name())});var i,o=this.path();"function"==typeof t&&(i=t),t=e.convertOptions(t),i||(i=t.order);for(var s=this.fs.opendir(o,t),a=[],u=0;u<s.length;u++){var c=s[u];t.excludes[o+c]||a.push(e.rel(c))}return"function"==typeof i&&a.sort&&a.sort(i),a},ls:function(t){r(null==t||"object"==typeof t);var e=this.assertDir(),n=e.listFiles(t);return n.map(function(t){return t.name()})},convertOptions:function(t){var e=(this.assertDir(),this.path());if(t||(t={}),t.excludes||(t.excludes={}),t.excludes instanceof Array){var n={};t.excludes.forEach(function(t){i.startsWith(t,"/")?n[t]=1:n[e+t]=1}),t.excludes=n}return r.is(t,{excludes:{}})},mkdir:function(){this.touch()},link:function(t,e){t=this._resolve(r(t)),this.fs.link(this.path(),t.path(),e)},_resolveLinkOpt:function(t){var e=this.fs.resolveLink(this.path());return r.is(e,i.Absolute),this._resolve(e,t)},_resolveLinkNoPolicy:function(){return this._resolveLinkOpt({policy:{}})},resolveLink:function(){return this._resolveLinkOpt()},isLink:function(){return this.fs.isLink(this.path())}},s}),requireSimulator.setName("FS2"),define(["extend","PathUtil","MIMETypes","assert","SFile"],function(t,e,n,r,i){function o(t){throw new Error(t+" is STUB!")}var s=function(){};return t(s.prototype,{err:function(t,e){throw new Error(t+": "+e)},fstab:function(){return this._fstab=this._fstab||[]},resolveFS:function(t){r.is(t,e.Absolute);var n;return this.fstab().forEach(function(r){n||e.startsWith(t,r.path)&&(n=r.fs)}),n||(n=this),r.is(n,s)},isReadOnly:function(){o("isReadOnly")},mounted:function(t,n){r.is(arguments,[s,e.AbsDir]),this.parentFS=t,this.mountPoint=n},relFromMountPoint:function(t){return r.is(t,e.Absolute),this.parentFS?(r.is(this.mountPoint,e.AbsDir),e.relPath(t,this.mountPoint)):e.relPath(t,e.SEP)},dirFromFstab:function(t,n){r.is(t,e.AbsDir);var i=(n||{}).res||[];return this.fstab().forEach(function(n){e.up(n.path)==t&&i.push(e.name(n.path))}),i},getRootFS:function(){for(var t,e=this;e;e=e.parentFS)t=e;return r.is(t,s)},getReturnTypes:function(){o("")},getContent:function(){o("")},setContent:function(){o("")},getMetaInfo:function(){o("")},setMetaInfo:function(){o("")},mkdir:function(){o("mkdir")},touch:function(){o("touch")},exists:function(){o("exists")},opendir:function(){o("opendir")},cp:function(t,n,i){r.is(arguments,[e.Absolute,e.Absolute]),i=i||{};var o=this.isDir(t),s=this.resolveFS(n).isDir(n);if(o||s)throw"only file to file supports";var a=this.getContent(t),u=this.resolveFS(n).setContent(n,a);return i.a&&this.setMetaInfo(n,this.getMetaInfo(t)),u},mv:function(t,e,n){return this.cp(t,e,n),this.rm(t,{r:!0})},rm:function(){o("")},link:function(){throw new Error("This FS not support link.")},getURL:function(){o("")}}),s.delegateMethods=function(t,n){for(var i in n)!function(i){t[i]=function(){var t=arguments[0];r.is(t,e.Absolute);var o=this.resolveFS(t);return o!==this?o[i].apply(o,arguments):n[i].apply(this,arguments)}}(i)},s.delegateMethods(s.prototype,{assertWriteable:function(t){this.isReadOnly(t)&&this.err(t,"read only.")},mount:function(t,n){if(r.is(arguments,[e.AbsDir,s]),this.exists(t))throw new Error(t+": Directory exists");var i=e.up(t);if(null==i)throw new Error("Cannot mount on root");if(!this.exists(i))throw new Error(t+": Parent Directory not exist");n.mounted(this,t),this.fstab().unshift({path:t,fs:n})},getContentType:function(t,r){var i=e.ext(t);return n[i]||(r||{}).def||"text/plain"},isText:function(t){var n=this.getContentType(t);return e.startsWith(n,"text")},assertExist:function(t,n){this.exists(t,n)||this.err(t,": No such "+(e.isDir(t)?"directory":"file"))},isDir:function(t){return e.isDir(t)},find:function(t,n){r.is(arguments,[e.Absolute]);var i=this.opendir(t,n),o=this,s=[t];return i.forEach(function(r){var i=e.rel(t,r);if(e.isDir(i)){var a=o.resolveFS(i);s=s.concat(a.find(i,n))}else s.push(i)}),s},resolveLink:function(t){r.is(t,e.Absolute);for(var n=t;n;n=e.up(n)){r(!this.mountPoint||e.startsWith(n,this.mountPoint),n+" is out of mountPoint. path="+t);var i=this.isLink(n);if(i){r(i!=n,"l==p=="+i);var o=e.rel(i,e.relPath(t,n));return r(o!=t,"np==path=="+o),r.is(this.getRootFS().resolveFS(o).resolveLink(o),e.Absolute)}if(this.exists(n))return t}return t},isLink:function(){return null},get:function(t){return r.eq(this.resolveFS(t),this),new i(this,t)}}),s}),requireSimulator.setName("WebSite"),define([],function(){var t,e=document.location.href,n=!!e.match(/html\/dev\//)&&!!e.match(/localhost:3/);t=e.match(/jsrun\.it/)?{urlAliases:{"images/Ball.png":"http://jsrun.it/assets/9/X/T/b/9XTbt.png","images/base.png":"http://jsrun.it/assets/6/F/y/3/6Fy3B.png","images/Sample.png":"http://jsrun.it/assets/s/V/S/l/sVSlZ.png","images/neko.png":"http://jsrun.it/assets/f/D/z/z/fDzze.png","images/mapchip.png":"http://jsrun.it/assets/f/u/N/v/fuNvz.png","images/inputPad.png":"http://jsrun.it/assets/r/K/T/Y/rKTY9.png"},top:"",devMode:n,pluginTop:"http://tonyuedit.appspot.com/js/plugins",removeJSOutput:!0}:e.match(/tonyuexe\.appspot\.com/)||e.match(/localhost:8887/)||e.match(/\/html\/((dev)|(build))\//)?{urlAliases:{"images/Ball.png":"../../images/Ball.png","images/base.png":"../../images/base.png","images/Sample.png":"../../images/Sample.png","images/neko.png":"../../images/neko.png","images/inputPad.png":"../../images/inputPad.png","images/mapchip.png":"../../images/mapchip.png","images/sound.png":"../../images/sound.png","images/ecl.png":"../../images/ecl.png"},top:"../..",devMode:n}:{urlAliases:{},top:".",devMode:n};var r=window.navigator.userAgent.toLowerCase();return t.tablet=-1!=r.indexOf("windows")&&-1!=r.indexOf("touch")||-1!=r.indexOf("ipad")||-1!=r.indexOf("android")&&-1==r.indexOf("mobile")||-1!=r.indexOf("firefox")&&-1!=r.indexOf("tablet")||-1!=r.indexOf("kindle")||-1!=r.indexOf("silk")||-1!=r.indexOf("playbook"),t.mobile=-1!=r.indexOf("windows")&&-1!=r.indexOf("phone")||-1!=r.indexOf("iphone")||-1!=r.indexOf("ipod")||-1!=r.indexOf("android")&&-1!=r.indexOf("mobile")||-1!=r.indexOf("firefox")&&-1!=r.indexOf("mobile")||-1!=r.indexOf("blackberry"),t.pluginTop||(t.pluginTop=t.top+"/js/plugins"),t.disableROM={},e.match(/tonyuedit\.appspot\.com/)||e.match(/localhost:8888/),(e.match(/\.appspot\.com/)||e.match(/localhost:888[87]/))&&(t.serverType="GAE"),e.match(/localhost:3000/)&&(t.serverType="Node"),t.serverTop=e.match(/tonyuexe\.appspot\.com/)||e.match(/localhost:8887/)?t.top+"/exe":t.top+"/edit",t.sampleImg=t.top+"/images",t.blobPath=t.serverTop+"/serveBlob",t.isNW="object"==typeof process&&process.__node_webkit,t.mp3Disabled=t.isNW,t.tonyuHome="/Tonyu/",t.url={getDirInfo:t.serverTop+"/getDirInfo",getFiles:t.serverTop+"/File2LSSync",putFiles:t.serverTop+"/LS2FileSync"},t.isNW&&(t.cwd=process.cwd().replace(/\\/g,"/").replace(/\/?$/,"/"),t.tonyuHome=process.env.TONYU_HOME?process.env.TONYU_HOME.replace(/\\/g,"/").replace(/\/?$/,"/"):t.cwd+"fs/Tonyu/",t.logdir="/var/log/Tonyu/",t.wwwDir=t.cwd+"www/",t.kernelDir=t.wwwDir+"Kernel/",t.ffmpeg=t.cwd+"ffmpeg/bin/ffmpeg.exe"),t.compiledKernel=e.match(/tonyuedit\.appspot\.com/)||e.match(/localhost:888/)||t.isNW?t.top+"/Kernel/js/concat.js":"http://tonyuexe.appspot.com/Kernel/js/concat.js",window.WebSite=t}),requireSimulator.setName("NativeFS"),define(["FS2","assert","PathUtil","extend","MIMETypes","DataURL"],function(t,e,n,r,i,o){var s="object"==typeof process&&process.__node_webkit;if(!s)return function(){throw new Error("This system not suppert native FS")};var a=e,u=require("fs"),c=function(t){t&&(e.is(t,n.AbsDir),this.rootPoint=t)};c.available=!0;var l=n.SEP,f=c.prototype=new t;return f.toNativePath=function(t){return this.rootPoint?(e.is(t,n.Absolute),n.rel(this.rootPoint,this.relFromMountPoint(t))):t},t.delegateMethods(c.prototype,{getReturnTypes:function(){return a.is(arguments,[String]),{getContent:ArrayBuffer,opendir:[String]}},getContent:function(t,r){r=r||{},e.is(t,n.Absolute);var i=this.toNativePath(t),s=r.type;if(this.isText(t))return s===String?u.readFileSync(i,{encoding:"utf8"}):u.readFileSync(i);if(s===String){var a=u.readFileSync(i),c=new o(a,this.getContentType(t));return c.url}return u.readFileSync(i)},setContent:function(t,r){e.is(t,n.Absolute);var i=n.up(t);i&&this.getRootFS().mkdir(i);var s=this.toNativePath(t),a="string"==typeof r;if(!this.isText(t)){if(a){var c=new o(r);return u.writeFileSync(s,c.buffer)}return u.writeFileSync(s,r)}u.writeFileSync(s,r)},getMetaInfo:function(t,e){this.assertExist(t,e);var n=this.stat(t);return n.lastUpdate=n.mtime.getTime(),n},setMetaInfo:function(){},isReadOnly:function(){return!1},stat:function(t){e.is(t,n.Absolute);var r=this.toNativePath(t);return u.statSync(r)},mkdir:function(t){if(a.is(arguments,[n.Absolute]),this.exists(t)){if(this.isDir(t))return;throw new Error(this+" is a file. not a dir.")}this.assertWriteable(t);var e=n.up(t);e&&this.getRootFS().mkdir(e);var r=this.toNativePath(t);return u.mkdirSync(r)},opendir:function(t){a.is(arguments,[String]);var e=this.toNativePath(t),r=n.truncSEP(e),i=u.readdirSync(e).map(function(t){var e=u.statSync(r+l+t),n=e.isDirectory()?l:"";return t+n}),o=this.dirFromFstab(t);return a.is(o.concat(i),Array)},rm:function(t,e){a.is(arguments,[n.Absolute]),e=e||{},this.assertExist(t);var r=this.toNativePath(t);return this.isDir(t)?u.rmdirSync(r):u.unlinkSync(r)},exists:function(t){var e=this.toNativePath(t);return u.existsSync(e)},isDir:function(t){return this.exists(t)?this.stat(t).isDirectory():n.isDir(t)},touch:function(t){!this.exists(t)&&this.isDir(t)?this.mkdir(t):this.exists(t)&&!this.isDir(t)},getURL:function(t){return"file:///"+t.replace(/\\/g,"/")}}),c}),requireSimulator.setName("LSFS"),define(["FS2","PathUtil","extend","assert","DataURL"],function(t,e,n,r,i){function o(){return(new Date).getTime()}var s=function(t,e){this.storage=t,this.options=e||{}},a=e.isDir.bind(e),u=e.up.bind(e),c=e.endsWith.bind(e),l=(e.Path,e.Absolute),f=e.SEP;return s.ramDisk=function(){var t={};return t[e.SEP]="{}",new s(t)},s.now=o,s.prototype=new t,s.prototype.resolveKey=function(t){return r.is(t,e.Absolute),e.SEP+this.relFromMountPoint(t)},s.prototype.getItem=function(t){r.is(t,e.Absolute);var n=this.resolveKey(t);return this.storage[n]},s.prototype.setItem=function(t,n){r.is(t,e.Absolute);var i=this.resolveKey(t);r(i.indexOf("..")<0),r(e.startsWith(i,e.SEP)),this.storage[i]=n},s.prototype.removeItem=function(t){r.is(t,e.Absolute);var n=this.resolveKey(t);delete this.storage[n]},s.prototype.itemExists=function(t){r.is(t,e.Absolute);var n=this.resolveKey(t);return n in this.storage},s.prototype.inMyFS=function(t){return!this.mountPoint||e.startsWith(t,this.mountPoint)},s.prototype.getDirInfo=function(t){if(r.is(arguments,[e.AbsDir]),null==t)throw new Error("getDir: Null path");c(t,f)||(t+=f),r(this.inMyFS(t));var n={};try{var i=this.getItem(t);i&&(n=JSON.parse(i))}catch(o){console.log("dinfo err : ",t,i)}return n},s.prototype.putDirInfo=function(t,n,i){if(r.is(arguments,[e.AbsDir,Object]),!a(t))throw new Error("Not a directory : "+t);r(this.inMyFS(t)),this.setItem(t,JSON.stringify(n));var o=u(t);if(null!=o){if(!this.inMyFS(o))return r(this.getRootFS()!==this),void this.getRootFS().touch(o);var s=this.getDirInfo(o);this._touch(s,o,e.name(t),i)}},s.prototype._touch=function(t,e,n,i){r.is(arguments,[Object,String,String]),r(this.inMyFS(e)),t[n]||(t[n]={},i&&(t[n].trashed=!0)),i||delete t[n].trashed,t[n].lastUpdate=o(),this.putDirInfo(e,t,i)},s.prototype.removeEntry=function(t,e,n){r.is(arguments,[Object,String,String]),t[n]&&(t[n]={lastUpdate:o(),trashed:!0},this.putDirInfo(e,t,!0))},s.prototype.removeEntryWithoutTrash=function(t,e,n){r.is(arguments,[Object,String,String]),t[n]&&(delete t[n],this.putDirInfo(e,t,!0))},t.delegateMethods(s.prototype,{isReadOnly:function(){return this.options.readOnly},getReturnTypes:function(){return r.is(arguments,[String]),{getContent:String,opendir:[String]}},getContent:function(t,e){if(r.is(arguments,[l]),this.assertExist(t),e&&e.type==ArrayBuffer){var n=new i(this.getItem(t));return n.buffer}return this.getItem(t)},setContent:function(t,e){r.is(arguments,[l,String]),this.assertWriteable(t),this.setItem(t,e),this.touch(t)},getMetaInfo:function(t){if(this.assertExist(t,{includeTrashed:!0}),r.is(arguments,[l]),t==e.SEP)return{};var n=r(e.up(t));if(!this.inMyFS(n))return{};var i=e.name(t);r.is(n,e.AbsDir);var o=this.getDirInfo(n);return r(o[i])},setMetaInfo:function(t,n){r.is(arguments,[String,Object]),this.assertWriteable(t);var i=r(e.up(t));if(this.inMyFS(i)){var o=this.getDirInfo(i),s=e.name(t);o[s]=n,this.putDirInfo(i,o,o[s].trashed)}},mkdir:function(t){r.is(arguments,[l]),this.assertWriteable(t),this.touch(t)},opendir:function(t,e){r.is(arguments,[String]),e=e||{};var n=this.getDirInfo(t),i=this.dirFromFstab(t);for(var o in n)r(n[o]),(!n[o].trashed||e.includeTrashed)&&i.push(o);return r.is(i,Array)},rm:function(t,n){r.is(arguments,[l]),n=n||{},this.assertWriteable(t);var i=e.up(t);if(null==i||!this.inMyFS(i))throw new Error(t+": cannot remove. It is root of this FS.");if(this.assertExist(t,{includeTrashed:n.noTrash}),e.isDir(t)){var o=this.opendir(t);o.length>0&&this.err(t,"Directory not empty"),n.noTrash&&this.removeItem(t)}else this.removeItem(t);var s=this.getDirInfo(i);n.noTrash?this.removeEntryWithoutTrash(s,i,e.name(t)):this.removeEntry(s,i,e.name(t))},exists:function(t,n){r.is(arguments,[l]),n=n||{};var i=e.name(t),o=e.up(t);if(null==o||!this.inMyFS(o))return!0;var s=this.getDirInfo(o),a=s[i];return a&&a.trashed&&this.itemExists(t)&&(this.isDir(t)||r.fail("Inconsistent "+t+": trashed, but remains in storage")),!a&&this.itemExists(t)&&r.fail("Inconsistent "+t+": not exists in metadata, but remains in storage"),!a||a.trashed||a.link||this.itemExists(t)||r.fail("Inconsistent "+t+": exists in metadata, but not in storage"),a&&!n.includeTrashed&&(a=!a.trashed),!!a
},link:function(t,n){r.is(arguments,[e.AbsDir,e.AbsDir]),this.assertWriteable(t),this.exists(t)&&this.err(t,"file exists"),e.isDir(t)&&!e.isDir(n)&&this.err(t," can not link to file "+n),!e.isDir(t)&&e.isDir(n)&&this.err(t," can not link to directory "+n);var i={};i.link=n,i.lastUpdate=o(),this.setMetaInfo(t,i),console.log(this.storage),r(this.exists(t)),r(this.isLink(t))},isLink:function(t){if(r.is(arguments,[e.AbsDir]),!this.exists(t))return null;var n=r(this.getMetaInfo(t));return n.link},touch:function(t){r.is(arguments,[l]),this.assertWriteable(t),this.itemExists(t)||(e.isDir(t)?this.setItem(t,"{}"):this.setItem(t,""));var n=u(t);if(null!=n)if(this.inMyFS(n)){var i=this.getDirInfo(n);this._touch(i,n,e.name(t),!1)}else r(this.getRootFS()!==this),this.getRootFS().touch(n)},getURL:function(t){return this.getContent(t,{type:String})}}),s}),requireSimulator.setName("Env"),define(["assert","PathUtil"],function(t,e){var n=function(t){this.value=t};return n.prototype={expand:function(e){t.is(e,String);var n=this;return e.replace(/\$\{([a-zA-Z0-9_]+)\}/g,function(t,e){return n.get(e)})},expandPath:function(n){return t.is(n,String),n=this.expand(n),n=n.replace(/\/+/g,"/"),t.is(n,e.Path)},get:function(t){return this.value[t]},set:function(t,e){this.value[t]=e}},n}),requireSimulator.setName("FS"),define(["FS2","WebSite","NativeFS","LSFS","PathUtil","Env","assert","SFile"],function(t,e,n,r,i,o,s,a){var t={};"object"==typeof window&&(window.FS=t);var u,c=new o(e);return u=e.isNW?new n:new r(localStorage),t.get=function(){return u.get.apply(u,arguments)},t.expandPath=function(){return c.expandPath.apply(c,arguments)},t.resolve=function(e,n){return a.is(e)?e:(e=c.expandPath(e),n&&!i.isAbsolutePath(e)?(n=c.expandPath(n),t.get(n).rel(e)):t.get(e))},t.mount=function(){return u.mount.apply(u,arguments)},t}),requireSimulator.setName("HttpHelper"),requireSimulator.setName("Arrow"),Arrow=function(){var t={};return t.show=function(t){function e(){t.addClass("tutorial-highlight"),setTimeout(n,200)}function n(){t.removeClass("tutorial-highlight"),o-->0?setTimeout(e,200):r()}function r(){o=0,$.data(t[0],"blinking","f")}if("string"==typeof t&&(t=$(t)),0==t.length)return!1;var i=$.data(t[0],"blinking");if("t"!=i){$.data(t[0],"blinking","t");var o=3;e(),t.click(function(){r()})}},t.showOld=function(t){function e(){r&&(r.attr({src:"images/arrow"+i+".png"}),i=(i+1)%4)}if("string"==typeof t&&(t=$(t)),0==t.length)return!1;var n=t.offset(),r=$("<img>").attr({src:"images/arrow0.png"}).css({font:"40px",position:"absolute",left:n.left,top:n.top+t.height(),color:"red",zIndex:1e3,"z-index":1e3}).appendTo("body"),i=0;return setInterval(e,250),t.click(function(){r&&(r.remove(),r=null)}),!0},t}(),requireSimulator.setName("Shell"),define(["FS","Util","WebSite"],function(t,e,n){function r(t,e){var n=i(t);if(e&&!n.exists())throw n+": no such file or directory";return n}function i(n){if("string"!=typeof n)return n;if(e.startsWith(n,"/"))return t.get(n);var r=o.cwd;return r.rel(n)}var o={cwd:t.get("/")};return o.cd=function(t){return o.cwd=r(t,!0),o.pwd()},o.resolve=r,o.pwd=function(){return o.cwd+""},o.ls=function(t){return t=t?r(t,!0):o.cwd,t.ls()},o.cp=function(t,e,n){n||(n={}),n.v&&(o.echo("cp",t,e),n.echo=o.echo.bind(o));var i=r(t,!0),s=r(e);return i.copyTo(s,n)},o.rm=function(t,e){if(e||(e={}),e.notrash)return t=r(t,!1),t.removeWithoutTrash(),1;if(t=r(t,!0),t.isDir()&&e.r){var n=t,i=0;return n.each(function(t){t.exists()&&(i+=o.rm(t,e))}),n.rm(),i+1}return t.rm(),1},o.cat=function(t){t=r(t,!0),o.echo(t.text())},o.resolve=function(t){return t||(t="."),t=r(t)},o.grep=function(t,e,n){function i(t,e,r){n.res&&n.res.push({file:t,lineNo:e,line:r}),o.echo(t+"("+e+"): "+r)}return e=r(e,!0),n||(n={}),n.res||(n.res=[]),e.isDir()?e.each(function(e){o.grep(t,e,n)}):"string"==typeof t&&e.lines().forEach(function(n,r){n.indexOf(t)>=0&&i(e,r+1,n)}),n.res},o.touch=function(t){return t=r(t),t.text(t.exists()?t.text():""),1},o.setout=function(t){o.outUI=t},o.echo=function(){console.log.apply(console,arguments),o.outUI&&o.outUI.log&&o.outUI.log.apply(o.outUI,arguments)},o.err=function(){console.log.apply(console,arguments),o.outUI&&o.outUI.err&&o.outUI.err.apply(o.outUI,arguments)},o.prompt=function(){},o.ASYNC={r:"SH_ASYNC"},o.help=function(){for(var t in o){var e=o[t];"function"==typeof e&&o.echo(t+(e.description?" - "+e.description:""))}},sh=o,n.isNW&&(sh.devtool=function(){require("nw.gui").Window.get().showDevTools()}),o}),requireSimulator.setName("Log"),define(["FS","WebSite","Shell"],function(t,e,n){function r(t,e){return t="00000000000000"+t,t.substring(t.length-e)}function i(t){return t.replace(/\n/g,"\n|")}var o={},s=e.logdir?t.resolve("${logdir}"):null,a=s&&s.exists();if(o.todayDir=function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return s.rel(e+"/").rel(n+"/").rel(r+"/")},o.curFile=function(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return o.todayDir().rel(e+"-"+n+"-"+r+".log")},o.curProject=function(){var t=new Date,e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return o.todayDir().rel("Project/").rel(r(e,2)+"_"+r(n,2)+"_"+r(i,2)+"/")},o.dumpProject=function(t){if(a){var e=o.curProject();n.cp(t,e),o.append("Dumped project to "+e.path())}},!e.logging&&!e.isNW){var u=t.get("/var/log/");u.exists()&&u.fs.storage===localStorage&&u.removeWithoutTrash({r:!0})}return o.append=function(t){if(a){var e=o.curFile(),n=e.exists()?e.text():"";e.text(n+t+"\n")}},o.d=function(t,e){o.append(new Date+": ["+t+"]"+i(e))},o.e=function(t,e){o.append(new Date+": ERROR["+t+"]"+i(e))},o}),requireSimulator.setName("exceptionCatcher"),define([],function(){var t={};return t.f=function(e){if("function"==typeof e){if(e.isTrcf)return e;var n=function(){if(!t.handleException||t.enter)return e.apply(this,arguments);try{return t.enter=!0,e.apply(this,arguments)}catch(n){t.handleException(n)}finally{t.enter=!1}};return n.isTrcf=!0,n}if("object"==typeof e){for(var r in e)e[r]=t.f(e[r]);return e}},t}),requireSimulator.setName("UI"),define(["Util","exceptionCatcher"],function(t,e){var n={},r=e.f;return n=function(){function e(){l.forEach(function(t){t()}),setTimeout(r(e),10)}function i(t){return t instanceof Array?o(t):"string"==typeof t?a(t):t}function o(t){var e=t[0],n=1,r=$("<"+e+">");for("object"!=typeof t[n]||t[n]instanceof Array||t[n]instanceof $||(s(r,t[n],e),n++);n<t.length;)r.append(i(t[n])),n++;return r}function s(e,i){function o(t,n){if(n)if("enterkey"==t)e.on("keypress",r(function(t){13==t.which&&n.apply(e,arguments)}));else if("realtimechange"==t){var o,s=!0;l.push(function(){var t;t="checkbox"==i.type?!!e.prop("checked"):e.val(),(s||o!=t)&&(n.apply(e,[t,o]),o=t),s=!1})}else e.on(t,r(n))}i.$var&&(f[i.$var]=e),i.$edit&&("string"==typeof i.$edit&&(i.$edit={name:i.$edit,type:n.types.String}),i.on||(i.on={}),i.on.realtimechange=r(function(t){p.writeToModel(i.$edit,t,e)}),f[i.$edit.name]||(f[i.$edit.name]=e),p.push({jq:e,params:i}));for(var s in i)if("on"==s)for(var a in i.on)o(a,i.on[a]);else"css"==s&&null!=i[s]?e.css(i[s]):t.startsWith(s,"$")||null==i[s]||e.attr(s,i[s])}function a(t){return $("<span>").text(t)}for(var u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];var l=[],f={},p=[],h=i(u);return h.$edits=p,h.$vars=f,p.load=function(t){p.model=t,p.forEach(function(t){p.writeToJq(t.params.$edit,t.jq)})},p.writeToJq=function(t,e){var n=p.model;if(n){for(var r=t.name,i=r.split("."),o=0;o<i.length;o++)n=n[i[o]];n=t.type.toVal(n),"checkbox"==e.attr("type")?e.prop("checked",!!n):e.val(n)}},p.validator={errors:{},show:function(){if(f.validationMessage){f.validationMessage.empty();for(var t in this.errors)f.validationMessage.append(n("div",this.errors[t].mesg))}if(f.OKButton){var e=!0;for(var t in this.errors)e=!1;f.OKButton.attr("disabled",!e)}},on:{validate:function(){}},addError:function(t,e,n){this.errors[t]={mesg:e,jq:n},this.show()},removeError:function(t){delete this.errors[t],this.show()},allOK:function(){for(var t in this.errors)delete this.errors[t];this.show()},isValid:function(){var t=!0;for(var e in this.errors)t=!1;return t}},p.writeToModel=function(t,e,n){var r=p.model;if(r){var i=t.name;try{e=t.type.fromVal(e)}catch(o){return void p.validator.addError(i,o,n)}p.validator.removeError(i);for(var s=i.split("."),a=0;a<s.length;a++)a==s.length-1?p.on.writeToModel(i,e)||(r[s[a]]=e):r=r[s[a]];p.validator.on.validate.call(p.validator,p.model)}},p.on={},p.on.writeToModel=function(){},l.length>0&&setTimeout(r(e),10),h},n.types={String:{toVal:function(t){return t},fromVal:function(t){return t}},Number:{toVal:function(t){return t+""},fromVal:function(t){return parseFloat(t)}}},n}),requireSimulator.setName("Wiki"),define(["HttpHelper","Arrow","Util","WebSite","Log","UI","FS"],function(t,e,n,r,i,o,s){return Wiki=function(n,a,u){function c(t){function e(t){t.stopPropagation(),t.preventDefault()}function n(t){if(u.editMode){var e=t.originalEvent,n=e.dataTransfer.files[0];if(!n.type.match(/image\/(png|gif|jpg)/)[1])return t.stopPropagation(),t.preventDefault(),!1;var r=new FileReader;return r.onload=function(){var t=r.result;a.text(t),i.empty().append(o("img",{src:t}))},r.readAsDataURL(n),t.stopPropagation(),t.preventDefault(),!1}}var i,a;if(f.builtinImages[t])return $("<div>").append($("<img>").attr("src",r.top+"/doc/images/"+t));i=o("div",{style:"margin:10px; padding:10px; border:solid black 1px;",on:{dragover:e,dragenter:e,drop:n}},"ここに画像ファイル(png/gif/jpg)をドラッグ＆ドロップして追加");var c=s.get(r.tonyuHome);return a=c.rel("doc/images/").rel(t),a.exists()&&i.empty().append(o("img",{src:a.text()})),i}function l(t,e,n){function r(){for(var s=[];;){var a=t.indexOf(e,o),u=t.indexOf(n,o);if(u>=0&&(0>a||a>u)){s.push(t.substring(o,u)),o=u;break}if(0>a){s.push(t.substring(o)),o=t.length;break}s.push(t.substring(o,a)),o=a+e.length;var c=r();c.hasBrace=!0,o<t.length&&(o+=n.length),s.push(c)}return i(s),s}function i(t){return t.split=function(t,e){if(1==e)return this;var n=[],r=i([]);return this.forEach(function(o){if("string"==typeof o){var s=o.indexOf(t);if(n.length>=e&&(s=-1),s>=0){if(s>0){var a=o.substring(0,s);r.push(a)}if(s+=t.length,n.push(1!=r.length?r:r[0]),r=i([]),s<o.length){var a=o.substring(s);r.push(a)}}else r.push(o)}else r.push(o)}),n.push(1!=r.length?r:r[0]),n},t.text=function(t){var r=this.hasBrace&&t?e:"";return this.forEach(function(t){r+="string"==typeof t?t:t.text(!0)}),r+=this.hasBrace&&t?n:""},t.toString=function(){return this.text(!0)},t}var o=0;return r(0)}var f={},p={figures:"図",plists:"リスト"},h="line_marker_",d={},g=[],m=".txt";if(u||(u={}),a&&!a.isDir())throw a+": not a dir";var v,y;f.on=d,f.cd=function(t){v=t,y=v.rel("toc.json")},a&&f.cd(a),f.encodeURL=function(t){return encodeURI(t).replace(/%/g,"")},f.parse=function(n,i,o){function s(t){g[t]={};var e=1,n=function(n,r){var i=g[t][n];return i||(i={refs:[]},g[t][n]=i),r&&(i.no=e++,i.name=p[t]+i.no,i.refs.forEach(function(t){t.text(i.name)})),i};return n}function a(t){function e(t){for(null==t&&(t=0);g.ul>t;)g.ul--,m.exit()}m.lineNo=g.lineNo;var n=0;if(t.match(/^-+/)&&(n=RegExp.lastMatch.length),n>g.ul)for(;n>g.ul;)g.ul++,m.enter("<ul>");else e(n);if(t=t.substring(n),n>0&&m.enter("<li>"),t.match(/^\*+/)){var r=RegExp.rightContext,i="h"+RegExp.lastMatch.length;m.enter("<"+i+">"),d(r),m.exit()}else if(t.match(/^$/))e(),m.p($("<p>"));else if(t.match(/^<<toc(.*)/))g.toc=[g.name],g.blocks.push({name:"toc",exit:function(){y&&!y.isReadOnly()&&y.obj(g.toc),g.toc=null}});else if(t.match(/^<<code(.*)/)){var o=RegExp.$1;if(o=o.replace(/^ */,""),o.length>0){var s,a,u=o.split(/ /,2);if(2==u.length){a=u[0],s=u[1];var c=x(s,!0);m.p($("<div>").addClass("plist").text(c.name+" "+a))}else m.p($("<div>").addClass("plist").text(u))}m.enter("<pre>"),g.blocks.push({name:"code",exit:function(){m.exit()}})}else if(t.match(/^>>/)){var l=g.blocks.pop();l&&l.exit&&l.exit(g)}else if(t.match(/^@@@@(.*)/)){if(g.pclose)m.exit();else{if(RegExp.$1.length>0){var c=x(RegExp.$1,!0);m.p($("<div>").addClass("plist").text(c.name))}m.enter("<pre>")}g.pclose=!g.pclose}else d(t),m.p("\n");n>0&&m.exit(),g.lineNo++}function d(t){function n(t){var n,i=t.text();if(i.match(/^@blink ([^>]+)>([^\s]+)/)){caption=RegExp.$1;var s=RegExp.$2;n=$("<span>").addClass("clickable").text(caption).hover(function(){var t;parent&&parent.Arrow&&(t=parent.Arrow),e&&(t=e),t&&t.show(s)})}else if(i.match(/^@plistref (.*)/)){var a=RegExp.$1,l=x(a);n=$("<strong>").text(l.name),l.refs.push(n)}else if(i.match(/^@editadd/))m.p($("<img>").attr("src",r.top+"/images/editAdd.png"));else if(i.match(/^@figref (.*)/)){var l=v(RegExp.$1);n=$("<strong>").text(l.name),l.refs.push(n)}else if(i.match(/^@cfrag (.*)/)){var h=RegExp.$1;n=$("<code>"),m.enter(n),d(h),m.exit()}else if(i.match(/^@arg (.*)/)){var y=RegExp.$1;n=$("<i>"),m.enter(n),d(y),m.exit()}else{var b=t.split(">",2);if(2==b.length?(i=b[1]+"",caption=b[0]):caption=i,g.toc&&g.toc.push(i),i.match(/\.(png|jpg|gif)$/)&&!i.match(/^http/)){var l=v(i,!0);n=$("<div>").addClass("figure").append(c(i)),m.enter(n),m.enter($("<div>")),m.p(p.figures+l.no+"."),d(caption),m.exit(),m.exit()}else if(i.match(/^https?:\/\//))n=$("<a>").attr({href:i,target:"ext"}).text(caption);else{var S=f.resolveFile(i);if(S.exists()||!S.isReadOnly()&&u.editMode){if(u.useAnchor){var w=S.relPath(o.up()).replace(/\.txt$/,".html");w=f.encodeURL(w),n=$("<a>").attr({href:w}).text(caption)}else n=$("<span>").addClass("clickable").text(caption).click(function(){f.show(S)});S.exists()||n.addClass("notexist")}else n=$("<span>").text(caption)}}m.p(n)}var i="string"==typeof t?l(t,g.beginMark,g.endMark):t;i.forEach(function(t){"string"==typeof t?m.p(t):n(t)})}var g={},m=t({lineMark:h});g.out=m,g.name=i,g.lines=n.split(/\r?\n/),g.lineNo=0,g.ul=0,g.beginMark="[[",g.endMark="]]",g.blocks=[];var v=s("figures"),x=s("plists"),b=[];y&&y.exists()&&(b=y.obj());var S=b.indexOf(i);if(S>=0){var w="",D=b[S-1];D&&(w+="[[前へ>"+D+"]]");var A=b[S+1];A&&(w+=" - [[次へ>"+A+"]]");var E=b[0];0!=S&&(w+=" - [[目次>"+E+"]]"),g.lines.unshift(w),g.lines.push(w)}return g.lines.forEach(a),m.buf},f.resolveFile=function(t){var e;return e=t.isDir?t:v&&"/"!=t.substring(0,1)?v.rel(t+m):s.get(t)},f.show=function(t){var e=f.resolveFile(t);u.editMode||i.d("wiki","show "+e),f.cd(e.up());var r=e.truncExt(m);if(!e.exists()&&!e.isReadOnly()&&u.editMode){var o=g[g.length-1];e.text(o?"[["+o.truncExt(m)+"]]\n":"")}if(e.exists()){var s=f.parse(e.text(),r,e);n.empty(),n.scrollTop(0),n.append(s),n.append($("<div>").css({height:"100px"}).text("")),d.show&&d.show.apply(f,[e,r]),g.push(e)}else alert(t+" というページはありません")},f.back=function(){var t=g.pop();t&&show(t)};var x;return f.highlightLine=function(t){var e=$("#"+h+"-"+t);if(0!=e.length){x&&x.removeClass("wiki-cur-line"),x=e.next(),x.addClass("wiki-cur-line");var r=e.position().top,i=n;0>r&&i.scrollTop(i.scrollTop()+(r-10)/2);var o=i.height()-100;r>o&&i.scrollTop(i.scrollTop()+(r-o+10)/2)}},f.builtinImages={"50_100.png":1,"50_160.png":1,"50_300.png":1,"apple1apple2.png":1,"coords.png":1,"copy60_100.png":1,"firstRunRes.png":1,"firstVarRes.png":1,"itadaki.png":1,"noWaitCat.png":1,"runtimeError.png":1,"sample.png":1,"sayonara.png":1,"syntaxError.png":1},f}}),requireSimulator.setName("Shell2"),define(["Shell","UI","FS","Util"],function(t,e,n,r){var i={};return i.show=function(t){var e=i.embed(t);e.dialog({width:600,height:500})},i.embed=function(){i.d||(i.d=e("div",{title:"Shell"},["div",{$var:"inner"},"Type 'help' to show commands.",["br"]]),i.inner=i.d.$vars.inner,t.prompt());var n=i.d;return n},t.cls=function(){i.d.$vars.inner.empty()},t.prompt=function(){function n(t){return 9==t.which?(t.stopPropagation(),t.preventDefault(),s(),!1):void(13==t.which&&(l.empty(),o(u.val())))}function o(){var n=u.val().replace(/^ */,"").replace(/ *$/,"");if(0!=n.length){var r=n.split(/ +/),i=r.shift(),o=t[i];if("function"!=typeof o)return c.append(i+": command not found.");try{var s=[],a=null;r.forEach(function(t){var e=/^-([A-Za-z_0-9]+)(=(.*))?/.exec(t);e?(a||(a={}),a[e[1]]=null!=e[3]?e[3]:1):s.push(t)}),a&&s.push(a);var l=o.apply(t,s);if(l===t.ASYNC)return;if("object"==typeof l)if(l instanceof Array){var f=e("table"),p=null,h=0;l.forEach(function(t){p||(p=e("tr").appendTo(f)),p.append(e("td",t)),h++,h%3==0&&(p=null)}),f.appendTo(c)}else c.append(JSON.stringify(l));else c.append(l);t.prompt()}catch(d){t.err(d),t.prompt()}}}function s(){var e=u.val(),n=e.split(" "),i=n.pop(),o=[];if(0==n.length)for(var s in t)"function"==typeof t[s]&&r.startsWith(s,i)&&o.push(s);else{var a=t.resolve(i,!1);if(!a)return;var c=a.isDir()?a:a.up();c.each(function(t){r.startsWith(t.path(),a.path())&&o.push(t.name())})}if(1==o.length){var f=i.split("/");f.pop(),f.push(o[0]),n.push(f.join("/")),u.val(n.join(" ")),l.empty()}else l.text(o.join(", "))}var a=e("div",["input",{$var:"cmd",size:40,on:{keydown:n}}],["pre",{$var:"out","class":"shell out"},["div",{$var:"cand","class":"shell cand"}]]),u=a.$vars.cmd,c=a.$vars.out,l=a.$vars.cand;return t.setout({log:function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);c.append(t.join(" ")+"\n")},err:function(t){c.append(e("div",{"class":"shell error"},t,["br"],["pre",t.stack]))}}),a.appendTo(i.inner),u.focus(),i.inner.closest(".ui-dialog-content").scrollTop(i.inner.height()),t.ASYNC},t.window=function(){i.show(t.cwd)},t.atest=function(t,e,n){console.log(t,e,n)},i}),requireSimulator.setName("NewProjectDialog"),define(["UI"],function(t){var e={};return e.show=function(t,n,r){var i=e.embed(t,n,r);i.dialog({width:600})},e.embed=function(n,r,i){if(i||(i={}),!e.d){var o={fromVal:function(t){return""==t?null:FS.get(t)},toVal:function(t){return t?t.path():""}};e.d=t("div",{title:i.ren?"プロジェクト名の変更":"新規プロジェクト"},["div",["span","プロジェクト名"],["input",{$edit:"name",value:i.defName||"",on:{enterkey:function(){e.d.done()}}}]],["div",["span","親フォルダ"],["input",{$edit:{name:"parentDir",type:o}}]],["div",["span","作成先フォルダ："],["span",{$var:"dstDir"}]],["div",{$var:"validationMessage",css:{color:"red"}}],["button",{$var:"OKButton",on:{click:function(){e.d.done()}}},"OK"])}var s=e.d,a={name:i.defName||"",parentDir:n};return s.$edits.load(a),s.$edits.validator.on.validate=function(t){return""==t.name?void this.addError("name","名前を入力してください"):(t.dstDir=t.parentDir.rel(t.name+"/"),t.dstDir.exists()?void this.addError("name","このフォルダはすでに存在します"):(this.allOK(),void s.$vars.dstDir.text(t.dstDir+"")))},s.done=function(){s.$edits.validator.isValid()&&(r(a.dstDir),s.dialog&&s.dialog("close"))},s},e}),requireSimulator.setName("requestFragment"),define(["WebSite"],function(t){var e={};return e.ajax=function(e){function n(t){return e.redirectTo&&(t.redirectTo=e.redirectTo),t}function r(){$.ajax({type:"post",url:t.serverTop+"/runFragments",data:n({id:a}),success:function(t){return"string"==typeof t&&t.match(/^notCompleted:([\-\d]+)\/([\-\d]+)$/)?(console.log("notcomp",t),l*=2,void setTimeout(r,l)):void e.success(t)},error:e.error,complete:e.complete})}var i=e.THRESH||8e5,o=e.data;if("object"!=typeof o)throw"Data should be object: "+o;if(o=JSON.stringify(o),!e.redirectTo&&("GAE"!=t.serverType||o.length<i))return $.ajax(e);for(var s=[],a=Math.random();o.length>0;)s.push(o.substring(0,i)),o=o.substring(i);var u=s.length,c=0,l=1e3;s.forEach(function(i,o){$.ajax({type:"post",url:t.serverTop+"/sendFragment",data:n({id:a,seq:o,len:u,content:i}),success:function(t){console.log("sendFrag",t,o),c++,c>=u&&setTimeout(r,l)},error:e.error})})},e}),requireSimulator.setName("Sync"),define(["FS","Shell","requestFragment","WebSite"],function(t,e,n,r){function i(t){return t&&t.isDir}var o={};return e.sync=function(){function t(t){return function(){t&&t.apply({},arguments),e.prompt()}}var n,r,s,a=function(){},u=0;return("string"==typeof arguments[u]||i(arguments[u]))&&(n=e.resolve(arguments[u],!0),u++,("string"==typeof arguments[u]||i(arguments[u]))&&(r=e.resolve(arguments[u],!1),u++)),"object"==typeof arguments[u]&&(s=arguments[u],u++),"function"==typeof arguments[u]&&(a=arguments[u],u++),n||(r=n=e.cwd),s&&s.onend&&(s.onend=t(s.onend)),r||(r=n),e.echo("sync args=",n,r,s,a),o.sync(n,r,s,t(a)),e.ASYNC},o.sync=function(){function t(t,n){e.echo("Status: "+t+" param:",n),h.onstatus&&h.onstatus(t,n)}function o(){h.onerror&&h.onerror.apply(this,arguments)}function s(){var e={base:p.path(),excludes:JSON.stringify(h.excludes)};t("getDirInfo",e),$.ajax({type:"get",url:r.serverTop+"/getDirInfo",data:e,success:a,error:o})}function a(n){h.v&&e.echo("getDirInfo",n);var i=f,s=n.data;for(var a in s){var c=i.rel(a),d=c.exists({includeTrashed:!0})&&c.metaInfo(),g=s[a];l(c,a,d,g)}f.recursive(function(t){var e=t.exists({includeTrashed:!0})&&t.metaInfo(),n=t.relPath(f),r=s[n];l(t,n,e,r)},{includeTrashed:!0,excludes:h.excludes}),h.v&&(e.echo("uploads:",m),e.echo("downloads:",v));var y={base:p.path(),paths:JSON.stringify(v)};t("File2LSSync",y),$.ajax({type:"post",url:r.serverTop+"/File2LSSync",data:y,success:u,error:o})}function u(i){e.echo("dlData=",i),h.v&&e.echo("dlData:",i);var s=f;if(!h.test){for(var a in i.data){var u=s.rel(a),l=i.data[a];l.trashed?u.exists()&&u.rm():u.text(l.text),delete l.text,u.metaInfo(l)}var d={base:p.path(),data:JSON.stringify(m)};d.pathInfo="/LS2FileSync",t("LS2FileSync",d),n.ajax({type:"post",url:r.serverTop+"/LS2FileSync",data:d,success:c,error:o})}}function c(t){h.v&&e.echo("LS2FileSync res=",t);var n=[];for(var r in m)n.push(r);t={msg:t,uploads:n,downloads:v},"function"==typeof d&&d(t)}function l(t,n,r,i){if(!y[n])if(y[n]=1,i&&(!r||r.lastUpdate<i.lastUpdate))v.push(n),h.v&&e.echo((r?"":"New")+"Download "+t+" trash="+!!i.trashed);else if(r&&(!i||r.lastUpdate>i.lastUpdate)){var o=r.trashed?{}:{text:t.text()},s=t.metaInfo();for(var a in s)o[a]=s[a];m[n]=o,h.v&&e.echo((i?"":"New")+"Upload "+t+" trash="+!!r.trashed)}}var f,p,h,d,g=0;if(i(arguments[g])&&(f=arguments[g],g++,i(arguments[g])&&(p=arguments[g],g++)),"object"==typeof arguments[g]&&(h=arguments[g],g++),"function"==typeof arguments[g]&&(d=arguments[g],g++),!f)throw"Sync.sync: Local dir must be specified as file object";p||(p=f),h||(h={}),!d&&h.onend&&(d=h.onend),h.test&&(h.v=1),s();var m={},v=[],y={}},e.rsh=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $.ajax({url:r.serverTop+"/rsh",data:{args:JSON.stringify(t)},success:function(t){e.echo(t)},error:function(t,n,r){e.err(r)},complete:function(){e.prompt()}}),e.ASYNC},o}),requireSimulator.setName("Auth"),define(["WebSite"],function(t){var e={};return e.currentUser=function(e){$.ajax({type:"get",url:t.serverTop+"/currentUser",data:{withCsrfToken:!0},success:function(t){console.log("auth.currentUser",t),t=JSON.parse(t);var n=t.user;"null"==n&&(n=null),console.log("user",n,"csrfToken",t.csrfToken),e(n,t.csrfToken)}})},e.assertLogin=function(n){e.currentUser(function(e,r){return e?n.success(e,r):(window.onLoggedIn=n.success,void n.showLoginLink(t.serverTop+"/login"))})},window.Auth=e,e}),requireSimulator.setName("zip"),define(["FS","Shell","Util"],function(t,e,n){if("undefined"==typeof JSZip)return{};var r={};r.zip=function(t){function e(t,n){n.each(function(n){if(n.isDir()){var r=t.folder(n.name());e(r,n)}else n.isText()?t.file(n.name(),n.text()):t.file(n.name(),n.getBytes())})}var n=new JSZip;e(n,t);var r=n.generate({type:"blob"});return r},"undefined"!=typeof saveAs&&(r.dlzip=function(t){var e=r.zip(t);saveAs(e,t.name().replace(/\/$/,"")+".zip")},e.dlzip=function(t){t=e.resolve(t||"."),r.dlzip(t)});var i={".png":"image/png",".jpg":"image/jpg",".gif":"image/gif",".jpeg":"image/jpg",".mp3":"audio/mp3",".ogg":"audio/ogg"};return r.unzip=function(t,e){var r=new JSZip(t);for(var o in r.files){var s=r.files[o],a=e.rel(s.name);for(var u in i){var c;if(a.endsWith(u)){var l=i[u];c="data:"+l+";base64,"+n.Base64_From_ArrayBuffer(s.asArrayBuffer())}else c=s.asText();a.text(c)}console.log(s.name)}},r}),requireSimulator.setName("ide/selProject"),requirejs(["FS","Wiki","Shell","Shell2","NewProjectDialog","UI","Sync","Auth","zip","requestFragment","WebSite"],function(t,e,n,r,i,o,s,a,u,c,l){$(function(){function e(){$("#prjItemList").empty();var t=[];u.each(function(e){if(e.isDir()){var n=e.lastUpdate(),r=e.rel("options.json");r.exists()&&(n=r.lastUpdate()),t.push([e,n])}}),t=t.sort(function(t,e){return e[1]-t[1]}),t.forEach(function(t){var e=t[0],n=e.name();if(e.isDir()){var r=o("div",{"class":"project"},["a",{href:"project.html?dir="+e.path()},["img",{$var:"t",src:"../../images/nowprint.png"}],["div",n]]);r.appendTo("#prjItemList"),setTimeout(function(){var t=e.rel("images/").rel("icon_thumbnail.png");t.exists()&&r.$vars.t.attr("src",t.getURL())},10)}})}var r=t.get(l.tonyuHome),s=r.rel("Projects/");s.exists()||s.mkdir(),n.cd(s);var u=s;l.isNW&&$("#loginGrp").hide(),a.currentUser(function(t){t?($(".while-logged-out").hide(),$("#login").text(t)):$(".while-logged-in").hide()});var c=$("<iframe>").attr("src",l.top+"/doc/index.html");c.height($(window).height()-$("#navBar").height()),$("#wikiViewArea").append(c),$("#newPrj").click(function(){i.show(s,function(t){t.mkdir(),document.location.href="project.html?dir="+t.path()})}),e(),SplashScreen.hide(),$("body").on("keydown",function(t){77==t.keyCode&&l.devMode&&(l.mobile=!l.mobile,console.log("Mobile mode",l.mobile),l.mobile?r.rel("mobile.txt").text("true"):r.rel("mobile.txt").rm())}),n.wikiEditor=function(){document.location.href="wikiEditor.html"}})}),requireSimulator.setName();