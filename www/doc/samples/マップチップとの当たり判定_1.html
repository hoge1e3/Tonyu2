<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
<script language='text/tonyu' type='text/tonyu' data-filename='Main.tonyu'>
$map=new Map;
$map.load("stage1.json");
new Player;
</script>

<script language='text/tonyu' type='text/tonyu' data-filename='Player.tonyu'>
x=100;
y=100;
while(true){
    //移動前の座標を覚える
    sx=x;sy=y;
    if(getkey("right")>0){
        x+=3;
    }
    if(getkey("left")>0){
        x-=3;
    }
    if(getkey("down")>0){
        y+=3;
    }
    if(getkey("up")>0){
        y-=3;
    }
    //マップチップとの当たり判定
    if($map.getOnAt(x,y)>-1){
        //マップチップにぶつかっていたら、移動前の座標に戻す
        x=sx;y=sy;
    }
    update();
}
</script>

<script>WebSite={runType:'singleHTML',useEditButton:true};</script>
<script src="https://edit.tonyu.jp/js/lib/jquery-1.10.1.js" type="text/javascript"></script>
<script src="https://edit.tonyu.jp/js/g2/runScript_concat.min.js" type="text/javascript"></script>
</head>
<body><div id='splash' style='position:relative; height: 100%;'>
Loading...    <div class='progress'></div>
</div></body></html>