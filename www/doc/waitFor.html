<html><body class="markdown-body">
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" href="css/style.css"/>
<script src="js/jquery-1.10.1.js"></script>
<script src="js/doc.js"></script>
<p><!-- Konbaatiddo from Tonyu2 non-md document -->
</p>
<p><a href="BaseActor">BaseActor</a></p>
<h1 id="waitfor-">waitForメソッド</h1>
<p>指定した動作が終わるまで待機します</p>
<h2 id="-">書式</h2>
<p>※必ず<a href="waitmode">待機可能モード</a>で呼び出して下さい</p>
<pre><code class="lang-JS">r=waitFor(promise);
</code></pre>
<p><code>promise</code>には，<a href="thread">スレッド</a>またはJavaScript/jQueryのPromiseオブジェクトを指定します（例：<code>$.get(...)</code>，<a href="Panel.load">Panel.load</a>など． )．</p>
<p><code>promise</code>が結果を返す（スレッドが正常終了する，または<code>promise.done(f)</code> の関数<code>f</code>が呼び出される）と，waitForメソッドは終了し，スレッドの戻り値または<code>f</code>に渡された第1引数の値が戻り値として返されます．</p>
<p><code>promise</code>が失敗する（スレッドが例外を投げるか，killメソッドで停止させられる，<code>promise.fail(f)</code> の関数<code>f</code>が呼び出される）と，waitForメソッドは例外を投げます．例外オブジェクト<code>e</code>の<code>e.original</code>に，<code>f</code>に渡された第1引数が格納されます</p>
<p>例</p>
<pre><code class="lang-JS">native $;
try {
    // $.getの結果がrに入る
    r=waitFor($.get(&quot;http://tonyu.jp/&quot;));
    print(r.substring(0,100));
} catch(e) {
    //エラーの場合
    print(e.original.statusText);
}
</code></pre>
<pre><code class="lang-JS">try {
    // okを実行し，その結果がrに入る
    r=waitFor(parallel(&quot;ok&quot;));
    print(&quot;Succ&quot;,r);
} catch(e) {
    //エラーの場合
    print(&quot;Err&quot;,e);
}

\ok() {
    updateEx(30);
    return &quot;OK&quot;;
}
</code></pre>
<p>.</p>
</body></html>
